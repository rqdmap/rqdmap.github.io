<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="[toc]">
<meta property="og:type" content="article">
<meta property="og:title" content="2021-XDU-寒假训练">
<meta property="og:url" content="http://rqdmap.github.io/2021/01/17/2021-XDU-%E5%AF%92%E5%81%87%E8%AE%AD%E7%BB%83/index.html">
<meta property="og:site_name" content="rqdmap">
<meta property="og:description" content="[toc]">
<meta property="og:locale">
<meta property="article:published_time" content="2021-01-17T07:47:57.000Z">
<meta property="article:modified_time" content="2021-01-17T07:47:57.000Z">
<meta property="article:author" content="rqdmap">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>2021-XDU-寒假训练</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<meta name="generator" content="Hexo 5.4.0"></head>

<body class="max-width mx-auto px3 ltr">    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" "Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/categories/">Category</a></li>
         
          <li><a href="/tags/">Tag</a></li>
         
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post " href="/2021/01/18/poj-1222/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post " href="/2021/01/16/%E5%9D%97%E7%8A%B6DS/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top " href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post " href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://rqdmap.github.io/2021/01/17/2021-XDU-%E5%AF%92%E5%81%87%E8%AE%AD%E7%BB%83/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://rqdmap.github.io/2021/01/17/2021-XDU-%E5%AF%92%E5%81%87%E8%AE%AD%E7%BB%83/&text=2021-XDU-寒假训练"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://rqdmap.github.io/2021/01/17/2021-XDU-%E5%AF%92%E5%81%87%E8%AE%AD%E7%BB%83/&title=2021-XDU-寒假训练"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://rqdmap.github.io/2021/01/17/2021-XDU-%E5%AF%92%E5%81%87%E8%AE%AD%E7%BB%83/&is_video=false&description=2021-XDU-寒假训练"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=2021-XDU-寒假训练&body=Check out this article: http://rqdmap.github.io/2021/01/17/2021-XDU-%E5%AF%92%E5%81%87%E8%AE%AD%E7%BB%83/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://rqdmap.github.io/2021/01/17/2021-XDU-%E5%AF%92%E5%81%87%E8%AE%AD%E7%BB%83/&title=2021-XDU-寒假训练"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://rqdmap.github.io/2021/01/17/2021-XDU-%E5%AF%92%E5%81%87%E8%AE%AD%E7%BB%83/&title=2021-XDU-寒假训练"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://rqdmap.github.io/2021/01/17/2021-XDU-%E5%AF%92%E5%81%87%E8%AE%AD%E7%BB%83/&title=2021-XDU-寒假训练"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://rqdmap.github.io/2021/01/17/2021-XDU-%E5%AF%92%E5%81%87%E8%AE%AD%E7%BB%83/&title=2021-XDU-寒假训练"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://rqdmap.github.io/2021/01/17/2021-XDU-%E5%AF%92%E5%81%87%E8%AE%AD%E7%BB%83/&name=2021-XDU-寒假训练&description=&lt;p&gt;[toc]&lt;/p&gt;"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://rqdmap.github.io/2021/01/17/2021-XDU-%E5%AF%92%E5%81%87%E8%AE%AD%E7%BB%83/&t=2021-XDU-寒假训练"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89"><span class="toc-number">1.</span> <span class="toc-text">（一）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#A"><span class="toc-number">1.1.</span> <span class="toc-text">A</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#B"><span class="toc-number">1.2.</span> <span class="toc-text">B</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#C-%E4%B8%89%E7%BB%B4%E5%B9%B3%E9%9D%A2%E4%B8%8A%E6%B1%82%E6%9C%80%E9%95%BF%E7%9A%84%E5%9F%BA%E5%BA%95%E9%95%BF%E5%BA%A6"><span class="toc-number">1.3.</span> <span class="toc-text">C 三维平面上求最长的基底长度</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%B1%E5%8C%96%EF%BC%9A%E4%BA%8C%E7%BB%B4%E5%B9%B3%E9%9D%A2%E4%B8%8A%E6%B1%82%E6%9C%80%E9%95%BF%E7%9A%84%E5%9F%BA%E5%BA%95%E9%95%BF%E5%BA%A6"><span class="toc-number">1.3.1.</span> <span class="toc-text">弱化：二维平面上求最长的基底长度</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E7%BB%B4%E7%A9%BA%E9%97%B4%E4%B8%8A%E5%88%A9%E7%94%A8%E5%9B%9B%E5%85%83%E6%95%B0%EF%BC%88%E7%95%99%E5%9D%91%EF%BC%89"><span class="toc-number">1.3.2.</span> <span class="toc-text">三维空间上利用四元数（留坑）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#D-%E6%97%A0%E5%90%91%E5%9B%BE%E7%94%9F%E6%88%90%E6%A0%91%E8%AE%A1%E6%95%B0-amp-%E5%85%81%E8%AE%B8%E6%97%8B%E8%BD%AC%E7%BD%AE%E6%8D%A2"><span class="toc-number">1.4.</span> <span class="toc-text">D 无向图生成树计数 &amp; 允许旋转置换</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E5%90%91%E5%9B%BE%E7%9F%A9%E9%98%B5%E6%A0%91%E5%AE%9A%E7%90%86"><span class="toc-number">1.4.1.</span> <span class="toc-text">无向图矩阵树定理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Burnside%E4%B8%8EPolya%E5%AE%9A%E7%90%86"><span class="toc-number">1.4.2.</span> <span class="toc-text">Burnside与Polya定理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#E-%E6%9D%A8%E8%A1%A8-amp-LIS"><span class="toc-number">1.5.</span> <span class="toc-text">E 杨表 &amp; LIS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Diworth%E5%AE%9A%E7%90%86"><span class="toc-number">1.5.1.</span> <span class="toc-text">Diworth定理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A8%E8%A1%A8"><span class="toc-number">1.5.2.</span> <span class="toc-text">杨表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">1.5.3.</span> <span class="toc-text"> </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%AC%E9%A2%98"><span class="toc-number">1.5.4.</span> <span class="toc-text">本题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#K-%E5%8F%AF%E6%8C%81%E4%B9%85%E5%8C%9601%E7%BA%BF%E6%AE%B5%E6%A0%91"><span class="toc-number">1.6.</span> <span class="toc-text">K 可持久化01线段树</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89"><span class="toc-number">2.</span> <span class="toc-text">（二）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#-1"><span class="toc-number">2.1.</span> <span class="toc-text"> </span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        2021-XDU-寒假训练
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">rqdmap</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2021-01-17T07:47:57.000Z" itemprop="datePublished">2021-01-17</time>
        
        (Updated: <time datetime="2021-01-17T07:47:57.000Z" itemprop="dateModified">2021-01-17</time>)
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/%E7%9F%A5%E8%AF%86%E7%82%B9/">知识点</a>
    </div>


      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>[toc]</p>
<span id="more"></span>
<h1 id="（一）"><a href="#（一）" class="headerlink" title="（一）"></a>（一）</h1><h2 id="A"><a href="#A" class="headerlink" title="A"></a>A</h2><h2 id="B"><a href="#B" class="headerlink" title="B"></a>B</h2><p>字符串上做快速幂优化的dp</p>
<h2 id="C-三维平面上求最长的基底长度"><a href="#C-三维平面上求最长的基底长度" class="headerlink" title="C 三维平面上求最长的基底长度"></a>C 三维平面上求最长的基底长度</h2><h3 id="弱化：二维平面上求最长的基底长度"><a href="#弱化：二维平面上求最长的基底长度" class="headerlink" title="弱化：二维平面上求最长的基底长度"></a>弱化：二维平面上求最长的基底长度</h3><p><a target="_blank" rel="noopener" href="https://codeforces.ml/gym/100959">K题</a></p>
<p>如何说明gcd欧几里得算法的正确性？等价于说明$gcd(a, b) = gcd(b, a \% b)$：</p>
<p>只要说明(a, b)的公因子一定是a%b的因子，(b, a % b)的公因子一定是a的因子。这样，双方的公因子全体必然相同，进而gcd相等。</p>
<p>那么，在一般的欧几里得算法中，必须要证明上述的式子，即$fun(a, b) = fun(b, a\%b)$</p>
<p>高斯整数是实部与虚部均为整数的复数。首先如下地定义高斯整数的唯一带余除法表示：</p>
<p>设$\frac{a}{b} = x + iy$, 一定存在唯一的整数$m, n$使得$m - 1/2 &lt; x &lt;=m + 1/2, n-1/2 &lt; y &lt;=n + 1/2$.</p>
<p>那么带余除法$a = bq +r, q =m+in$.</p>
<p>实际在运算时，对两个复数做除法，将实部虚部四舍五入，就得到了倍数q。</p>
<p>接下来尝试说明上述的除法满足欧几里得算法的条件：</p>
<p>仍然认为这里的$fun$函数是找二者最大的公因子。</p>
<p>由于$<C, +, *>$是环，乘法对加法可分配，运算满足封闭性，很容易证明两边的因子全体相同。</p>
<p>（<del>手算证明a、b的因子一定是a%b的因子，大概利用了上述的几个性质，不知道是否正确</del>）</p>
<p>那么通过欧几里得不断辗转相除就可以得到给出的所有向量的最大公因子。</p>
<p>得出的这个”Gcd”因子，就是我们要求的最终的基底向量。无需考虑转化为平面坐标上的基底，直接利用这个向量就可以得知需要几个向量才能构成一个题目要求的”正方形”：将给出的所有向量除以该基底，按道理可以得到标准的<strong>高斯整数</strong>，实部可以看作是为了表示这个向量，实轴基底所需要的数量，虚部可以看作是虚轴基底所需要的数量。不断地用横纵坐标更新最大最小值，最后在这个矩形区域中最长的边（即长方形的长），这就是为了表示所有的复数所需要的最少的基底数量，也就是题目要求中的K。显然，因为基底最大，相应的K就会最小。</p>
<p>此外，因为题目还允许变化基础偏移值$(a, b)$，所以给出的n个复数不需要全部使用，可以认为某一个为原点，考虑剩余$n-1$个对它的相对坐标，使用相对坐标完成上述讨论的gcd等操作即可。</p>
<p><del>因为看到了一份代码，在gcd中有四舍五入，而在将向量除以标准基底后得到的商上也进行了四舍五入，让人不禁怀疑这一坨四舍五入到底都是什么。事实上，gcd的四舍五入是高斯整数除法所内在要求的，而商上的四舍五入是为了防止double复数除法的精度问题。</del></p>
<p>此时不禁赞叹这一份优美的自定义高斯整数结构的<a target="_blank" rel="noopener" href="https://codeforces.ml/gym/100959/submission/30276053">代码</a>。（可能需要coach才能查看）</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">GaussianInteger</span>&#123;</span></span><br><span class="line">    ll x, y;</span><br><span class="line">    <span class="function">ll <span class="title">norm</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> x * x + y * y;&#125;</span><br><span class="line">    GaussianInteger <span class="keyword">operator</span> + (<span class="keyword">const</span> GaussianInteger &amp;b)&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x + b.x, y + b.y&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    GaussianInteger <span class="keyword">operator</span> - (<span class="keyword">const</span> GaussianInteger &amp;b)&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x - b.x, y - b.y&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    GaussianInteger <span class="keyword">operator</span> * (<span class="keyword">const</span> GaussianInteger &amp;b)&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x * b.x - y * b.y, x * b.y + y * b.x&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//(专用! 因为此处b保证大于0)四舍五入除法</span></span><br><span class="line">    <span class="comment">//高斯整数商的实部虚部在某个整数的**(-1/2, 1/2]**区间中。</span></span><br><span class="line">    <span class="function">ll <span class="title">D</span><span class="params">(ll a, ll b)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(a &gt;= <span class="number">0</span>) <span class="keyword">return</span> (a % b) * <span class="number">2</span> &lt; b? a / b: a / b + <span class="number">1</span>;</span><br><span class="line">        a = -a; <span class="keyword">return</span> -((a % b) * <span class="number">2</span> &lt;= b? a / b: a / b + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    GaussianInteger <span class="keyword">operator</span> / (<span class="keyword">const</span> GaussianInteger &amp;b)&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="built_in">D</span>(x * b.x + y * b.y, x * b.x + y * b.y), <span class="built_in">D</span>(y * b.x - x * b.y, x * b.x + y * b.y)&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    GaussianInteger <span class="keyword">operator</span> % (<span class="keyword">const</span> GaussianInteger &amp;b)&#123;</span><br><span class="line">        GaussianInteger a = &#123;x, y&#125;;</span><br><span class="line">        <span class="keyword">return</span> a - a / b * b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">typedef</span> GaussianInteger NODE;</span><br><span class="line"><span class="function">NODE <span class="title">gcd</span><span class="params">(NODE a, NODE b)</span></span>&#123;<span class="keyword">return</span> !b.<span class="built_in">norm</span>()? a: <span class="built_in">gcd</span>(b, a % b);&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line">NODE node[maxn];</span><br><span class="line"></span><br><span class="line">ll xmi, xmx, ymi, ymx;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   Fastin;</span><br><span class="line">    <span class="keyword">int</span> n; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="built_in">scnaf</span>(<span class="string">&quot;%lld %lld&quot;</span>, &amp;node[i].x, &amp;node[i].y);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) node[i] = node[i] - node[<span class="number">0</span>];</span><br><span class="line">    NODE d = node[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; n; i++) d = <span class="built_in">gcd</span>(d, node[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++)&#123;</span><br><span class="line">        NODE p = node[i] / d;</span><br><span class="line">        xmi = <span class="built_in">min</span>(xmi, p.x); xmx = <span class="built_in">max</span>(xmx, p.x);</span><br><span class="line">        ymi = <span class="built_in">min</span>(ymi, p.y); ymx = <span class="built_in">max</span>(ymx, p.y);</span><br><span class="line">    &#125;</span><br><span class="line">    ll ans = <span class="built_in">max</span>(ymx - ymi + <span class="number">1</span>, xmx - xmi + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans - n);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="三维空间上利用四元数（留坑）"><a href="#三维空间上利用四元数（留坑）" class="headerlink" title="三维空间上利用四元数（留坑）"></a>三维空间上利用四元数（留坑）</h3><p><del>暂时不太愿意花费太多时间去研究四元数的若干表示形式 因而留坑待补（弃坑（bushi</del></p>
<h2 id="D-无向图生成树计数-amp-允许旋转置换"><a href="#D-无向图生成树计数-amp-允许旋转置换" class="headerlink" title="D 无向图生成树计数 &amp; 允许旋转置换"></a>D 无向图生成树计数 &amp; 允许旋转置换</h2><h3 id="无向图矩阵树定理"><a href="#无向图矩阵树定理" class="headerlink" title="无向图矩阵树定理"></a>无向图矩阵树定理</h3><p>图中不允许自环，允许重边。</p>
<p>定理基尔霍夫矩阵$L(G) = D(G)-A(G)$，度数矩阵$D_{ii}(G) =deg(i),D_{ij}=0,i≠j$，邻接矩阵$A_{ij}(G)=A_{ji}(G)=#e(ij), i≠j$。</p>
<p>那么$L(G)$的所有代数余子式均相同，且等于G的生成树数量。</p>
<h3 id="Burnside与Polya定理"><a href="#Burnside与Polya定理" class="headerlink" title="Burnside与Polya定理"></a>Burnside与Polya定理</h3><p><strong>burnside</strong>：G是X的置换群，C是X中满足如下条件的着色集合：对于G中所有的f和C中所有的c都有$f*c$仍在C中，则C中非等价的着色数$N(G,C)=\frac{1}{|G|}\sum _{f∈G}|C(f)|$，其中$C(f)$是在f作用下使得着色c保持不变的所有着色的集合。</p>
<p><strong>polya</strong>: 如果一个置换$f$有$σ_f$个循环，那么可以根据循环具体地计算出不动点的数量，从而得到等价类的数量: $\frac 1 {|G|}\sum_ {f∈G}m^{σ_f}$，其中m是可选颜色的数量。</p>
<p>polya练习题-&gt; <a target="_blank" rel="noopener" href="https://www.cnblogs.com/hankers/archive/2012/08/03/2622231.html">这里</a></p>
<h2 id="E-杨表-amp-LIS"><a href="#E-杨表-amp-LIS" class="headerlink" title="E 杨表 &amp; LIS"></a>E 杨表 &amp; LIS</h2><h3 id="Diworth定理"><a href="#Diworth定理" class="headerlink" title="Diworth定理"></a>Diworth定理</h3><blockquote>
<p><strong>一个序列中下降子序列的最少划分数个数等于最长上升子序列的长度。</strong></p>
<p><strong>一个序列中上升子序列的最少划分数个数等于最长下降子序列的长度。</strong></p>
<p><strong>每句中的前后两者互为偏序关系。</strong></p>
</blockquote>
<h3 id="杨表"><a href="#杨表" class="headerlink" title="杨表"></a>杨表</h3><p>标准杨表从左向右、从上到下格子中的元素大小均是递增的。</p>
<p><del>大概长阶梯状，但是博客比较垃圾不太能上传图所以从略</del></p>
<p>$1-n$构成杨表个数为$f(1) = 1, f(2)=2, f(n) = f(n-1)+(n-1)*f(n-2),n &gt;2$</p>
<p>定义某个方格的勾长为<code>该方格正右方方格数+正下方方格数+1</code>，那么如果给定杨表的形状，用$1-n$填充杨表的所有方式有$\frac {n!}{\prod _{x是杨表格子}hook(x)}$，这被称为勾长公式。</p>
<p>杨表的对行插入：设要插入x，从第一行开始，在当前行中找第一个大于x的位置，如果找到了就用x替换该元素y，并尝试在下一行插入y，反复不断进行；如果找不到这样的位置，就将当前的值放在行末，算法结束。</p>
<p>杨表的删除：假设要删除$(x, y)$，保证$(x, y)$是边角。设x = $S_{xy}$，如果x在第一行，删除x算法结束；不然，找出最大的小于x的位置，用x替换该位置上的元素y，再尝试在上一行中删除y，反复进行。</p>
<p><strong>杨表$P_x$与LIS、LDS：</strong></p>
<p>$P_x$中第一行的长度就是排列$X$的LIS的长度，第一列的长度是其LDS的长度</p>
<p>事实上，定义k-LIS序列为LIS长度不超过k的序列，类似地定义k-LDS序列。那么杨表前k列的长度就是最长的k-LIS长度。</p>
<h3 id=""><a href="#" class="headerlink" title=" "></a> </h3><h3 id="本题"><a href="#本题" class="headerlink" title="本题"></a>本题</h3><p>给定长度n，要求找出满足如下条件的长为n的排列：存在两个长度相同且无相交元素的LIS，答案对998244353取模。</p>
<p>由于diworth定理，可以得知就是要找包含一个总长为2L，LDS=2，LIS=L的子序列的序列的个数，这也就是说要找长度为n、2_LDS=2L、LIS=L的序列的个数。转换到杨表上来，杨表大小为n，前两行总共应有2L个元素，第一行必须有 L个元素，从而第二行也就必须有L个元素。将整数n进行拆分后用钩子公式即可得知当前形状的杨表的合法数量。又由于一对杨表唯一的确定一个排列，那么最终的排列数则是所有杨表合法数量的平方之和。</p>
<ol>
<li>没有仔细研读2019国家集训队论文集，偷了几个结论就跑了</li>
<li>不是特别明白利用diworth定理和杨表相关性质对题目进行的转化</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">onst <span class="keyword">int</span> M = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">const</span> itn maxn = <span class="number">1e2</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, l;</span><br><span class="line"><span class="keyword">int</span> a[maxn];</span><br><span class="line">ll ans = <span class="number">0</span>, pre[maxn], inv[maxn];</span><br><span class="line"><span class="function">ll <span class="title">fun</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> !x? inv[y]: inv[y] * pre[x - <span class="number">1</span>] % M;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//将要放第k层,上限为x，剩余sum个格子</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> x, <span class="keyword">int</span> sum)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(sum == <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="comment">//对第i层而言，显然有i-1个上方的格子，右边的格子分别为0,1,...,a[i] - 1</span></span><br><span class="line">        <span class="comment">//i * (i + 1) * ... * (i + a[i] - 1)</span></span><br><span class="line">        ll res = pre[n];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++)&#123;</span><br><span class="line">            res *= <span class="built_in">fun</span>(i, i + a[i] - <span class="number">1</span>);</span><br><span class="line">            res %= M;</span><br><span class="line">        &#125;</span><br><span class="line">        ans += res; asn %= M;</span><br><span class="line">        <span class="built_in">prt</span>(a, k, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= sum &amp;&amp; i &lt;= x; i++)&#123;</span><br><span class="line">        a[k] = i;</span><br><span class="line">        <span class="built_in">dfs</span>(k + <span class="number">1</span>, i, sum - i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// Fastin;</span></span><br><span class="line">    <span class="keyword">int</span> n; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    pre[<span class="number">0</span>] = <span class="number">1</span>; inv[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">100</span>; i++)&#123;</span><br><span class="line">        pre[i] = pre[i - <span class="number">1</span>] * <span class="number">1ll</span> * i % M;</span><br><span class="line">        inv[i] = <span class="built_in">qp</span>(pre[i], M - <span class="number">2</span>, M);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i + i &lt;= n; i++)&#123;</span><br><span class="line">        a[<span class="number">0</span>] = a[<span class="number">1</span>] = i; l = i;</span><br><span class="line">        <span class="built_in">dfs</span>(<span class="number">2</span>, i, n - <span class="number">2</span> * i);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="K-可持久化01线段树"><a href="#K-可持久化01线段树" class="headerlink" title="K 可持久化01线段树"></a>K 可持久化01线段树</h2><p>支持区间翻转，单点置值。每次操作完后输出整个序列中1的个数。</p>
<p><del>貌似可持久化线段树不是很能支持直接的区间操作？</del></p>
<p>在这道题中，如果出现区间翻转的操作，那么将所有有关的小线段都打上tag（实际是异或加1），并将他们的结果都用$r - l + 1 - st[p]$来代替本身；而如果出现了单点置值的情况，检查一路上遇到的所有的线段的tag，将将要置的值x不断地异或上这些tag，以最终的结果作为最终要置的值。这是因为，在一个已经翻转过的线段上置值（然而此时只是对这个大线段打了tag，没有实际地修改子线段，不然会T）等价于将要置的值先翻转，不断往下走，置好后再将$st[ls] + st[rs]$的值翻转一遍后置回本身。</p>
<p>需要注意的是，<strong>这里的翻转tag必须要在相邻的版本之间进行继承</strong>！不然就会发生翻转信息遗漏的问题。</p>
<p>对于01串的区间翻转问题，这种将要置的值翻转的手段好像是一个比较通用的手法？值得学习。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mid ((l + r) &gt;&gt; 1)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">2e7</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, q;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> root[<span class="number">100010</span>], version = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> st[manx], tag[maxn];</span><br><span class="line"><span class="keyword">int</span> ls[maxn], rs[maxn], top = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> now = top++;</span><br><span class="line">    <span class="keyword">if</span>(l == r) <span class="keyword">return</span> now;</span><br><span class="line">    ls[now] = <span class="built_in">build</span>(l, mid);</span><br><span class="line">    rs[now] = <span class="built_in">build</span>(mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="keyword">return</span> now;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">up</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    st[p] = st[ls[p]] + st[rs[p]];</span><br><span class="line">    <span class="keyword">if</span>(tag[p]) st[p] = r - l + <span class="number">1</span> - st[p];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">set</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> now = top++;</span><br><span class="line">    tag[now] = tag[p];</span><br><span class="line">    <span class="keyword">if</span>(l == r &amp;&amp; l == k)&#123;</span><br><span class="line">        st[now] = x;</span><br><span class="line">        <span class="keyword">return</span> now;</span><br><span class="line">    &#125;</span><br><span class="line">    x ^= tag[p];</span><br><span class="line">    ls[now] = ls[p]; rs[now] = rs[p];</span><br><span class="line">    <span class="keyword">if</span>(k &lt;= mid) ls[now] = <span class="built_in">set</span>(ls[p], l, mid, k, x);</span><br><span class="line">    <span class="keyword">else</span> rs[now] = <span class="built_in">set</span>(rs[p], mid + <span class="number">1</span>, r, k, x);</span><br><span class="line">    <span class="built_in">up</span>(now, l, r);</span><br><span class="line">    <span class="keyword">return</span> now;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> now = top++;</span><br><span class="line">    ls[now] = ls[p]; rs[now] = rs[p];</span><br><span class="line">    tag[now] = tag[p];</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= l &amp;&amp; r &lt;= R)&#123;</span><br><span class="line">        st[now] = r - l + <span class="number">1</span> - st[p];</span><br><span class="line">        tag[now] ^= <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> now;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= mid) ls[now] = <span class="built_in">update</span>(ls[p], l, mid, L, R);</span><br><span class="line">    <span class="keyword">if</span>(R &gt; mid) rs[now] = <span class="built_in">update</span>(rs[p], mid + <span class="number">1</span>, r, L, R);</span><br><span class="line">    <span class="built_in">up</span>(now, l, r);</span><br><span class="line">    <span class="keyword">return</span> now;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;n, &amp;m, &amp;q);</span><br><span class="line">    root[version++] = <span class="built_in">build</span>(<span class="number">0</span>, n * m - <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; q; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> op; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;op);</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> i, j; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;i, &amp;j); i--; j--;</span><br><span class="line">            root[version] = <span class="built_in">set</span>(root[version - <span class="number">1</span>], <span class="number">0</span>, n * m - <span class="number">1</span>, i * m + j, <span class="number">1</span>);</span><br><span class="line">            version++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">2</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> i, j; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;i, &amp;j); i--; j--;</span><br><span class="line">            root[version] = <span class="built_in">set</span>(root[version - <span class="number">1</span>], <span class="number">0</span>, n * m - <span class="number">1</span>, i * m + j, <span class="number">0</span>);</span><br><span class="line">            version++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">3</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> i; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;i);</span><br><span class="line">            root[version] = <span class="built_in">update</span>(root[version - <span class="number">1</span>], <span class="number">0</span>, n * m - <span class="number">1</span>, (i - <span class="number">1</span>) * m, i * m - <span class="number">1</span>);</span><br><span class="line">            version++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">int</span> x; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">            root[version] = root[x];</span><br><span class="line">            version++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, st[root[version - <span class="number">1</span>]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="（二）"><a href="#（二）" class="headerlink" title="（二）"></a>（二）</h1><h2 id="-1"><a href="#-1" class="headerlink" title=" "></a> </h2>
  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/categories/">Category</a></li>
         
          <li><a href="/tags/">Tag</a></li>
         
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89"><span class="toc-number">1.</span> <span class="toc-text">（一）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#A"><span class="toc-number">1.1.</span> <span class="toc-text">A</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#B"><span class="toc-number">1.2.</span> <span class="toc-text">B</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#C-%E4%B8%89%E7%BB%B4%E5%B9%B3%E9%9D%A2%E4%B8%8A%E6%B1%82%E6%9C%80%E9%95%BF%E7%9A%84%E5%9F%BA%E5%BA%95%E9%95%BF%E5%BA%A6"><span class="toc-number">1.3.</span> <span class="toc-text">C 三维平面上求最长的基底长度</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%B1%E5%8C%96%EF%BC%9A%E4%BA%8C%E7%BB%B4%E5%B9%B3%E9%9D%A2%E4%B8%8A%E6%B1%82%E6%9C%80%E9%95%BF%E7%9A%84%E5%9F%BA%E5%BA%95%E9%95%BF%E5%BA%A6"><span class="toc-number">1.3.1.</span> <span class="toc-text">弱化：二维平面上求最长的基底长度</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E7%BB%B4%E7%A9%BA%E9%97%B4%E4%B8%8A%E5%88%A9%E7%94%A8%E5%9B%9B%E5%85%83%E6%95%B0%EF%BC%88%E7%95%99%E5%9D%91%EF%BC%89"><span class="toc-number">1.3.2.</span> <span class="toc-text">三维空间上利用四元数（留坑）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#D-%E6%97%A0%E5%90%91%E5%9B%BE%E7%94%9F%E6%88%90%E6%A0%91%E8%AE%A1%E6%95%B0-amp-%E5%85%81%E8%AE%B8%E6%97%8B%E8%BD%AC%E7%BD%AE%E6%8D%A2"><span class="toc-number">1.4.</span> <span class="toc-text">D 无向图生成树计数 &amp; 允许旋转置换</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E5%90%91%E5%9B%BE%E7%9F%A9%E9%98%B5%E6%A0%91%E5%AE%9A%E7%90%86"><span class="toc-number">1.4.1.</span> <span class="toc-text">无向图矩阵树定理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Burnside%E4%B8%8EPolya%E5%AE%9A%E7%90%86"><span class="toc-number">1.4.2.</span> <span class="toc-text">Burnside与Polya定理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#E-%E6%9D%A8%E8%A1%A8-amp-LIS"><span class="toc-number">1.5.</span> <span class="toc-text">E 杨表 &amp; LIS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Diworth%E5%AE%9A%E7%90%86"><span class="toc-number">1.5.1.</span> <span class="toc-text">Diworth定理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A8%E8%A1%A8"><span class="toc-number">1.5.2.</span> <span class="toc-text">杨表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">1.5.3.</span> <span class="toc-text"> </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%AC%E9%A2%98"><span class="toc-number">1.5.4.</span> <span class="toc-text">本题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#K-%E5%8F%AF%E6%8C%81%E4%B9%85%E5%8C%9601%E7%BA%BF%E6%AE%B5%E6%A0%91"><span class="toc-number">1.6.</span> <span class="toc-text">K 可持久化01线段树</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89"><span class="toc-number">2.</span> <span class="toc-text">（二）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#-1"><span class="toc-number">2.1.</span> <span class="toc-text"> </span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://rqdmap.github.io/2021/01/17/2021-XDU-%E5%AF%92%E5%81%87%E8%AE%AD%E7%BB%83/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://rqdmap.github.io/2021/01/17/2021-XDU-%E5%AF%92%E5%81%87%E8%AE%AD%E7%BB%83/&text=2021-XDU-寒假训练"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://rqdmap.github.io/2021/01/17/2021-XDU-%E5%AF%92%E5%81%87%E8%AE%AD%E7%BB%83/&title=2021-XDU-寒假训练"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://rqdmap.github.io/2021/01/17/2021-XDU-%E5%AF%92%E5%81%87%E8%AE%AD%E7%BB%83/&is_video=false&description=2021-XDU-寒假训练"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=2021-XDU-寒假训练&body=Check out this article: http://rqdmap.github.io/2021/01/17/2021-XDU-%E5%AF%92%E5%81%87%E8%AE%AD%E7%BB%83/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://rqdmap.github.io/2021/01/17/2021-XDU-%E5%AF%92%E5%81%87%E8%AE%AD%E7%BB%83/&title=2021-XDU-寒假训练"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://rqdmap.github.io/2021/01/17/2021-XDU-%E5%AF%92%E5%81%87%E8%AE%AD%E7%BB%83/&title=2021-XDU-寒假训练"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://rqdmap.github.io/2021/01/17/2021-XDU-%E5%AF%92%E5%81%87%E8%AE%AD%E7%BB%83/&title=2021-XDU-寒假训练"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://rqdmap.github.io/2021/01/17/2021-XDU-%E5%AF%92%E5%81%87%E8%AE%AD%E7%BB%83/&title=2021-XDU-寒假训练"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://rqdmap.github.io/2021/01/17/2021-XDU-%E5%AF%92%E5%81%87%E8%AE%AD%E7%BB%83/&name=2021-XDU-寒假训练&description=&lt;p&gt;[toc]&lt;/p&gt;"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://rqdmap.github.io/2021/01/17/2021-XDU-%E5%AF%92%E5%81%87%E8%AE%AD%E7%BB%83/&t=2021-XDU-寒假训练"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2020-2021
    rqdmap
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/categories/">Category</a></li>
         
          <li><a href="/tags/">Tag</a></li>
         
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'rqdmap';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>


<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
</body>
</html>
