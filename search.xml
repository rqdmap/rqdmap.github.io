<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>BUAAå¤ä»¤è¥è®°</title>
      <link href="/2021/07/12/BUAA%E5%A4%8F%E4%BB%A4%E8%90%A5%E8%AE%B0/"/>
      <url>/2021/07/12/BUAA%E5%A4%8F%E4%BB%A4%E8%90%A5%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<p>åŒ—èˆªå¤ä»¤è¥è®°</p><span id="more"></span> <p>ç™¾å‘³æ‚é™ˆå¤§æŠµå¦‚æ­¤â€¦</p><p>ä»ç„¶è®°å¾—é‚£ä¸ªæ—©æ™¨ï¼Œ7æœˆ1æ—¥çš„æ—©æ™¨ï¼Œé€šå®µè‚å®Œç¼–è¯‘åŸç†å®éªŒæŠ¥å‘Šï¼Œ4ç‚¹å¤šé’Ÿæƒ³rushå®ŒBUAAçš„ç”³è¯·è¡¨å†ç¡è§‰ï¼Œç»“æœå¿½ç„¶æ„è¯†åˆ°æ—©ä¸Šçš„è€ƒè¯•å¯èƒ½æ¥ä¸åŠå¤ä¹ äº†ï¼Œä¸‹åˆä¸‰ç‚¹å¤šé’Ÿå¡ç€æˆªæ­¢æ—¶é—´æ‰å¡«è¡¨äº¤å¥½ã€‚æœ¬æ¥ç”šè‡³éƒ½æ²¡æƒ³æŠ¥BUAAï¼Œ2kå­—çš„ç ”ç©¶è®¡åˆ’è®©äººæœ›è€Œå´æ­¥ï¼Œæœ€ç»ˆæŠ±ç€éšæ„æµ·æµ·çš„å¿ƒæ€ç»“æœæˆäº†å°‘æ•°å‡ ä¸ªè¿‡äº†åˆå®¡çš„å¤0è¥ã€‚</p><p><strong>æœºè¯•</strong></p><p>æœºè¯•å¾ˆç®€å•ï¼Œä¸€é“æ¨¡æ‹Ÿä¸€é“MSTåŸºç¡€é¢˜ï¼Œæ²¡æœ‰è¯„æµ‹ç»“æœä»¥åŠä¸èƒ½å‡ºè€ƒåœºå¾ˆå¤´å¤§ï¼Œ<del>å·®ç‚¹æ†‹æ­»åœ¨åº§ä½ä¸Š</del></p><p><strong>é¢è¯•</strong></p><p>é¢è¯•å¤§æŠµä¹Ÿå¾ˆç®€å•ã€‚ã€‚ç„¶è€Œå°±è·Ÿæ¨¡ç”µè€ƒè¯•ç±»ä¼¼ï¼Œåªè¦å­¦è¿‡å°±èƒ½è½»æ˜“è§£ç­”ï¼Œåƒæˆ‘è¿™ç§ä¸å¥½å¥½å­¦ä¹ çš„äººå°±å•¥ä¹Ÿä¸ä¼šã€‚ã€‚</p><p>å…ˆæ˜¯1-10éšæœºæŠ½äº†ä¸€é“æ”¿æ²»é¢˜ï¼Œéšæ„å£èƒ¡äº†15ç§’å°±FINäº†ï¼Œèƒ¡ä¸å‡ºæ›´å¤šäº†ã€‚</p><p>ç„¶ååº”è¯¥æ˜¯è‡ªæˆ‘ä»‹ç»ï¼Œè‹±æ–‡å£èƒ¡äº†2åˆ†é’Ÿå·¦å³ä¹‹åå°±å¼€å§‹é—®é—®é¢˜äº†ã€‚ã€‚</p><p>é—®äº†å‡ ä¸ªæ•°å­¦é¢˜ï¼Œå•¥æ˜¯ç‰¹å¾å€¼ç‰¹å¾å‘é‡ï¼ˆå®šä¹‰ä¸è®°å¾—äº†ï¼Œè¯´äº†ä¸ªè®¡ç®—å…¬å¼å’Œå®é™…çš„æ„ä¹‰FINï¼‰ï¼Œå•¥æ˜¯å¯å¾®å¯å¯¼è¿ç»­ï¼ˆå…·ä½“ä¹Ÿä¸è®°å¾—äº†ï¼Œéšæ„è¯´äº†ç‚¹è®°å¾—çš„å†…å®¹ï¼‰ï¼Œåº”è¯¥è¿˜æœ‰äº›å•¥ä½†ä¸å¤ªè®°å¾—äº†</p><p>é—®äº†ä¸ªç®—æ³•ï¼Œå•¥æ˜¯dijstraï¼Œæ„Ÿè§‰ç­”çš„ä¸ç®—å¥½ï¼Œå› ä¸ºè¦å£è¿°ç®—æ³•æµç¨‹ï¼Œè¿˜æ˜¯æ¯”è¾ƒè´¹å£åŠ›çš„</p><p>é—®äº†æ“ä½œç³»ç»Ÿï¼Œè¿›ç¨‹ä¸Šä¸‹æ–‡ï¼Ÿåˆ‡æ¢è¿›ç¨‹æ—¶OSä¼šå¹²å•¥ï¼Ÿæˆ‘åªèƒ½å£èƒ¡å›æ”¶èµ„æºåˆ†é…èµ„æºã€‚ã€‚</p><p>é—®äº†è®¡ç»„ï¼Œå•æŒ‡ä»¤å‘¨æœŸå˜æˆæµæ°´çº¿çš„è¯æŒ‡ä»¤æ—¶é—´ä¼šå˜åŒ–å—ï¼Ÿæˆ‘å­¦çš„ä¸å¥½å•Šæˆ‘ä¹Ÿä¸ä¼šåšã€‚ã€‚æ„Ÿè§‰ä¸Šæ˜¯ä¸ä¼šï¼Œåªæ˜¯æŠŠå¤šæ¡æŒ‡ä»¤äº¤é”™åœ°ä¸€èµ·è¿è¡Œï¼Œè¿™æ ·å›ç­”åè€å¸ˆåˆé—®æˆ‘ç¡®å®šå—ã€‚ã€‚ã€‚æˆ‘æƒ³ä¸åˆ°ç‰¹æ®Šçš„æƒ…å†µåªèƒ½è¯´ç¡®å®š</p><p>é—®äº†ç½‘ç»œï¼Œå…¶å®æ›´åå‘äºç½‘ç»œå®‰å…¨ï¼Œhttpså’Œhttpæœ‰å•¥åŒºåˆ«ã€‚ã€‚å®‰å…¨å¯¼è®ºè€ƒè¯•å‰å’Œå¯†ç å­¦è€ƒè¯•å‰å…¨éƒ½æ²¡çœ‹è¿™å—å†…å®¹ï¼Œå•¥ä¹Ÿä¸æ‡‚ï¼Œé¢è¯•çš„æ—¶å€™è‡ªç„¶ä¹Ÿä¸ä¼šï¼Œåªè¯´äº†ä¸ªSSLï¼Œå…·ä½“æœ‰å•¥æˆ‘ä¸çŸ¥é“ï¼ˆè€å¸ˆéå¸¸å¤±æœ›ï¼Œè®¤ä¸ºè¿™æ˜¯ç½‘å®‰çš„åŸºç¡€ã€‚ã€‚ã€‚ï¼‰ä¸€çŸ³ä¸‰é¸Ÿï¼Œé‡åˆ°ä¸€ä¸ªGGä¸€ä¸ªã€‚è®©æˆ‘æ¨¡æ‹Ÿä¸€ä¸‹ä¼ è¾“æˆ‘çš„ç”³è¯·è¡¨åˆ°åŒ—èˆªçš„æƒ…å†µï¼Œå…¬ç§é’¥åŠ å¯†ï¼Œå¦‚ä½•ä¿è¯å…¬é’¥ç¡®å®æ˜¯åŒ—èˆªçš„ï¼ˆå›ç­”äº†ç¬¬ä¸‰æ–¹å¯ä¿¡æœºæ„æœ‰è¯ä¹¦ï¼Œä½†æ˜¯ä¸å¤ªç¡®å®šæ˜¯å¦æ­£ç¡®ï¼‰ã€‚ã€‚è¿˜é—®äº†httpså’Œshttpçš„åŒºåˆ«ï¼Ÿï¼Ÿï¼Ÿåªèƒ½è€å®è¯´ä»æ¥æ²¡å¬è¯´è¿‡shttpâ€¦</p><p>é—®äº†åŒºå—é“¾ï¼Œæˆ‘å°±æŠŠå¤§æ•°æ®å®‰å…¨éšç§çš„ä¸¤ä¸ªå®éªŒå¤§æ¦‚è¯´äº†ä¸‹ã€‚ã€‚å› æœå…³ç³»ä¸è®°å¾—äº†ï¼Œå¯èƒ½æ˜¯çœ‹äº†æˆ‘çš„å®éªŒå†…å®¹é—®æˆ‘åŒºå—é“¾çš„ã€‚ã€‚<del>è€å®è¯´ï¼Œæˆ‘ä¸æ˜¯å¾ˆæ‡‚åŒºå—é“¾ã€‚ã€‚</del></p><p>é—®äº†å¹³æ—¶é‡åˆ°æ„Ÿå…´è¶£çš„ä¼šå¦‚ä½•æŸ¥é˜…èµ„æ–™ã€‚ã€‚å›ç­”äº†å›½å†…çš„CSDNç­‰åšå®¢è®ºå›å’Œå›½å¤–çš„è°·æ­Œå­¦æœ¯ç›´æ¥æŸ¥è®ºæ–‡ã€‚ã€‚</p><p>æ ¹æ®ç®€å†ä¸Šâ€œç²¾é€šâ€c/c++ç¼–ç¨‹ï¼Œé—®äº†æˆ‘å‡ ä¸ªC/C++é—®é¢˜ã€‚ã€‚C++ä¸­ç±»ä¸­staticå‡½æ•°æœ‰å•¥ç”¨ã€‚ã€‚æƒ³äº†åŠå¤©ä¸çŸ¥é“ã€‚ã€‚åªçŸ¥é“javaæ˜¯å¯ä»¥ç›´æ¥ç”¨ç±»æ¥è°ƒç”¨ï¼Œä½†æ˜¯C++å¯èƒ½ä¸å¤ªä¸€æ ·ï¼Œå°±æ²¡æ•¢è¯´ã€‚ã€‚å…¶å®åæ¥æŸ¥é˜…å¥½åƒæ˜¯è·Ÿjavaä¸€æ ·ã€‚ã€‚çœ‹æˆ‘ä¸ä¼šè€å¸ˆåˆé—®Cä¸­staticæœ‰å•¥ç”¨ã€‚ã€‚emmã€‚ã€‚ä¸ä¼šå•Šä½†æ˜¯ä¼°è®¡æ˜¯ä¸€æ ·çš„ã€‚ã€‚ä½†æˆ‘å•¥ä¹Ÿæ²¡è¯´ æ¯•ç«Ÿéƒ½ä¸ä¼šã€‚ã€‚åˆé—®äº†æˆ‘çˆ¶ç±»å­ç±»ã€‚ã€‚å­ç±»åˆ›å»ºå®ä¾‹æ—¶ä¼šä¸ä¼šæ‰ç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ã€‚ã€‚ã€‚æˆ‘å£èƒ¡äº†ä¸ä¼šã€‚ã€‚æˆ‘ç¡®å®ä¸ä¼šã€‚ã€‚å‡ ä¹æ²¡æœ‰å­¦è¿‡C++ç±»æœ‰å…³çŸ¥è¯†ã€‚ã€‚</p><p>æ€»è€Œè¨€ä¹‹ï¼Œæ„Ÿè§‰ç­”ä¸‹æ¥ç‰¹åˆ«çš„å·®ã€‚ã€‚æ²¡æœ‰æŒæ¡åº”è¯¥æŒæ¡çš„çŸ¥è¯†ã€‚ã€‚å½“æ—¶æ„Ÿè§‰å°±æ˜¯å‡‰äº†ã€‚ã€‚</p><p>æœ€ç»ˆç»“æœå‡ºåå±…ç„¶æ˜¯ä¼˜è¥ã€‚ã€‚çœŸçš„å¤ªç¥ç§˜äº†ã€‚ã€‚ä¸€çœ‹åå•ï¼Œå«ç”µé‡æé«˜ï¼Œ110äººä¼˜è¥æœ‰10äººè¥¿ç”µçš„ã€‚ã€‚</p><p>ğŸ¤¤ğŸ¤¤</p><p>å’Œç½‘ç»œçš„å¤è€å¸ˆå–å¾—äº†è”ç³»ï¼Œç›´æ¥ç­¾å¥½äº†åŒå‘æ„æ„¿è¡¨(<del>å¬å¦ä¸€ä¸ªCVæ–¹å‘è€å¸ˆçš„åŒå­¦è¯´ç”šè‡³è¿˜æœ‰ç»„ç»‡é¢è¯•ï¼Ÿï¼ŸçœŸæ˜¯çƒ­é—¨å•Š</del>)ï¼Œä¹Ÿå’¨è¯¢äº†æ‰‹ä¸‹çš„å­¦é•¿ï¼Œæ„Ÿè§‰è¿˜è›®ä¸é”™çš„ã€‚ã€‚ä½†æ˜¯ä¸€è€ƒè™‘åˆ°æœ¬æ ¡ç”šè‡³æœ‰å¯èƒ½ä¼šä¸§å¤±ä¿ç ”èµ„æ ¼ã€‚ã€‚ã€‚ã€‚</p><p>å†çœ‹å§qaq</p>]]></content>
      
      
      <categories>
          
          <category> æ‚è°ˆ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>BMP-FS</title>
      <link href="/2021/05/28/BMP-FS/"/>
      <url>/2021/05/28/BMP-FS/</url>
      
        <content type="html"><![CDATA[<p>[toc]</p><p>BMPæ–‡ä»¶æ ¼å¼åˆæ¢</p><p>å®ç°BMPæ–‡ä»¶çš„æ”¾ç¼©</p><span id="more"></span><p>æœç´¢èµ„æ–™æ—¶æ‰¾åˆ°ï¼Œç¬‘æ­»ã€‚</p><blockquote><p>æ­¤ä¸ºè¯¾ç¨‹è®¾è®¡çš„ç¬¬å››é¢˜,è¿™é“é¢˜ä½“ç°äº†å¤§ä½œä¸šçš„ç²¾é«“:åœ¨æŠ„ä¸­çŸ¥é“ï¼Œåœ¨æŠ„ä¸­å­¦ä¹ ï¼Œåœ¨æŠ„ä¸­è‹Ÿä¸”ã€‚</p></blockquote><h1 id="BMP-æ–‡ä»¶ç»“æ„"><a href="#BMP-æ–‡ä»¶ç»“æ„" class="headerlink" title="BMP æ–‡ä»¶ç»“æ„"></a>BMP æ–‡ä»¶ç»“æ„</h1><p>ä¸€èˆ¬çš„æƒ…å†µå¦‚ä¸‹æ‰€ç¤ºï¼Œæ‘˜è‡ª<a href="https://en.wikipedia.org/wiki/BMP_file_format#File_structure">wiki</a></p><div class="table-container"><table><thead><tr><th style="text-align:center">Structure name</th><th style="text-align:center">Optional</th><th style="text-align:center">Size</th><th style="text-align:center">Purpose</th><th style="text-align:center">Comments</th></tr></thead><tbody><tr><td style="text-align:center">Bitmap file header</td><td style="text-align:center"><strong>No</strong></td><td style="text-align:center">14 bytes</td><td style="text-align:center">To store general information about the bitmap image file</td><td style="text-align:center">Not needed after the file is loaded in memory</td></tr><tr><td style="text-align:center">DIB header</td><td style="text-align:center"><strong>No</strong></td><td style="text-align:center">Fixed-size (7 different versions exist)</td><td style="text-align:center">To store detailed information about the bitmap image and define the pixel format</td><td style="text-align:center">Immediately follows the Bitmap file header</td></tr><tr><td style="text-align:center">Extra bit masks</td><td style="text-align:center">Yes</td><td style="text-align:center">3 or 4 <a href="https://en.wikipedia.org/wiki/DWORD">DWORDs</a><a href="https://en.wikipedia.org/wiki/BMP_file_format#cite_note-AlphaBitFields-6">[6]</a> (12 or 16 bytes)</td><td style="text-align:center">To define the pixel format</td><td style="text-align:center">Present only in case the DIB header is the BITMAPINFOHEADER and the Compression Method member is set to either BI_BITFIELDS or BI_ALPHABITFIELDS</td></tr><tr><td style="text-align:center">Color table</td><td style="text-align:center">Semi-optional</td><td style="text-align:center">Variable size</td><td style="text-align:center">To define colors used by the bitmap image data (Pixel array)</td><td style="text-align:center">Mandatory for <a href="https://en.wikipedia.org/wiki/Color_depth">color depths</a> â‰¤ 8 bits</td></tr><tr><td style="text-align:center">Gap1</td><td style="text-align:center">Yes</td><td style="text-align:center">Variable size</td><td style="text-align:center">Structure alignment</td><td style="text-align:center">An artifact of the File offset to Pixel array in the Bitmap file header</td></tr><tr><td style="text-align:center">Pixel array</td><td style="text-align:center"><strong>No</strong></td><td style="text-align:center">Variable size</td><td style="text-align:center">To define the actual values of the pixels</td><td style="text-align:center">The pixel format is defined by the DIB header or Extra bit masks. Each row in the Pixel array is padded to a multiple of 4 bytes in size</td></tr><tr><td style="text-align:center">Gap2</td><td style="text-align:center">Yes</td><td style="text-align:center">Variable size</td><td style="text-align:center">Structure alignment</td><td style="text-align:center">An artifact of the ICC profile data offset field in the DIB header</td></tr><tr><td style="text-align:center">ICC color profile</td><td style="text-align:center">Yes</td><td style="text-align:center">Variable size</td><td style="text-align:center">To define the color profile for color management</td><td style="text-align:center">Can also contain a path to an external file containing the color profile. When loaded in memory as â€œnon-packed DIBâ€, it is located between the color table and Gap1.<a href="https://en.wikipedia.org/wiki/BMP_file_format#cite_note-DIBHeaderTypes-7">[7]</a></td></tr></tbody></table></div><p>ä¸€èˆ¬æ¥è¯´ï¼Œç°åœ¨è·å–åˆ°çš„BMPæ–‡ä»¶çš„DIBå¤´éƒ½æ˜¯ç¬¬äº”ä»£(BITMAPV5HEADER)ï¼Œé•¿124å­—èŠ‚ï¼›ä½†æ˜¯é’ˆå¯¹æœ¬å®éªŒè€Œè¨€ï¼Œåªéœ€è¦æå°‘çš„ä¸€äº›ä¿¡æ¯ï¼Œå› è€Œåªä¿ç•™40å­—èŠ‚ï¼Œå‰©ä½™84å­—èŠ‚è¯»è¿›æ¥ä¸ä¸ä½¿ç”¨ã€‚</p><p>è°ƒè‰²ç›˜åœ¨24ä½(RGBå„å ä¸€ä¸ªå­—èŠ‚)æ—¶ä¸éœ€è¦ï¼Œå› è€Œåƒç´ çŸ©é˜µçš„åç§»å°±æ˜¯14 + 124</p><p>å› è€Œåœ¨æœ¬å®éªŒä¸­ï¼ŒBMPç»“æ„ä»…æœ‰ä¸‰éƒ¨åˆ†ï¼š</p><ul><li>BMP file header</li><li>DIB header</li><li>pixel array</li></ul><h2 id="BMP-file-header"><a href="#BMP-file-header" class="headerlink" title="BMP file header"></a>BMP file header</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line">    <span class="keyword">u_int16_t</span> bfType;   </span><br><span class="line">    <span class="keyword">u_int32_t</span> bfSize;   </span><br><span class="line">    <span class="keyword">u_int16_t</span> bfReserved1;   </span><br><span class="line">    <span class="keyword">u_int16_t</span> bfReserved2;   </span><br><span class="line">    <span class="keyword">u_int32_t</span> bfOffBits;  </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>&#123;</span><br><span class="line">        PRINT_FONT_GRE;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;BmpFileHeader\n&quot;</span>);</span><br><span class="line">        PRINT_ATTR_REC;</span><br><span class="line">        <span class="built_in">fflush</span>(stdout);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;bfType: %d\n&quot;</span>, bfType);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;bfSize: %d kb\n&quot;</span>, bfSize);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;bfReservered1, 2: %d %d\n&quot;</span>, bfReserved1, bfReserved2);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;bfOffBits: %d\n&quot;</span>, bfOffBits);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125; </span><br><span class="line">&#125;BmpFileHeader;</span><br></pre></td></tr></table></figure><p>è¯¥å¤´å›ºå®š14å­—èŠ‚</p><h2 id="DIB-header"><a href="#DIB-header" class="headerlink" title="DIB header"></a>DIB header</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span>&#123;</span>  </span><br><span class="line">    <span class="keyword">u_int32_t</span> biSize;   </span><br><span class="line">    <span class="keyword">u_int32_t</span> biWidth;   </span><br><span class="line">    <span class="keyword">u_int32_t</span> biHeight;   </span><br><span class="line">    <span class="keyword">u_int16_t</span> biPlanes;   </span><br><span class="line">    <span class="keyword">u_int16_t</span> biBitCount;   </span><br><span class="line">    <span class="keyword">u_int32_t</span> biCompression;   </span><br><span class="line">    <span class="keyword">u_int32_t</span> biSizeImage;   </span><br><span class="line">    <span class="keyword">u_int32_t</span> biXPelsPerMeter;   </span><br><span class="line">    <span class="keyword">u_int32_t</span> biYPelsPerMeter;   </span><br><span class="line">    <span class="keyword">u_int32_t</span> biClrUsed;   </span><br><span class="line">    <span class="keyword">u_int32_t</span> biClrImportant;   </span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”±äºç›®å‰ä¸€èˆ¬dedaodeBMPæ–‡ä»¶å‡é‡‡ç”¨ç¬¬5ä»£DIBHEADERæ ¼å¼ï¼Œå› è€ŒDIBHEADERä¿¡æ¯é•¿ä¸º124å­—èŠ‚</span></span><br><span class="line"><span class="comment">     * æˆ‘ä»¬é¢å¤–å¸æ”¶æ‰è¿™äº›é¢å¤–çš„ä¿¡æ¯ï¼Œåœ¨æœ¬å®éªŒä¸­ä¸äºˆè€ƒè™‘å®ƒä»¬ã€‚</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="keyword">u_int8_t</span> foo[<span class="number">84</span>];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>&#123;</span><br><span class="line">        PRINT_FONT_GRE;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;DibHeader\n&quot;</span>);</span><br><span class="line">        PRINT_ATTR_REC;</span><br><span class="line">        <span class="built_in">fflush</span>(stdout);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;biSize: %d\n&quot;</span>, biSize);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;biWidth: %d\n&quot;</span>, biWidth);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;biHeight: %d\n&quot;</span>, biHeight);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;biPlanes(always 1): %d\n&quot;</span>, biPlanes);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;biBitCount: %d\n&quot;</span>, biBitCount);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;biCompression: %d\n&quot;</span>, biCompression);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;biSizeImage: %d\n&quot;</span>, biSizeImage);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;biXPelsPerMeter: %d\n&quot;</span>, biXPelsPerMeter);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;biYPelsPerMeter: %d\n&quot;</span>, biYPelsPerMeter);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;biClrUsed(0 if 2^biBitCount): %d\n&quot;</span>, biClrUsed);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;biClrImportant(0 if all important): %d\n&quot;</span>, biClrImportant);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;DibHeader;</span><br></pre></td></tr></table></figure><h2 id="pixel-array"><a href="#pixel-array" class="headerlink" title="pixel array"></a>pixel array</h2><p>å¯¹äºç¼©æ”¾åçš„å›¾ç‰‡çš„æ¯ä¸€ä¸ªåƒç´ ç‚¹ï¼Œå°†å…¶æŒ‰å¯¹åº”æ¯”ä¾‹æ˜ å°„å›åŸå›¾ï¼Œåœ¨åŸå›¾ä¸­å‡è®¾è¯¥æŠ•å½±ç‚¹è¢«å››ä¸ªç‚¹$A,B,C,D$æ„æˆçš„çŸ©å½¢åŒ…å›´ï¼Œé‚£ä¹ˆå°±åˆ©ç”¨è¿™å››ä¸ªç‚¹çš„é¢œè‰²æ„é€ å‡ºè¯¥ç‚¹çš„é¢œè‰²ã€‚</p><p><img src="/images/Screenshot from 2021-05-28 23-01-55.png" alt=""></p><p>ä½¿ç”¨åšå®¢<a href="https://blog.csdn.net/gtyinstinct/article/details/116144674">ä½å›¾å›¾åƒæ–‡ä»¶ç¼©æ”¾ï¼ˆc++ï¼‰</a>æåŠçš„<strong>åŒçº¿æ€§æ’å€¼</strong>ï¼š</p><script type="math/tex; mode=display">F(X) = dxdyF(B)+(1-dx)(1-dy)F(D)+(1-dx)dyF(a)+dx(1-dy)F(C)</script><h1 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h1><p><strong>å‘ç‚¹ï¼š </strong> BMPæ–‡ä»¶çš„<strong>width</strong>åº”å½“æ˜¯4çš„å€æ•°ï¼</p><p>æœ€å¼€å§‹è™½ç„¶æ³¨æ„åˆ°äº†4çš„å€æ•°ï¼Œä½†æ˜¯æ˜¯ä½¿å¾—heightæ˜¯4çš„å€æ•°ï¼Œå¯¼è‡´æœ€åçš„satoué…±ä¸ä»…æ˜¯ç°è‰²çš„ï¼Œè¿˜æ˜¯å€¾æ–œçš„ã€‚ç»è¿‡å¥½ä¸€ç•ªè°ƒè¯•æ‰å‘ç°æ˜¯widthï¼Œä¹Ÿå°±æ˜¯åˆ—ã€‚</p><p><img src="/images/Screenshot from 2021-05-28 23-04-45.png" alt=""></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span>  </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span>  </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span>  </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;rqdmap.h&quot;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> pack(2)   <span class="comment">//å¯¹é½</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;  </span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line">    <span class="keyword">u_int16_t</span> bfType;   </span><br><span class="line">    <span class="keyword">u_int32_t</span> bfSize;   </span><br><span class="line">    <span class="keyword">u_int16_t</span> bfReserved1;   </span><br><span class="line">    <span class="keyword">u_int16_t</span> bfReserved2;   </span><br><span class="line">    <span class="keyword">u_int32_t</span> bfOffBits;  </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>&#123;</span><br><span class="line">        PRINT_FONT_GRE;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;BmpFileHeader\n&quot;</span>);</span><br><span class="line">        PRINT_ATTR_REC;</span><br><span class="line">        <span class="built_in">fflush</span>(stdout);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;bfType: %d\n&quot;</span>, bfType);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;bfSize: %d kb\n&quot;</span>, bfSize);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;bfReservered1, 2: %d %d\n&quot;</span>, bfReserved1, bfReserved2);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;bfOffBits: %d\n&quot;</span>, bfOffBits);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125; </span><br><span class="line">&#125;BmpFileHeader;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span>&#123;</span>  </span><br><span class="line">    <span class="keyword">u_int32_t</span> biSize;   </span><br><span class="line">    <span class="keyword">u_int32_t</span> biWidth;   </span><br><span class="line">    <span class="keyword">u_int32_t</span> biHeight;   </span><br><span class="line">    <span class="keyword">u_int16_t</span> biPlanes;   </span><br><span class="line">    <span class="keyword">u_int16_t</span> biBitCount;   </span><br><span class="line">    <span class="keyword">u_int32_t</span> biCompression;   </span><br><span class="line">    <span class="keyword">u_int32_t</span> biSizeImage;   </span><br><span class="line">    <span class="keyword">u_int32_t</span> biXPelsPerMeter;   </span><br><span class="line">    <span class="keyword">u_int32_t</span> biYPelsPerMeter;   </span><br><span class="line">    <span class="keyword">u_int32_t</span> biClrUsed;   </span><br><span class="line">    <span class="keyword">u_int32_t</span> biClrImportant;   </span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”±äºç›®å‰ä¸€èˆ¬dedaodeBMPæ–‡ä»¶å‡é‡‡ç”¨ç¬¬5ä»£DIBHEADERæ ¼å¼ï¼Œå› è€ŒDIBHEADERä¿¡æ¯é•¿ä¸º124å­—èŠ‚</span></span><br><span class="line"><span class="comment">     * æˆ‘ä»¬é¢å¤–å¸æ”¶æ‰è¿™äº›é¢å¤–çš„ä¿¡æ¯ï¼Œåœ¨æœ¬å®éªŒä¸­ä¸äºˆè€ƒè™‘å®ƒä»¬ã€‚</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="keyword">u_int8_t</span> foo[<span class="number">84</span>];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>&#123;</span><br><span class="line">        PRINT_FONT_GRE;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;DibHeader\n&quot;</span>);</span><br><span class="line">        PRINT_ATTR_REC;</span><br><span class="line">        <span class="built_in">fflush</span>(stdout);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;biSize: %d\n&quot;</span>, biSize);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;biWidth: %d\n&quot;</span>, biWidth);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;biHeight: %d\n&quot;</span>, biHeight);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;biPlanes(always 1): %d\n&quot;</span>, biPlanes);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;biBitCount: %d\n&quot;</span>, biBitCount);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;biCompression: %d\n&quot;</span>, biCompression);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;biSizeImage: %d\n&quot;</span>, biSizeImage);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;biXPelsPerMeter: %d\n&quot;</span>, biXPelsPerMeter);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;biYPelsPerMeter: %d\n&quot;</span>, biYPelsPerMeter);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;biClrUsed(0 if 2^biBitCount): %d\n&quot;</span>, biClrUsed);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;biClrImportant(0 if all important): %d\n&quot;</span>, biClrImportant);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;DibHeader;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">pixel</span>&#123;</span></span><br><span class="line">    <span class="keyword">u_int8_t</span> c[<span class="number">3</span>];</span><br><span class="line">    pixel <span class="keyword">operator</span> * (<span class="keyword">double</span> x)&#123;</span><br><span class="line">        pixel res; res.c[<span class="number">0</span>] = res.c[<span class="number">1</span>] = res.c[<span class="number">2</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) res.c[i] = c[i] * x;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    pixel <span class="keyword">operator</span> +(<span class="keyword">const</span> pixel &amp;b)&#123;</span><br><span class="line">        pixel res; res.c[<span class="number">0</span>] = res.c[<span class="number">1</span>] = res.c[<span class="number">2</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) res.c[i] = c[i] + b.c[i];</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">prt</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;&lt;%d, %d, %d&gt;\n&quot;</span>, c[<span class="number">0</span>], c[<span class="number">1</span>], c[<span class="number">2</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> height, width;</span><br><span class="line">pixel *rawPic;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> newHeight, newWidth;</span><br><span class="line">pixel *toPic;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">convert</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> j, <span class="keyword">int</span> n, <span class="keyword">int</span> m)</span></span>&#123;</span><br><span class="line">    i = <span class="built_in">max</span>(<span class="number">0</span>, <span class="built_in">min</span>(i, n));</span><br><span class="line">    j = <span class="built_in">max</span>(<span class="number">0</span>, <span class="built_in">min</span>(j, m));</span><br><span class="line">    <span class="keyword">return</span> i * m + j;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">prt</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *to)</span></span>&#123;</span><br><span class="line">    FILE *out = <span class="built_in">fopen</span>(to, <span class="string">&quot;wb+&quot;</span>);</span><br><span class="line">    BmpFileHeader.bfOffBits = <span class="number">14</span> + <span class="number">40</span>;</span><br><span class="line">    BmpFileHeader.bfSize = BmpFileHeader.bfOffBits + newHeight * newWidth * <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">    DibHeader.biSize = <span class="number">40</span>;</span><br><span class="line">    DibHeader.biWidth = newWidth;</span><br><span class="line">    DibHeader.biHeight = newHeight;</span><br><span class="line">    <span class="built_in">fwrite</span>(&amp;BmpFileHeader, <span class="built_in"><span class="keyword">sizeof</span></span>(BmpFileHeader), <span class="number">1</span>, out);</span><br><span class="line">    <span class="built_in">fwrite</span>(&amp;DibHeader, DibHeader.biSize, <span class="number">1</span>, out);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; newHeight; i++) <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; newWidth; j++)</span><br><span class="line">        <span class="built_in">fwrite</span>(&amp;toPic[<span class="built_in">convert</span>(i, j, newHeight, newWidth)], <span class="built_in"><span class="keyword">sizeof</span></span>(pixel), <span class="number">1</span>, out);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span>&#123;      </span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(argc != <span class="number">4</span> &amp;&amp; argc != <span class="number">2</span>)&#123;</span><br><span class="line">        PRINT_FONT_RED;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot; usage: ./main bmpFrom ratio bmpto&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot; usage: ./main bmpFile&quot;</span>);</span><br><span class="line">        PRINT_ATTR_REC;</span><br><span class="line">        <span class="built_in">fflush</span>(stdout);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    FILE *in = <span class="built_in">fopen</span>(argv[<span class="number">1</span>], <span class="string">&quot;rb&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">fread</span>(&amp;BmpFileHeader, <span class="number">1</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(BmpFileHeader), in);</span><br><span class="line">    <span class="built_in">fread</span>(&amp;DibHeader, <span class="number">1</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(DibHeader), in);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(argc == <span class="number">2</span>)&#123;</span><br><span class="line">        BmpFileHeader.<span class="built_in">show</span>();</span><br><span class="line">        DibHeader.<span class="built_in">show</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è€ƒè™‘åˆ°24è‰²RGBé¢œè‰²æ— è°ƒè‰²ç›˜ï¼Œæ¥ä¸‹æ¥çš„ä¿¡æ¯å°±æ˜¯åƒç´ ç‚¹ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     * è¿™ä¸€ç‚¹ä¹Ÿå¯ä»¥ä»:</span></span><br><span class="line"><span class="comment">     *  bfOffBits(138) = BmpFileHeader(14) + biSize(124)å¾—ä»¥å°è¯</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line"></span><br><span class="line">    height = DibHeader.biHeight;</span><br><span class="line">    width = DibHeader.biWidth;</span><br><span class="line">    rawPic = (pixel*)<span class="built_in">malloc</span>(height * width * <span class="built_in"><span class="keyword">sizeof</span></span>(pixel));</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; height; i++) <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; width; j++)</span><br><span class="line">        <span class="built_in">fread</span>(rawPic + <span class="built_in">convert</span>(i, j, height, width), <span class="number">1</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(pixel), in);</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">double</span> ratio; <span class="built_in">sscanf</span>(argv[<span class="number">2</span>], <span class="string">&quot;%lf&quot;</span>, &amp;ratio);</span><br><span class="line">    ratio /= <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    newHeight = ratio * height;</span><br><span class="line">    <span class="comment">// newHeight = (newHeight + 3) / 4 * 4;</span></span><br><span class="line">    newWidth = ratio * width;</span><br><span class="line">    newWidth = (newWidth + <span class="number">3</span>) / <span class="number">4</span> * <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// newWidth = 600;</span></span><br><span class="line">    toPic = (pixel*)<span class="built_in">malloc</span>(newHeight * newWidth * <span class="built_in"><span class="keyword">sizeof</span></span>(pixel));</span><br><span class="line">    <span class="built_in">memset</span>(toPic, <span class="number">0</span>, newHeight * newWidth * <span class="built_in"><span class="keyword">sizeof</span></span>(pixel));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; newHeight; i++) <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; newWidth; j++)&#123;</span><br><span class="line">        <span class="comment">// double _i = i * height / newHeight, _j = j * width / newWidth;</span></span><br><span class="line">        <span class="keyword">double</span> _i = i / ratio, _j = j / ratio;</span><br><span class="line">        <span class="keyword">int</span> ni = _i, nj = _j;</span><br><span class="line">        <span class="keyword">double</span> dx = _i - ni, dy = _j - nj;</span><br><span class="line"></span><br><span class="line">        pixel B = rawPic[<span class="built_in">convert</span>(ni + <span class="number">1</span>, nj + <span class="number">1</span>, height, width)];</span><br><span class="line">        pixel D = rawPic[<span class="built_in">convert</span>(ni, nj, height, width)];</span><br><span class="line">        pixel A = rawPic[<span class="built_in">convert</span>(ni + <span class="number">1</span>, nj, height, width)];</span><br><span class="line">        pixel C = rawPic[<span class="built_in">convert</span>(ni, nj + <span class="number">1</span>, height, width)];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        toPic[<span class="built_in">convert</span>(i, j, newHeight, newWidth)] = \</span><br><span class="line">            (B * dx * dy) + (D * (<span class="number">1</span> - dx) * (<span class="number">1</span> - dy)) + (A * (<span class="number">1</span> - dx) * dy) + (C * dx * (<span class="number">1</span> - dy));</span><br><span class="line">        </span><br><span class="line">    &#125;   </span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">    <span class="built_in">prt</span>(argv[<span class="number">3</span>]);</span><br><span class="line">    <span class="built_in">fclose</span>(in);  </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><del>æœ€åæ”¾ä¸€å¼ satou(é€ƒ</del></p><p><img src="/images/satou.bmp" alt=""></p>]]></content>
      
      
      
        <tags>
            
            <tag> BMP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>qko-gym</title>
      <link href="/2021/04/02/qko-gym/"/>
      <url>/2021/04/02/qko-gym/</url>
      
        <content type="html"><![CDATA[<p>[toc]</p><span id="more"></span><h1 id="Day1"><a href="#Day1" class="headerlink" title="Day1"></a>Day1</h1><h2 id="hdu6643"><a href="#hdu6643" class="headerlink" title="hdu6643"></a><a href="https://vjudge.net/contest/318115#problem/J">hdu6643</a></h2><p>å› ä¸ºä¾‹é¢˜ä¸ä»…æœ‰ç‚¹åˆ†æ²»è¿˜æ¶‰åŠåˆ°äº†æ ‘ä¸Šä¾èµ–èƒŒåŒ…çš„ç®—æ³•ï¼Œæ‰å‘ç°è‡ªå·±å¹¶ä¸å¤ªä¼šæ ‘å½¢èƒŒåŒ…çš„è‹¥å¹²ä¼˜åŒ–ç®—æ³•ï¼Œæ•…å­¦ä¹ ã€‚</p><h3 id="æ ‘å½¢èƒŒåŒ…"><a href="#æ ‘å½¢èƒŒåŒ…" class="headerlink" title="æ ‘å½¢èƒŒåŒ…"></a>æ ‘å½¢èƒŒåŒ…</h3><p><a href="https://www.acwing.com/problem/content/description/10/">æ¨¡æ¿é¢˜</a></p><p>ç»™å‡ºä¸€é¢—ä¾èµ–æ ‘ï¼Œè¯¢é—®æ€»é‡é‡é™å®šä¸‹å¯èƒ½è·å¾—çš„æœ€å¤§ä»·å€¼ã€‚</p><p>ç‰©å“çš„æ•°é‡å’Œé‡é‡çš„é™åˆ¶å‡ä¸è¶…è¿‡100</p><p>æœ‰ä¸åŒçš„åšæ³•ï¼Œå¤æ‚åº¦ä¹Ÿä¸åŒã€‚</p><h4 id="å‘ä¸Šåˆå¹¶"><a href="#å‘ä¸Šåˆå¹¶" class="headerlink" title="å‘ä¸Šåˆå¹¶"></a>å‘ä¸Šåˆå¹¶</h4><p>éšæ„é‡‡å–$O(nm^2)$çš„ç®—æ³•å³å¯åœ¨æ ‘ä¸Šåˆå¹¶ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> manx = <span class="number">1e2</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, W, v[maxn], w[maxn];</span><br><span class="line"><span class="keyword">int</span> dp[maxn][maxn];</span><br><span class="line">star edge[maxn &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> head[maxn], top = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//dp[i][j]è¡¨ç¤ºiå­æ ‘ä¸­é‡é‡ä¸ºjä¸‹çš„æœ€å¤§ä»·å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> par)</span></span>&#123;</span><br><span class="line">    dp[u][w[u]] = v[u];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[u]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(to == par) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(to, u);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = W; j &gt;= w[u]; j--)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k = j; k &gt;= w[u]; k--)&#123;</span><br><span class="line">                <span class="keyword">if</span>(dp[u][k] != <span class="number">-1</span> &amp;&amp; dp[to][j - k] != <span class="number">-1</span>)</span><br><span class="line">                    dp[u][j] = <span class="built_in">max</span>(dp[u][j], dp[u][k] + dp[to][j - k]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span>&#123;</span><br><span class="line">    <span class="comment">// Fastin; </span></span><br><span class="line">    <span class="built_in">clr</span>(head, <span class="number">-1</span>); <span class="built_in">clr</span>(dp, <span class="number">-1</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;W);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> x, y, z; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;x, &amp;y, &amp;z); <span class="keyword">if</span>(z == <span class="number">-1</span>) z = <span class="number">0</span>;</span><br><span class="line">        w[i] = x; v[i] = y;<span class="keyword">const</span> <span class="keyword">int</span> manx = <span class="number">1e2</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, W, v[maxn], w[maxn];</span><br><span class="line"><span class="keyword">int</span> dp[maxn][maxn];</span><br><span class="line">star edge[maxn &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> head[maxn], top = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="comment">// printf(&quot;%d %d\n&quot;,æ ‘å½¢èƒŒåŒ… u, v);</span></span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//dp[i][j]è¡¨ç¤ºiå­æ ‘ä¸­é‡é‡ä¸ºjä¸‹çš„æœ€å¤§ä»·å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> par)</span></span>&#123;</span><br><span class="line">    dp[u][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[u]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(to == par) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= W; i++) dp[to][i] = dp[u][i];</span><br><span class="line">        <span class="built_in">dfs</span>(to, u);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = W; i &gt;= w[to]; i--) <span class="keyword">if</span>(dp[to][i - w[to]] != <span class="number">-1</span>)</span><br><span class="line">            dp[u][i] = <span class="built_in">max</span>(dp[u][i], dp[to][i - w[to]] + v[to]);</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span>&#123;</span><br><span class="line">    <span class="comment">// Fastin; </span></span><br><span class="line">    <span class="built_in">clr</span>(head, <span class="number">-1</span>); <span class="built_in">clr</span>(dp, <span class="number">-1</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;W);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> x, y, z; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;x, &amp;y, &amp;z); <span class="keyword">if</span>(z == <span class="number">-1</span>) z = <span class="number">0</span>;</span><br><span class="line">        w[i] = x; v[i] = y;</span><br><span class="line">        <span class="built_in">add</span>(z, i);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">0</span>, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>; <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= W; i++) ans = <span class="built_in">max</span>(ans, dp[<span class="number">0</span>][i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">add</span>(z, i);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">0</span>, <span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>; <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= W; i++) ans = <span class="built_in">max</span>(ans, dp[<span class="number">0</span>][i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="å‘ä¸‹ä¼ é€’"><a href="#å‘ä¸‹ä¼ é€’" class="headerlink" title="å‘ä¸‹ä¼ é€’"></a>å‘ä¸‹ä¼ é€’</h4><p>åœ¨å‘ä¸‹ä¼ é€’çš„æ›´æ–°èƒŒåŒ…è¿‡ç¨‹æ—¶ï¼Œdpæ•°ç»„çš„å«ä¹‰æœ‰äº†äº›è®¸çš„å˜åŒ–ã€‚æ­¤æ—¶$dp[i][j]$è¡¨ç¤ºé€‰å–ièŠ‚ç‚¹çš„å­æ ‘<strong>ä¸”ä¸å…è®¸é€‰å–</strong>iæœ¬èº«ã€æ€»é‡é‡ä¸ºjçš„æœ€å¤§ä»·å€¼ã€‚</p><p>å°†æ‰€æœ‰å­©å­çš„èƒŒåŒ…ä¿¡æ¯å­˜åœ¨çˆ¶èŠ‚ç‚¹çš„dpæ•°ç»„ä¸­ï¼Œä½†ä¸åŒ…å«çˆ¶äº²è‡ªèº«çš„ä¿¡æ¯ï¼Œæ¯æ¬¡ä¼ é€’ã€å›æ”¶éƒ½åªæ¶‰åŠåˆ°æ‰€æœ‰çš„å„¿å­èŠ‚ç‚¹ã€‚å› è€Œåœ¨ä½¿ç”¨è¿™ç§æ–¹æ³•æ—¶ï¼Œä¸€å®šè¦ä½¿ç”¨ä¸€ä¸ª <font color="#dd0000"> è¶…çº§æºç‚¹    </font>æ¥ç»Ÿä¸€æ‰€æœ‰çš„ä¿¡æ¯ï¼</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> manx = <span class="number">1e2</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, W, v[maxn], w[maxn];</span><br><span class="line"><span class="keyword">int</span> dp[maxn][maxn];</span><br><span class="line">star edge[maxn &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> head[maxn], top = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//dp[i][j]è¡¨ç¤ºiå­æ ‘ä¸­é‡é‡ä¸ºjä¸‹çš„æœ€å¤§ä»·å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> par)</span></span>&#123;fun</span><br><span class="line">    dp[u][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[u]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(to == par) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= W; i++) dp[to][i] = dp[u][i];</span><br><span class="line">        <span class="built_in">dfs</span>(to, u);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = W; i &gt;= w[to]; i--) <span class="keyword">if</span>(dp[to][i - w[to]] != <span class="number">-1</span>)</span><br><span class="line">            dp[u][i] = <span class="built_in">max</span>(dp[u][i], dp[to][i - w[to]] + v[to]);</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span>&#123;</span><br><span class="line">    <span class="comment">// Fastin; </span></span><br><span class="line">    <span class="built_in">clr</span>(head, <span class="number">-1</span>); <span class="built_in">clr</span>(dp, <span class="number">-1</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;W);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> x, y, z; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;x, &amp;y, &amp;z); <span class="keyword">if</span>(z == <span class="number">-1</span>) z = <span class="number">0</span>;</span><br><span class="line">        w[i] = x; v[i] = y;</span><br><span class="line">        <span class="built_in">add</span>(z, i);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">0</span>, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>; <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= W; i++) ans = <span class="built_in">max</span>(ans, dp[<span class="number">0</span>][i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="å‚è€ƒåšå®¢"><a href="#å‚è€ƒåšå®¢" class="headerlink" title="å‚è€ƒåšå®¢"></a>å‚è€ƒåšå®¢</h5><p><a href="https://www.cnblogs.com/chdy/p/10095783.html">æ ‘ä¸Šä¾èµ–èƒŒåŒ…æ€»ç»“</a></p><h4 id="dfsåºä¼˜åŒ–"><a href="#dfsåºä¼˜åŒ–" class="headerlink" title="dfsåºä¼˜åŒ–"></a>dfsåºä¼˜åŒ–</h4><p>æˆ‘ä»¬è®°å½•æ ‘çš„dfsåºåˆ—ï¼Œä»¥åŠæ¯ä¸ªèŠ‚ç‚¹åŠå…¶å­æ ‘çš„å¤§å°ã€‚</p><p>æœ‰äº†è¿™æ ·çš„ä¸¤ä¸ªä¿¡æ¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°å¦‚ä¸‹çš„è½¬ç§»æ–¹ç¨‹</p><p>$dp[i][j] = max(dp[i + size[list[i]]][j], dp[i + 1][j - w[i]] + v[i])$</p><p>ç¬¬ä¸€é¡¹è¡¨ç¤ºå®Œå…¨ä¸é€‰è¿™ä¸€æ£µå­æ ‘ï¼Œç¬¬äºŒé¡¹åˆ™è¡¨ç¤ºé€‰è¿™ä¸ªå­æ ‘å¹¶è¿›è¡Œè½¬ç§»ã€‚</p><p>éå¸¸çš„ç²¾å¦™ã€‚</p><h5 id="å‚è€ƒåšå®¢å‹ç¼©"><a href="#å‚è€ƒåšå®¢å‹ç¼©" class="headerlink" title="å‚è€ƒåšå®¢å‹ç¼©"></a>å‚è€ƒåšå®¢å‹ç¼©</h5><p><a href="https://note.youdao.com/ynoteshare1/index.html?id=07619acf27a64381650dbb9dc2000f68&amp;type=note">å…ˆåºéå†ä¼˜åŒ–æ ‘å½¢èƒŒåŒ…</a></p><h3 id="ä¹˜ç§¯å‹ç¼©"><a href="#ä¹˜ç§¯å‹ç¼©" class="headerlink" title="ä¹˜ç§¯å‹ç¼©"></a>ä¹˜ç§¯å‹ç¼©</h3><p>å½“è½¬ç§»ä¹‹é—´çš„å…³ç³»ä¸æ˜¯åŠ æ³•è€Œæ˜¯ä¹˜æ³•æ—¶ï¼Œå¦‚æœä½¿ç”¨ä¸€èˆ¬çš„æ–¹å¼ç©ºé—´åˆ©ç”¨å¯†åº¦è¾ƒä½ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ä¸€ç§å‹ç¼©çš„æ–¹å¼è¾¾åˆ°$O(\sqrt W)$çš„çŠ¶æ€ç©ºé—´ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œè®¾ç½®$dp[i]$è¡¨ç¤ºä¹˜ç§¯$\prod a_i$æ»¡è¶³å…³ç³» $\frac {W}{\prod a_i}=i$ çš„æŸä»·å€¼ã€‚</p><p>ä»xåˆ°xyè½¬ç§»æ—¶å³ä¸ºä»dp[W / x]åˆ°dp[W / x / y]è½¬ç§»ã€‚</p><h4 id="ACä¸‹"><a href="#ACä¸‹" class="headerlink" title="ACä¸‹"></a>ACä¸‹</h4><p>åœ¨æœ¬é¢˜ä¸­ï¼Œåˆ©ç”¨ç‚¹åˆ†æ²»é™åˆ¶æ ‘çš„æ·±åº¦ï¼Œæ¯æ¬¡æš´åŠ›éå†å­æ ‘ï¼Œå¤æ‚åº¦$O(nlogn)$</p><p>åœ¨éå†å­æ ‘æ—¶ï¼Œè®°å½•å½“å‰æ ¹ä¸‹æ¯ä¸ªå­æ ‘çš„å¤§å°ä»¥åŠdfnåºåˆ—ã€‚</p><p>æœ‰äº†ä¸Šè¿°ä¸¤ä¸ªä¿¡æ¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ›´æ–°ä¾èµ–èƒŒåŒ…ã€‚</p><p>æœ¬é¢˜è¦è®¡æ•°çš„æ˜¯è¿é€šå—çš„ä¸ªæ•°ï¼Œè€Œä¸æ˜¯å¹³å¸¸çš„æœ€å¤§èƒŒåŒ…ä»·å€¼ï¼Œå› è€Œåœ¨dpè½¬ç§»æ—¶æœ‰æ‰€ä¸åŒã€‚</p><p>$dp[i][j]$ç”±<strong>ä¸¤éƒ¨åˆ†</strong>æ„æˆï¼Œä¸€éƒ¨åˆ†æ˜¯dfn[i]èŠ‚ç‚¹æœ¬èº«å­æ ‘æ„æˆçš„æ€»é‡é‡ä¸ºjçš„è®¡æ•°æ–¹æ¡ˆï¼Œå¦ä¸€éƒ¨åˆ†é€’å½’åœ°ç»§æ‰¿dfsæ ‘ä¸Šiçš„<strong>å³å…„å¼Ÿ</strong>çš„è‹¥å¹²ä¿¡æ¯ã€‚å› è€Œé™¤äº†æ ¹èŠ‚ç‚¹çš„dpæ•°ç»„ä¸ºå…¶çœŸå®æƒ…å†µï¼Œå…¶ä½™èŠ‚ç‚¹çš„dpæ•°ç»„å‡æœ‰ä¸€äº›ç»§æ‰¿å³å…„å¼Ÿè€Œæ¥çš„è®¡æ•°æ–¹æ¡ˆï¼Œä»…åœ¨å‰ä¸€ä¸ªdfnå…ƒç´ å°±æ˜¯å…¶çˆ¶äº²æ—¶å°†è¿™äº›è´¡çŒ®ç»Ÿä¸€åœ°ä¼ é€’ç»™çˆ¶äº²ã€‚</p><p>æ¥ä¸‹æ¥ç”¨åˆ°ä¹˜ç§¯å‹ç¼©å³å¯ï¼Œå†™çš„æ¯”è¾ƒä¸‘ï¼Œå°†ä¸€ä¸€æ˜ å°„çš„å…³ç³»è¿›è¡Œä¿å­˜ï¼Œæ¯æ¬¡ä»…ä»…å¯¹è¿™$\sqrt W$ä¸ªå¯èƒ½çš„çŠ¶æ€è¿›è¡Œè½¬ç§»å³å¯ã€‚</p><p>åŸºæœ¬çš„æ€è·¯å°±æ˜¯è¿™äº›ï¼ŒæŠŠè‡ªå·±å‘äº†ä¸€ä¸‹åˆçš„ç‚¹æ˜¯æœ€å¼€å§‹å†™çš„æ—¶å€™è®¤ä¸ºgetrootåsove(root)æ—¶ï¼Œå½“å‰è¿é€šå—å†…æ¯ä¸ªèŠ‚ç‚¹çš„å­æ ‘å¤§å°å°±æ˜¯getrootå¤„ç†å‡ºæ¥çš„å¤§å°ã€‚è¿™æ˜¾ç„¶æ˜¯é”™è¯¯çš„ï¼Œä¸€æ—¦getrootæ¢æ ¹åï¼Œå­æ ‘å¤§å°æ˜¾ç„¶ä¹Ÿä¼šå‘ç”Ÿæ”¹å˜ï¼Œåº”è¯¥é‡æ–°è®¡æ•°ï¼</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">2e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxe = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> K =  <span class="number">2e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, W;</span><br><span class="line"><span class="keyword">int</span> head[maxn], top = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> w[maxn];</span><br><span class="line">star edge[maxe &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> mx[maxn], root, vis[maxn], S, sze[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getroot</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> par)</span></span>&#123;</span><br><span class="line">    sze[now] = <span class="number">1</span>; mx[now] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[now]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(vis[to] || to == par) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">getroot</span>(to, now);</span><br><span class="line">        sze[now] += sze[to];</span><br><span class="line">        mx[now] = <span class="built_in">max</span>(mx[now], sze[to]);</span><br><span class="line">    &#125;</span><br><span class="line">    mx[now] = <span class="built_in">max</span>(mx[now], S - mx[now]);</span><br><span class="line">    <span class="keyword">if</span>(mx[now] &lt; mx[root]) root = now;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> dfn[maxn], cnt = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> par)</span></span>&#123;</span><br><span class="line">    dfn[cnt++] = now; sze[now] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = haed[now]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(vis[to] || par == to) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(to, now);</span><br><span class="line">        sze[now] += sze[to];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">ll ans = <span class="number">0</span>;</span><br><span class="line">ll dp[maxn][K];</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; vec;</span><br><span class="line"><span class="keyword">int</span> mp[K * K];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fun</span><span class="params">(<span class="keyword">int</span> now)</span></span>&#123;</span><br><span class="line">    cnt = <span class="number">0</span>; <span class="built_in">dfs</span>(now, <span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= cnt; i++) <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; vec.<span class="built_in">size</span>(); j++) dp[i][j] = <span class="number">0</span>;</span><br><span class="line">    dp[cnt][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = cnt - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">        <span class="keyword">int</span> u = dfn[i];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; vec.<span class="built_in">size</span>(); j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(vec[j] / w[u])&#123;</span><br><span class="line">                <span class="keyword">int</span> pos = mp[vec[j] / w[u]];</span><br><span class="line">                </span><br><span class="line">                dp[i][pos] += dp[i + <span class="number">1</span>][j];</span><br><span class="line">                dp[i][pos] %= M;</span><br><span class="line">            &#125;</span><br><span class="line">            dp[i][j] += dp[i + sze[u]][j];</span><br><span class="line">            dp[i][j] %= M;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (itn)vec.<span class="built_in">size</span>(); i++) ans = (ans + dp[<span class="number">0</span>][i]) % M;</span><br><span class="line">    ans = (ans + M - <span class="number">1</span>) % M;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sove</span><span class="params">(<span class="keyword">int</span> now)</span></span>&#123;</span><br><span class="line">    vis[now] = <span class="number">1</span>; </span><br><span class="line">    <span class="built_in">fun</span>(now);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[now]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(vis[to]) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        S = sze[to]; root = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">getroot</span>(to, now);</span><br><span class="line">        <span class="built_in">sove</span>(root);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// Fastin; </span></span><br><span class="line">    TTT&#123;</span><br><span class="line">        ans = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">clr</span>(head, <span class="number">-1</span>); top = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;W);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scnaf</span>(<span class="string">&quot;%d&quot;</span>, w + i);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> u, v; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">            <span class="built_in">add</span>(u, v); <span class="built_in">add</span>(v, u);</span><br><span class="line">        &#125;</span><br><span class="line">        vec.<span class="built_in">clear</span>(); <span class="built_in">clr</span>(mp, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= W; i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> res = W / i; </span><br><span class="line">            <span class="keyword">if</span>(vec.<span class="built_in">empty</span>() || *vec.<span class="built_in">rbegin</span>() != res) vec.<span class="built_in">push_back</span>(res);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; vec.<span class="built_in">size</span>(); i++) mp[vec[i]] = i;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        root = <span class="number">0</span>;</span><br><span class="line">        S = mx[<span class="number">0</span>] = n;</span><br><span class="line">        <span class="built_in">clr</span>(vis, <span class="number">0</span>); <span class="built_in">clr</span>(dp, <span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">getroot</span>(<span class="number">1</span>, <span class="number">0</span>); <span class="built_in">sove</span>(root);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ ‘å½¢èƒŒåŒ… </tag>
            
            <tag> ä¹˜ç§¯å‹ç¼© </tag>
            
            <tag> ç‚¹åˆ†æ²» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>arc-116</title>
      <link href="/2021/03/28/arc-116(%E5%9D%91)/"/>
      <url>/2021/03/28/arc-116(%E5%9D%91)/</url>
      
        <content type="html"><![CDATA[<p>[toc]</p><span id="more"></span><p><del>è‡ªä»¥ä¸ºAäº†ä¸€é“ç²¾å¦™çš„DPé¢˜ç»“æœè¢«ç¬¬äºŒé“åŒæ ·æ€æƒ³çš„DPå¡æ­»</del></p><h1 id="D-æ€»å’Œç»™å®šä¸‹è¿›è¡ŒNIMå¿…è´¥æ€è®¡æ•°"><a href="#D-æ€»å’Œç»™å®šä¸‹è¿›è¡ŒNIMå¿…è´¥æ€è®¡æ•°" class="headerlink" title="D æ€»å’Œç»™å®šä¸‹è¿›è¡ŒNIMå¿…è´¥æ€è®¡æ•°"></a>D æ€»å’Œç»™å®šä¸‹è¿›è¡ŒNIMå¿…è´¥æ€è®¡æ•°</h1><p>ç»™å‡ºnã€mï¼Œè¡¨ç¤ºæ€»å…±æœ‰nå †å¯ç©ºçŸ³å †$ \{a_i\}$ï¼Œè¦æ±‚æ»¡è¶³$\sum a_i = m, \bigoplus a_i=0$ï¼ŒæŸ¥è¯¢è¿™æ ·çš„åºåˆ—çš„ä¸ªæ•°ã€‚</p><p>æ„Ÿè§‰ä¸Šå¯ä»¥ç§°ä¹‹ä¸ºéå¸¸ç»å…¸çš„é¢˜ç›®ã€‚</p><p>è®¾ç½®dpçŠ¶æ€ï¼šdp[i]è¡¨ç¤ºnå †çŸ³å­å’Œä¸ºiï¼Œå¼‚æˆ–å’Œä¸º0çš„åºåˆ—æ•°é‡ã€‚</p><p>çŠ¶æ€è½¬ç§»ä¸ºï¼š</p><p><script type="math/tex">dp[2x + k] = \sum dp[x] * (^n_k)</script>ï¼Œkå–éèŒƒå›´å†…çš„å¶æ•°ã€‚</p><p>è¿™ä¸ªçŠ¶æ€çš„è½¬ç§»æœ¬è´¨ä¸Šæ˜¯ç”¨ä¸€äº›æ›´å°çš„æƒ…å†µä¸é‡ä¸æ¼åœ°åˆ»ç”»æ–°çš„çŠ¶æ€ã€‚å¦‚æœå½“å‰å·²çŸ¥dp[x]ï¼Œå°†è¿™nå †çŸ³å­çš„äºŒè¿›åˆ¶è¡¨ç¤ºå…¨éƒ¨å·¦ç§»ä¸€ä½ï¼Œå†æšä¸¾nä¸ªæœ€ä½ä½æœ‰å¤šå°‘ä¸ª1ï¼Œå°±æ˜¯å’Œä¸º$2*x+k$çš„ä¸€ç§æ„é€ æƒ…å†µã€‚</p><p>è¿™ç§æ€æƒ³è·Ÿç”¨æœ€å°çš„ç´ å› å­æ¥åˆ»ç”»æ•°å­—ä¹‹é—´è½¬åŒ–å…³ç³»æœ‰ç€å¼‚æ›²åŒå·¥ä¹‹å¦™ï¼Œä½†æˆ‘æš‚æ—¶æƒ³ä¸åˆ°ä»€ä¹ˆå½¢è€Œä¸Šçš„è¡¨è¾¾å½¢å¼æ¥ç»Ÿä¸€åœ°åˆ»ç”»è¿™ç§æ€è€ƒæ–¹å¼ï¼Œæ•…ç•™å‘ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">5e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">998244353</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">C</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span></span>&#123;</span><br><span class="line">    m = <span class="built_in">min</span>(m, n - m);</span><br><span class="line">    ll ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)&#123;</span><br><span class="line">        ans = ans * <span class="built_in">qp</span>(i, M - <span class="number">2</span>, M) % M;</span><br><span class="line">        ans = ans * (n + <span class="number">1</span> - i) % M;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ll dp[maxn];</span><br><span class="line">ll c[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// Fastin;</span></span><br><span class="line">    <span class="keyword">int</span> n, m; <span class="built_in">scnaf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++) c[i] = <span class="built_in">C</span>(n, i);</span><br><span class="line">    dp[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(i &amp; <span class="number">1</span>) dp[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j + j &lt;= i &amp;&amp; j + j &lt;= n; j++)&#123;</span><br><span class="line">                dp[i] += c[<span class="number">2</span> * j] * dp[i / <span class="number">2</span> - j] % M;</span><br><span class="line">                dp[i] %= M;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// prt(dp, m + 1, 1);</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, dp[m]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åšå¼ˆè®º </tag>
            
            <tag> DP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>test</title>
      <link href="/2021/03/24/test%E5%9B%BE%E7%89%87/"/>
      <url>/2021/03/24/test%E5%9B%BE%E7%89%87/</url>
      
        <content type="html"><![CDATA[<p>æ”¯æŒå›¾ç‰‡äº†ï¼</p><p>åœ¨ç›®å½•/imagesä¸‹æ’å…¥å›¾ç‰‡å³å¯ï¼</p><p>eg:</p><p><img src="/images/1.png" alt="1"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>linuxå¤šçº¿ç¨‹</title>
      <link href="/2021/03/23/linux%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
      <url>/2021/03/23/linux%E5%A4%9A%E7%BA%BF%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p>[toc]</p><p>åœ¨linuxä¸‹ï¼ŒPthreadæ˜¯ä¸€å¥—é€šç”¨çš„çº¿ç¨‹åº“ï¼Œç”±POSIXæå‡ºï¼Œå…·æœ‰è¾ƒå¥½çš„ç§»æ¤æ€§ã€‚</p><p>ä½¿ç”¨å¤´æ–‡ä»¶<code>&lt;pthread.h&gt;</code></p><span id="more"></span><h1 id="çº¿ç¨‹åŸºæœ¬æ“ä½œ"><a href="#çº¿ç¨‹åŸºæœ¬æ“ä½œ" class="headerlink" title="çº¿ç¨‹åŸºæœ¬æ“ä½œ"></a>çº¿ç¨‹åŸºæœ¬æ“ä½œ</h1><h2 id="çº¿ç¨‹çš„åˆ›å»ºä¸é€€å‡º"><a href="#çº¿ç¨‹çš„åˆ›å»ºä¸é€€å‡º" class="headerlink" title="çº¿ç¨‹çš„åˆ›å»ºä¸é€€å‡º"></a>çº¿ç¨‹çš„åˆ›å»ºä¸é€€å‡º</h2><h3 id="pthead-create"><a href="#pthead-create" class="headerlink" title="pthead_create"></a>pthead_create</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_create</span><span class="params">(<span class="keyword">pthread_t</span> *thread, <span class="keyword">pthread_attr_t</span> * attr, <span class="keyword">void</span> *(*start_routine)(<span class="keyword">void</span> *), <span class="keyword">void</span> *arg)</span></span>;</span><br></pre></td></tr></table></figure><p>ä¼ å…¥å‚æ•°ï¼šthreadä¸ºçº¿ç¨‹æ ‡è¯†ç¬¦ï¼Œatträ¸ºçº¿ç¨‹å±æ€§è®¾ç½®ï¼Œstart_routineä¸ºçº¿ç¨‹å‡½æ•°èµ·å§‹åœ°å€ï¼Œargä¸ºä¼ ç»™start_routineçš„å‚æ•°ã€‚</p><p>è¿”å›å€¼ï¼š0æˆåŠŸï¼Œ-1å¤±è´¥ã€‚</p><h3 id="pthread-exit"><a href="#pthread-exit" class="headerlink" title="pthread_exit"></a>pthread_exit</h3><p>çº¿ç¨‹å¯ä»¥é€šè¿‡ä¸»åŠ¨è°ƒç”¨è¯¥å‡½æ•°ç»“æŸè‡ªèº«ã€‚</p><p>å€¼å¾—æ³¨æ„ä¸èƒ½ä½¿ç”¨<code>exit</code>æ¥ç»“æŸå½“å‰<strong>çº¿ç¨‹</strong>ï¼Œå› ä¸ºexitä¼šç»ˆæ­¢<strong>è¿›ç¨‹</strong>ï¼Œç»ˆæ­¢è¯¥è¿›ç¨‹ä¸­æ‰€æœ‰çº¿ç¨‹ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pthread_exit</span><span class="params">(<span class="keyword">void</span> *retval)</span></span></span><br></pre></td></tr></table></figure><p>ä¼ å…¥å‚æ•°ï¼šretvalä¸ºè°ƒç”¨è€…çº¿ç¨‹çš„è¿”å›å€¼ã€‚</p><h3 id="pthread-join"><a href="#pthread-join" class="headerlink" title="pthread_join"></a>pthread_join</h3><p>è¯¥å‡½æ•°ç”¨äºå°†å½“å‰çº¿ç¨‹æŒ‚èµ·ï¼Œå€¼å¾—è¢«ç­‰å¾…çš„çº¿ç¨‹ç»“æŸä¸ºæ­¢ï¼Œå½“å‡½æ•°è¿”å›æ—¶ï¼Œè¢«ç­‰å¾…çº¿ç¨‹çš„èµ„æºå°±è¢«æ”¶å›ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_join</span> <span class="params">((<span class="keyword">pthread_t</span> th, <span class="keyword">void</span> å‚è€ƒèµ„æ–™**thread_return))</span></span></span><br></pre></td></tr></table></figure><p>ä¼ å…¥å‚æ•°ï¼šthä¸ºç­‰å¾…çº¿ç¨‹çš„æ ‡è¯†ç¬¦ï¼Œthread_returnä¸ºç”¨æˆ·å®šä¹‰çš„æŒ‡é’ˆï¼Œç”¨äºå­˜å‚¨è¢«ç­‰å¾…çº¿ç¨‹çš„è¿”å›å€¼(ä¸ä¸ºNULL)æ—¶ã€‚</p><h2 id="ä¿®æ”¹çº¿ç¨‹çš„å±æ€§èµ„æº"><a href="#ä¿®æ”¹çº¿ç¨‹çš„å±æ€§èµ„æº" class="headerlink" title="ä¿®æ”¹çº¿ç¨‹çš„å±æ€§èµ„æº"></a>ä¿®æ”¹çº¿ç¨‹çš„å±æ€§èµ„æº</h2><p>å‚è€ƒèµ„æ–™ï¼š<a href="https://blog.csdn.net/baobingji/article/details/84285951">å¤šçº¿ç¨‹å±æ€§pthread_attrè¯¦è§£</a></p><p>åœ¨thread_createå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰çº¿ç¨‹çš„å±æ€§ã€‚çº¿ç¨‹ä¸»è¦æœ‰å¦‚ä¸‹çš„ä¸€äº›å±æ€§ï¼šç»‘å®šå±æ€§ã€åˆ†ç¦»å±æ€§ã€å †æ ˆåœ°å€ã€å †æ ˆå¤§å°ã€ä¼˜å…ˆçº§ã€‚é»˜è®¤çš„å±æ€§æ˜¯éç»‘å®šã€éåˆ†ç¦»ã€1Mçš„å †æ ˆã€ä¸çˆ¶è¿›ç¨‹ä¼˜å…ˆçº§ç›¸åŒã€‚</p><h3 id="pthread-attr-init"><a href="#pthread-attr-init" class="headerlink" title="pthread_attr_init"></a>pthread_attr_init</h3><p>çº¿ç¨‹å±æ€§çš„è®¾ç½®é€šå¸¸å…ˆè°ƒç”¨è¯¥å‡½æ•°è¿›è¡Œåˆå§‹åŒ–ï¼Œä¹‹åå†è°ƒç”¨ç›¸åº”çš„å±æ€§è®¾ç½®å‡½æ•°è¿›è¡Œè®¾ç½®ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_attr_init</span><span class="params">(<span class="keyword">pthread_attr_t</span> *attr)</span></span></span><br></pre></td></tr></table></figure><p>ä¼ å…¥å‚æ•°: attrçº¿ç¨‹å±æ€§</p><p>è¿”å›å€¼ï¼šæˆåŠŸ0ï¼Œå¤±è´¥-1</p><h3 id="pthread-attr-setscope"><a href="#pthread-attr-setscope" class="headerlink" title="pthread_attr_setscope"></a>pthread_attr_setscope</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_attr_getscope</span><span class="params">( <span class="keyword">const</span> <span class="keyword">pthread_attr_t</span> * attr, <span class="keyword">int</span> * scope )</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_attr_setscope</span><span class="params">( <span class="keyword">pthread_attr_t</span>*, <span class="keyword">int</span> scope )</span></span>;</span><br></pre></td></tr></table></figure><p>ä¼ å…¥å‚æ•°ï¼š</p><ul><li>attrçº¿ç¨‹å±æ€§</li><li>scopeï¼šPTHREAD_SCOPE_SYSTEM ç»‘å®š(ç³»ç»Ÿçº§ç«äº‰èµ„æº)ï¼ŒPTHREAD_SCOPE_PROCESS éç»‘å®š(è¿›ç¨‹å†…ç«äº‰èµ„æº)</li></ul><h3 id="pthread-attr-setdetachstate"><a href="#pthread-attr-setdetachstate" class="headerlink" title="pthread_attr_setdetachstate"></a>pthread_attr_setdetachstate</h3><p>çº¿ç¨‹çš„åˆ†ç¦»çŠ¶æ€å†³å®šä¸€ä¸ªçº¿ç¨‹ä»¥ä»€ä¹ˆæ–¹å¼ç»“æŸè‡ªå·±ã€‚é»˜è®¤æƒ…å†µä¸‹ä¸ºéåˆ†ç¦»ï¼Œæ­¤æ—¶åŸæœ‰çš„çº¿ç¨‹ç­‰å¾…æ–°çº¿ç¨‹çš„ç»“æŸï¼Œåªæœ‰å½“pthread_joinè¿”å›æ—¶ï¼Œæ–°çº¿ç¨‹æ‰ç®—ç»ˆæ­¢ã€‚è€Œåœ¨åˆ†ç¦»çŠ¶æ€ä¸‹ï¼Œæ–°çº¿ç¨‹ä¸€æ—¦è¿è¡Œç»“æŸé©¬ä¸Šé‡Šæ”¾èµ„æºã€‚</p><p>éœ€è¦æ³¨æ„ï¼Œåœ¨<strong>åˆ†ç¦»çŠ¶æ€</strong>ä¸‹ï¼Œå¦‚æœæŸä¸€ä¸ªè¿›ç¨‹è¿è¡Œçš„é£å¿«ï¼Œåœ¨pthread_createå‡½æ•°è¿”å›å‰å°±ç»ˆæ­¢äº†ï¼Œå®ƒç»ˆæ­¢åå°±å¯èƒ½å°†çº¿ç¨‹å·å’Œç³»ç»Ÿèµ„æºç»™å…¶ä»–çº¿ç¨‹ä½¿ç”¨ï¼Œè¿™æ—¶è°ƒç”¨pthread_createå°±å¯èƒ½è¿”å›é”™è¯¯çš„çº¿ç¨‹å·ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_attr_setdetachstate</span><span class="params">(<span class="keyword">pthread_attr_t</span> *attr, <span class="keyword">int</span> detachstate)</span></span></span><br></pre></td></tr></table></figure><p>detachstate: PTHREAD_CREATE_DETACHED åˆ†ç¦»ï¼Œ PTHREAD _CREATE_JOINABLE éåˆ†ç¦»</p><h3 id="è°ƒåº¦ç­–ç•¥çš„è·å–-è®¾ç½®"><a href="#è°ƒåº¦ç­–ç•¥çš„è·å–-è®¾ç½®" class="headerlink" title="è°ƒåº¦ç­–ç•¥çš„è·å–/è®¾ç½®"></a>è°ƒåº¦ç­–ç•¥çš„è·å–/è®¾ç½®</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_attr_getschedpolicy</span><span class="params">(<span class="keyword">const</span> <span class="keyword">pthread_attr_t</span> *, <span class="keyword">int</span> * policy)</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_attr_setschedpolicy</span><span class="params">(pthread_attr_*, <span class="keyword">int</span> policy)</span></span></span><br></pre></td></tr></table></figure><p>ä¼ å…¥å‚æ•°ï¼špolicyä¸ºè°ƒåº¦ç­–ç•¥ï¼Œæœ‰è‹¥å¹²ç§å¯èƒ½çš„æƒ…å†µï¼š</p><ul><li>SCHED_FIFO</li><li>SCHED_RR (è½®è½¬æ³•)</li><li>SHCED_OTHER</li></ul><p>å‰ä¸¤ç§æ–¹æ³•å‡æ”¯æŒä¼˜å…ˆçº§çš„ä½¿ç”¨ï¼Œä¼˜å…ˆçº§ä»1-99ï¼Œæ•°å€¼è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜ã€‚</p><h3 id="ä¼˜å…ˆçº§çš„è·å–-è®¾ç½®-æœ€å€¼æŸ¥è¯¢"><a href="#ä¼˜å…ˆçº§çš„è·å–-è®¾ç½®-æœ€å€¼æŸ¥è¯¢" class="headerlink" title="ä¼˜å…ˆçº§çš„è·å–/è®¾ç½®/æœ€å€¼æŸ¥è¯¢"></a>ä¼˜å…ˆçº§çš„è·å–/è®¾ç½®/æœ€å€¼æŸ¥è¯¢</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_attr_getschedparam</span><span class="params">(<span class="keyword">const</span> <span class="keyword">pthread_attr_t</span> *,struct sched_param *)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_attr_setschedparam</span><span class="params">(<span class="keyword">pthread_attr_t</span> *,<span class="keyword">const</span> struct sched_param *)</span></span>;</span><br></pre></td></tr></table></figure><p>é»˜è®¤çš„ç»“æ„å¤§æ¦‚æ˜¯è¿™æ ·</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sched_param</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> sched_priority;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å¯ä»¥é€šè¿‡å¦‚ä¸‹ä¸¤ä¸ªå‡½æ•°è·å–ç³»ç»Ÿæ”¯æŒçš„ä¼˜å…ˆçº§çš„æœ€å€¼</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sched_get_priority_max</span><span class="params">( <span class="keyword">int</span> policy )</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sched_get_priority_min</span><span class="params">( <span class="keyword">int</span> policy )</span></span>;</span><br></pre></td></tr></table></figure><h1 id="çº¿ç¨‹è®¿é—®æ§åˆ¶"><a href="#çº¿ç¨‹è®¿é—®æ§åˆ¶" class="headerlink" title="çº¿ç¨‹è®¿é—®æ§åˆ¶"></a>çº¿ç¨‹è®¿é—®æ§åˆ¶</h1><p>ç”±äºçº¿ç¨‹å…±äº«è¿›ç¨‹èµ„æºï¼Œå› è€Œéœ€è¦è€ƒè™‘èµ„æºè®¿é—®çš„é—®é¢˜ã€‚</p><h2 id="mutexäº’æ–¥é”"><a href="#mutexäº’æ–¥é”" class="headerlink" title="mutexäº’æ–¥é”"></a>mutexäº’æ–¥é”</h2><h3 id="äº’æ–¥é”çš„ç±»å‹"><a href="#äº’æ–¥é”çš„ç±»å‹" class="headerlink" title="äº’æ–¥é”çš„ç±»å‹"></a>äº’æ–¥é”çš„ç±»å‹</h3><p>å‚è€ƒèµ„æ–™ <a href="https://blog.csdn.net/qq_42169059/article/details/90600257">ä¹ã€Linuxä¸‹çº¿ç¨‹äº’æ–¥é”ç±»å‹åŠå±æ€§</a></p><ul><li><p>PTHREAD_MUTEX_NORMALï¼š<strong><font color="#dd0000"> æ ‡å‡†äº’æ–¥é”ï¼šç¬¬ä¸€æ¬¡ä¸Šé”æˆåŠŸï¼Œç¬¬äºŒæ¬¡ä¸Šé”ä¼šé˜»å¡ã€‚</font></strong><br>æè¿°:<br>æ­¤ç±»å‹çš„äº’æ–¥é”ä¸ä¼šæ£€æµ‹æ­»é”ã€‚å¦‚æœçº¿ç¨‹åœ¨ä¸é¦–å…ˆè§£é™¤äº’æ–¥é”çš„æƒ…å†µä¸‹å°è¯•é‡æ–°é”å®šè¯¥äº’æ–¥é”ï¼Œåˆ™ä¼šäº§ç”Ÿæ­»é”ã€‚å°è¯•è§£é™¤ç”±å…¶ä»–çº¿ç¨‹é”å®šçš„äº’æ–¥é”ä¼šäº§ç”Ÿä¸ç¡®å®šçš„è¡Œä¸ºã€‚å¦‚æœå°è¯•è§£é™¤é”å®šçš„äº’æ–¥é”æœªé”å®šï¼Œåˆ™ä¼šäº§ç”Ÿä¸ç¡®å®šçš„è¡Œä¸ºã€‚</p></li><li><p>PTHREAD_MUTEX_ERRORCHECKï¼š<font color="#dd0000"> <strong>æ£€é”™äº’æ–¥é”ï¼šç¬¬ä¸€æ¬¡ä¸Šé”æˆåŠŸï¼Œç¬¬äºŒæ¬¡ä¸Šé”ä¼šå‡ºé”™ã€‚</strong></font></p><p>æè¿°:<br>æ­¤ç±»å‹çš„äº’æ–¥é”å¯æä¾›é”™è¯¯æ£€æŸ¥ã€‚å¦‚æœçº¿ç¨‹åœ¨ä¸é¦–å…ˆè§£é™¤é”å®šäº’æ–¥é”çš„æƒ…å†µä¸‹å°è¯•é‡æ–°é”å®šè¯¥äº’æ–¥é”ï¼Œåˆ™ä¼šè¿”å›é”™è¯¯ã€‚å¦‚æœçº¿ç¨‹å°è¯•è§£é™¤é”å®šçš„äº’æ–¥é”å·²ç»ç”±å…¶ä»–çº¿ç¨‹é”å®šï¼Œåˆ™ä¼šè¿”å›é”™è¯¯ã€‚å¦‚æœçº¿ç¨‹å°è¯•è§£é™¤é”å®šçš„äº’æ–¥é”æœªé”å®šï¼Œåˆ™ä¼šè¿”å›é”™è¯¯ã€‚</p></li><li><p>PTHREAD_MUTEX_RECURSIVEï¼š<font color="#dd0000"><strong>é€’å½’äº’æ–¥é”ï¼šç¬¬ä¸€æ¬¡ä¸Šé”æˆåŠŸï¼Œç¬¬äºŒæ¬¡ä¸Šé”ä¹Ÿä¼šæˆåŠŸï¼Œå†…éƒ¨è®¡æ•°ã€‚</strong></font><br>æè¿°:æ“ä½œæ“ä½œ<br>å¦‚æœçº¿ç¨‹åœ¨ä¸é¦–å…ˆè§£é™¤é”å®šäº’æ–¥é”çš„æƒ…å†µä¸‹å°è¯•é‡æ–°é”å®šè¯¥äº’æ–¥é”ï¼Œåˆ™å¯æˆåŠŸé”å®šè¯¥äº’æ–¥é”ã€‚ ä¸ PTHREAD_MUTEX_NORMAL ç±»å‹çš„äº’æ–¥é”ä¸åŒï¼Œå¯¹æ­¤ç±»å‹äº’æ–¥é”è¿›è¡Œé‡æ–°é”å®šæ—¶ä¸ä¼šäº§ç”Ÿæ­»é”æƒ…å†µã€‚å¤šæ¬¡é”å®šäº’æ–¥é”éœ€è¦è¿›è¡Œç›¸åŒæ¬¡æ•°çš„è§£é™¤é”å®šæ‰å¯ä»¥é‡Šæ”¾è¯¥é”ï¼Œç„¶åå…¶ä»–çº¿ç¨‹æ‰èƒ½è·å–è¯¥äº’æ–¥é”ã€‚å¦‚æœçº¿ç¨‹å°è¯•è§£é™¤é”å®šçš„äº’æ–¥é”å·²ç»ç”±å…¶ä»–çº¿ç¨‹é”å®šï¼Œåˆ™ä¼šè¿”å›é”™è¯¯ã€‚ å¦‚æœçº¿ç¨‹å°è¯•è§£é™¤é”å®šçš„äº’æ–¥é”æœªé”å®šï¼Œåˆ™ä¼šè¿”å›é”™è¯¯ã€‚</p></li><li><p>PTHREAD_MUTEX_DEFAULTï¼š<font color="#dd0000"><strong>é»˜è®¤äº’æ–¥é”ï¼šåŒæ ‡å‡†çš„äº’æ–¥é”</strong></font><br>æè¿°:<br>å¦‚æœå°è¯•ä»¥é€’å½’æ–¹å¼é”å®šæ­¤ç±»å‹çš„äº’æ–¥é”ï¼Œåˆ™ä¼šäº§ç”Ÿä¸ç¡®å®šçš„è¡Œä¸ºã€‚å¯¹äºä¸æ˜¯ç”±è°ƒç”¨çº¿ç¨‹é”å®šçš„æ­¤ç±»å‹äº’æ–¥é”ï¼Œå¦‚æœå°è¯•å¯¹å®ƒè§£é™¤é”å®šï¼Œåˆ™ä¼šäº§ç”Ÿä¸ç¡®å®šçš„è¡Œä¸ºã€‚å¯¹äºå°šæœªé”å®šçš„æ­¤ç±»å‹äº’æ–¥é”ï¼Œå¦‚æœå°è¯•å¯¹å®ƒè§£é™¤é”å®šï¼Œä¹Ÿä¼šäº§ç”Ÿä¸ç¡®å®šçš„è¡Œä¸ºã€‚å…è®¸åœ¨å®ç°ä¸­å°†è¯¥äº’æ–¥é”æ˜ å°„åˆ°å…¶ä»–äº’æ–¥é”ç±»å‹ä¹‹ä¸€ã€‚</p></li></ul><h3 id="å¯¹äº’æ–¥é”çš„æ“ä½œ"><a href="#å¯¹äº’æ–¥é”çš„æ“ä½œ" class="headerlink" title="å¯¹äº’æ–¥é”çš„æ“ä½œ"></a>å¯¹äº’æ–¥é”çš„æ“ä½œ</h3><h4 id="äº’æ–¥é”çš„åˆ›å»º"><a href="#äº’æ–¥é”çš„åˆ›å»º" class="headerlink" title="äº’æ–¥é”çš„åˆ›å»º"></a>äº’æ–¥é”çš„åˆ›å»º</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_mutex_init</span><span class="params">(<span class="keyword">pthread_mutex_t</span> *mutex, <span class="keyword">const</span> <span class="keyword">pthread_mutexattr_t</span> *mutexattr)</span></span></span><br></pre></td></tr></table></figure><p>mutexattrç¼ºçœæ—¶é»˜è®¤åˆ›å»ºå¿«é€Ÿäº’æ–¥é”ï¼ˆPTHREAD_MUTEX_DEFAULTï¼‰</p><h4 id="äº’æ–¥é”çš„æ“ä½œ"><a href="#äº’æ–¥é”çš„æ“ä½œ" class="headerlink" title="äº’æ–¥é”çš„æ“ä½œ"></a>äº’æ–¥é”çš„æ“ä½œ</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_mutex_lock</span><span class="params">(<span class="keyword">pthread_mutex_t</span> *mutex)</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_mutex_trylock</span><span class="params">(<span class="keyword">pthread_mutex_t</span> *mutex)</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_mutex_unlock</span><span class="params">(<span class="keyword">pthread_mutex_t</span> *mutex,)</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_mutex_destroy</span><span class="params">(<span class="keyword">pthread_mutex_t</span> *mutex,)</span></span></span><br></pre></td></tr></table></figure><p>ï¼ˆæœ›æ–‡ç”Ÿä¹‰å³å¯.jpgï¼‰</p><h2 id="ä¿¡å·é‡çº¿ç¨‹æ§åˆ¶"><a href="#ä¿¡å·é‡çº¿ç¨‹æ§åˆ¶" class="headerlink" title="ä¿¡å·é‡çº¿ç¨‹æ§åˆ¶"></a>ä¿¡å·é‡çº¿ç¨‹æ§åˆ¶</h2><p>åŠŸèƒ½å‚è§OSæ•™æå³å¯ã€‚</p><h3 id="å¤´æ–‡ä»¶"><a href="#å¤´æ–‡ä»¶" class="headerlink" title="å¤´æ–‡ä»¶"></a>å¤´æ–‡ä»¶</h3><p><code>#include &lt;semaphore.h&gt;</code></p><h3 id="åŸºæœ¬æ“ä½œ"><a href="#åŸºæœ¬æ“ä½œ" class="headerlink" title="åŸºæœ¬æ“ä½œ"></a>åŸºæœ¬æ“ä½œ</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sem_init</span><span class="params">(<span class="keyword">sem_t</span> *sem, <span class="keyword">int</span> pshared, <span class="keyword">unsigned</span> <span class="keyword">int</span> value)</span></span></span><br></pre></td></tr></table></figure><p>ä¼ å…¥å‚æ•°ï¼š</p><ul><li>semä¿¡å·é‡</li><li>psharedå†³å®šä¿¡å·é‡èƒ½åœ¨å‡ ä¸ªè¿›ç¨‹é—´å…±äº«ï¼Œç”±äºç›®å‰linuxè¿˜ä¸èƒ½å®ç°è¿›ç¨‹é—´ä¿¡å·é‡çš„å…±äº«ï¼Œæ‰€ä»¥è¯¥å€¼åªèƒ½å–1</li><li>valueä¿¡å·åˆå§‹å€¼</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sem_wait</span><span class="params">(<span class="keyword">sem_t</span> *sem)</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sem_trywait</span><span class="params">(<span class="keyword">sem_t</span> *sem)</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sem_post</span><span class="params">(<span class="keyword">sem_t</span> *sem)</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sem_getvalue</span><span class="params">(<span class="keyword">sem_t</span> *sem)</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sem_destroy</span><span class="params">(<span class="keyword">sem_t</span> *sem)</span></span></span><br></pre></td></tr></table></figure><p>æœ›æ–‡ç”Ÿä¹‰å³å¯ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¤šçº¿ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>socket</title>
      <link href="/2021/03/23/socket/"/>
      <url>/2021/03/23/socket/</url>
      
        <content type="html"><![CDATA[<p>[toc]</p><span id="more"></span><h1 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h1><h2 id="socketå¸¸ç”¨å‡½æ•°"><a href="#socketå¸¸ç”¨å‡½æ•°" class="headerlink" title="socketå¸¸ç”¨å‡½æ•°"></a>socketå¸¸ç”¨å‡½æ•°</h2><h3 id="socket"><a href="#socket" class="headerlink" title="socket"></a>socket</h3><p>domainæŒ‡å®šåè®®æ—ï¼ŒtypeæŒ‡å®šsocketç±»å‹ï¼ŒprotocolæŒ‡å®šåè®®ï¼ˆä¸º0æ—¶è‡ªåŠ¨é€‰æ‹©typeç±»å‹å¯¹åº”çš„é»˜è®¤åè®®ï¼‰</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">socket</span><span class="params">(<span class="keyword">int</span> domain, <span class="keyword">int</span> type, <span class="keyword">int</span> protocol)</span></span>;</span><br></pre></td></tr></table></figure><p>è¿”å›å€¼å¤§äº0æˆåŠŸï¼›-1å¤±è´¥ï¼Œé”™è¯¯ç±»å‹ä¿å­˜åœ¨å…¨å±€å˜é‡errnoä¸­ã€‚</p><h3 id="bind"><a href="#bind" class="headerlink" title="bind"></a>bind</h3><p>åˆ†é…åœ°å€æ—ä¸­çš„ç‰¹åœ°åœ°å€ç»™socket<br> sockfdä¸ºsocketæè¿°å­—ï¼Œé€šè¿‡socketå‡½æ•°çš„è¿”å›å€¼ç¡®å®š<br> addræŒ‡å‘ç»‘å®šç»™sockfdçš„åœ°å€ï¼Œæ ¹æ®socketåˆ›å»ºæ—¶åè®®æ—çš„ä¸åŒè€Œä¸åŒã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">bind</span><span class="params">(<span class="keyword">int</span> sockfd, <span class="keyword">const</span> struct sockaddr *addr, <span class="keyword">socklen_t</span> addrlen)</span></span>;</span><br></pre></td></tr></table></figure><p>è¿”å›å€¼ç­‰äº0æˆåŠŸï¼›-1å¤±è´¥ï¼Œé”™è¯¯ç±»å‹ä¿å­˜åœ¨å…¨å±€å˜é‡errnoä¸­ã€‚</p><h4 id="sockaddr-å¯èƒ½çš„è‹¥å¹²ç»“æ„"><a href="#sockaddr-å¯èƒ½çš„è‹¥å¹²ç»“æ„" class="headerlink" title="sockaddr*å¯èƒ½çš„è‹¥å¹²ç»“æ„"></a>sockaddr*å¯èƒ½çš„è‹¥å¹²ç»“æ„</h4><h5 id="ipv4"><a href="#ipv4" class="headerlink" title="ipv4"></a>ipv4</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> &#123;</span></span><br><span class="line">    <span class="keyword">sa_family_t</span>    sin_family; </span><br><span class="line">    <span class="keyword">in_port_t</span>      sin_port;   </span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">in_addr</span> <span class="title">sin_addr</span>;</span>   </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">in_addr</span> &#123;</span></span><br><span class="line">    <span class="keyword">uint32_t</span>       s_addr;     </span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="ipv6"><a href="#ipv6" class="headerlink" title="ipv6"></a>ipv6</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in6</span> &#123;</span> </span><br><span class="line">    <span class="keyword">sa_family_t</span>     sin6_famiä¸€ä¸ªly;    </span><br><span class="line">    <span class="built_in">in_port_thtonl</span>()--<span class="string">&quot;Host to Network Long&quot;</span></span><br><span class="line"><span class="built_in">ntohl</span>()--<span class="string">&quot;Network to Host Long&quot;</span></span><br><span class="line"><span class="built_in">htons</span>()--<span class="string">&quot;Host to Network Short&quot;</span></span><br><span class="line"><span class="built_in">ntohs</span>()--<span class="string">&quot;Network to Host Short&quot;</span>       sin6_port;      </span><br><span class="line">    <span class="keyword">uint32_t</span>        sin6_flowinfo;  </span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">in6_addr</span> <span class="title">sin6_addr</span>;</span>      </span><br><span class="line">    <span class="keyword">uint32_t</span>        sin6_scope_id;  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">in6_addr</span> &#123;</span> </span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span>   s6_addr[<span class="number">16</span>];    </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="listen"><a href="#listen" class="headerlink" title="listen"></a>listen</h3><p>æœåŠ¡å™¨ç›‘å¬æŒ‡å®šçš„å¥—æ¥å­—ï¼ŒbacklogæŒ‡å®šsocketæœ€å¤§è¿æ¥ä¸ªæ•°ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">listen</span><span class="params">(<span class="keyword">int</span> sockfd, <span class="keyword">int</span> backlog)</span></span>;</span><br></pre></td></tr></table></figure><p>è¿”å›å€¼ç­‰äº0æˆåŠŸï¼›-1å¤±è´¥ï¼Œé”™è¯¯ç±»å‹ä¿å­˜åœ¨å…¨å±€å˜é‡errnoä¸­ã€‚</p><h3 id="connect"><a href="#connect" class="headerlink" title="connect"></a>connect</h3><p>å®¢æˆ·ç«¯è°ƒç”¨connectå‡½æ•°ä¸æœåŠ¡å™¨è¿›è¡Œè¿æ¥ã€‚</p><p>sockfdä¸ºå®¢æˆ·æœºçš„å¥—æ¥å­—æè¿°ç¬¦ï¼Œaddrä¸ºæœåŠ¡å™¨çš„å¥—æ¥å­—åœ°å€ï¼Œaddrlenä¸ºsocketåœ°å€çš„é•¿åº¦ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">connect</span><span class="params">(<span class="keyword">int</span> sockfd, <span class="keyword">const</span> struct sockaddr *addr, <span class="keyword">socklen_t</span> addrlen)</span></span>;</span><br></pre></td></tr></table></figure><p>å®¢æˆ·æœºä¸€èˆ¬ä¸æŒ‡å®šè‡ªå·±çš„ç«¯å£ï¼Œç³»ç»Ÿåœ¨1024-5000ä¸­é€‰ä¸€ä¸ªï¼ˆå³è‡ªç”±ç«¯å£ï¼‰ï¼Œ5000ä»¥ä¸Šä½œä¸ºå…¬å…±ç«¯å£ã€‚</p><h3 id="accept"><a href="#accept" class="headerlink" title="accept"></a>accept</h3><p>å½“æœåŠ¡å™¨listenåˆ°æŸhtonl()â€”â€œHost to Network Longâ€<br> ntohl()â€”â€œNetwork to Host Longâ€<br> htons()â€”â€œHost to Network Shortâ€<br> ntohs()â€”â€œNetwork to Host Shortâ€å®¢æˆ·æœºçš„connectè¿æ¥è¯·æ±‚ï¼Œåˆ™å¯ä»¥é€šè¿‡accpetå‡½æ•°æ¥å—è¯·æ±‚ï¼ŒåŒæ—¶å»ºç«‹ä¸€ä¸ªæ–°çš„å¥—æ¥å­—ï¼Œä¸“é—¨ç”¨äºæœ¬æ¬¡çš„é€šä¿¡æœåŠ¡ã€‚</p><p>sockfdä¸ºæœåŠ¡å™¨çš„ç›‘å¬socketæè¿°ç¬¦ï¼Œaddrä¸ºå…¶åœ°å€ï¼Œaddrlenä¸ºåè®®åœ°å€çš„é•¿åº¦ï¼Œè¿”å›è¿æ¥å¥—æ¥å­—çš„æè¿°å­—ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">accept</span><span class="params">(<span class="keyword">int</span> sockfd, struct sockaddr *addr, <span class="keyword">socklen_t</span> *addrlen)</span></span>;</span><br></pre></td></tr></table></figure><h3 id="IO"><a href="#IO" class="headerlink" title="IO"></a>IO</h3><p>æœåŠ¡å™¨ä¸å®¢æˆ·æœºåƒæ“ä½œæ–‡ä»¶ä¸€æ ·æ“ä½œsocketè¿›è¡Œé€šä¿¡ã€‚</p><p>æœ‰è®¸å¤šå¯¹IOæ“ä½œï¼š</p><ul><li>read/write</li><li>recv/send</li><li>readv/writev</li><li>recvmsg/sendmsg</li><li>recvfrome/sendto</li></ul><p>æš‚æ—¶ä»…è€ƒè™‘ä¸€å¯¹IOæ“ä½œï¼ˆread/writeï¼‰</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">ssize_t</span> <span class="title">read</span><span class="params">(<span class="keyword">int</span> fd, <span class="keyword">void</span> *buf, <span class="keyword">size_t</span> count)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">ssize_t</span> <span class="title">write</span><span class="params">(<span class="keyword">int</span> fd, <span class="keyword">const</span> <span class="keyword">void</span> *buf, <span class="keyword">size_t</span> count)</span></span>;</span><br></pre></td></tr></table></figure><h3 id="close"><a href="#close" class="headerlink" title="close"></a>close</h3><p>å°†å¥—æ¥å­—<strong>å¼•ç”¨è®¡æ•°</strong>-1</p><p>closeåè¿›ç¨‹ä¸å†èƒ½è®¿é—®è¯¥å¥—æ¥å­—ï¼Œä½†å¥—æ¥å­—çš„æ¸…é™¤ç”±TCPå»¶åå®Œæˆã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">close</span><span class="params">(<span class="keyword">int</span> sockfd)</span></span>;</span><br></pre></td></tr></table></figure><h3 id="getsockname-getpeername"><a href="#getsockname-getpeername" class="headerlink" title="getsockname, getpeername"></a>getsockname, getpeername</h3><p>è·å–å¥—æ¥å­—çš„åå­—ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getsockname</span><span class="params">(<span class="keyword">int</span> fd,struct sockaddr* localaddr,<span class="keyword">int</span>* addrlen)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getpeername</span><span class="params">(<span class="keyword">int</span> fd,struct sockaddr* peeraddr,<span class="keyword">int</span>* addrlen)</span></span>;</span><br></pre></td></tr></table></figure><h3 id="å­—èŠ‚é¡ºåºè½¬æ¢"><a href="#å­—èŠ‚é¡ºåºè½¬æ¢" class="headerlink" title="å­—èŠ‚é¡ºåºè½¬æ¢"></a>å­—èŠ‚é¡ºåºè½¬æ¢</h3><p>htonl()â€”â€œHost to Network Longâ€<br>ntohl()â€”â€œNetwork to Host Longâ€<br>htons()â€”â€œHost to Network Shortâ€<br>ntohs()â€”â€œNetwork to Host Shortâ€</p><h3 id="å‚è€ƒåšå®¢"><a href="#å‚è€ƒåšå®¢" class="headerlink" title="å‚è€ƒåšå®¢"></a>å‚è€ƒåšå®¢</h3><p> <a href="https://blog.csdn.net/pashanhu6402/article/details/96428887#t1">SocketåŸç†è®²è§£</a></p><h1 id="Unit-02"><a href="#Unit-02" class="headerlink" title="Unit 02"></a>Unit 02</h1><h2 id="ç®€å•çš„äº¤äº’ç¤ºä¾‹"><a href="#ç®€å•çš„äº¤äº’ç¤ºä¾‹" class="headerlink" title="ç®€å•çš„äº¤äº’ç¤ºä¾‹"></a>ç®€å•çš„äº¤äº’ç¤ºä¾‹</h2><p>clientå‘serverå‘é€ä¸‰æ¡æ¶ˆæ¯hello hello1 hello2</p><p>serveræ”¶åˆ°æ¶ˆæ¯åå›å¤ä¸€ä¸ªwelcome</p><h3 id="server-c"><a href="#server-c" class="headerlink" title="server.c"></a>server.c</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netinet/in.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXDATASIZE 128</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PORT 3000</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BACKLOG 5</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc,<span class="keyword">char</span> **argv)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> sockfd, new_fd, nbytes, sin_size;</span><br><span class="line"><span class="keyword">char</span> buf[MAXDATASIZE];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">srvaddr</span>, <span class="title">clientaddr</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//1.åˆ›å»ºç½‘ç»œç«¯ç‚¹</span></span><br><span class="line">sockfd=<span class="built_in">socket</span>(AF_INET,SOCK_STREAM,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(sockfd==<span class="number">-1</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;can;t create socket\n&quot;</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¥—æ¥å­—é€‰é¡¹ å¢æ·»ç«¯å£åœ°å€å¯é‡ç”¨é€‰é¡¹ï¼Œä½¿å¾—æŸå°æœåŠ¡å™¨å´©æºƒåå¯ä»¥å¿«é€Ÿç”¨å…¶ä½™æœåŠ¡å™¨é‡æ–°æä¾›æœåŠ¡</span></span><br><span class="line"><span class="keyword">if</span>(argc==<span class="number">2</span>)&#123;</span><br><span class="line"><span class="keyword">int</span> on=<span class="number">1</span>;</span><br><span class="line"><span class="built_in">setsockopt</span>(sockfd,SOL_SOCKET,SO_REUSEADDR,&amp;on,<span class="built_in"><span class="keyword">sizeof</span></span>(on));</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;reuse addr\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¡«å……åœ°å€</span></span><br><span class="line"><span class="built_in">bzero</span>(&amp;srvaddr,<span class="built_in"><span class="keyword">sizeof</span></span>(srvaddr));</span><br><span class="line">srvaddr.sin_family=AF_INET;</span><br><span class="line"><span class="comment">//htonsè¿›è¡Œå­—èŠ‚é¡ºåºè½¬æ¢</span></span><br><span class="line">srvaddr.sin_port=<span class="built_in">htons</span>(PORT);</span><br><span class="line"><span class="comment">//æœåŠ¡å™¨ä¸Šæ— è®ºæœ‰å¤šå°‘ä¸ªIPå‘æ¥æ¶ˆæ¯ï¼Œå…¨éƒ¨éƒ½äºˆä»¥æ¥å—</span></span><br><span class="line">srvaddr.sin_addr.s_addr=<span class="built_in">htonl</span>(INADDR_ANY);</span><br><span class="line"></span><br><span class="line"><span class="comment">//å°†xxx.xxx.xxx.xxxè½¬æ¢ä¸º32ä½çš„åœ°å€</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">if(inet_aton(argv[1],&amp;srvaddr.sin_addr)==-1)&#123;</span></span><br><span class="line"><span class="comment">printf(&quot;addr convert error\n&quot;);</span></span><br><span class="line"><span class="comment">exit(1);</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">//2.ç»‘å®šæœåŠ¡å™¨åœ°å€å’Œç«¯å£</span></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">bind</span>(sockfd,(struct sockaddr *)&amp;srvaddr,<span class="built_in"><span class="keyword">sizeof</span></span>(struct sockaddr))==<span class="number">-1</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;bind error\n&quot;</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//3. ç›‘å¬ç«¯å£ï¼Œå°†ä¸»åŠ¨å¥—æ¥å­—è½¬æ¢ä¸ºè¢«åŠ¨å¥—æ¥å­—</span></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">listen</span>(sockfd,BACKLOG)==<span class="number">-1</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;listen error\n&quot;</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ä¸€èˆ¬åº”è¯¥åœ¨å¾ªç¯ä¸­æ·»åŠ ä¸€äº›é€€å‡ºçš„æ–¹æ³•</span></span><br><span class="line"><span class="keyword">for</span>(;;)&#123;</span><br><span class="line"><span class="comment">//4.æ¥å—å®¢æˆ·ç«¯è¿æ¥</span></span><br><span class="line">sin_size=<span class="built_in"><span class="keyword">sizeof</span></span>(struct sockaddr_in);</span><br><span class="line"><span class="keyword">if</span>((new_fd=<span class="built_in">accept</span>(sockfd,(struct sockaddr *)&amp;clientaddr, (<span class="keyword">socklen_t</span>*)&amp;sin_size))==<span class="number">-1</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;accept error\n&quot;</span>);</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å¦‚æœæˆåŠŸè¿æ¥ï¼Œé‚£ä¹ˆæ‰“å°å‡ºå®¢æˆ·æœºçš„ipã€port</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;client addr:%s %d\n&quot;</span>,<span class="built_in">inet_ntoa</span>(clientaddr.sin_addr),<span class="built_in">ntohs</span>(clientaddr.sin_port));</span><br><span class="line"></span><br><span class="line"><span class="comment">//5.æ¥æ”¶è¯·æ±‚ </span></span><br><span class="line"><span class="comment">//å»¶æ—¶ å¿…é¡»è¯»å…¥ä¸€ä¸ªå­—ç¬¦æ‰ç»§ç»­ å¯ä»¥æ£€æŸ¥è¯»å…¥çš„å®¢æˆ·æœºæ•°æ®çš„æƒ…å†µ(ä½†æ˜¯å¾ˆéº»çƒ¦æ‰€ä»¥æˆ‘åˆ äº†)</span></span><br><span class="line"><span class="comment">//getchar();</span></span><br><span class="line">        </span><br><span class="line"><span class="comment">//sockfdå±äºç›‘å¬å¥—æ¥å­—ï¼Œnew_fdå±äºè¿æ¥å¥—æ¥å­—</span></span><br><span class="line">nbytes=<span class="built_in">read</span>(new_fd,buf,MAXDATASIZE);</span><br><span class="line">buf[nbytes]=<span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;client:%s\n\n&quot;</span>,buf);</span><br><span class="line"></span><br><span class="line"><span class="comment">//6.å›é€å“åº”</span></span><br><span class="line"><span class="built_in">sprintf</span>(buf,<span class="string">&quot;wellcome!&quot;</span>);</span><br><span class="line"><span class="built_in">write</span>(new_fd,buf,<span class="built_in">strlen</span>(buf));</span><br><span class="line"></span><br><span class="line"><span class="comment">//å…³é—­socket</span></span><br><span class="line"><span class="built_in">close</span>(new_fd);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">close</span>(sockfd);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="client-c"><a href="#client-c" class="headerlink" title="client.c"></a>client.c</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netinet/in.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;errno.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netdb.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXDATASIZE 128</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PORT 3000</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">addr_conv</span><span class="params">(<span class="keyword">char</span> *address,struct in_addr *inaddr)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc,<span class="keyword">char</span> **argv)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> sockfd,nbytes;</span><br><span class="line"><span class="keyword">int</span> port=PORT;</span><br><span class="line"><span class="keyword">char</span> buf[MAXDATASIZE];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">srvaddr</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//å¿…é¡»è¾“å…¥1/2ä¸ªå‚æ•°ï¼Œå…·ä½“æ ¼å¼å‚è§printfçš„å†…å®¹</span></span><br><span class="line"><span class="keyword">if</span>(argc!=<span class="number">2</span> &amp;&amp; argc!=<span class="number">3</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;usage:./client hostname|ip. Or usage:./client hostname|ip port\n&quot;</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å¦‚æœæœ‰æŒ‡å®šç«¯å£å·åˆ™ä½¿ç”¨ï¼Œä¸ç„¶ä½¿ç”¨é»˜è®¤ç«¯å£PORT=3000</span></span><br><span class="line"><span class="keyword">if</span>(argc==<span class="number">3</span>) port=<span class="built_in">atoi</span>(argv[<span class="number">2</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">//1.åˆ›å»ºç½‘ç»œç«¯ç‚¹</span></span><br><span class="line">sockfd=<span class="built_in">socket</span>(AF_INET,SOCK_STREAM,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(sockfd==<span class="number">-1</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;can;t create socket\n&quot;</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æŒ‡å®šæœåŠ¡å™¨åè®®ç°‡ï¼Œç«¯å£ï¼ˆæœ¬åœ°socketåœ°å€é‡‡ç”¨é»˜è®¤å€¼ï¼‰</span></span><br><span class="line"><span class="built_in">bzero</span>(&amp;srvaddr,<span class="built_in"><span class="keyword">sizeof</span></span>(srvaddr));</span><br><span class="line">srvaddr.sin_family=AF_INET;</span><br><span class="line">srvaddr.sin_port=<span class="built_in">htons</span>(port);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">if(inet_aton(&quot;127.0.0.1&quot;,&amp;srvaddr.sin_addr)==-1)&#123;</span></span><br><span class="line"><span class="comment">printf(&quot;addr convert error\n&quot;);</span></span><br><span class="line"><span class="comment">exit(1);</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">//æ ¹æ®ä¼ å…¥å‚æ•°æŒ‡å®šæœåŠ¡å™¨IPåœ°å€</span></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">addr_conv</span>(argv[<span class="number">1</span>],&amp;srvaddr.sin_addr)==<span class="number">-1</span>)&#123;</span><br><span class="line"><span class="built_in">perror</span>(<span class="built_in">strerror</span>(errno));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//2.è¿æ¥æœåŠ¡å™¨</span></span><br><span class="line"><span class="comment">//å®¢æˆ·ç«¯çš„IPåœ°å€ç­‰ä¿¡æ¯ä¸éœ€è¦æ‰‹åŠ¨å¡«å†™ï¼Œç”±å†…æ ¸è‡ªåŠ¨å®Œæˆ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">connect</span>(sockfd,(struct sockaddr *)&amp;srvaddr,<span class="built_in"><span class="keyword">sizeof</span></span>(struct sockaddr))==<span class="number">-1</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;connect error\n&quot;</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//3.å‘é€è¯·æ±‚</span></span><br><span class="line"><span class="built_in">sprintf</span>(buf,<span class="string">&quot;hello&quot;</span>); <span class="built_in">write</span>(sockfd,buf,<span class="built_in">strlen</span>(buf));</span><br><span class="line"><span class="built_in">sprintf</span>(buf,<span class="string">&quot;hello2&quot;</span>); <span class="built_in">write</span>(sockfd,buf,<span class="built_in">strlen</span>(buf));</span><br><span class="line"><span class="built_in">sprintf</span>(buf,<span class="string">&quot;hello3&quot;</span>); <span class="built_in">write</span>(sockfd,buf,<span class="built_in">strlen</span>(buf));</span><br><span class="line"></span><br><span class="line"><span class="comment">//4.æ¥æ”¶å“åº”</span></span><br><span class="line"><span class="keyword">if</span>((nbytes=<span class="built_in">read</span>(sockfd,buf,MAXDATASIZE))==<span class="number">-1</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;read error\n&quot;</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">buf[nbytes]=<span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;srv respons:%s\n\n&quot;</span>,buf);</span><br><span class="line"></span><br><span class="line"><span class="comment">//å…³é—­socket</span></span><br><span class="line"><span class="built_in">close</span>(sockfd);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">addr_conv</span><span class="params">(<span class="keyword">char</span> *address,struct in_addr *inaddr)</span></span>&#123;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">hostent</span> *<span class="title">he</span>;</span></span><br><span class="line"><span class="comment">//inet_aton å‡½æ•°å°†ä¸€ä¸ªâ€œå­—ç¬¦ä¸²ç±»å‹â€çš„IPåœ°å€è½¬åŒ–ä¸ºâ€œæ•´æ•°ç±»å‹â€çš„åœ°å€</span></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">inet_aton</span>(address,inaddr)==<span class="number">1</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;call inet_aton sucess.\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;call inet_aton fail.\n&quot;</span>);</span><br><span class="line"><span class="comment">//å¦‚æœè¾“å…¥çš„ä¸æ˜¯IPåœ°å€è€Œä¸»æœºå/åŸŸåï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡è¿™äº›æ¥è·å¾—IPåœ°å€</span></span><br><span class="line">he=<span class="built_in">gethostbyname</span>(address);</span><br><span class="line"><span class="keyword">if</span>(he!=<span class="literal">NULL</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;call gethostbyname sucess.\n&quot;</span>);</span><br><span class="line">*inaddr=*((struct in_addr *)(he-&gt;h_addr_list[<span class="number">0</span>]));</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="å¥—æ¥å­—æœ€å¤§åˆ›å»ºæ•°é‡"><a href="#å¥—æ¥å­—æœ€å¤§åˆ›å»ºæ•°é‡" class="headerlink" title="å¥—æ¥å­—æœ€å¤§åˆ›å»ºæ•°é‡"></a>å¥—æ¥å­—æœ€å¤§åˆ›å»ºæ•°é‡</h2><h3 id="client-msock-c-ä¸»åŠ¨å¥—æ¥å­—æœ€å¤§æ•°é‡"><a href="#client-msock-c-ä¸»åŠ¨å¥—æ¥å­—æœ€å¤§æ•°é‡" class="headerlink" title="client_msock.c(ä¸»åŠ¨å¥—æ¥å­—æœ€å¤§æ•°é‡)"></a>client_msock.c(ä¸»åŠ¨å¥—æ¥å­—æœ€å¤§æ•°é‡)</h3><p>æ£€æŸ¥æœ€å¤šå¯åˆ›å»ºçš„å¥—æ¥å­—æ•°é‡<br>å‘ç¨‹åºä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºIPåœ°å€ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºæƒ³è¦åˆ›å»ºçš„å¥—æ¥å­—æ•°é‡<br>å…·ä½“å®ç°å…¶å®æ˜¯Onåœ°å°è¯•åˆ›å»ºæ‰€æœ‰å¸Œæœ›çš„å¥—æ¥å­—ï¼Œå‡ºé”™åˆ™é€€å‡ºã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netinet/in.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;errno.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netdb.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXDATASIZE 128</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PORT 3000</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">addr_conv</span><span class="params">(<span class="keyword">char</span> *address,struct in_addr *inaddr)</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc,<span class="keyword">char</span> **argv)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i,sockfd;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">srvaddr</span>;</span></span><br><span class="line"><span class="keyword">int</span> n=<span class="built_in">atoi</span>(argv[<span class="number">2</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">//1.åˆ›å»ºç½‘ç»œç«¯ç‚¹</span></span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">&#123;</span><br><span class="line">sockfd=<span class="built_in">socket</span>(AF_INET,SOCK_STREAM,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(sockfd==<span class="number">-1</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Failed to create the %d socket.\n&quot;</span>,i);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æŒ‡å®šæœåŠ¡å™¨åœ°å€ï¼ˆæœ¬åœ°socketåœ°å€é‡‡ç”¨é»˜è®¤å€¼ï¼‰</span></span><br><span class="line"><span class="built_in">bzero</span>(&amp;srvaddr,<span class="built_in"><span class="keyword">sizeof</span></span>(srvaddr));</span><br><span class="line">srvaddr.sin_family=AF_INET;</span><br><span class="line">srvaddr.sin_port=<span class="built_in">htons</span>(PORT);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">addr_conv</span>(argv[<span class="number">1</span>],&amp;srvaddr.sin_addr)==<span class="number">-1</span>)&#123;</span><br><span class="line"><span class="built_in">perror</span>(<span class="built_in">strerror</span>(errno));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Finished.\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="server-msock-c-è¢«åŠ¨å¥—æ¥å­—æœ€å¤§æ•°é‡"><a href="#server-msock-c-è¢«åŠ¨å¥—æ¥å­—æœ€å¤§æ•°é‡" class="headerlink" title="server_msock.c(è¢«åŠ¨å¥—æ¥å­—æœ€å¤§æ•°é‡)"></a>server_msock.c(è¢«åŠ¨å¥—æ¥å­—æœ€å¤§æ•°é‡)</h3><p>ä¼ å…¥2/4ä¸ªå‚æ•°ï¼Œè¡¨ç¤ºèµ·å§‹ç«¯å£å·ã€åˆ›å»ºè¿ç»­å¥—æ¥å­—æ•°é‡ã€å‘é€ä¿¡æ¯å¤§å°ã€æ¥å—ä¿¡æ¯å¤§å°ã€‚</p><p>å…·ä½“å®ç°ä¸ä¸Šè¿°ç±»ä¼¼ï¼Œæš´åŠ›æ¨¡æ‹Ÿï¼Œæ£€éªŒæ˜¯å¦å¯è¡Œã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netinet/in.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXDATASIZE 128</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BACKLOG 5</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc,<span class="keyword">char</span> **argv)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> sockfd,new_fd,nbytes,sin_size;</span><br><span class="line"><span class="keyword">char</span> buf[MAXDATASIZE];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">srvaddr</span>;</span></span><br><span class="line"><span class="keyword">int</span> i,lastsockfd=<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">int</span> minport,n,sizeSND,sizeRCV;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(argc!=<span class="number">3</span> &amp;&amp; argc!=<span class="number">5</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;You should input 3 or 5 params: &quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;func, startPort, number, SND size, RCV size.\n&quot;</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">minport=<span class="built_in">atoi</span>(argv[<span class="number">1</span>]);</span><br><span class="line">n=<span class="built_in">atoi</span>(argv[<span class="number">2</span>]);</span><br><span class="line"><span class="keyword">if</span>(argc==<span class="number">5</span>)</span><br><span class="line">&#123;</span><br><span class="line">sizeSND=<span class="built_in">atoi</span>(argv[<span class="number">3</span>]);</span><br><span class="line">sizeRCV=<span class="built_in">atoi</span>(argv[<span class="number">4</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//1.åˆ›å»ºç½‘ç»œç«¯ç‚¹</span></span><br><span class="line">sockfd=<span class="built_in">socket</span>(AF_INET,SOCK_STREAM,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(sockfd==<span class="number">-1</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Failed to create %d socket.The last sockfd is %d.\n&quot;</span>,i,lastsockfd);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">lastsockfd=sockfd;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(argc==<span class="number">5</span>)&#123;<span class="comment">// get &amp; set SO_SNDBUF,SO_RCVBUF</span></span><br><span class="line"><span class="keyword">int</span> size;</span><br><span class="line"><span class="keyword">socklen_t</span> size2=<span class="built_in"><span class="keyword">sizeof</span></span>(size);</span><br><span class="line"><span class="keyword">if</span>((<span class="built_in">getsockopt</span>(sockfd,SOL_SOCKET,SO_SNDBUF,&amp;size,&amp;size2))&lt;<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;getsockopt failed\n&quot;</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//printf(&quot;SND buff is %d\n&quot;,size);</span></span><br><span class="line"><span class="keyword">if</span>((<span class="built_in">getsockopt</span>(sockfd,SOL_SOCKET,SO_RCVBUF,&amp;size,&amp;size2))&lt;<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;getsockopt failed\n&quot;</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//printf(&quot;RCV buff is %d\n&quot;,size);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>((<span class="built_in">setsockopt</span>(sockfd,SOL_SOCKET,SO_SNDBUF,&amp;sizeSND,<span class="built_in"><span class="keyword">sizeof</span></span>(sizeSND)))&lt;<span class="number">0</span> </span><br><span class="line">|| (<span class="built_in">setsockopt</span>(sockfd,SOL_SOCKET,SO_RCVBUF,&amp;sizeRCV,<span class="built_in"><span class="keyword">sizeof</span></span>(sizeRCV)))&lt;<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;setsockopt failed.\n&quot;</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//printf(&quot;New SND and RCV buff are %d and %d.\n&quot;,sizeSND,sizeRCV);</span></span><br><span class="line"><span class="comment">//exit(0);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¡«å……åœ°å€</span></span><br><span class="line"><span class="built_in">bzero</span>(&amp;srvaddr,<span class="built_in"><span class="keyword">sizeof</span></span>(srvaddr));</span><br><span class="line">srvaddr.sin_family=AF_INET;</span><br><span class="line">srvaddr.sin_port=<span class="built_in">htons</span>(minport+i);</span><br><span class="line">srvaddr.sin_addr.s_addr=<span class="built_in">htonl</span>(INADDR_ANY);</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.ç»‘å®šæœåŠ¡å™¨åœ°å€å’Œç«¯å£</span></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">bind</span>(sockfd,(struct sockaddr *)&amp;srvaddr,<span class="built_in"><span class="keyword">sizeof</span></span>(struct sockaddr))==<span class="number">-1</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;bind error\n&quot;</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//3. ç›‘å¬ç«¯å£</span></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">listen</span>(sockfd,BACKLOG)==<span class="number">-1</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;listen error\n&quot;</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Finished.The last sockfd is %d.\n&quot;</span>,sockfd);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="ç»Ÿè®¡è‡ªç”±ç«¯å£æ•°é‡"><a href="#ç»Ÿè®¡è‡ªç”±ç«¯å£æ•°é‡" class="headerlink" title="ç»Ÿè®¡è‡ªç”±ç«¯å£æ•°é‡"></a>ç»Ÿè®¡è‡ªç”±ç«¯å£æ•°é‡</h2><p>å…·ä½“å®ç°æ˜¯å®¢æˆ·ç«¯å°è¯•è¿›è¡Œå……åˆ†å¤šæ¬¡çš„å¥—æ¥å­—è¿æ¥è¯·æ±‚ï¼ŒæœåŠ¡å™¨ç«¯æ¯æ¬¡æ ¹æ®å‘é€æ–¹çš„IPåœ°å€æ›´æ–°æœ€å¤§æœ€å°å€¼ï¼Œè¿™æ ·å°±èƒ½çŸ¥é“è‡ªç”±ç«¯å£æ‰€åœ¨çš„åŒºé—´ã€‚.</p><p><del>å¤§æ¦‚è‡ªç”±ç«¯å£ä¿è¯æ˜¯è¿ç»­çš„</del></p><h3 id="client-port-c"><a href="#client-port-c" class="headerlink" title="client_port.c"></a>client_port.c</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netinet/in.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;errno.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netdb.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXDATASIZE 128</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PORT 3000</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">addr_conv</span><span class="params">(<span class="keyword">char</span> *address,struct in_addr *inaddr)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc,<span class="keyword">char</span> **argv)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> sockfd,nbytes,i,j;</span><br><span class="line"><span class="keyword">char</span> buf[MAXDATASIZE];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">srvaddr</span>;</span></span><br><span class="line"><span class="keyword">if</span>(argc!=<span class="number">2</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;usage:./client hostname|ip\n&quot;</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">bzero</span>(&amp;srvaddr,<span class="built_in"><span class="keyword">sizeof</span></span>(srvaddr));</span><br><span class="line">srvaddr.sin_family=AF_INET;</span><br><span class="line">srvaddr.sin_port=<span class="built_in">htons</span>(PORT);</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">addr_conv</span>(argv[<span class="number">1</span>],&amp;srvaddr.sin_addr)==<span class="number">-1</span>)</span><br><span class="line">&#123;</span><br><span class="line">   <span class="built_in">perror</span>(<span class="built_in">strerror</span>(errno));</span><br><span class="line">   <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">100</span>;j++)</span><br><span class="line">&#123;</span><br><span class="line">   <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">10000</span>;i++)</span><br><span class="line">   &#123;</span><br><span class="line">      sockfd=<span class="built_in">socket</span>(AF_INET,SOCK_STREAM,<span class="number">0</span>);</span><br><span class="line">      <span class="keyword">if</span>(sockfd==<span class="number">-1</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;can;t create socket\n&quot;</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span>(<span class="built_in">connect</span>(sockfd,(struct sockaddr *)&amp;srvaddr,<span class="built_in"><span class="keyword">sizeof</span></span>(struct sockaddr))==<span class="number">-1</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;connect error\n&quot;</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="built_in">sprintf</span>(buf,<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">      <span class="built_in">write</span>(sockfd,buf,<span class="built_in">strlen</span>(buf));</span><br><span class="line">      <span class="keyword">if</span>((nbytes=<span class="built_in">read</span>(sockfd,buf,MAXDATASIZE))==<span class="number">-1</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;read error\n&quot;</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">close</span>(sockfd);</span><br><span class="line">   &#125;</span><br><span class="line">    </span><br><span class="line">   <span class="built_in">printf</span>(<span class="string">&quot;srv respons 10k times:%d\n&quot;</span>,j);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="server-port-c"><a href="#server-port-c" class="headerlink" title="server_port.c"></a>server_port.c</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netinet/in.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXDATASIZE 128</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PORT 3000</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BACKLOG 5</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc,<span class="keyword">char</span> **argv)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> sockfd, new_fd, nbytes, sin_size;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> port, minport, maxport;</span><br><span class="line"><span class="keyword">char</span> buf[MAXDATASIZE];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">srvaddr</span>,<span class="title">clientaddr</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//1.åˆ›å»ºç½‘ç»œç«¯ç‚¹</span></span><br><span class="line">sockfd=<span class="built_in">socket</span>(AF_INET,SOCK_STREAM,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(sockfd==<span class="number">-1</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;can;t create socket\n&quot;</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(argc==<span class="number">2</span>)&#123;</span><br><span class="line"><span class="keyword">int</span> on=<span class="number">1</span>;</span><br><span class="line"><span class="built_in">setsockopt</span>(sockfd,SOL_SOCKET,SO_REUSEADDR,&amp;on,<span class="built_in"><span class="keyword">sizeof</span></span>(on));</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;reuse addr\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å¡«å……åœ°å€</span></span><br><span class="line"><span class="built_in">bzero</span>(&amp;srvaddr,<span class="built_in"><span class="keyword">sizeof</span></span>(srvaddr));</span><br><span class="line">srvaddr.sin_family=AF_INET;</span><br><span class="line">srvaddr.sin_port=<span class="built_in">htons</span>(PORT);</span><br><span class="line">srvaddr.sin_addr.s_addr=<span class="built_in">htonl</span>(INADDR_ANY);</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.ç»‘å®šæœåŠ¡å™¨åœ°å€å’Œç«¯å£</span></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">bind</span>(sockfd,(struct sockaddr *)&amp;srvaddr,<span class="built_in"><span class="keyword">sizeof</span></span>(struct sockaddr))==<span class="number">-1</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;bind error\n&quot;</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//3. ç›‘å¬ç«¯å£</span></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">listen</span>(sockfd,BACKLOG)==<span class="number">-1</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;listen error\n&quot;</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;åœ¨æ‰§è¡Œ make  ä¹‹</span><br><span class="line"></span><br><span class="line">minport=<span class="number">65535</span>;</span><br><span class="line">maxport=<span class="number">0</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Listening......\n&quot;</span>);</span><br><span class="line"><span class="keyword">for</span>(;;)&#123;</span><br><span class="line"><span class="comment">//4.æ¥å—å®¢æˆ·ç«¯è¿æ¥</span></span><br><span class="line">sin_size=<span class="built_in"><span class="keyword">sizeof</span></span>(struct sockaddr_in);</span><br><span class="line"><span class="keyword">if</span>((new_fd=<span class="built_in">accept</span>(sockfd,(struct sockaddr *)&amp;clientaddr,&amp;sin_size))==<span class="number">-1</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;accept error\n&quot;</span>);</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">port=(<span class="keyword">unsigned</span> <span class="keyword">int</span>)<span class="built_in">ntohs</span>(clientaddr.sin_port);</span><br><span class="line"><span class="keyword">if</span>(port&lt;minport || port&gt;maxport)</span><br><span class="line">&#123;</span><br><span class="line">   <span class="keyword">if</span>(port&lt;minport)</span><br><span class="line">      minport=port;</span><br><span class="line">   <span class="keyword">else</span> <span class="keyword">if</span>(port&gt;maxport)</span><br><span class="line">      maxport=port;</span><br><span class="line">   </span><br><span class="line">   <span class="built_in">printf</span>(<span class="string">&quot;minport is: %d\t&quot;</span>,minport);</span><br><span class="line">   <span class="built_in">printf</span>(<span class="string">&quot;maxport is: %d\n&quot;</span>,maxport);</span><br><span class="line">&#125;</span><br><span class="line">nbytes=<span class="built_in">read</span>(new_fd,buf,MAXDATASIZE);</span><br><span class="line"><span class="built_in">write</span>(new_fd,buf,<span class="built_in">strlen</span>(buf));</span><br><span class="line"><span class="built_in">close</span>(new_fd);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">close</span>(sockfd);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="star-å®¢æˆ·ç«¯å‘é€æ•´æ•°ï¼ŒæœåŠ¡å™¨è®¡ç®—å¹³å‡å€¼åè¿”å›"><a href="#star-å®¢æˆ·ç«¯å‘é€æ•´æ•°ï¼ŒæœåŠ¡å™¨è®¡ç®—å¹³å‡å€¼åè¿”å›" class="headerlink" title=":star: å®¢æˆ·ç«¯å‘é€æ•´æ•°ï¼ŒæœåŠ¡å™¨è®¡ç®—å¹³å‡å€¼åè¿”å›"></a>:star: å®¢æˆ·ç«¯å‘é€æ•´æ•°ï¼ŒæœåŠ¡å™¨è®¡ç®—å¹³å‡å€¼åè¿”å›</h2><h3 id="header"><a href="#header" class="headerlink" title="header"></a>header</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;termio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;pthread.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdarg.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> itn int</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> whlie while</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fro for</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pritnf printf</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">termios</span> <span class="title">tmtemp</span>, <span class="title">tm</span>;</span></span><br><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">getch</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> c = <span class="number">0</span>, fd = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è·å–å½“å‰çš„ç»ˆç«¯å±æ€§è®¾ç½®ï¼Œå¹¶ä¿å­˜åˆ°tmç»“æ„ä½“ä¸­</span></span><br><span class="line">    <span class="keyword">if</span>(tcgetattr(fd,&amp;tm) != <span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">    tmtemp=tm;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//å°†tetempåˆå§‹åŒ–ä¸ºç»ˆç«¯åŸå§‹æ¨¡å¼çš„å±æ€§è®¾ç½®</span></span><br><span class="line">    cfmakeraw(&amp;tmtemp);     </span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç»ˆç«¯è®¾ç½®ä¸ºåŸå§‹æ¨¡å¼çš„è®¾ç½®</span></span><br><span class="line">    <span class="keyword">if</span>(tcsetattr(fd,TCSANOW,&amp;tmtemp) != <span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    </span><br><span class="line">    c=getchar();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(tcsetattr(fd,TCSANOW,&amp;tm) != <span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">char</span>)c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">myprintf</span><span class="params">(<span class="keyword">char</span> *format, ...)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">termios</span> <span class="title">now</span>;</span></span><br><span class="line">    <span class="keyword">if</span>(tcgetattr(<span class="number">0</span>, &amp;now) != <span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">if</span>(tcsetattr(<span class="number">0</span>,TCSANOW,&amp;tm) != <span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">    va_list args;</span><br><span class="line">    va_start(args, format);</span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="built_in">vprintf</span>(format, args);</span><br><span class="line">    va_end(args);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(tcsetattr(<span class="number">0</span>,TCSANOW,&amp;now) != <span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="client"><a href="#client" class="headerlink" title="client"></a>client</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netinet/in.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;errno.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netdb.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>  SERVER_PORT 8086</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, buf[<span class="number">1024</span>], msg[<span class="number">1024</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fun</span><span class="params">(<span class="keyword">char</span> *ip)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> sockfd;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">servaddr</span>;</span></span><br><span class="line">    sockfd = socket(AF_INET, SOCK_STREAM, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span>(sockfd &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;Socket error\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    bzero(&amp;servaddr, <span class="keyword">sizeof</span> servaddr);</span><br><span class="line">    servaddr.sin_family = AF_INET;</span><br><span class="line">    servaddr.sin_port = htons(SERVER_PORT);</span><br><span class="line">    <span class="keyword">if</span>(inet_aton(ip, &amp;servaddr.sin_addr) == <span class="number">-1</span>)&#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>,<span class="string">&quot;Inet_aton error\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(connect(sockfd, (struct sockaddr*)&amp;servaddr, <span class="keyword">sizeof</span> servaddr) &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>,<span class="string">&quot;Connect error\n&quot;</span>);</span><br><span class="line">        close(sockfd);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    msg[<span class="number">0</span>] = htonl(n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) msg[i + <span class="number">1</span>] = htonl(buf[i]);  msg[n + <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    write(sockfd, msg, (n + <span class="number">1</span>) * <span class="keyword">sizeof</span>(<span class="keyword">int</span>)); </span><br><span class="line"></span><br><span class="line">    n = (<span class="keyword">int</span>)read(sockfd, msg, <span class="number">1024</span>);</span><br><span class="line">    <span class="keyword">if</span>(n &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;Read error\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;æœåŠ¡å™¨è¿”å›å¹³å‡å€¼ä¸º%d\n&quot;</span>, ntohl(msg[<span class="number">0</span>]));</span><br><span class="line">    close(sockfd);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(argc != <span class="number">2</span>)&#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;è¯·è¾“å…¥ä¸€ä¸ªå‚æ•°è¡¨ç¤ºæœåŠ¡å™¨IPåœ°å€!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    srand((<span class="keyword">int</span>)time(<span class="literal">NULL</span>));</span><br><span class="line"></span><br><span class="line">    n = <span class="number">255</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) buf[i] = rand() % <span class="number">100</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;æ€»å…±äº§ç”Ÿ%dä¸ªæ•°å­—:\n&quot;</span>, n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, buf[i]); <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">    fun(argv[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="server"><a href="#server" class="headerlink" title="server"></a>server</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netinet/in.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;errno.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netdb.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;rqdmap.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>  SERVER_PORT 8086</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>  BACKLOG    5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> op;</span><br><span class="line"><span class="function"><span class="keyword">void</span> * <span class="title">thread</span><span class="params">(<span class="keyword">void</span> * listenfd)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(op != <span class="string">&#x27;q&#x27;</span>)&#123;</span><br><span class="line">        fflush(<span class="built_in">stdin</span>);</span><br><span class="line">        op = getch();</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;receive %d\n&quot;</span>, op);</span><br><span class="line">    &#125;</span><br><span class="line">    close(*(<span class="keyword">int</span> *)listenfd);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> buf[<span class="number">1030</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fun</span><span class="params">(<span class="keyword">int</span> connfd)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n = (<span class="keyword">int</span>)read(connfd, (<span class="keyword">char</span>*)buf, <span class="number">1100</span>);</span><br><span class="line">    <span class="keyword">if</span>(n &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>,<span class="string">&quot;Read error&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    n = ntohl(buf[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// for(int i = 0; i &lt; n; i++) printf(&quot;%d &quot;, ntohl(buf[i + 1]));</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) sum += ntohl(buf[i]);</span><br><span class="line">    sum /= n;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(myprintf(<span class="string">&quot;æœåŠ¡å™¨è¾“å‡º %d \n&quot;</span>, sum) &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;Print error\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    buf[<span class="number">0</span>] = htonl(sum); buf[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    write(connfd, buf, <span class="keyword">sizeof</span>(<span class="keyword">int</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> listenfd, connfd;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">servaddr</span>;</span></span><br><span class="line">    </span><br><span class="line">    listenfd = socket(AF_INET, SOCK_STREAM, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;äº§ç”Ÿå¥—æ¥å­— %d\n&quot;</span>, listenfd);</span><br><span class="line">    <span class="keyword">if</span>(listenfd &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;Socket error\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> on = <span class="number">1</span>;</span><br><span class="line">    setsockopt(listenfd, SOL_SOCKET, SO_REUSEADDR, &amp;on, <span class="keyword">sizeof</span>(on));</span><br><span class="line">    </span><br><span class="line">    bzero(&amp;servaddr, <span class="keyword">sizeof</span> servaddr);</span><br><span class="line">    servaddr.sin_family = AF_INET;</span><br><span class="line">    servaddr.sin_addr.s_addr = htonl(INADDR_ANY);</span><br><span class="line">    servaddr.sin_port=htons(SERVER_PORT);</span><br><span class="line">    <span class="keyword">if</span>(bind(listenfd, (struct sockaddr*)&amp;servaddr, <span class="keyword">sizeof</span> (struct sockaddr)) &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>,<span class="string">&quot;Bind error\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);    </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">if</span>(listen(listenfd, <span class="number">5</span>) &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>,<span class="string">&quot;Listen error\n&quot;</span>);</span><br><span class="line">        close(listenfd);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="keyword">pthread_t</span> pid;</span><br><span class="line">    <span class="keyword">if</span>(pthread_create(&amp;pid, <span class="literal">NULL</span>, thread, &amp;listenfd) != <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Create pthread error!&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">        connfd = accept(listenfd, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">        <span class="keyword">if</span>(connfd &lt; <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>,<span class="string">&quot;Accept error\n&quot;</span>);</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(fun(connfd) != <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;fun error\n&quot;</span>);</span><br><span class="line">            op = <span class="string">&#x27;q&#x27;</span>; <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        close(connfd);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    pthread_join(pid, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="å®æˆ˜è®°å½•"><a href="#å®æˆ˜è®°å½•" class="headerlink" title="å®æˆ˜è®°å½•"></a>å®æˆ˜è®°å½•</h3><p>é‡åˆ°äº†éå¸¸å¤šçš„å‘ç‚¹â€¦å¼„äº†å¾ˆä¹…</p><p>åˆ©ç”¨socketå¥—æ¥å­—è¿›è¡Œæ•°æ®é€šä¿¡æœ€å…³é”®çš„åœ°æ–¹å…¶å®åœ¨äº<font color = "#dd0000"> é€šä¿¡æ ¼å¼</font>çš„è®¾è®¡ï¼Œè¿™æ ·æ¥æ”¶æ–¹æ‰èƒ½å¤Ÿæ­£ç¡®æ— è¯¯åœ°è§£è¯»å‘é€æ–¹çš„æ¯”ç‰¹ä¸²ã€‚</p><p>è€Œåœ¨å…¶ä¸­éå¸¸é‡è¦çš„ä¸€ä¸ªç»†èŠ‚å°±æ˜¯<font color = "#dd0000"> å­—èŠ‚é¡ºåº</font>ï¼Œå‘é€æ–¹å’Œæ¥æ”¶æ–¹åº”è¯¥ä½¿ç”¨åŒ¹é…çš„<code>htonl</code>æˆ–<code>htons</code>ï¼Œæ¯æ¬¡æƒ³è¦é€šè¿‡socketè¿›è¡Œä¼ è¾“ä¿¡æ¯éƒ½åº”è¯¥è¿›è¡Œç¼–ç å’Œè§£ç ã€‚</p><p>æ¥æ”¶æ–¹æ¥å—æ•°æ®æ—¶ï¼Œå¦‚ä½•æ­£ç¡®åœ°éå†ä¸åŒæ ¼å¼çš„ç¼“å†²åŒºä¹Ÿéå¸¸é‡è¦ï¼Œéœ€è¦æ³¨æ„åˆ°readå‡½æ•°è¿”å›çš„æ˜¯æ¥æ”¶åˆ°çš„å­—èŠ‚(8ä½)çš„ä¸ªæ•°ï¼</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> buf[];</span><br><span class="line"><span class="keyword">int</span> n = read(connfd, (<span class="keyword">char</span>*)buf, <span class="number">1024</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i * <span class="number">4</span> &lt; n; i++)&#123;</span><br><span class="line">   <span class="comment">//do something on buf[]</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸ºäº†ä½¿å¾—æœåŠ¡å™¨ä¸ä»…èƒ½å¤Ÿæ¥å—ä¸æ–­åœ°ç›‘å¬å¥—æ¥å­—æä¾›æœåŠ¡ï¼Œè¿˜èƒ½å¤Ÿé€šè¿‡é”®ç›˜çš„é”®å…¥æ¥é€€å‡ºæ­»å¾ªç¯ã€å›æ”¶èµ„æºç»ˆæ­¢æœåŠ¡ï¼Œä¸Šè¿°ç¨‹åºè¿˜å¤¹æ‚äº†éå¸¸å¤šçš„ç§æ´»ã€‚</p><ul><li><p>ä¸ºäº†å®ç°ä¸Šè¿°ä¸¤ä¸ª<font color="#dd00000"> ä¸é—´æ–­çš„</font>æœåŠ¡ï¼Œæˆ‘ä»¬ä½¿ç”¨å¤šçº¿ç¨‹ã€‚é™¤å»mainå‡½æ•°ä¸­å¯¹å¥—æ¥å­—ä¸æ–­åœ°ç›‘å¬ï¼Œæˆ‘ä»¬å†å¼€ä¸€ä¸ªthreadè¿›è¡Œé”®ç›˜çš„è¯»å…¥ã€‚</p><p>èµ·åˆä¸å……åˆ†çš„è®¾æƒ³æ˜¯é€šè¿‡threadè¯»å–é”®ç›˜ï¼Œå°†è¾“å…¥çš„å­—ç¬¦å­˜å‚¨åˆ°å…¨å±€å˜é‡opä¸­ï¼Œmainå‡½æ•°åœ¨å¾ªç¯ä¸­ä¸æ–­åœ°æ£€æŸ¥opæ˜¯å¦ä¸ºq.</p><p>ç„¶è€Œäº‹å®ä¸Šlistenä¼šç”±äºæ²¡æœ‰å®¢æˆ·æœºçš„è®¿é—®è€Œä¸€ç›´å µå¡ï¼Œå› è€Œä¼šå¡åœ¨ä¸€æ¬¡å¾ªç¯ä¸­æ— æ³•å¾—åˆ°opå·²ç»è¢«ä¿®æ”¹çš„ä¿¡æ¯ã€‚</p><p>é‚£ä¹ˆè€ƒè™‘åˆ°è¿™ä¸¤ä¸ªçº¿ç¨‹å…¶å®ä¸å­˜åœ¨å¿…è¦çš„é€šä¿¡è¦æ±‚ï¼Œåªè¦threadè¯»å–åˆ°qå°±åº”è¯¥å°†å¥—æ¥å­—æœåŠ¡èµ„æºå…¨éƒ¨å›æ”¶ï¼Œç»ˆæ­¢è¿›ç¨‹ï¼Œæ‰€ä»¥æœ€ç»ˆçš„å®ç°å°±æ˜¯åœ¨threadä¸­å›æ”¶èµ„æºå¹¶ä¸”ç»ˆæ­¢è¿›ç¨‹ï¼Œä¸»å‡½æ•°ä¸æ–­åœ°å¾ªç¯å³å¯ã€‚</p><p><del>ä¸è¿‡ä¹‹åç”±äºmainå‡½æ•°çš„å¾ªç¯ç›‘å¬ä¸­æœ‰å¯èƒ½æœ‰å‡½æ•°å‡ºé”™è€Œç»ˆæ­¢æœåŠ¡ï¼Œæ‰€ä»¥è¿˜æ˜¯åˆ©ç”¨äº†opå‘threadä¼ è¾¾ä¿¡æ¯</del></p></li><li><p>å¬é—»æœ‰å‡½æ•°getchå¯ä»¥è¯»å…¥é”®ç›˜çš„è¾“å…¥ï¼Œä¸éœ€è¦æŒ‰å›è½¦ä¹Ÿä¸ä¼šåœ¨æ§åˆ¶å°å›æ˜¾ï¼Œéå¸¸é€‚åˆä½œä¸ºé€€å‡ºæ­»å¾ªç¯çš„æ–¹æ³•ã€‚ç„¶è€Œå¥½åƒgetchä¸æ˜¯æ ‡å‡†åº“çš„å‡½æ•°ï¼Œåœ¨linuxä¸‹å¹¶æ²¡æœ‰å®ç°ï¼Œæ‰€ä»¥ä¾¿è‡ªå·±å®ç°äº†ä¸€ä¸ª<font color="#dd0000">ä¸å›æ˜¾ã€ä¸éœ€è¦ç©ºæ ¼</font> çš„é”®ç›˜è¯»å…¥ã€‚åŸºæœ¬åŸç†æ˜¯å°†æ§åˆ¶å°è°ƒæ•´ä¸º<strong>åŸå§‹æ¨¡å¼</strong>ï¼Œåœ¨åŸå§‹æ¨¡å¼ä¸‹ï¼Œæ‰€æœ‰çš„æ•°æ®è¾“å…¥ä»¥å­—èŠ‚ä¸ºå•ä½è¿›è¡Œå¤„ç†ï¼Œå½“ä¸€ä¸ªå­—èŠ‚è¢«è¾“å…¥åï¼Œä¾¿è§¦å‘è¾“å…¥æœ‰æ•ˆã€‚é‚£ä¹ˆå°†æ§åˆ¶å°è®¾ç½®ä¸ºåŸå§‹æ¨¡å¼ï¼Œå®Œæˆgetchar()åå°†ç»ˆç«¯æ¨¡å¼æ¢å¤åˆ°åŸå…ˆçš„çŠ¶æ€å³å¯ã€‚å…·ä½“å®ç°å‚è§headerã€‚</p></li><li><p>ä¸Šè¿°çš„å¤šçº¿ç¨‹å‡½æ•°å¸¦æ¥äº†è‹¥å¹²çš„é—®é¢˜ã€‚ç”±ä¸Šè¿°åˆ†æå¯çŸ¥ï¼Œè¿è¡Œgetch()åï¼Œå½“å‰ç»ˆç«¯ä¼šä¸€ç›´ä¿æŒåŸå§‹æ¨¡å¼ï¼Œé‚£ä¹ˆå¦‚æœæ­¤æ—¶mainå‡½æ•°å¸Œæœ›è¿›è¡ŒIOæ“ä½œï¼Œè¾“å‡ºçš„æ ¼å¼å°±ä¼šå‡ºç°éå¸¸å¥‡æ€ªçš„é—®é¢˜ï¼ˆå¤§æ¦‚ç±»ä¼¼äºé˜¶æ¢¯çŠ¶ï¼Œä¸æ˜¯å¾ˆæ‡‚ä¸ºä»€ä¹ˆï¼‰ã€‚æ‰€ä»¥æˆ‘ä»¬è¿˜å¤šå†™äº†ä¸€ä¸ªè‡ªå®šä¹‰çš„printfå‡½æ•°ï¼Œè¿™ä¸ªprintfå‡½æ•°åœ¨è¾“å‡ºå‰ä¼šå…ˆå°†ç»ˆç«¯è®¾ç½®ä¸ºgetchè°ƒç”¨å‰çš„çŠ¶æ€ï¼Œè¾“å‡ºå®Œæˆåå†å°†å…¶åˆ°åŸå§‹æ¨¡å¼ã€‚å› ä¸ºä¸€å°æœºå­ä¸Šæ¨¡æ‹ŸCSä¸å¤ªä¼šåŒæ—¶æ“ä½œä¸¤ä¸ªç»ˆç«¯ï¼Œæ‰€ä»¥è¿™æ ·åŸºæœ¬èƒ½å®Œæˆä»»åŠ¡ã€‚ä½†æ˜¯è¿™æ ·å®ç°ä»ç„¶æ˜¯éå¸¸æœ´ç´ çš„ï¼ŒçœŸæ­£åœ¨è®¾è®¡ç½‘ç»œæœåŠ¡å™¨çš„æ—¶å€™<strong>ä¸€å®šè¦é‡æ–°è€ƒè™‘</strong>ï¼</p></li></ul><h1 id="Unit-03"><a href="#Unit-03" class="headerlink" title="Unit 03"></a>Unit 03</h1><h2 id="DNS"><a href="#DNS" class="headerlink" title="DNS"></a>DNS</h2><h3 id="struct-hostent"><a href="#struct-hostent" class="headerlink" title="struct hostent"></a>struct hostent</h3><p>hostentæ˜¯host entryçš„ç¼©å†™ï¼Œè¯¥ç»“æ„è®°å½•ä¸»æœºçš„ç›¸å…³ä¿¡æ¯ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">hostent</span>&#123;</span></span><br><span class="line">    <span class="keyword">char</span> * h_name;</span><br><span class="line">    <span class="keyword">char</span> ** h_aliases;</span><br><span class="line">    <span class="keyword">short</span> h_addrtype;</span><br><span class="line">    <span class="keyword">short</span> h_length;</span><br><span class="line">    <span class="keyword">char</span> ** h_addr_list;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> h_addr h_addr_list[0];</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="åŸŸå-lt-gt-IPåœ°å€"><a href="#åŸŸå-lt-gt-IPåœ°å€" class="headerlink" title="åŸŸå&lt;-&gt;IPåœ°å€"></a>åŸŸå&lt;-&gt;IPåœ°å€</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">struct hostent* <span class="title">gethostbyname</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *name)</span></span></span><br><span class="line"><span class="function">struct hostent *<span class="title">gethostbyaddr</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *addr, <span class="keyword">size_t</span> len, <span class="keyword">int</span> family)</span></span></span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œé€šè¿‡IPè·å–ä¸»æœºä¿¡æ¯æ—¶ä¼ å…¥çš„å‚æ•°addrä¸æ˜¯IPå­—ç¬¦ä¸²ï¼Œè€Œæ˜¯ç»è¿‡inet_atonè½¬åŒ–è¿‡çš„32ä½çš„ç½‘ç»œåºåˆ—åœ°å€ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">inet_aton</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *<span class="built_in">string</span>, struct in_addr*addr)</span></span>;</span><br></pre></td></tr></table></figure><p>å‡½æ•°æˆåŠŸè¿”å›éé›¶ï¼Œå¤±è´¥è¿”å›0</p><h2 id="recvä¸send"><a href="#recvä¸send" class="headerlink" title="recvä¸send"></a>recvä¸send</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">recv</span><span class="params">(<span class="keyword">int</span> sockfd,<span class="keyword">void</span>* buf,<span class="keyword">int</span> len, <span class="keyword">int</span> flags)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">send</span><span class="params">(<span class="keyword">int</span> sockfd,<span class="keyword">void</span>* buf,<span class="keyword">int</span> len, <span class="keyword">int</span> flags)</span></span>;</span><br></pre></td></tr></table></figure><p>lenä¸ºå‘é€/æ¥å—æ•°æ®çš„é•¿åº¦</p><p>flagsä¸­å¯ä»¥å¡«å†™ä¸€äº›å‚æ•°</p><ul><li>0ï¼šç›¸å½“äºwriteå’Œread</li><li>MSG_DONTROUTEï¼šå‘é€æ•°æ®ä¸æŸ¥æ‰¾è·¯ç”±è¡¨</li><li>MSG_OOBï¼šå‘é€ã€æ¥å—å¸¦å¤–æ•°æ®</li><li>MSG_PEEKï¼šæ¥å—æ•°æ®æ—¶ä¸ä»ç¼“å†²åŒºç§»èµ°æ•°æ®ï¼Œå…¶ä»–è¿›ç¨‹ä»ç„¶å¯ä»¥readåˆ°æ•°æ®</li><li>MSG_WAITALLï¼šæ•°æ®é‡ä¸å¤Ÿæ—¶ï¼Œè¯»æ“ä½œç­‰å¾…</li></ul><h2 id="shutdown"><a href="#shutdown" class="headerlink" title="shutdown"></a>shutdown</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">shutdown</span><span class="params">(<span class="keyword">int</span> sockfd,<span class="keyword">int</span> howto)</span></span>; </span><br></pre></td></tr></table></figure><p>å‚æ•°howtoæŒ‡å®šå…³é—­æ“ä½œçš„ç±»å‹ï¼š</p><ul><li>howto = 0ï¼Œ å…³é—­è¯»é€šé“ï¼›ä¸¢å¼ƒå°šæœªè¯»å–çš„æ•°æ®ï¼Œå¯¹åæ¥æ¥æ”¶åˆ°çš„æ•°æ®è¿”å›ç¡®è®¤åä¸¢å¼ƒã€‚</li><li>howto = 1ï¼Œ å…³é—­å†™é€šé“ï¼›ç»§ç»­å‘é€æœªå‘é€å®Œæˆçš„æ•°æ®ï¼Œç„¶åå‘é€FINå­—æ®µå…³é—­å†™é€šé“ã€‚</li><li>howto = 2ï¼Œ å…³é—­è¯»å†™é€šé“ï¼›ä»»ä½•è¿›ç¨‹éƒ½ä¸èƒ½å†æ“ä½œè¿™ä¸ªsocktet</li></ul><h3 id="shutdownä¸closeçš„åŒºåˆ«"><a href="#shutdownä¸closeçš„åŒºåˆ«" class="headerlink" title="shutdownä¸closeçš„åŒºåˆ«"></a>shutdownä¸closeçš„åŒºåˆ«</h3><p>closeå…³é—­å½“å‰è¿›ç¨‹ä¸å¥—æ¥å­—çš„è”ç³»ï¼Œå…¶ä»–è¿›ç¨‹ä»ç„¶å¯èƒ½ä½¿ç”¨è¿™ä¸ªå¥—æ¥å­—ã€‚</p><p>shutdownç›´æ¥åœ¨tcpå±‚ä¸Šæ“ä½œè¯¥å¥—æ¥å­—ï¼Œä¸ç®¡æœ‰å¤šå°‘ä¸ªè¿›ç¨‹å¼•ç”¨è¯¥å¥—æ¥å­—ï¼Œå½“å¥—æ¥å­—å…³é—­åè¯•å›¾è¯»çš„è¿›ç¨‹ä¼šè¯»åˆ°EOFï¼Œè¯•å›¾å†™çš„è¿›ç¨‹ä¼šæ£€æµ‹åˆ°SIGPIPEä¿¡å·ã€‚</p><h2 id="readvä¸writev"><a href="#readvä¸writev" class="headerlink" title="readvä¸writev"></a>readvä¸writev</h2><p>readvä¸º<strong>æ•£å¸ƒè¯»</strong>ï¼Œå°†æ–‡ä»¶ä¸­è‹¥å¹²è¿ç»­çš„æ•°æ®å—è¯»å…¥å†…å­˜åˆ†æ•£çš„ç¼“å†²åŒºä¸­ã€‚</p><p>writevä¸º<strong>èšé›†å†™</strong>ï¼Œå³æ”¶é›†å†…å­˜ä¸­åˆ†æ•£çš„è‹¥å¹²ç¼“å†²åŒºä¸­çš„æ•°æ®å†™è‡³æ–‡ä»¶çš„è¿ç»­åŒºåŸŸä¸­ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">iovec</span>&#123;</span></span><br><span class="line">  <span class="keyword">void</span> *  iov_base; <span class="comment">/* æ•°æ®åŒºçš„èµ·å§‹åœ°å€ */</span></span><br><span class="line">  <span class="keyword">size_t</span>  iov_len;  <span class="comment">/*   æ•°æ®åŒºçš„å¤§å°  */</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">ssize_t</span> <span class="title">readv</span><span class="params">(<span class="keyword">int</span> fildes, <span class="keyword">const</span> struct iovec *iov, <span class="keyword">int</span> iovcnt)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">ssize_t</span> <span class="title">writev</span><span class="params">(<span class="keyword">int</span> fildes, <span class="keyword">const</span> struct iovec *iov, <span class="keyword">int</span> iovcnt)</span></span>;</span><br></pre></td></tr></table></figure><p>å‚æ•°iovcntæŒ‡å‡ºæ•°ç»„iovçš„å…ƒç´ ä¸ªæ•°ï¼Œå…ƒç´ ä¸ªæ•°è‡³å¤šä¸è¶…è¿‡IOV_MAXã€‚linuxä¸­å®šä¹‰IOV_MAXçš„å€¼ä¸º1024ã€‚</p><p>ç»™å‡ºä¸€ä¸ªç¤ºä¾‹ä»£ç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å‘é€</span></span><br><span class="line"><span class="keyword">char</span> *name = <span class="string">&quot; Wang Jin-pyng&quot;</span>;</span><br><span class="line"><span class="keyword">char</span> *occupation = <span class="string">&quot;Head of the legislative body&quot;</span>;</span><br><span class="line"><span class="keyword">int</span> len[<span class="number">2</span>];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">iov</span>[3];</span></span><br><span class="line"><span class="keyword">int</span> iovcnt;</span><br><span class="line"></span><br><span class="line">len[<span class="number">0</span>]=<span class="built_in">strlen</span>(name);</span><br><span class="line">len[<span class="number">1</span>]=<span class="built_in">strlen</span>(occupation);</span><br><span class="line"></span><br><span class="line">iov[<span class="number">1</span>].iov_base=name;å…³é—­å</span><br><span class="line">iov[<span class="number">1</span>].iov_len=len[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">iov[<span class="number">2</span>].iov_base=occupation;</span><br><span class="line">iov[<span class="number">2</span>].iov_len=len[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">len[<span class="number">0</span>]=htonl(len[<span class="number">0</span>]);</span><br><span class="line">len[<span class="number">1</span>]=htonl(len[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">iov[<span class="number">0</span>].iov_base=len;</span><br><span class="line">iov[<span class="number">0</span>].iov_len=<span class="number">2</span>*<span class="keyword">sizeof</span>(<span class="keyword">int</span>);</span><br><span class="line"></span><br><span class="line">writev(sockfd,iov,<span class="number">3</span>);</span><br><span class="line">......</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ¥æ”¶</span></span><br><span class="line"><span class="keyword">char</span> name[<span class="number">1024</span>];</span><br><span class="line"><span class="keyword">char</span> occupation[<span class="number">1024</span>];</span><br><span class="line"><span class="keyword">int</span> len[<span class="number">2</span>];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">iov</span>[2];</span></span><br><span class="line"><span class="keyword">int</span> iovlen;</span><br><span class="line"></span><br><span class="line">......<span class="comment">//</span></span><br><span class="line">read(sockfd,len,<span class="number">2</span>*<span class="keyword">sizeof</span>(<span class="keyword">int</span>));</span><br><span class="line"></span><br><span class="line">len[<span class="number">0</span>]=ntohl(len[<span class="number">0</span>]);</span><br><span class="line">len[<span class="number">1</span>]=ntohl(len[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">iov[<span class="number">0</span>].iov_base=name;</span><br><span class="line">iov[<span class="number">0</span>].iov_len=len[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">iov[<span class="number">1</span>].iov_base=occupation;</span><br><span class="line">iov[<span class="number">1</span>].iov_len=len[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">readv(sockfd,iov,<span class="number">2</span>);</span><br><span class="line">......</span><br><span class="line"></span><br><span class="line"><span class="comment">//Noteï¼šé€šå¸¸è¿˜éœ€è¦è°ƒç”¨å‡½æ•°</span></span><br><span class="line"><span class="comment">//ioctl(fd,FIONREAD,nbyte),ä»¥ç¡®å®šæ¥æ”¶ç¼“å­˜åŒºå†…æœ‰å¤šå°‘ä¸ªå­—èŠ‚å¯è¯»ã€‚</span></span><br></pre></td></tr></table></figure><h3 id="å‚è€ƒåšå®¢-1"><a href="#å‚è€ƒåšå®¢-1" class="headerlink" title="å‚è€ƒåšå®¢"></a>å‚è€ƒåšå®¢</h3><p> <a href="https://blog.csdn.net/qq_39642794/article/details/108080722">readv()å’Œwritev()å‡½æ•°</a></p><h2 id="recvmsgä¸sendmsg"><a href="#recvmsgä¸sendmsg" class="headerlink" title="recvmsgä¸sendmsg"></a>recvmsgä¸sendmsg</h2><p>è¿™ä¸¤ä¸ªå‡½æ•°æ˜¯æœ€åº•å±‚çš„å‡½æ•°ï¼Œå…¶ä½™æ‰€æœ‰çš„IOå‡é€šè¿‡è½¬åŒ–ä¸ºè¯¥å‡½æ•°æ¥è¿›è¡Œã€‚</p><p>å…·ä½“å‚æ•°ä¸äº†è§£ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">recvmsg</span><span class="params">(<span class="keyword">int</span> sockfd,struct msghdr* msg,<span class="keyword">int</span> flags)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sendmsg</span><span class="params">(<span class="keyword">int</span> sockfd,struct msghdr* msg,<span class="keyword">int</span> flags)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">msghdr</span>&#123;</span></span><br><span class="line">  <span class="keyword">void</span> *msg_name;  </span><br><span class="line">  <span class="keyword">int</span> msg_namelen;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">iovec</span>* <span class="title">msg_iov</span>;</span></span><br><span class="line">  <span class="keyword">int</span> msg_iovlen;</span><br><span class="line">  <span class="keyword">void</span>* msg_control;</span><br><span class="line">  <span class="keyword">int</span> msg_controllen;</span><br><span class="line">  <span class="keyword">int</span> msg_flags;  <span class="comment">//åŒrecvã€send</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¤šè·¯å¤ç”¨select"><a href="#å¤šè·¯å¤ç”¨select" class="headerlink" title="å¤šè·¯å¤ç”¨select"></a>å¤šè·¯å¤ç”¨select</h2><p>æ£€æŸ¥å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼ˆsocketæè¿°ç¬¦ï¼‰æ˜¯å¦å°±ç»ªï¼Œå½“æŸä¸€ä¸ªæè¿°ç¬¦å°±ç»ªï¼ˆå¯è¯»ã€å¯å†™æˆ–å‘ç”Ÿå¼‚å¸¸ï¼‰æ—¶å‡½æ•°è¿”å›ã€‚å¯ä»¥å®ç°è¾“å…¥è¾“å‡ºå¤šè·¯å¤ç”¨ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">select</span><span class="params">(<span class="keyword">int</span> maxfd, fd_set *rdset, fd_set *wrest, fd_set *exset, struct timeval *timeout)</span></span>;</span><br></pre></td></tr></table></figure><p>è¿”å›å€¼ï¼šæœ‰æè¿°ç¬¦å°±ç»ªåˆ™è¿”å›å°±ç»ªçš„æè¿°ç¬¦ä¸ªæ•°ï¼›è¶…æ—¶æ—¶é—´å†…æ²¡æœ‰æè¿°ç¬¦å°±ç»ªè¿”å›0ï¼›æ‰§è¡Œå¤±è´¥è¿”å›-1ã€‚</p><p>å‚æ•°ï¼š</p><ul><li><p>maxfdï¼éœ€è¦æµ‹è¯•çš„æè¿°ç¬¦çš„æœ€å¤§å€¼ï¼Œå®é™…æµ‹è¯•çš„æè¿°ç¬¦ä»0ï¼maxfd-1  </p></li><li><p>rdsetï¼éœ€è¦æµ‹è¯•æ˜¯å¦å¯è¯»çš„æè¿°ç¬¦é›†åˆï¼ˆåŒ…æ‹¬å¤„äºlistençŠ¶æ€çš„socketæ¥æ”¶åˆ°è¿æ¥è¯·æ±‚ï¼‰ </p></li><li><p>wrsetï¼éœ€è¦æµ‹è¯•æ˜¯å¦å¯å†™çš„æè¿°ç¬¦é›†åˆï¼ˆåŒ…æ‹¬ä»¥éé˜»å¡æ–¹å¼è°ƒç”¨connectæ˜¯å¦æˆåŠŸï¼‰  </p></li><li><p>exsetï¼éœ€è¦æµ‹è¯•æ˜¯å¦å¼‚å¸¸çš„æè¿°ç¬¦é›†åˆï¼ˆåŒ…æ‹¬æ¥æ”¶å¸¦å¤–æ•°æ®çš„socketæœ‰å¸¦å¤–æ•°æ®åˆ°è¾¾ï¼‰   </p></li><li><p>timeoutï¼æŒ‡å®šæµ‹è¯•è¶…æ—¶çš„æ—¶é—´</p><ul><li>timevalç»“æ„</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">timeval</span>&#123;</span></span><br><span class="line"><span class="keyword">long</span> tv_sec;  <span class="comment">//ç§’</span></span><br><span class="line"><span class="keyword">long</span> tv_usec; <span class="comment">//æ¯«ç§’</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><ul><li>timeout=NULLï¼Œselectå°†æ°¸è¿œé˜»å¡ç›´åˆ°æœ‰ä¸€ä¸ªæè¿°ç¬¦å°±ç»ªï¼Œæˆ–è€…å‡ºç°é”™è¯¯ï¼ˆæ¥æ”¶åˆ°ä¿¡å·ï¼‰ã€‚</li><li>timeout&gt;0ï¼Œåœ¨timeoutæ—¶é—´å†…å¦‚æœæœ‰æè¿°ç¬¦å°±ç»ªåˆ™è¿”å›ï¼Œå¦åˆ™åœ¨timeoutæ—¶é—´åè¿”å›0ï¼›å¦‚æœå°†3ä¸ªæè¿°ç¬¦é›†åˆéƒ½è®¾å®šä¸ºNULLåˆ™selectç›¸å½“äºsleepå‡½æ•°ï¼Œåªæ˜¯æ—¶é—´å¯ä»¥ç²¾ç¡®åˆ°æ¯«ç§’  </li><li>timeout=0ï¼Œselectæ£€æŸ¥å®Œæè¿°ç¬¦é›†åˆåç«‹å³è¿”å› </li></ul></li></ul><p>æ“ä½œæè¿°ç¬¦é›†åˆï¼š</p><ul><li>FD_ZERO(fd_set *fdset)ï¼æ¸…ç©ºæè¿°ç¬¦é›†åˆ </li><li>FD_SET(int fd, fd_set *fdset)ï¼å°†ä¸€ä¸ªæè¿°ç¬¦æ·»åŠ åˆ°æè¿°ç¬¦é›†åˆ </li><li>FD_CLR(int fd, fd_set *fdset)ï¼å°†ä¸€ä¸ªæè¿°ç¬¦ä»æè¿°ç¬¦é›†åˆä¸­æ¸…é™¤ </li><li>FD_ISSET(int fd, fd_set *fdset)ï¼æ£€æµ‹ä¸€ä¸ªæè¿°ç¬¦æ˜¯å¦å°±ç»ª </li></ul><p>åœ¨è®¾ç½®æè¿°ç¬¦é›†åˆå‰åº”è¯¥å…ˆè°ƒç”¨FD_ZEROå°†é›†åˆæ¸…ç©ºï¼Œæ¯æ¬¡è°ƒç”¨selectå‡½æ•°å‰åº”è¯¥é‡æ–°è®¾ç½®è¿™3ä¸ªé›†åˆ </p><p>ä¸‰ä¸ªé›†åˆä¸­çš„æè¿°ç¬¦å¯ä»¥äº¤å‰ </p><p><del>ä¸è¿‡ç°åœ¨çš„æœåŠ¡å™¨ä¸€èˆ¬ä¸ä½¿ç”¨selectï¼Œselectæœ¬è´¨å¥½åƒæ˜¯Onåœ°æŸ¥è¯¢ï¼Œæ•ˆç‡ä¸é«˜ï¼Œä¸€èˆ¬ä½¿ç”¨pollç­‰å‡½æ•°æ–¹æ³•</del></p><h2 id="socketé€‰é¡¹"><a href="#socketé€‰é¡¹" class="headerlink" title="socketé€‰é¡¹"></a>socketé€‰é¡¹</h2><p>è·å–æˆ–è®¾ç½®socketé€‰é¡¹</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getsockopt</span><span class="params">(<span class="keyword">int</span> sockfd, <span class="keyword">int</span> level, <span class="keyword">int</span> optname, <span class="keyword">void</span> *optval,sock_len *optlen)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">setsockopt</span><span class="params">(<span class="keyword">int</span> sockfd, <span class="keyword">int</span> level, <span class="keyword">int</span> optname, <span class="keyword">void</span> *optval,sock_len optlen)</span></span>;</span><br></pre></td></tr></table></figure><p>è¿”å›å€¼ï¼š 0æˆåŠŸï¼Œ-1å¤±è´¥</p><p>å‚æ•°ï¼š</p><ul><li><p>level é€‰é¡¹çº§åˆ«</p><ul><li>SOL_SOCKET â€”é€šç”¨socketé€‰é¡¹ </li><li>IPPROTO_IPâ€”IPé€‰é¡¹ </li><li>IPPROTO_TCPâ€”TCPé€‰é¡¹ </li></ul></li><li><p>optname é€‰é¡¹åç§°</p><ul><li><p>ä¸€èˆ¬é€šç”¨socketé€‰é¡¹</p><ul><li><p>SO_KEEPALIVE</p><p>è®¾ç½®è¯¥é€‰é¡¹åï¼Œ2å°æ—¶å†…æ²¡æœ‰æ•°æ®äº¤æ¢æ—¶ï¼ŒTCPåè®®å°†è‡ªåŠ¨å‘é€æ¢æµ‹æ•°æ®åŒ…ï¼Œæ£€æŸ¥ç½‘ç»œè¿æ¥</p></li><li><p>SO_RCVBUFå’ŒSO_SNDBUF</p><p>è®¾ç½®å‘é€å’Œæ¥æ”¶æ•°æ®ç¼“å†²åŒºçš„å¤§å°ï¼ˆåœ¨è¿æ¥å»ºç«‹ä»¥å‰è®¾ç½®ï¼‰</p></li><li><p>SO_RCVTIMEOå’ŒSO_SNDTIMEO</p><p>è®¾ç½®å‘é€å’Œæ¥æ”¶è¶…æ—¶ï¼Œå½“æŒ‡å®šæ—¶é—´å†…æ•°æ®æ²¡æœ‰æˆåŠŸæ¥æ”¶æˆ–å‘é€ï¼Œå‘é€å’Œæ¥æ”¶å‡½æ•°å°†è¿”å›ã€‚</p></li><li><p>SO_REUSEADDR</p><p>å¿«é€Ÿé‡å¯æœåŠ¡å™¨ç¨‹åº</p><p>å¯åŠ¨æœåŠ¡å™¨ç¨‹åºçš„å¤šä¸ªå®ä¾‹ï¼ˆç»‘å®šæœ¬åœ°IPåœ°å€çš„å¤šä¸ªåˆ«åï¼‰</p></li></ul></li><li><p>IPé€‰é¡¹</p><p>IP_HDRINCLï¼šæ˜¯å¦éœ€è¦è‡ªå·±å»ºç«‹IPæ•°æ®åŒ…é¦–éƒ¨ï¼Œé€‚ç”¨äºåŸå§‹socket</p></li><li><p>TCPé€‰é¡¹</p><ul><li>TCP_MAXSEGï¼TCPåè®®æœ€å¤§æ•°æ®æ®µé•¿åº¦</li><li>TCP_NODELAYï¼å°æ•°æ®åŒ…æ˜¯å¦å»¶è¿Ÿå‘é€ï¼ˆ<strong>Nagleç®—æ³•</strong>ï¼‰</li></ul></li></ul></li><li><p>optalé€‰é¡¹å€¼</p></li><li><p>opelené€‰é¡¹é•¿åº¦/å­˜æ”¾é€‰é¡¹é•¿åº¦çš„æŒ‡é’ˆ</p></li></ul><h2 id="fcntl"><a href="#fcntl" class="headerlink" title="fcntl"></a>fcntl</h2><p>ä¿®æ”¹æ–‡ä»¶çš„å±æ€§ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fcntl</span><span class="params">(<span class="keyword">int</span> fd,<span class="keyword">int</span> cmd,â€¦)</span></span></span><br></pre></td></tr></table></figure><p>è¿”å›å€¼ï¼š éè´ŸæˆåŠŸï¼Œ-1å¤±è´¥</p><p>æ“ä½œç±»å‹:</p><div class="table-container"><table><thead><tr><th style="text-align:center">Cmd</th><th style="text-align:center">å‚æ•°</th><th style="text-align:center">è¿”å›å€¼</th><th style="text-align:center">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:center">F_GETFL</td><td style="text-align:center">0</td><td style="text-align:center">fd</td><td style="text-align:center">è·å–æè¿°ç¬¦æ ‡å¿—</td></tr><tr><td style="text-align:center">F_SETFL</td><td style="text-align:center">O_NONBLOCK</td><td style="text-align:center">0, -1</td><td style="text-align:center">è®¾ç½®å¥—æ¥å­—ä¸ºéé˜»å¡å¼</td></tr><tr><td style="text-align:center">F_GETOWN</td><td style="text-align:center">int*</td><td style="text-align:center">0, -1</td><td style="text-align:center">å–å¾—å¥—æ¥å­—çš„æ‰€æœ‰è€…</td></tr><tr><td style="text-align:center">F_SETOWN</td><td style="text-align:center">int</td><td style="text-align:center">0, -1</td><td style="text-align:center">è®¾ç½®å¥—æ¥å­—çš„æ‰€æœ‰è€…</td></tr></tbody></table></div><h3 id="å¥—æ¥å­—çš„é˜»å¡æ–¹å¼"><a href="#å¥—æ¥å­—çš„é˜»å¡æ–¹å¼" class="headerlink" title="å¥—æ¥å­—çš„é˜»å¡æ–¹å¼"></a>å¥—æ¥å­—çš„é˜»å¡æ–¹å¼</h3><p>è®¾ç½®socketä¸ºé˜»å¡æ–¹å¼</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> flags;</span><br><span class="line">flags=fcntl(fd,F_GETFL,<span class="number">0</span>);</span><br><span class="line">flags|=O_NONBLOCK;</span><br><span class="line">fcntl(fd,F_SETFL,flags);</span><br></pre></td></tr></table></figure><p>è®¾ç½®socketä¸ºéé˜»å¡æ–¹å¼</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> flags;</span><br><span class="line">flags=fcntl(fd,F_GETFL,<span class="number">0</span>);</span><br><span class="line">flags&amp;=~O_NONBLOCK;</span><br><span class="line">fcntl(fd,F_SETFL,flags); </span><br></pre></td></tr></table></figure><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œsocket<strong>é»˜è®¤</strong>æ˜¯é˜»å¡æ–¹å¼çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å¥—æ¥å­—ä¼šé˜»å¡ï¼Œç›´åˆ°å®¢æˆ·æœºå‘é€ä¿¡æ¯ä¸ºæ­¢ã€‚</p><p>åœ¨éé˜»å¡æ–¹å¼ä¸‹ï¼Œå¦‚æœæ²¡æœ‰æ¥æ”¶åˆ°æ¶ˆæ¯å¥—æ¥å­—ä¹Ÿä¼šè¿”å›ï¼Œé‚£ä¹ˆä¸»ç¨‹åºä¸ºäº†ä¸æ–­ç›‘å¬ä¿¡æ¯å°±å¾—<strong>ä¸€ç›´è½®è¯¢</strong>å¥—æ¥å­—ï¼Œå ç”¨å¤§é‡çš„CPUèµ„æºã€‚</p><p>è€Œåœ¨å¤šå¥—æ¥å­—æƒ…å†µä¸‹ï¼Œç”±äºé˜»å¡æ–¹å¼çš„å­˜åœ¨ï¼Œå¤šå¥—æ¥å­—å¯èƒ½ä¸èƒ½å¾ˆå¥½çš„åŒæ—¶ç›‘å¬ã€‚</p><p>æœ‰ä¸€äº›è§£å†³æ–¹æ¡ˆ</p><ul><li>å¤šçº¿ç¨‹ã€‚ä½†æ˜¯çº¿ç¨‹éœ€è¦å ç”¨èµ„æºï¼Œlinuxå¤§æ¦‚èƒ½å¼€å°å‡ ç™¾çš„å¥—æ¥å­—çº¿ç¨‹ã€‚</li><li>IOå¤šè·¯å¤ç”¨ï¼šselectã€pollã€epollç­‰ï¼ŒåŒæ—¶æ£€æµ‹å¤šä¸ªå¥—æ¥å­—æ˜¯å¦å°±ç»ªã€‚</li></ul><h4 id="å‚è€ƒåšå®¢-2"><a href="#å‚è€ƒåšå®¢-2" class="headerlink" title="å‚è€ƒåšå®¢"></a>å‚è€ƒåšå®¢</h4><p><a href="https://blog.csdn.net/wxlfreewind/article/details/108274842">ä¸ºä»€ä¹ˆç½‘ç»œsocketç¼–ç¨‹æ˜¯é˜»å¡çš„ï¼Ÿå› ä¸ºéé˜»å¡è½®è¯¢å CPUï¼Œç”¨å¤šçº¿ç¨‹å’ŒIOå¤ç”¨</a></p><h2 id="ioctl"><a href="#ioctl" class="headerlink" title="ioctl"></a>ioctl</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ioctl</span><span class="params">(<span class="keyword">int</span> fd,<span class="keyword">int</span> req,â€¦)</span></span>;</span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th style="text-align:center">req</th><th style="text-align:center">å‚æ•°</th><th style="text-align:center">è¿”å›å€¼</th><th style="text-align:center">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:center">SIOCATMARK</td><td style="text-align:center">int*</td><td style="text-align:center">0, -1</td><td style="text-align:center">æ˜¯å¦åˆ°è¾¾å¸¦å¤–æ ‡è®°</td></tr><tr><td style="text-align:center">FIOASYNC</td><td style="text-align:center">int*</td><td style="text-align:center">0, -1</td><td style="text-align:center">å¼‚æ­¥I/Oæ ‡å¿—</td></tr><tr><td style="text-align:center">FIONREAD</td><td style="text-align:center">int*</td><td style="text-align:center">0, -1</td><td style="text-align:center">ç¼“å­˜åŒºä¸­æœ‰å¤šå°‘å­—èŠ‚æ•°æ®å¯è¯»</td></tr></tbody></table></div>]]></content>
      
      
      <categories>
          
          <category> Socket </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>gym-102956</title>
      <link href="/2021/02/21/gym-102956/"/>
      <url>/2021/02/21/gym-102956/</url>
      
        <content type="html"><![CDATA[<p>[toc]</p><span id="more"></span><p><strong><a href="[2020-2021 Winter Petrozavodsk Camp, Belarusian SU Contest (XXI Open Cup, Grand Prix of Belarus">é¢˜ç›®é“¾æ¥</a>](<a href="https://codeforces.ml/gym/102956">https://codeforces.ml/gym/102956</a>))</strong></p><h2 id="G-prufer-amp-amp-æ ‘ä¸Šç»„åˆè®¡æ•°é—®é¢˜"><a href="#G-prufer-amp-amp-æ ‘ä¸Šç»„åˆè®¡æ•°é—®é¢˜" class="headerlink" title="G. prufer &amp;&amp; æ ‘ä¸Šç»„åˆè®¡æ•°é—®é¢˜"></a>G. prufer &amp;&amp; æ ‘ä¸Šç»„åˆè®¡æ•°é—®é¢˜</h2><p>å½“nä¸ºå¥‡æ•°æ—¶æ˜¾ç„¶ä¸º0.</p><p>å½“nä¸ºå¶æ•°æ—¶ï¼Œé¦–å…ˆå°†nä¸ªç‚¹åˆ†ç»„æˆä¸¤ä¸ªä¸¤ä¸ªï¼Œæœ‰$\frac {n!}{(\frac n 2)!2^{\frac n2}}$ç§ ï¼ˆå…ˆæ’åˆ—èµ·æ¥ï¼Œç„¶åé™¤å»n/2ç»„äº¤æ¢é¡ºåºçš„æƒ…å†µï¼Œå†é™¤å»ç»„å†…çš„ä¸¤ç§ç»„åˆæƒ…å†µï¼‰</p><p>ä¸Šè¿°åˆ†å¼åŒ–ç®€ç»“æœä¸º$(n-1)!!$ </p><p><del>æ²¡æœ‰æƒ³åˆ°æ€ä¹ˆæ ·ç›´æ¥åœ°åŒ–ç®€å¾—æ¥ï¼Œåªèƒ½ç”¨æ•°å­¦å½’çº³æ³•è¯æ˜ç»“è®ºçš„æ­£ç¡®æ€§ã€‚</del></p><p>å¦ä¸€æ–¹é¢ï¼Œç”±å‡¯è±å…¬å¼å¯ä»¥çŸ¥é“ï¼Œn/2ä¸ªèŠ‚ç‚¹çš„å¸¦æ ‡å·å®Œå…¨å›¾ç”Ÿæˆæ ‘æœ‰$(\frac n 2) ^ {\frac n 2 -2}$ä¸ª</p><p>è€Œè¿™n/2ä¸ªâ€èŠ‚ç‚¹â€éƒ½æ˜¯ç”±ä¸€å¯¹çœŸå®çš„å•ç‚¹ç»„æˆçš„ï¼Œæ‰€ä»¥n/2æ ‘ä¸Šçš„ä»»æ„ä¸€æ¡è¾¹ï¼Œéƒ½æ˜¯ç”±2ä¸ªç‚¹å¯¹ç»„åˆæ„æˆçš„ï¼Œå…±æœ‰4ç§å¯èƒ½çš„ç»“æœã€‚</p><p>é‚£ä¹ˆå½“n/2ä¸ªç‚¹å¯¹å·²ç»è¢«æŒ‡å®šåï¼Œè¯¥æ ‘å¯èƒ½çš„å½¢æ€å°±æœ‰$(\frac n 2) ^ {\frac n 2 -2} * 4^{\frac n 2 -1}$ç§</p><p>æ‰€ä»¥ç»¼ä¸Šè€ƒè™‘ï¼Œæ€»çš„æ–¹æ¡ˆæ•°å°±æ˜¯$(n-1)!! <em> (\frac n 2) ^ {\frac n 2 -2} </em> 4^{\frac n 2 -1}$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">5e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">int</span> par[maxn], prufer[maxn], du[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">encode</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ptr = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="keyword">if</span>(ptr == <span class="number">-1</span> &amp;&amp; du[i] == <span class="number">1</span>) ptr = i;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> leaf = ptr;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">2</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> next = prufer[i] = par[leaf];</span><br><span class="line">        <span class="keyword">if</span>(--du[next] == <span class="number">1</span> &amp;&amp; next &lt; ptr) leaf = next;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            ptr++;</span><br><span class="line">            <span class="keyword">while</span>(du[ptr] != <span class="number">1</span>) ptr++;</span><br><span class="line">            leaf = ptr;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rebuild</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ptr = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(du[ptr] != <span class="number">1</span>) ptr++;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> leaf = ptr;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">2</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> next = par[leaf] = prufer[i];</span><br><span class="line">        <span class="keyword">if</span>(--du[next] == <span class="number">1</span> &amp;&amp; next &lt; ptr) leaf = next;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            ptr++;</span><br><span class="line">            <span class="keyword">while</span>(du[ptr] != <span class="number">1</span>) ptr++;</span><br><span class="line">            leaf = ptr;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    par[leaf] = n;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">hsh</span><span class="params">(<span class="keyword">int</span> a[maxn], <span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) ans ^= (i + <span class="number">1</span>) * <span class="number">1ll</span> * a[i];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> op;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;op);</span><br><span class="line">    <span class="keyword">if</span>(op == <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n - <span class="number">1</span>; i++)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, par + i);</span><br><span class="line">            du[par[i]]++; du[i]++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">encode</span>();</span><br><span class="line">        <span class="built_in">hsh</span>(prufer, n - <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) du[i] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">2</span>; i++)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, prufer + i);</span><br><span class="line">            du[prufer[i]]++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">rebuild</span>();</span><br><span class="line">        <span class="built_in">hsh</span>(par + <span class="number">1</span>, n - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç»„åˆè®¡æ•° </tag>
            
            <tag> æ ‘ </tag>
            
            <tag> Pruferåºåˆ— </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¿æ®µæ ‘æ‰©å±•</title>
      <link href="/2021/02/18/%E7%BA%BF%E6%AE%B5%E6%A0%91%E6%89%A9%E5%B1%95/"/>
      <url>/2021/02/18/%E7%BA%BF%E6%AE%B5%E6%A0%91%E6%89%A9%E5%B1%95/</url>
      
        <content type="html"><![CDATA[<p>[toc]</p><span id="more"></span><h2 id="CF-1083C-çº¿æ®µæ ‘äºŒåˆ†-æŸ¥è¯¢æ ‘ä¸Šæ‹¥æœ‰æœ€å¤§MEXå€¼çš„ç®€å•è·¯å¾„"><a href="#CF-1083C-çº¿æ®µæ ‘äºŒåˆ†-æŸ¥è¯¢æ ‘ä¸Šæ‹¥æœ‰æœ€å¤§MEXå€¼çš„ç®€å•è·¯å¾„" class="headerlink" title="CF 1083C çº¿æ®µæ ‘äºŒåˆ† - æŸ¥è¯¢æ ‘ä¸Šæ‹¥æœ‰æœ€å¤§MEXå€¼çš„ç®€å•è·¯å¾„"></a><a href="https://codeforces.ml/contest/1083/problem/C">CF 1083C</a> çº¿æ®µæ ‘äºŒåˆ† - æŸ¥è¯¢æ ‘ä¸Šæ‹¥æœ‰æœ€å¤§MEXå€¼çš„ç®€å•è·¯å¾„</h2><p>ç»™å‡ºä¸€æ£µæ ‘ï¼Œæ ‘ä¸Šæ‰€æœ‰ç‚¹çš„ç‚¹æƒæ˜¯<code>[0, n - 1]</code>çš„ä¸€ä¸ªæ’åˆ—</p><p>è¿›è¡ŒQæ¬¡æ“ä½œï¼š</p><ul><li>äº¤æ¢æŸä¸¤ä¸ªç‚¹ä¹‹é—´çš„ç‚¹æƒ</li><li>æŸ¥è¯¢æ ‘ä¸Šæ‹¥æœ‰æœ€å¤§MEXå€¼çš„ç®€å•è·¯å¾„ï¼Œè¾“å‡ºMEXå€¼</li></ul><p>ç»´æŠ¤ä¸€ä¸ªçº¿æ®µæ ‘ï¼Œçº¿æ®µæ ‘ä¸ŠåŒºé—´[l, r]è®°å½•ç€æ•°å€¼[l, r]æ˜¯å¦åœ¨ä¸€æ¡ç®€å•è·¯å¾„å†…ï¼Œå¦‚æœæ˜¯çš„è¯åŒæ—¶è®°å½•ç®€å•è·¯å¾„çš„ä¸¤ä¸ªç«¯ç‚¹</p><p>ç›¸æ¯”äºä¸€èˆ¬çš„çº¿æ®µæ ‘æ¯”è¾ƒä¸åŒçš„æ˜¯upå‡½æ•°çš„è®¾ç½®ï¼Œç®—æ³•ä¸­é‡‡ç”¨äº†è¿™æ ·çš„åŠæ³•ï¼šå·²ç»ä¸¤æ¡ç®€å•è·¯å¾„å„è‡ªçš„ä¸¤ä¸ªç«¯ç‚¹ï¼Œä»è¿™4ä¸ªç‚¹ä¸­æšä¸¾2ä¸ªç‚¹å°è¯•ä½œä¸ºæ–°è·¯å¾„çš„ç«¯ç‚¹ï¼Œåˆ†åˆ«æ£€æŸ¥å‰©ä½™ä¸¤ä¸ªç‚¹åˆ°è¿™ä¸¤ä¸ªç«¯ç‚¹çš„è·ç¦»ä¹‹å’Œæ˜¯å¦ç­‰äºè·¯å¾„æœ¬èº«çš„è·ç¦»ã€‚</p><p>å› ä¸ºè¦æŸ¥è¯¢ä¸¤ç‚¹çš„è·ç¦»ï¼Œæ‰€ä»¥æå‡ºå‰é˜µå­çš„ç‚¹åˆ†æ ‘ä¸­O1 STè¡¨</p><p>æ¥ä¸‹æ¥åœ¨çº¿æ®µæ ‘ä¸ŠåšäºŒåˆ†ï¼ŒæŸ¥è¯¢å‡ºæœ€é•¿çš„è¿ç»­çš„å‰ç¼€å³å¯</p><p>å¤æ‚åº¦$O(nlogn)$ å†™çš„å¾ˆæŒ« å¸¸æ•°å·¨å¤§ </p><p>åœ¨mergeä¸­åŠæ—¶çš„<code>break</code>å’Œ<code>return</code>ã€ä»¥åŠä¿®æ”¹<code>vector&lt;int&gt; vec</code>ä¸º <code>int vec[4]</code>æ‰ç®—å¡è¿‡å»</p><p><del>æœç„¶nlognlognæ˜¯ä¸å¤ªå¯èƒ½é€šè¿‡ äºŒåˆ†åŠ çº¿æ®µæ ‘æŸ¥è¯¢çš„ç®—æ³•ä¸å¯è¡Œ</del></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ls (p &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rs ((p &lt;&lt; 1) | 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mid ((l + r) &gt;&gt; 1)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">20</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-8</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, w[manx];</span><br><span class="line"><span class="keyword">int</span> head[manx], par[maxn], top = <span class="number">0</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> &#123;</span><span class="keyword">int</span> to, next;&#125;edge[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    par[v] = u;</span><br><span class="line">    haed[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> dfn[maxn &lt;&lt; <span class="number">1</span>], pos[manx], cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> dep[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> par)</span></span>&#123;</span><br><span class="line">    dfn[cnt] = now; pos[now] = cnt; cnt++;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[now]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(to == par) <span class="keyword">continue</span>;</span><br><span class="line">        dep[to] = dep[now] + <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(to, now);</span><br><span class="line">        dfn[cnt++] = now;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> TEMP&#123;</span><br><span class="line">    <span class="keyword">int</span> st[maxn &lt;&lt; <span class="number">1</span>][N];</span><br><span class="line">    <span class="comment">//é€šè¿‡æ·±åº¦æ•°ç»„è·å–stè¡¨, stç»´æŠ¤åŒºé—´ä¸­æ·±åº¦æœ€å°çš„èŠ‚ç‚¹æ ‡å·</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">getst</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cnt; i++) st[i][<span class="number">0</span>] = dfn[i];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; N; j++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cnt; i++)&#123;</span><br><span class="line">                <span class="keyword">int</span> nxt = i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>));</span><br><span class="line">                <span class="keyword">if</span>(nxt &gt;= cnt) st[i][j] = st[i][j - <span class="number">1</span>];</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(dep[st[i][j - <span class="number">1</span>]] &lt; dep[st[nxt][j - <span class="number">1</span>]]) st[i][j] = st[i][j - <span class="number">1</span>];</span><br><span class="line">                <span class="keyword">else</span> st[i][j] = st[nxt][j - <span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//O1è·å–ä¸¤ç‚¹ä¹‹é—´çš„è·ç¦»</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getdis</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x == y) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> l = <span class="built_in">min</span>(pos[x], pos[y]), r = <span class="built_in">max</span>(pos[x], pos[y]);</span><br><span class="line">    <span class="keyword">int</span> k = (<span class="keyword">int</span>)(<span class="built_in">log2</span>(r - l) + eps);</span><br><span class="line">    <span class="keyword">int</span> lca = TEMP::st[l][k];</span><br><span class="line">    <span class="keyword">if</span>(dep[lca] &gt; dep[TEMP::st[r - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k]]) lca = TEMP::st[r - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k];</span><br><span class="line">    <span class="keyword">return</span> dep[x] + dep[y] - <span class="number">2</span> * dep[lca];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//çº¿æ®µæ ‘stä¸ŠåŒºé—´[l, r]è¡¨ç¤ºæ•°å€¼[l, r]æ˜¯å¦åœ¨ä¸€æ¡ç®€å•è·¯å¾„ä¸Šï¼ŒåŒæ—¶ç»´æŠ¤ç®€å•è·¯å¾„çš„ä¸¤ä¸ªç«¯ç‚¹</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NODE</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> l, r;</span><br><span class="line">    <span class="built_in">NODE</span>()&#123;l = r = <span class="number">-1</span>;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">NODE st[maxn &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> vec[<span class="number">4</span>];</span><br><span class="line"><span class="comment">//æ£€æŸ¥aå’Œbæ‰€ä»£è¡¨çš„ä¸¤ä¸ªç®€å•è·¯å¾„æ˜¯å¦èƒ½è¢«ä¸€ä¸ªæ–°çš„ç®€å•è·¯å¾„åŒ…å«</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> j)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> dis = <span class="built_in">getdis</span>(vec[i], vec[j]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; k++) <span class="keyword">if</span>(k != i &amp;&amp; k != j)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">getdis</span>(vec[k], vec[i]) + <span class="built_in">getdis</span>(vec[k], vec[j]) != dis) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">NODE <span class="title">merge</span><span class="params">(NODE &amp;a, NODE &amp;b)</span></span>&#123;</span><br><span class="line">    NODE temp;</span><br><span class="line">    <span class="keyword">if</span>(a.l == <span class="number">-1</span> || b.l == <span class="number">-1</span>) <span class="keyword">return</span> temp;</span><br><span class="line">    vec[<span class="number">0</span>] = a.l; vec[<span class="number">1</span>] = a.r; vec[<span class="number">2</span>] = b.l; vec[<span class="number">3</span>] = b.r;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) <span class="keyword">for</span>(<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; <span class="number">4</span>; j++) <span class="keyword">if</span>(<span class="built_in">check</span>(i, j))&#123;</span><br><span class="line">        temp.l = vec[i];</span><br><span class="line">        temp.r = vec[j];</span><br><span class="line">        <span class="keyword">return</span> temp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> temp;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//kå€¼ç°åœ¨å¤„åœ¨èŠ‚ç‚¹xçš„ä½ç½®</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l == r &amp;&amp; l == k)&#123;</span><br><span class="line">        st[p].l = st[p].r = x;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(k &lt;= mid) <span class="built_in">update</span>(ls, l, mid, k, x);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">update</span>(rs, mid + <span class="number">1</span>, r, k, x);</span><br><span class="line">    st[p] = <span class="built_in">merge</span>(st[ls], st[rs]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ ¹æ®ans.firstå°è¯•ç¼€ä¸ŠæŸä¸ªå‰ç¼€</span></span><br><span class="line">pair&lt;<span class="keyword">int</span>, NODE&gt; ans;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(st[p].l != <span class="number">-1</span> &amp;&amp; ans.first + <span class="number">1</span> == l)&#123;</span><br><span class="line">        NODE temp;</span><br><span class="line">        <span class="keyword">if</span>(ans.first == <span class="number">-1</span>)&#123;</span><br><span class="line">            ans.first = r;</span><br><span class="line">            ans.second = st[p];</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> temp = <span class="built_in">merge</span>(ans.second, st[p]);</span><br><span class="line">        <span class="keyword">if</span>(temp.l != <span class="number">-1</span>)&#123;</span><br><span class="line">            ans.first = r;</span><br><span class="line">            ans.second = temp;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(l == r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">query</span>(ls, l, mid);</span><br><span class="line">    <span class="keyword">if</span>(ans.first == mid) <span class="built_in">query</span>(rs, mid + <span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="built_in">scnaf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="built_in">clr</span>(head, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, w + i);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> x; <span class="built_in">scnaf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">        <span class="built_in">add</span>(x, i);</span><br><span class="line">    &#125;</span><br><span class="line">    TEMP::<span class="built_in">getst</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="built_in">update</span>(<span class="number">1</span>, <span class="number">0</span>, n - <span class="number">1</span>, w[i], i);</span><br><span class="line">    <span class="keyword">int</span> q; <span class="built_in">scnaf</span>(<span class="string">&quot;%d&quot;</span>, &amp;q);</span><br><span class="line">    <span class="keyword">while</span>(q--)&#123;</span><br><span class="line">        <span class="keyword">int</span> op; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;op);</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> x, y; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;x, &amp;y);</span><br><span class="line">            <span class="built_in">update</span>(<span class="number">1</span>, <span class="number">0</span>, n - <span class="number">1</span>, w[y], x);</span><br><span class="line">            <span class="built_in">update</span>(<span class="number">1</span>, <span class="number">0</span>, n - <span class="number">1</span>, w[x], y);</span><br><span class="line">            <span class="built_in">swap</span>(w[x], w[y]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            ans.first = <span class="number">-1</span>;</span><br><span class="line">            <span class="built_in">query</span>(<span class="number">1</span>, <span class="number">0</span>, n <span class="number">-1</span>);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans.first + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="bzoj3073-çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾"><a href="#bzoj3073-çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾" class="headerlink" title="bzoj3073 çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾"></a><a href="https://darkbzoj.tk/problem/3073">bzoj3073</a> çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾</h2><p>ç»™å‡ºnä¸ªèŠ‚ç‚¹ã€mç§è¾¹ã€‚</p><p>å¯¹äºæŸä¸€ç§è¾¹è€Œè¨€ï¼Œæœ‰4ä¸ªå‚æ•°ï¼ša, b, c, dï¼Œè¡¨ç¤ºå¯¹äºæ‰€æœ‰çš„$a \leq x \leq b, c \leq y \leq d$éƒ½æœ‰ä¸€æ¡æ— å‘è¾¹$<x, y>$ç›¸è¿ã€‚</p><p>è¯¢é—®å¯¹äºæŸä¸ªæŒ‡å®šç‚¹pè€Œè¨€ï¼Œåˆ°å…¶ä»–æ‰€æœ‰ç‚¹çš„æœ€çŸ­è·ç¦»</p><p>æ•°æ®èŒƒå›´ $n \leq 5e5, m \leq 1e5$</p><h3 id="çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾"><a href="#çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾" class="headerlink" title="çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾"></a>çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾</h3><p>æœ´ç´ çš„åšæ³•æ˜¯å¯¹æ¯ä¸€ç§è¾¹éƒ½ç”¨<strong>è™šç‚¹</strong>åˆ»ç”»ç›¸è¿å…³ç³»ï¼Œå³å°†æ‰€æœ‰çš„[a, b]è¿å‘è™šç‚¹uï¼Œå†å°†uè¿å‘æ‰€æœ‰çš„[c, d]ã€‚æ—¶ç©ºå¤æ‚åº¦ä¸º$O(mn^2)$</p><p>çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾åˆ™åˆ©ç”¨äº†çº¿æ®µæ ‘çš„åˆ†æ²»ç‰¹æ€§ï¼Œä¸å†æš´åŠ›åœ°å°†æ‰€æœ‰çš„[a, b]æˆ–[c, d]èŠ‚ç‚¹ä¸è™šç‚¹ç›¸è¿ï¼Œè€Œæ˜¯å°†çº¿æ®µæ ‘ä¸Šå¯¹åº”çš„åŒºé—´èŠ‚ç‚¹ä¸è™šç‚¹ç›¸è¿ï¼Œè¿™æ ·å¯ä»¥ä¿è¯å¯¹äºä»»æ„ä¸€æ®µåŒºé—´ï¼Œéƒ½åªæœ‰$logn$ä¸ªèŠ‚ç‚¹ä¸è™šç‚¹ç›¸è¿ï¼Œç©ºé—´å¤æ‚åº¦$O(m*log^2n)$ã€‚</p><p>å…·ä½“çš„å®ç°å¦‚ä¸‹ï¼š</p><p>å»ºç«‹ä¸¤æ£µ<strong>çº¿æ®µæ ‘ç»“æ„</strong>çš„æ ‘å½¢ç»“æ„ï¼Œç¬¬ä¸€æ£µä»çˆ¶äº²èŠ‚ç‚¹å‘å„¿å­èŠ‚ç‚¹è¿è¾¹ï¼Œç§°ä¸ºæ ‘Aï¼Œç¬¬äºŒæ£µä»å„¿å­èŠ‚ç‚¹å‘çˆ¶äº²èŠ‚ç‚¹è¿è¾¹ï¼Œç§°ä¸ºæ ‘Bã€‚Aæ ‘çš„æ‰€æœ‰å¶å­ç›¸åº”åœ°è¿å‘Bä¸­æ‰€æœ‰çš„å¶å­ã€‚</p><p>æ¥ä¸‹æ¥æ¯è¯»å…¥ä¸€ç»„abcd, å°†å°†Bæ ‘ä¸­å¯¹åº”[a, b]åŒºé—´çš„èŠ‚ç‚¹è¿å‘è™šç‚¹ï¼Œå†å°†è¯¥è™šç‚¹è¿å‘Aæ ‘ä¸­[c, d]åŒºé—´å¯¹åº”çš„èŠ‚ç‚¹ã€‚åè¿‡æ¥å†å¯¹[c, d]å’Œ[a, b]è¿›è¡ŒåŒæ ·çš„è¿æ¥ã€‚ä¸ºäº†ä½¿å¾—æƒå€¼æ€»ä¸º1ï¼Œå¯ä»¥ä¸å¦¨ä½¿å¾—å…¥è¾¹æƒä¸º1ï¼Œå‡ºè¾¹æƒä¸º0ã€‚</p><p>è¿™æ ·ï¼Œä¾¿åˆ©ç”¨äº†çº¿æ®µæ ‘çš„ç»“æ„å®Œæˆäº†è¾ƒä¸ºé«˜æ•ˆçš„å›¾çš„å»ºç«‹ã€‚</p><h3 id="01-BFS"><a href="#01-BFS" class="headerlink" title="01 BFS"></a>01 BFS</h3><p>ç”±äºè¯¥å›¾è¾¹æƒä»…ä¸º0æˆ–1ï¼Œæ‰€ä»¥è€ƒè™‘ä½¿ç”¨01BFSå®Œæˆæœ€çŸ­è·¯çš„æ±‚è§£ã€‚</p><p>å…·ä½“å®ç°å¦‚ä¸‹ï¼ˆä½¿ç”¨åŒç«¯é˜Ÿåˆ—ï¼‰ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(é˜Ÿåˆ—éç©º)&#123;</span><br><span class="line">  å–å‡ºé˜Ÿé¦–å…ƒç´ <span class="function">now</span></span><br><span class="line"><span class="function">  <span class="title">for</span><span class="params">(nowçš„ç›¸é‚»èŠ‚ç‚¹)</span></span>&#123;</span><br><span class="line">    æ›´æ–°è·ç¦»</span><br><span class="line">    <span class="keyword">if</span>(è¾¹æƒä¸º<span class="number">0</span>) æ·»åŠ åˆ°é˜Ÿé¦–</span><br><span class="line">    <span class="keyword">else</span> æ·»åŠ åˆ°é˜Ÿå°¾</span><br><span class="line">  &#125;</span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure><h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><p>åœ¨å¼€è®¾Aã€Bä¸¤æ£µæ ‘ã€æ·»åŠ æœ‰å‘è¾¹çš„æ—¶å€™å¯ä»¥ç²¾å¿ƒé€‰æ‹©åç§»é‡ç­‰æ•°å€¼ï¼Œä½¿å¾—å¿«é€Ÿè·å–æƒ³è¦çš„ä¸‹æ ‡ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mid ((l + r) &gt;&gt; 1)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">5e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxe = <span class="number">4e7</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> M;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m, p;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> &#123;</span><span class="keyword">int</span> to, next, w;&#125;edge[maxe];</span><br><span class="line"><span class="keyword">int</span> head[maxe], top = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].w = w;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">0</span>, pos[maxn], ls[maxn &lt;&lt; <span class="number">3</span>], rs[maxn &lt;&lt; <span class="number">3</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> now = cnt++;</span><br><span class="line">    <span class="keyword">if</span>(l == r)&#123;</span><br><span class="line">        <span class="built_in">add</span>(now, now + M, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> pos[l] = now;</span><br><span class="line">    &#125;</span><br><span class="line">    ls[now] = <span class="built_in">build</span>(l, mid);</span><br><span class="line">    <span class="built_in">add</span>(now, ls[now], <span class="number">0</span>); <span class="built_in">add</span>(ls[now] + M, now + M, <span class="number">0</span>);</span><br><span class="line">    rs[now] = <span class="built_in">build</span>(mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="built_in">add</span>(now, rs[now], <span class="number">0</span>); <span class="built_in">add</span>(rs[now] + M, now + M, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> now;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> u, <span class="keyword">int</span> type)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= l &amp;&amp; r &lt;= R)&#123;</span><br><span class="line">        <span class="keyword">if</span>(type) <span class="built_in">add</span>(p + M, u, <span class="number">1</span>); <span class="keyword">else</span> <span class="built_in">add</span>(u, p, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= mid) <span class="built_in">update</span>(ls[p], l, mid, L, R, u, type);</span><br><span class="line">    <span class="keyword">if</span>(R &gt; mid) <span class="built_in">update</span>(rs[p], mid + <span class="number">1</span>, r, L, R, u, type);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> dis[<span class="number">5000000</span>];</span><br><span class="line">deque&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bfs</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">clr</span>(dis, <span class="number">0x3f</span>);</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>()) q.<span class="built_in">pop_back</span>();</span><br><span class="line">    </span><br><span class="line">    dis[pos[p]] = <span class="number">0</span>; q.<span class="built_in">push_back</span>(pos[p]);</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())&#123;</span><br><span class="line">        <span class="keyword">int</span> now = q.<span class="built_in">front</span>(); q.<span class="built_in">pop_front</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = head[now]; ~i; i = edge[i].next)&#123;</span><br><span class="line">            <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(dis[to] != <span class="number">0x3f3f3f3f</span>) <span class="keyword">continue</span>;</span><br><span class="line">            dis[to] = dis[now] + edge[i].w;</span><br><span class="line">            <span class="keyword">if</span>(edge[i].w) q.<span class="built_in">push_back</span>(to);</span><br><span class="line">            <span class="keyword">else</span> q.<span class="built_in">push_front</span>(to);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="built_in">clr</span>(head, <span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;n, &amp;m, &amp;p);</span><br><span class="line">    M = n &lt;&lt; <span class="number">2</span>; <span class="built_in">build</span>(<span class="number">1</span>, n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> a, b, c, d; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d %d&quot;</span>, &amp;a, &amp;b, &amp;c, &amp;d);</span><br><span class="line">        <span class="comment">//åŠ å…¥è™šç‚¹i + 2Mä¸i + 1 + 2M;</span></span><br><span class="line">        <span class="built_in">update</span>(<span class="number">0</span>, <span class="number">1</span>, n, a, b, <span class="number">2</span> * i + <span class="number">2</span> * M, <span class="number">1</span>); <span class="built_in">update</span>(<span class="number">0</span>, <span class="number">1</span>, n, c, d, <span class="number">2</span> * i + <span class="number">2</span> * M, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">update</span>(<span class="number">0</span>, <span class="number">1</span>, n, c, d, <span class="number">2</span> * i + <span class="number">2</span> * M + <span class="number">1</span>, <span class="number">1</span>); <span class="built_in">update</span>(<span class="number">0</span>, <span class="number">1</span>, n, a, b, <span class="number">2</span> * i + <span class="number">2</span> * M + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">bfs</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, dis[pos[i]]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="çº¿æ®µæ ‘åˆå¹¶"><a href="#çº¿æ®µæ ‘åˆå¹¶" class="headerlink" title="çº¿æ®µæ ‘åˆå¹¶"></a>çº¿æ®µæ ‘åˆå¹¶</h2><p>çº¿æ®µæ ‘åˆå¹¶æ˜¯è¿™æ ·çš„ä¸€ç§æ“ä½œï¼š</p><p>å½“æ„é€ è§„åˆ™æŒ‡å®šã€å·¦å³è¾¹ç•Œç¡®å®šåï¼Œä»»æ„ä¸¤æ£µçº¿æ®µæ ‘çš„ç»“æ„ä¸€å®šç›¸åŒï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ®æ­¤å°†ä¸¤é¢—è¾¹ç•Œç›¸åŒçš„çº¿æ®µæ ‘è¿›è¡Œåˆå¹¶ã€‚</p><h3 id="CF-600E-å­æ ‘æœ€å¤šå‡ºç°æ¬¡æ•°é¢œè‰²å’Œçš„æŸ¥è¯¢"><a href="#CF-600E-å­æ ‘æœ€å¤šå‡ºç°æ¬¡æ•°é¢œè‰²å’Œçš„æŸ¥è¯¢" class="headerlink" title="CF 600E å­æ ‘æœ€å¤šå‡ºç°æ¬¡æ•°é¢œè‰²å’Œçš„æŸ¥è¯¢"></a><a href="https://codeforces.ml/problemset/problem/600/E">CF 600E</a> å­æ ‘æœ€å¤šå‡ºç°æ¬¡æ•°é¢œè‰²å’Œçš„æŸ¥è¯¢</h3><p>ç»™å‡ºä¸€æ£µnèŠ‚ç‚¹çš„æ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹å…·æœ‰ä¸€ä¸ªé¢œè‰²ã€‚</p><p>è¾“å‡ºåœ¨ä»¥1ä¸ºæ ¹æ—¶ï¼Œæ¯ä¸ªèŠ‚ç‚¹åŠå…¶å­æ ‘ä¸Šæ‰€æœ‰èŠ‚ç‚¹ä¸­æœ€å¤šæ•°é‡çš„é¢œè‰²çš„å’Œã€‚</p><p>$n \leq 1e5, c_i \leq n$</p><p>æ¯æ’å…¥ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¼šäº§ç”Ÿlognä¸ªæ–°èŠ‚ç‚¹ï¼Œå› è€Œæ€»å…±è‡³å¤šäº§ç”Ÿnlognä¸ªæ–°èŠ‚ç‚¹ã€‚</p><p>è€Œåœ¨æ¯ä¸€æ¬¡mergeæ—¶ï¼Œä¼šåˆå¹¶æ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œåˆå¹¶çš„å¤æ‚åº¦æ˜¯$O(1)$ï¼Œæ‰€ä»¥è‡³å¤šè¿›è¡Œnlognæ¬¡åˆå¹¶ã€‚</p><p>å› è€Œçº¿æ®µæ ‘åˆå¹¶çš„æ€»ä½“å¤æ‚åº¦æ˜¯$O(nlogn)$</p><p>ç›¸æ¯”äº$O(nlog^2n)$çš„å¯å‘å¼åˆå¹¶å¤æ‚åº¦æ›´å°ï¼Œæ›´å¥½å†™ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘ï¼š</span></span><br><span class="line"><span class="comment">    - æ’å…¥ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">    - åˆå¹¶ä¸¤æ£µæ ‘</span></span><br><span class="line"><span class="comment"> ç»´æŠ¤å‡ºç°æœ€å¤šçš„æ¬¡æ•°çš„é¢œè‰²çš„å’Œï¼Œè®°å½•ä¸¤ä¸ªå€¼(å‡ºç°æ¬¡æ•°ï¼Œé¢œè‰²å’Œ)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mid ((l + r) &gt;&gt; 1)</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1e5</span> * <span class="number">20</span> * <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">int</span> haed[maxn], top = <span class="number">0</span>, root[maxn];</span><br><span class="line">star edge[maxn &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NODE</span>&#123;</span><span class="keyword">int</span> mx; ll sum;&#125;;</span><br><span class="line">NODE st[M];</span><br><span class="line"><span class="keyword">int</span> ls[M], rs[M], cnt = <span class="number">1</span>;</span><br><span class="line"><span class="comment">//cntå¿…é¡»ä»1å¼€å§‹ï¼è¿™æ˜¯ç”±mergeçš„å®ç°æ‰€å†³å®šçš„ï¼</span></span><br><span class="line"><span class="comment">//åŠ å…¥ä¸€ä¸ªå•ç‚¹ä½œä¸ºåˆå§‹åŒ–</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> &amp;p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!p) p = cnt++;</span><br><span class="line">    <span class="keyword">if</span>(l == r &amp;&amp; l == k)&#123;</span><br><span class="line">        st[p].mx = <span class="number">1</span>; st[p].sum = k;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(k &lt;= mid)&#123;</span><br><span class="line">        <span class="built_in">update</span>(ls[p], l, mid, k);</span><br><span class="line">        st[p] = st[ls[p]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">update</span>(rs[p], mid + <span class="number">1</span>, r, k);</span><br><span class="line">        st[p] = st[rs[p]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">up</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(st[ls[p]].mx &gt; st[rs[p]].mx) st[p] = st[ls[p]];</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(st[ls[p]].mx &lt; st[rs[p]].mx) st[p] = st[rs[p]];</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        st[p].mx = st[ls[p]].mx;</span><br><span class="line">        st[p].sum = st[ls[p]].sum + st[rs[p]].sum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å°†r1ä¸r2å¯¹åº”çš„ä¸¤æ£µç»“æ„ç›¸åŒçš„çº¿æ®µæ ‘è¿›è¡Œåˆå¹¶ï¼Œè¿”å›å€¼ä¸ºåˆå¹¶åçš„æ ‘çš„æ ‡å·</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> r1, <span class="keyword">int</span> r2, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!r1) <span class="keyword">return</span> r2;</span><br><span class="line">    <span class="keyword">if</span>(!r2) <span class="keyword">return</span> r1;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(l == r)&#123;</span><br><span class="line">        st[r1].mx += st[r2].mx;</span><br><span class="line">        <span class="keyword">return</span> r1;</span><br><span class="line">    &#125;</span><br><span class="line">    ls[r1] = <span class="built_in">merge</span>(ls[r1], ls[r2], l, mid);</span><br><span class="line">    rs[r1] = <span class="built_in">merge</span>(rs[r1], rs[r2], mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="built_in">up</span>(r1);</span><br><span class="line">    <span class="keyword">return</span> r1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ll ans[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> par)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[now]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(to == par) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(to, now);</span><br><span class="line">        root[now] = <span class="built_in">merge</span>(root[now], root[to], <span class="number">1</span>, n);</span><br><span class="line">    &#125;</span><br><span class="line">    ans[now] = st[root[now]].sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="built_in">clr</span>(head, <span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> c; <span class="built_in">scnaf</span>(<span class="string">&quot;%d&quot;</span>, &amp;c);</span><br><span class="line">        <span class="built_in">udpate</span>(root[i], <span class="number">1</span>, n, c);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> u, v; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">        <span class="built_in">add</span>(u, v); <span class="built_in">add</span>(v, u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">prt</span>(ans + <span class="number">1</span>, n);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="æ›´å¤šçš„ä¾‹é¢˜-ï¼ˆæœªè¡¥"><a href="#æ›´å¤šçš„ä¾‹é¢˜-ï¼ˆæœªè¡¥" class="headerlink" title="æ›´å¤šçš„ä¾‹é¢˜ ï¼ˆæœªè¡¥"></a>æ›´å¤šçš„ä¾‹é¢˜ ï¼ˆæœªè¡¥</h3><p><a href="https://www.luogu.com.cn/blog/styx-ferryman/xian-duan-shu-ge-bing-zong-ru-men-dao-fang-qi">https://www.luogu.com.cn/blog/styx-ferryman/xian-duan-shu-ge-bing-zong-ru-men-dao-fang-qi</a></p><h2 id="çº¿æ®µæ ‘åˆ†è£‚"><a href="#çº¿æ®µæ ‘åˆ†è£‚" class="headerlink" title="çº¿æ®µæ ‘åˆ†è£‚"></a>çº¿æ®µæ ‘åˆ†è£‚</h2><h2 id="åŒºé—´æœ€å€¼æ“ä½œä¸å†å²æœ€å€¼æ“ä½œ"><a href="#åŒºé—´æœ€å€¼æ“ä½œä¸å†å²æœ€å€¼æ“ä½œ" class="headerlink" title="åŒºé—´æœ€å€¼æ“ä½œä¸å†å²æœ€å€¼æ“ä½œ"></a>åŒºé—´æœ€å€¼æ“ä½œä¸å†å²æœ€å€¼æ“ä½œ</h2>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çº¿æ®µæ ‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>edu-104-div2</title>
      <link href="/2021/02/16/edu-104-div2/"/>
      <url>/2021/02/16/edu-104-div2/</url>
      
        <content type="html"><![CDATA[<p>è¢«setçˆ†é”¤çš„ä¸€åœº</p><p>å¦‚æœè‡ªå®šä¹‰äº†æ¯”è¾ƒç¬¦ï¼Œé‚£ä¹ˆåº”è¯¥è¦ä»”ç»†çš„å®¡æŸ¥<strong>æ¯”è¾ƒç¬¦çš„å®šä¹‰</strong>æ˜¯å¦ç¬¦åˆé¢„æœŸï¼ç‰¹åˆ«æ˜¯<strong>ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰</strong>çš„æƒ…å†µï¼</p><p>ä¸ç„¶åœ¨è¿›è¡Œset.erase()/set.insert()æ—¶ä¼šå‡ºç°å¤´deçƒ‚éƒ½çœ‹ä¸å‡ºæ¥çš„çš„bug</p>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>CF-699-div2</title>
      <link href="/2021/02/06/CF-699-div2/"/>
      <url>/2021/02/06/CF-699-div2/</url>
      
        <content type="html"><![CDATA[<p>[toc]</p><span id="more"></span><h2 id="A-ç­¾åˆ°"><a href="#A-ç­¾åˆ°" class="headerlink" title="A ç­¾åˆ°"></a>A ç­¾åˆ°</h2><p>æ‹‰å®çš„ç¬¬ä¸€é¢˜ å¾—å†™åŠå¤©</p><h2 id="B-æ¨¡æ‹Ÿæš´åŠ›"><a href="#B-æ¨¡æ‹Ÿæš´åŠ›" class="headerlink" title="B æ¨¡æ‹Ÿæš´åŠ›"></a>B æ¨¡æ‹Ÿæš´åŠ›</h2><p>å‘ç°æœ‰æ•ˆçš„èŒƒå›´æ¯”è¾ƒå°åå°±å¾ˆå¥½å†™äº†</p><h2 id="C-æ¨¡æ‹Ÿ"><a href="#C-æ¨¡æ‹Ÿ" class="headerlink" title="C æ¨¡æ‹Ÿ"></a>C æ¨¡æ‹Ÿ</h2><p>å€’åºå¤„ç†ï¼Œæ²¡å•¥æ„æ€ï¼Œä½†æ˜¯è‡ªå·±å†™èµ·æ¥è¿˜æ˜¯å†™çš„å¾ˆä¸‘</p><h2 id="D-æ„é€ "><a href="#D-æ„é€ " class="headerlink" title="D æ„é€ "></a>D æ„é€ </h2><p>å¦‚æœå‡ºç°ä¸€å¯¹æ ‡å·ç›¸åŒçš„è¾¹é‚£ä¹ˆéšæ„æ„é€ ï¼›ä¸ç„¶çš„è¯æ£€æŸ¥mçš„å¥‡å¶æ€§ï¼Œå¦‚æœmæ˜¯å¥‡æ•°çš„è¯åå¤æ¨ªè·³ï¼Œå¦‚æœmæ˜¯å¶æ•°çš„è¯è¿˜å¾—ç»§ç»­è€ƒè™‘m/2çš„å¥‡å¶æ€§ï¼Œè¿™æ ·åˆ†ç±»æ‰ç®—å®Œå…¨ã€‚</p><h2 id="E-DP-ï¼ˆè¡¥é¢˜"><a href="#E-DP-ï¼ˆè¡¥é¢˜" class="headerlink" title="E DP ï¼ˆè¡¥é¢˜"></a>E DP ï¼ˆè¡¥é¢˜</h2><p>åœºä¸Šç”¨äº†æ®‹ä½™çš„äºŒåæ¥åˆ†é’Ÿè€ƒè™‘äº†ä¸€é˜µå­ï¼Œå¦„æƒ³ç”¨ä¸€äº›ç¥ç§˜çš„å¯æŒä¹…åŒ–æƒå€¼çº¿æ®µæ ‘äº‘äº‘ï¼Œä½†æ˜¯å¥½åƒå¤æ‚åº¦ä¹Ÿæ˜¯n2çº§åˆ«çš„æ ·å­</p><p>æ­£ç¡®çš„åšæ³•æ˜¯dp</p><p>è€ƒè™‘è¿™æ ·çš„dpæ•°ç»„ï¼šdp[i]è¡¨ç¤ºä½¿å¾—a[i..n]ç¬¦åˆçº¦æŸçš„æœ€å¤šçš„ä¸éœ€è¦ç§»åŠ¨çš„å…ƒç´ æ•°é‡</p><p>å†å¼€è®¾ä¸€äº›è¾…åŠ©æ•°ç»„ï¼šl[i]è¡¨ç¤ºé¢œè‰²iå‡ºç°çš„æœ€å·¦è¾¹çš„ä½ç½®ï¼Œr[i]è¡¨ç¤ºé¢œè‰²iå‡ºç°çš„æœ€å³è¾¹çš„ä½ç½®ï¼Œcnt[i]è¡¨ç¤ºé¢œè‰²iå‡ºç°çš„æ¬¡æ•°ï¼Œnow[i]è¡¨ç¤ºç›®å‰è½¬ç§»çŠ¶æ€ä¸‹é¢œè‰²iå‡ºç°çš„æ¬¡æ•°</p><p>é‚£ä¹ˆä»åå¾€å‰è½¬ç§»ï¼Œå‡è®¾å½“å‰è€ƒè™‘ä¸‹æ ‡iæ‰€åœ¨çš„ä½ç½®ã€‚</p><p>å¦‚æœè®¤ä¸ºa[i]ä¸ç§»åŠ¨ï¼š</p><ul><li>$i == l[a[i]]$ï¼Œå³iä½ç½®çš„é¢œè‰²æ˜¯æœ€åä¸€æ¬¡å‡ºç°ï¼Œåˆ™$dp[i] = dp[r[a[i]] + 1] + cnt[a[i]]$</li><li>elseï¼Œdp[i] = now[a[i]]</li></ul><p>è¿™æ˜¯å› ä¸ºå½“iå¤„å…ƒç´ è¿˜ä¸æ˜¯æœ€å·¦è¾¹çš„å…ƒç´ æ—¶ï¼Œ$r[a[i]] + 1$åŠä»¥åçš„å…ƒç´ ä¹Ÿéƒ½éœ€è¦å¾€åæŒªåŠ¨ä¸€æ¬¡ï¼Œä¸ç„¶$l[a[i]]$æ²¡æœ‰åŠæ³•å’Œå‰©ä½™çš„$a[i]$æ±‡åˆï¼›è€Œå½“iå·²ç»æ˜¯æœ€å·¦è¾¹çš„å…ƒç´ æ—¶ï¼Œ$r[a[i]] + 1$åŠå…¶ä»¥åçš„å…ƒç´ ä¸ä¸€å®šéƒ½è¦æŒªåŠ¨ä¸€æ¬¡ï¼Œä»–ä»¬ä¸éœ€è¦ä¸ºæ›´å¤šçš„$a[i]$è…¾å‡ºç©ºé—´</p><p>å¦‚æœè®¤ä¸ºa[i]ç§»åŠ¨ï¼Œæ˜¾ç„¶$dp[i] = dp[i +1]$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> itn maxn = <span class="number">5e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">int</span> a[maxn], l[maxn], r[maxn], cnt[maxn], now[maxn], dp[manx];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// Fastin;</span></span><br><span class="line">    <span class="built_in">scnaf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="built_in">scnaf</span>(<span class="string">&quot;%d&quot;</span>, a + i);</span><br><span class="line">    <span class="keyword">for</span>(itn i = <span class="number">0</span>; i &lt; n; i++) r[a[i]] = i;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">        l[a[i]] = i; cnt[a[i]]++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    dp[n] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">        now[a[i]]++;</span><br><span class="line">        <span class="keyword">if</span>(l[a[i]] == i) dp[i] = dp[r[a[i]] + <span class="number">1</span>] + cnt[a[i]];</span><br><span class="line">        <span class="keyword">else</span> dp[i] = now[a[i]];</span><br><span class="line">        dp[i] = <span class="built_in">max</span>(dp[i], dp[i + <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// prt(dp, n);</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, n - dp[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç‚¹åˆ†æ ‘</title>
      <link href="/2021/02/05/%E7%82%B9%E5%88%86%E6%A0%91/"/>
      <url>/2021/02/05/%E7%82%B9%E5%88%86%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<p><strong><a href="https://www.luogu.com.cn/problem/P6329">P6329 ç‚¹åˆ†æ ‘æ¨¡ç‰ˆ éœ‡æ³¢</a></strong></p><span id="more"></span><p>ç»™å‡ºnä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œæ ‘ä¸ŠèŠ‚ç‚¹æœ‰ç‚¹æƒ$w_i$</p><p>è¿›è¡Œqæ¬¡å¼ºåˆ¶åœ¨çº¿æ“ä½œï¼š</p><ul><li>æ“ä½œ0: æŸ¥è¯¢è·ç¦»èŠ‚ç‚¹xè·ç¦»å°äºç­‰äºyçš„æ‰€æœ‰èŠ‚ç‚¹çš„ç‚¹æƒå’Œ</li><li>æ“ä½œ1: å°†èŠ‚ç‚¹xçš„å€¼ä¿®æ”¹ä¸ºy</li></ul><p>è¯¥é¢˜ä¸»è¦å…³å¿ƒèŠ‚ç‚¹ä¹‹é—´çš„è·ç¦»ï¼Œæ‰€ä»¥ä¸€å®šç¨‹åº¦ä¸Šä¸æ ‘æœ¬èº«çš„æ‹“æ‰‘ç»“æ„æ— å…³ï¼Œå› è€Œè€ƒè™‘å°†åŸæ ‘é‡æ„ä¸ºç»“æ„ä¼˜ç§€çš„ç‚¹åˆ†æ ‘ï¼Œè¯¥æ ‘çš„é«˜åº¦ä¸è¶…è¿‡$logn$ã€‚é‡æ„åå¯¹æ¯ä¸ªç‚¹å¼€æ¡¶ï¼Œtong[i]è®°å½•è¯¥èŠ‚ç‚¹æ‰€æœ‰ä¸ä¹‹è·ç¦»ä¸ºiçš„å­©å­çš„ç‚¹æƒå’Œã€‚å› ä¸ºç‚¹åˆ†æ ‘ç»“æ„ä¼˜ç§€ï¼Œæ‰€ä»¥ç©ºé—´æ¶ˆè€—ä»…ä¸º$O(nlogn)$ã€‚</p><p>è¿™æ ·ï¼Œç±»ä¼¼äºç‚¹åˆ†æ²»ï¼Œå¯¹æŸä¸ªèŠ‚ç‚¹xçš„æŸ¥è¯¢å°±ç›¸å½“äºåˆ†æ²»åœ°æŸ¥è¯¢xçš„æ‰€æœ‰ç¥–å…ˆä½œå‡ºçš„è´¡çŒ®ã€‚</p><p>ä½†åŒæ ·ç±»ä¼¼äºç‚¹åˆ†æ²»ï¼Œå¯¹æŸèŠ‚ç‚¹uçš„çˆ¶äº²par[u]è¿›è¡Œç»Ÿè®¡æ—¶ï¼Œæœ‰å¯èƒ½ä¼šå‡ºç°å’ŒèŠ‚ç‚¹uè´¡çŒ®é‡å¤çš„éƒ¨åˆ†ï¼Œå› è€Œå¯¹çˆ¶äº²èŠ‚ç‚¹è¿›è¡Œç»Ÿè®¡å‰åº”è¯¥å°†å½“å‰èŠ‚ç‚¹å¯èƒ½ç®—é‡çš„è´¡çŒ®å‡å»ï¼Œè¿™æ ·æ‰èƒ½ä¸é‡å¤åœ°è®¡ç®—ç‚¹æƒå’Œã€‚è€Œç”±äº<strong>ç‚¹åˆ†æ ‘å®Œå…¨ç ´åäº†åŸæ ‘çš„æ‹“æ‰‘ç»“æ„</strong>ï¼Œå› è€Œä»…ä»…çŸ¥é“uèŠ‚ç‚¹æ‰€æœ‰å­©å­å¯¹uçš„è´¡çŒ®(å³ä¸Šè¿°çš„tong)æ˜¯ä¸èƒ½å¤Ÿé€šè¿‡<code>è·ç¦»+1</code>ç­‰ç®€å•çš„æ‰‹æ®µçŸ¥é“uèŠ‚ç‚¹æ‰€æœ‰å­©å­å¯¹par[u]çš„è´¡çŒ®çš„ï¼Œæ‰€ä»¥å¯¹æ¯ä¸ªèŠ‚ç‚¹æˆ‘ä»¬åº”è¯¥å¼€ä¸¤ä¸ªæ¡¶ï¼Œä¸€ä¸ªè®°å½•å¯¹è‡ªèº«çš„è´¡çŒ®ï¼Œä¸€ä¸ªè®°å½•å¯¹çˆ¶äº²çš„è´¡çŒ®ã€‚è€Œè¯¥é¢˜è¦æ±‚èƒ½å•ç‚¹ä¿®æ”¹æ¡¶ä¸­æƒå€¼ï¼ŒåŒºé—´æŸ¥è¯¢æ¡¶çš„å‰ç¼€å’Œï¼Œå› è€Œè¯¥æ¡¶è‡³å°‘åº”è¯¥æ˜¯bitï¼Œè€Œç”±äºæœ¬äººå¤ªèœä¸æ“…é•¿bitï¼Œå°±ä½¿ç”¨åŠ¨æ€å¼€ç‚¹çš„çº¿æ®µæ ‘å®ŒæˆåŠ¨æ€çš„ä¿®æ”¹ã€æŸ¥è¯¢ã€‚å½“ä¿®æ”¹æ—¶ï¼Œä¸æ–­å‘ä¸Šçˆ¬ï¼Œæ ¹æ®è·ç¦»ä¸æ–­åœ°ä¿®æ”¹ä¸¤æ£µçº¿æ®µæ ‘ï¼›å½“æŸ¥è¯¢æ—¶ï¼Œä¸æ–­åœ°å‘ä¸Šçˆ¬ï¼Œå»é™¤é‡å¤çš„éƒ¨åˆ†ï¼Œæ±‚å’Œç»Ÿè®¡ã€‚</p><p>æ­¤å¤–ï¼Œä¸ºäº†å¿«é€Ÿæ±‚åŸæ ‘ä¸­ä¸¤ç‚¹çš„è·ç¦»ï¼Œæˆ‘ä»¬èŠ±è´¹$O(nlogn)$çš„æ—¶é—´ã€ç©ºé—´åœ¨dfnåºä¸Šå»ºç«‹stè¡¨ï¼Œ$O(1)$åœ°å®Œæˆæ¯æ¬¡çš„æŸ¥è¯¢ã€‚</p><p>æ€»ä½“æ—¶é—´å¤æ‚åº¦å¤§æ¦‚æ˜¯$O(nlog^2n)$</p><p>æ ‘å¥—æ ‘éš¾å†™çš„ä¸€æ¯”ï¼Œæ˜¥èŠ‚å‰å†™åˆ°è‡ªé—­ï¼Œæ˜¨å¤©æ™šä¸Šé‡æ–°å†™å†™åˆ°åŠå¤œæ€»ç®—è¿‡äº†ã€‚</p><p><del>ç åŠ›å®åœ¨å¤ªæŒ«äº†</del></p><p>æœ‰ä¸€äº›å‘ç‚¹æ”¾åœ¨<a href="http://rqdmap.top/2020/06/17/template/">template</a>é‡Œè¿›è¡Œæ³¨è§£ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mid ((l + r) &gt;&gt; 1)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> manx = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="comment">//æ ¹æ®dfnæ•°ç»„çš„é•¿åº¦å†³å®šN(å³N = log2(cnt), cnt = maxn &lt;&lt; 1)</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">20</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, q;</span><br><span class="line"><span class="keyword">int</span> w[manx];</span><br><span class="line"><span class="comment">//åŠ¨æ€å¼€ç‚¹çš„å•ç‚¹ä¿®æ”¹ã€åŒºé—´æ±‚å’Œçº¿æ®µæ ‘</span></span><br><span class="line"><span class="comment">//ç»´æŠ¤ä¸¤ä¸ªstï¼Œä¸€ä¸ªæ˜¯uå­æ ‘å¯¹uçš„è´¡çŒ®ï¼Œå¦ä¸€ä¸ªæ˜¯uå­æ ‘å¯¹par[u]çš„è´¡çŒ®ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = maxn * N * <span class="number">4</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SEG</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> root[maxn];</span><br><span class="line">    <span class="keyword">int</span> st[M], ls[M], rs[M], top = <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> now = top++;</span><br><span class="line">        <span class="keyword">if</span>(l == r) <span class="keyword">return</span> now;</span><br><span class="line">        ls[now] = <span class="built_in">build</span>(l, mid);</span><br><span class="line">        rs[now] = <span class="built_in">build</span>(mid + <span class="number">1</span>, r);</span><br><span class="line">        <span class="keyword">return</span> now;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">up</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;st[p] = st[ls[p]] + st[rs[p]];&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">        <span class="built_in">assert</span>(k &gt;= l &amp;&amp; k &lt;= r);</span><br><span class="line">        <span class="keyword">if</span>(l == r &amp;&amp; l == k)&#123;</span><br><span class="line">            st[p] += x;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(k &lt;= mid) <span class="built_in">add</span>(ls[p], l, mid, k, x);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">add</span>(rs[p], mid + <span class="number">1</span>, r, k, x);</span><br><span class="line">        <span class="built_in">up</span>(p);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(R &lt; L) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(L &lt;= l &amp;&amp; r &lt;= R) <span class="keyword">return</span> st[p];</span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(L &lt;= mid) ans += <span class="built_in">query</span>(ls[p], l, mid, L, R);</span><br><span class="line">        <span class="keyword">if</span>(R &gt; mid) ans += <span class="built_in">query</span>(rs[p], mid + <span class="number">1</span>, r, L, R);</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;seg[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">vector&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt; E;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">TREE</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> head[maxn], par[manx], top = <span class="number">0</span>;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">star</span>&#123;</span><span class="keyword">int</span> to, next;&#125;;</span><br><span class="line">    star edge[maxn &lt;&lt; <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">TREE</span>()&#123;<span class="built_in">clr</span>(head, <span class="number">-1</span>); top = <span class="number">0</span>;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">        edge[top].to = v;</span><br><span class="line">        edge[top].next = head[u];</span><br><span class="line">        head[u] = top++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(vector&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt; &amp;E)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> e: E)&#123;</span><br><span class="line">            <span class="built_in">add</span>(e.first, e.second);</span><br><span class="line">            par[e.second] = e.first;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> mx[maxn], sze[maxn], vis[maxn], root = <span class="number">0</span>, S;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">getroot</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> par)</span></span>&#123;</span><br><span class="line">        sze[now] = <span class="number">1</span>; mx[now] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = head[now]; ~i; i = edge[i].next)&#123;</span><br><span class="line">            <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(to == par || vis[to]) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="built_in">getroot</span>(to, now);</span><br><span class="line">            sze[now] += sze[to];</span><br><span class="line">            mx[now] = <span class="built_in">max</span>(mx[now], sze[to]);</span><br><span class="line">        &#125;</span><br><span class="line">        mx[now] = <span class="built_in">max</span>(mx[now], S - sze[now]);</span><br><span class="line">        <span class="keyword">if</span>(mx[root] &gt; mx[now]) root = now;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å½“å‰åˆ†æ²»ä¸­å¿ƒä¸ºnowï¼Œå°é”ä½é€šå¾€parçš„è·¯å¾„ï¼Œå‡½æ•°è¿”å›é‡å¿ƒ</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">divide</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> par)</span></span>&#123;</span><br><span class="line">        root = <span class="number">0</span>; <span class="built_in">getroot</span>(now, par);</span><br><span class="line">        <span class="keyword">int</span> rt = root; vis[rt] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = head[rt]; ~i; i = edge[i].next)&#123;</span><br><span class="line">            <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(to == par || vis[to]) <span class="keyword">continue</span>;</span><br><span class="line">            S = sze[to];</span><br><span class="line">            E.<span class="built_in">push_back</span>(&#123;rt, <span class="built_in">divide</span>(to, rt)&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> rt;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å°†æ ‘é‡æ„ä¸ºç‚¹åˆ†æ ‘ï¼Œç‚¹åˆ†æ•°çš„è¾¹å­˜æ”¾åœ¨Eä¸­ï¼Œä¾›tree[1].addè°ƒç”¨ï¼›è¿”å›é‡æ„æ ‘çš„æ ¹</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">rebuild</span><span class="params">()</span></span>&#123;</span><br><span class="line">        S = mx[<span class="number">0</span>] = n;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">divide</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//åˆå§‹åŒ–dfnã€posæ•°ç»„ï¼Œå¾—åˆ°æ¯ä¸ªèŠ‚ç‚¹çš„æ·±åº¦dep</span></span><br><span class="line">    <span class="keyword">int</span> dfn[maxn &lt;&lt; <span class="number">1</span>], pos[manx], cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> dep[maxn];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> par)</span></span>&#123;</span><br><span class="line">        dfn[cnt] = now; pos[now] = cnt; cnt++;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = head[now]; ~i; i = edge[i].next)&#123;</span><br><span class="line">            <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(to == par) <span class="keyword">continue</span>;</span><br><span class="line">            dep[to] = dep[now] + <span class="number">1</span>;</span><br><span class="line">            <span class="built_in">dfs</span>(to, now);</span><br><span class="line">            dfn[cnt++] = now;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> st[maxn &lt;&lt; <span class="number">1</span>][N];</span><br><span class="line">    <span class="comment">//é€šè¿‡æ·±åº¦æ•°ç»„è·å–stè¡¨, stç»´æŠ¤åŒºé—´ä¸­æ·±åº¦æœ€å°çš„èŠ‚ç‚¹æ ‡å·</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">getst</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cnt; i++) st[i][<span class="number">0</span>] = dfn[i];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; N; j++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cnt; i++)&#123;</span><br><span class="line">                <span class="keyword">int</span> nxt = i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>));</span><br><span class="line">                <span class="keyword">if</span>(nxt &gt;= cnt) st[i][j] = st[i][j - <span class="number">1</span>];</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(dep[st[i][j - <span class="number">1</span>]] &lt; dep[st[nxt][j - <span class="number">1</span>]]) st[i][j] = st[i][j - <span class="number">1</span>];</span><br><span class="line">                <span class="keyword">else</span> st[i][j] = st[nxt][j - <span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//O1è·å–ä¸¤ç‚¹ä¹‹é—´çš„è·ç¦»</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getdis</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(x == y) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> l = <span class="built_in">min</span>(pos[x], pos[y]), r = <span class="built_in">max</span>(pos[x], pos[y]);</span><br><span class="line">        <span class="keyword">int</span> k = (<span class="keyword">int</span>)(<span class="built_in">log2</span>(r - l) + eps);</span><br><span class="line">        <span class="keyword">int</span> lca = st[l][k];</span><br><span class="line">        <span class="keyword">if</span>(dep[lca] &gt; dep[st[r - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k]]) lca = st[r - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k];</span><br><span class="line">        <span class="keyword">return</span> dep[x] + dep[y] - <span class="number">2</span> * dep[lca];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//è·å–å­æ ‘å¤§å°å¹¶åˆå§‹åŒ–çº¿æ®µæ ‘</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ini</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> par)</span></span>&#123;</span><br><span class="line">        sze[now] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = head[now]; ~i; i = edge[i].next)&#123;</span><br><span class="line">            <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(to == par) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="built_in">ini</span>(to, now);</span><br><span class="line">            sze[now] += sze[to];</span><br><span class="line">        &#125;</span><br><span class="line">        seg[<span class="number">0</span>].root[now] = seg[<span class="number">0</span>].<span class="built_in">build</span>(<span class="number">0</span>, sze[now]);</span><br><span class="line">        seg[<span class="number">1</span>].root[now] = seg[<span class="number">1</span>].<span class="built_in">build</span>(<span class="number">0</span>, sze[now] + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;tree[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¬¬kä¸ªåŸå¸‚ä¸Šå‘ç”Ÿxçš„å¢é‡ï¼Œå½“å‰å¤„ç†åˆ°nowèŠ‚ç‚¹ï¼Œä¿è¯nowèŠ‚ç‚¹ä¸€å®šæ˜¯kçš„ç¥–å…ˆ</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> k, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> dis = tree[<span class="number">0</span>].<span class="built_in">getdis</span>(now, k);</span><br><span class="line">    seg[<span class="number">0</span>].<span class="built_in">add</span>(seg[<span class="number">0</span>].root[now], <span class="number">0</span>, tree[<span class="number">1</span>].sze[now], dis, x);</span><br><span class="line">    <span class="keyword">if</span>(tree[<span class="number">1</span>].par[now])&#123;</span><br><span class="line">        dis = tree[<span class="number">0</span>].<span class="built_in">getdis</span>(tree[<span class="number">1</span>].par[now], k);</span><br><span class="line">        seg[<span class="number">1</span>].<span class="built_in">add</span>(seg[<span class="number">1</span>].root[now], <span class="number">0</span>, tree[<span class="number">1</span>].sze[now] + <span class="number">1</span>, dis, x);</span><br><span class="line">        <span class="built_in">add</span>(tree[<span class="number">1</span>].par[now], k, x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŸ¥è¯¢è·ç¦»kåŸå¸‚è·ç¦»å°äºç­‰äºxçš„ä»·å€¼å’Œï¼Œå½“å‰å¤„ç†åˆ°now</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> k, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> d = tree[<span class="number">0</span>].<span class="built_in">getdis</span>(now, k);</span><br><span class="line">    ans += seg[<span class="number">0</span>].<span class="built_in">query</span>(seg[<span class="number">0</span>].root[now], <span class="number">0</span>, tree[<span class="number">1</span>].sze[now], <span class="number">0</span>, x - d);</span><br><span class="line">    <span class="keyword">if</span>(tree[<span class="number">1</span>].par[now])&#123;</span><br><span class="line">        <span class="keyword">int</span> D = tree[<span class="number">0</span>].<span class="built_in">getdis</span>(tree[<span class="number">1</span>].par[now], k);</span><br><span class="line">        ans -= seg[<span class="number">1</span>].<span class="built_in">query</span>(seg[<span class="number">1</span>].root[now], <span class="number">0</span>, tree[<span class="number">1</span>].sze[now] + <span class="number">1</span>, <span class="number">0</span>, x - D);</span><br><span class="line">        ans += <span class="built_in">query</span>(tree[<span class="number">1</span>].par[now], k, x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//     Fastin;</span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;q);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, w + i);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> u, v; <span class="built_in">scnaf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">        tree[<span class="number">0</span>].<span class="built_in">add</span>(u, v); tree[<span class="number">0</span>].<span class="built_in">add</span>(v, u);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    tree[<span class="number">0</span>].<span class="built_in">getst</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> root = tree[<span class="number">0</span>].<span class="built_in">rebuild</span>();</span><br><span class="line">    tree[<span class="number">1</span>].<span class="built_in">add</span>(E);</span><br><span class="line"></span><br><span class="line">    tree[<span class="number">1</span>].<span class="built_in">ini</span>(root, <span class="number">0</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">add</span>(i, i, w[i]);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">whlie</span>(q--)&#123;</span><br><span class="line">        <span class="keyword">int</span> op, x, y; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;op, &amp;x, &amp;y);</span><br><span class="line">        x ^= ans; y ^= ans;</span><br><span class="line">        <span class="keyword">if</span>(op)&#123;</span><br><span class="line">            <span class="built_in">add</span>(x, x, y - w[x]);</span><br><span class="line">            w[x] = y;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans = <span class="built_in">query</span>(x, x, y));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ ‘ </tag>
            
            <tag> ç‚¹åˆ†æ ‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç‚¹åˆ†æ²»</title>
      <link href="/2021/02/01/%E7%82%B9%E5%88%86%E6%B2%BB/"/>
      <url>/2021/02/01/%E7%82%B9%E5%88%86%E6%B2%BB/</url>
      
        <content type="html"><![CDATA[<p>[toc]</p><span id="more"></span><h2 id="æ´›è°·-P3806"><a href="#æ´›è°·-P3806" class="headerlink" title="æ´›è°· P3806"></a><a href="https://www.luogu.com.cn/problem/P3806">æ´›è°· P3806</a></h2><p>ä»ä¸€é“ç»å…¸çš„ç‚¹åˆ†æ²»é—®é¢˜å…¥é—¨</p><p>ç»™å‡ºnä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œæ ‘ä¸Šçš„è¾¹æœ‰è¾¹æƒï¼Œè¿›è¡Œmæ¬¡æŸ¥è¯¢ï¼Œæ¯æ¬¡æŸ¥è¯¢ä¸€ä¸ªå€¼kï¼Œè¯¢é—®æ˜¯å¦å­˜åœ¨ä¸€æ¡ä¸¤ç‚¹é—´çš„è·¯å¾„ä½¿å¾—è·¯å¾„ä¸Šæƒå€¼å’Œä¸ºk</p><p>$n &lt;=10^4,m&lt;=10^2,k&lt;=10^7, w_i&lt;=10^4$</p><p>å› ä¸ºè¯¥é¢˜æœ‰å¤šç»„æŸ¥è¯¢ï¼Œå¯ä»¥è€ƒè™‘ä¸€æ¬¡ç‚¹åˆ†ååŒæ—¶å¯¹mæ¬¡æŸ¥è¯¢è¿›è¡Œå¤„ç†ï¼Œä¹Ÿå¯ä»¥è€ƒè™‘æ¯æ¬¡æŸ¥è¯¢éƒ½è¿›è¡Œä¸€æ¬¡ç‚¹åˆ†ã€‚æ—¶é—´å¤æ‚åº¦åŒä¸º$O(nmlogn)$ï¼Œä½†æ˜¯åè€…å› ä¸ºä¼šè¿›è¡Œè‹¥å¹²æ¬¡ç‚¹åˆ†ï¼Œæ‰€ä»¥å¸¸æ•°æ›´å¤§ã€‚</p><p>æ­¤å¤–ï¼Œä¸ºäº†èƒ½å¤Ÿ$O(nlogn)$åœ°è¿›è¡Œç»Ÿè®¡ï¼Œéœ€è¦å¼€è®¾æ¡¶æ¥åŠ é€Ÿç»Ÿè®¡ç»“æœã€‚å¦‚æœæ²¡æœ‰é‡‡ç”¨æ¡¶ï¼Œè€Œä½¿ç”¨äºŒåˆ†åºåˆ—ç­‰æ–¹æ³•ï¼Œé‚£ä¹ˆä¼šå¤šä¸Šä¸€ä¸ªlogï¼Œåº”è¯¥æ˜¯æ— æ³•é€šè¿‡3806è¿™é¢˜çš„ï¼Œä½†æ˜¯å¯¹äºä¸€äº›æŸ¥è¯¢çš„kæ›´å¤§çš„é¢˜ç›®ï¼ŒäºŒåˆ†ä»ç„¶æœ‰å¯å–ä¹‹å¤„ã€‚æ•…è¿™é‡Œä¹Ÿè´´ä¸Šä¸€ä»½ä¸èƒ½AC3806ä½†æ˜¯å¯èƒ½ä»æœ‰ç”¨æ­¦ä¹‹å¤„çš„$O(nmlog^2n)$çš„ä»£ç ï¼ˆèƒ½é¡ºåˆ©ACæ‰€æœ‰éTLEçš„ç‚¹ï¼Œä½†æ˜¯æ­£ç¡®æ€§ä»éœ€æ›´å¼ºçš„æ£€éªŒï¼Œä½¿ç”¨æ—¶åº”æ›´åŠ è°¨æ…ï¼‰</p><h3 id="O-nmlog-2n-ä»£ç -ä¸å¼€æ¡¶"><a href="#O-nmlog-2n-ä»£ç -ä¸å¼€æ¡¶" class="headerlink" title="$O(nmlog^2n)$ä»£ç  ä¸å¼€æ¡¶"></a>$O(nmlog^2n)$ä»£ç  ä¸å¼€æ¡¶</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, k;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">star</span>&#123;</span><span class="keyword">int</span> to, next, w;&#125;;</span><br><span class="line"><span class="keyword">int</span> head[maxn], top = <span class="number">0</span>;</span><br><span class="line">star edge[maxn &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    edge[top].w = w;</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è°ƒç”¨getrootå‰åº”è¯¥åˆå§‹åŒ–Sï¼ï¼ï¼</span></span><br><span class="line"><span class="keyword">int</span> root = <span class="number">0</span>, S;</span><br><span class="line"><span class="keyword">int</span> vis[maxn], sze[maxn], mx[maxn];;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getroot</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> par)</span></span>&#123;</span><br><span class="line">    sze[u] = <span class="number">1</span>; mx[u] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = haed[u]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(vis[to] || to == par) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">getroot</span>(to, u);</span><br><span class="line">        sze[u] += sze[to];</span><br><span class="line">        mx[u] = <span class="built_in">max</span>(mx[u], sze[to]);</span><br><span class="line">    &#125;</span><br><span class="line">    mx[u] = <span class="built_in">max</span>(mx[u], S - sze[u]);</span><br><span class="line">    <span class="keyword">if</span>(mx[u] &lt; mx[root]) root = u;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vector&lt;ll&gt; dis;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> par, ll d)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[u]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(vis[to] || to == par) <span class="keyword">continue</span>;</span><br><span class="line">        dis.<span class="built_in">push_back</span>(&#123;d + edge[i].w&#125;);</span><br><span class="line">        <span class="built_in">dfs</span>(to, u, d + edge[i].w);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getcnt</span><span class="params">(ll x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">int</span>)(<span class="built_in">upper_bound</span>(dis.<span class="built_in">begin</span>(), dis.<span class="built_in">end</span>(), x) - <span class="built_in">lower_bound</span>(dis.<span class="built_in">begin</span>(), dis.<span class="built_in">end</span>(), x));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è·å–ç»è¿‡uçš„ç­”æ¡ˆï¼Œè·¯å¾„é•¿åº¦æœ‰åŸºç¡€åç§»å€¼d</span></span><br><span class="line"><span class="function">ll <span class="title">fun</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    dis.<span class="built_in">clear</span>(); dis.<span class="built_in">push_back</span>(d); <span class="built_in">dfs</span>(u, <span class="number">0</span>, d);</span><br><span class="line">    <span class="built_in">sort</span>(dis.<span class="built_in">begin</span>(), dis.<span class="built_in">end</span>());</span><br><span class="line">    <span class="comment">//ä¸¤æ¡é•¿åº¦ç›¸åŒçš„è·¯å¾„å’Œk</span></span><br><span class="line">    <span class="keyword">if</span>(k % <span class="number">2</span> == <span class="number">0</span>)&#123;</span><br><span class="line">        ll temp = <span class="built_in">getcnt</span>(k / <span class="number">2</span>);</span><br><span class="line">        ans += temp * (temp - <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">     &#125;</span><br><span class="line">    <span class="comment">//ä¸¤æ¡é•¿åº¦ä¸åŒçš„è·¯å¾„å’Œä¸ºk</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>)dis.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(dis[i] + dis[i] &gt;= k) <span class="keyword">break</span>;</span><br><span class="line">        ans += <span class="built_in">getcnt</span>(k - dis[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//uæ˜¯é‡å¿ƒï¼Œè€ƒå¯Ÿä»¥ç»è¿‡uçš„è·¯å¾„é•¿åº¦</span></span><br><span class="line"><span class="function">ll <span class="title">sove</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">    <span class="comment">//å°é”uèŠ‚ç‚¹ï¼Œåˆ†æ²»åœ°å¯»æ‰¾å­æ ‘.</span></span><br><span class="line">    vis[u] = <span class="number">1</span>; ll ans = <span class="built_in">fun</span>(u, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[u]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(vis[to]) <span class="keyword">continue</span>;</span><br><span class="line">        ans -= <span class="built_in">fun</span>(to, edge[i].w);</span><br><span class="line"></span><br><span class="line">        S = sze[to]; root = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">getroot</span>(to, u);</span><br><span class="line">        ans += <span class="built_in">sove</span>(root);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="built_in">clr</span>(head, <span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> n, m; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> u, v, w; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;u, &amp;v, &amp;w);</span><br><span class="line">        <span class="built_in">add</span>(u, v, w); <span class="built_in">add</span>(v, u, w);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    mx[<span class="number">0</span>] = n; root = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(m--)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;k);</span><br><span class="line">        S = n; <span class="built_in">clr</span>(vis, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">getroot</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        ll ans = <span class="built_in">sove</span>(root);</span><br><span class="line">        <span class="built_in">puts</span>(ans? <span class="string">&quot;AYE&quot;</span>: <span class="string">&quot;NAY&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="O-nmlogn-è¿›è¡Œmæ¬¡ç‚¹åˆ†æ²»-å¼€æ¡¶-å¸¸æ•°è¾ƒå¤§"><a href="#O-nmlogn-è¿›è¡Œmæ¬¡ç‚¹åˆ†æ²»-å¼€æ¡¶-å¸¸æ•°è¾ƒå¤§" class="headerlink" title="$O(nmlogn)$ è¿›è¡Œmæ¬¡ç‚¹åˆ†æ²» å¼€æ¡¶ å¸¸æ•°è¾ƒå¤§"></a>$O(nmlogn)$ è¿›è¡Œmæ¬¡ç‚¹åˆ†æ²» å¼€æ¡¶ å¸¸æ•°è¾ƒå¤§</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, k;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">star</span>&#123;</span><span class="keyword">int</span> to, next, w;&#125;;</span><br><span class="line"><span class="keyword">int</span> head[maxn], top = <span class="number">0</span>;</span><br><span class="line">star edge[maxn &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    edge[top].w = w;</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è°ƒç”¨getrootå‰åº”è¯¥åˆå§‹åŒ–Sï¼ï¼ï¼</span></span><br><span class="line"><span class="keyword">int</span> root = <span class="number">0</span>, S;</span><br><span class="line"><span class="keyword">int</span> vis[maxn], sze[maxn], mx[maxn];;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getroot</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> par)</span></span>&#123;</span><br><span class="line">    sze[u] = <span class="number">1</span>; mx[u] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = haed[u]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(vis[to] || to == par) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">getroot</span>(to, u);</span><br><span class="line">        sze[u] += sze[to];</span><br><span class="line">        mx[u] = <span class="built_in">max</span>(mx[u], sze[to]);</span><br><span class="line">    &#125;</span><br><span class="line">    mx[u] = <span class="built_in">max</span>(mx[u], S - sze[u]);</span><br><span class="line">    <span class="keyword">if</span>(mx[u] &lt; mx[root]) root = u;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; dis;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> par, <span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(d &gt; k) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[u]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(vis[to] || to == par) <span class="keyword">continue</span>;</span><br><span class="line">        dis.<span class="built_in">push_back</span>(d + edge[i].w);</span><br><span class="line">        <span class="built_in">dfs</span>(to, u, d + edge[i].w);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ ¹æ®é¢˜ç›®çš„æ•°æ®èŒƒå›´è¿›è¡Œä¿®æ”¹ï¼</span></span><br><span class="line"><span class="keyword">int</span> tong[<span class="number">10000010</span>];</span><br><span class="line"><span class="comment">//è·å–ç»è¿‡uçš„ç­”æ¡ˆï¼Œè·¯å¾„é•¿åº¦æœ‰åŸºç¡€åç§»å€¼d</span></span><br><span class="line"><span class="function">ll <span class="title">fun</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    dis.<span class="built_in">clear</span>(); dis.<span class="built_in">push_back</span>(d); <span class="built_in">dfs</span>(u, <span class="number">0</span>, d);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>)dis.<span class="built_in">size</span>(); i++) <span class="keyword">if</span>(dis[i] &lt;= k) tong[dis[i]]++;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>)dis.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(dis[i] + dis[i] &lt; k) ans += tong[k - dis[i]];</span><br><span class="line">        <span class="keyword">if</span>(dis[i] + dis[i] == k) ans += tong[dis[i]] - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>)dis.<span class="built_in">size</span>(); i++) <span class="keyword">if</span>(dis[i] &lt;= k) tong[dis[i]]--;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//uæ˜¯é‡å¿ƒï¼Œè€ƒå¯Ÿä»¥ç»è¿‡uçš„è·¯å¾„é•¿åº¦</span></span><br><span class="line"><span class="function">ll <span class="title">sove</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">    <span class="comment">//å°é”uèŠ‚ç‚¹ï¼Œåˆ†æ²»åœ°å¯»æ‰¾å­æ ‘.</span></span><br><span class="line">    vis[u] = <span class="number">1</span>; ll ans = <span class="built_in">fun</span>(u, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[u]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(vis[to]) <span class="keyword">continue</span>;</span><br><span class="line">        ans -= <span class="built_in">fun</span>(to, edge[i].w);</span><br><span class="line"></span><br><span class="line">        S = sze[to]; root = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">getroot</span>(to, u);</span><br><span class="line">        ans += <span class="built_in">sove</span>(root);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="built_in">clr</span>(head, <span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> n, m; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> u, v, w; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;u, &amp;v, &amp;w);</span><br><span class="line">        <span class="built_in">add</span>(u, v, w); <span class="built_in">add</span>(v, u, w);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    mx[<span class="number">0</span>] = n; root = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(m--)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;k);</span><br><span class="line">        S = n; <span class="built_in">clr</span>(vis, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">getroot</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        ll ans = <span class="built_in">sove</span>(root);</span><br><span class="line">        <span class="built_in">puts</span>(ans? <span class="string">&quot;AYE&quot;</span>: <span class="string">&quot;NAY&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="O-nmlogn-ä¸€æ¬¡ç‚¹åˆ†æ²»-åŒæ—¶å¤„ç†mæ¬¡è¯¢é—®-å¼€æ¡¶-å¸¸æ•°è¾ƒå°-AC"><a href="#O-nmlogn-ä¸€æ¬¡ç‚¹åˆ†æ²»-åŒæ—¶å¤„ç†mæ¬¡è¯¢é—®-å¼€æ¡¶-å¸¸æ•°è¾ƒå°-AC" class="headerlink" title="$O(nmlogn)$ ä¸€æ¬¡ç‚¹åˆ†æ²» åŒæ—¶å¤„ç†mæ¬¡è¯¢é—® å¼€æ¡¶ å¸¸æ•°è¾ƒå° (AC)"></a>$O(nmlogn)$ ä¸€æ¬¡ç‚¹åˆ†æ²» åŒæ—¶å¤„ç†mæ¬¡è¯¢é—® å¼€æ¡¶ å¸¸æ•°è¾ƒå° (AC)</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">star</span>&#123;</span><span class="keyword">int</span> to, next, w;&#125;;</span><br><span class="line"><span class="keyword">int</span> head[maxn], top = <span class="number">0</span>;</span><br><span class="line">star edge[maxn &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    edge[top].w = w;</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è°ƒç”¨getrootå‰åº”è¯¥åˆå§‹åŒ–Sï¼ï¼ï¼</span></span><br><span class="line"><span class="keyword">int</span> root = <span class="number">0</span>, S;</span><br><span class="line"><span class="keyword">int</span> vis[maxn], sze[maxn], mx[maxn];;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getroot</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> par)</span></span>&#123;</span><br><span class="line">    sze[u] = <span class="number">1</span>; mx[u] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = haed[u]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(vis[to] || to == par) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">getroot</span>(to, u);</span><br><span class="line">        sze[u] += sze[to];</span><br><span class="line">        mx[u] = <span class="built_in">max</span>(mx[u], sze[to]);</span><br><span class="line">    &#125;</span><br><span class="line">    mx[u] = <span class="built_in">max</span>(mx[u], S - sze[u]);</span><br><span class="line">    <span class="keyword">if</span>(mx[u] &lt; mx[root]) root = u;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; dis;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> par, <span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(d &gt; <span class="number">10000000</span>) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[u]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(vis[to] || to == par) <span class="keyword">continue</span>;</span><br><span class="line">        dis.<span class="built_in">push_back</span>(d + edge[i].w);</span><br><span class="line">        <span class="built_in">dfs</span>(to, u, d + edge[i].w);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> tong[<span class="number">10000010</span>];</span><br><span class="line"><span class="keyword">int</span> k[maxn], ans[maxn];</span><br><span class="line"><span class="comment">//è·å–ç»è¿‡uçš„ç­”æ¡ˆï¼Œè·¯å¾„é•¿åº¦æœ‰åŸºç¡€åç§»å€¼d</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fun</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> d, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    dis.<span class="built_in">clear</span>(); dis.<span class="built_in">push_back</span>(d); <span class="built_in">dfs</span>(u, <span class="number">0</span>, d);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>)dis.<span class="built_in">size</span>(); i++) <span class="keyword">if</span>(dis[i] &lt;= <span class="number">10000000</span>) tong[dis[i]]++;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>)dis.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; m; j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(dis[i] + dis[i] &lt; k[j]) ans[j] += (tong[k[j] - dis[i]]) * x;</span><br><span class="line">            <span class="keyword">if</span>(dis[i] + dis[i] == k[j]) ans[j] += (tong[dis[i]] - <span class="number">1</span>) * x;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>)dis.<span class="built_in">size</span>(); i++) <span class="keyword">if</span>(dis[i] &lt;= <span class="number">10000000</span>) tong[dis[i]]--;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//uæ˜¯é‡å¿ƒï¼Œè€ƒå¯Ÿä»¥ç»è¿‡uçš„è·¯å¾„é•¿åº¦</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sove</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">    <span class="comment">//å°é”uèŠ‚ç‚¹ï¼Œåˆ†æ²»åœ°å¯»æ‰¾å­æ ‘.</span></span><br><span class="line">    vis[u] = <span class="number">1</span>; <span class="built_in">fun</span>(u, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[u]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(vis[to]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">fun</span>(to, edge[i].w, <span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">        S = sze[to]; root = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">getroot</span>(to, u);</span><br><span class="line">        <span class="built_in">sove</span>(root);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="built_in">clr</span>(head, <span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> u, v, w; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;u, &amp;v, &amp;w);</span><br><span class="line">        <span class="built_in">add</span>(u, v, w); <span class="built_in">add</span>(v, u, w);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, k + i);</span><br><span class="line"></span><br><span class="line">    mx[<span class="number">0</span>] = n; root = <span class="number">0</span>;</span><br><span class="line">    S = n; <span class="built_in">clr</span>(vis, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">getroot</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">sove</span>(root);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) <span class="built_in">puts</span>(ans[i]? <span class="string">&quot;AYE&quot;</span>: <span class="string">&quot;NAY&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æœ¬åœ°æµ‹è¯•æ´›è°·æä¾›çš„æœ€å¤§çš„æ•°æ®è·‘äº†1sï¼Œè€Œä¹‹å‰çš„mæ¬¡ç‚¹åˆ†æ²»è·‘äº†3sï¼›è€Œåœ¨ojä¸Šåˆ™ä»371msåŠ é€Ÿåˆ°48ms</p><p><del>è¿˜è¯´ä¸å¡å¸¸ï¼è¿˜è¯´ä¸å¡å¸¸ï¼</del></p><h2 id="VK-Cup-2012-Round-1-D"><a href="#VK-Cup-2012-Round-1-D" class="headerlink" title="VK Cup 2012 Round 1 D"></a><a href="http://codeforces.com/problemset/problem/161/D">VK Cup 2012 Round 1 D</a></h2><p>æŸ¥è¯¢æ ‘ä¸Šç»è¿‡è¾¹æ•°æ°ä¸ºkçš„ä¸¤ç‚¹è·¯å¾„æ•°é‡ï¼Œ$<u, v>$ä¸$<v, u>$è®¡æ•°æ—¶è§†ä¸ºåŒä¸€å¯¹ç‚¹ã€‚</p><p>ç¨å¾®æ”¹ä¸€ä¸‹æ´›è°·çš„æ¿å­å³å¯ã€‚æ³¨æ„æ¡¶çš„èŒƒå›´ï¼Œç‚¹æ•°maxn</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">5e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, k;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">star</span>&#123;</span><span class="keyword">int</span> to, next;&#125;;</span><br><span class="line"><span class="keyword">int</span> head[maxn], top = <span class="number">0</span>;</span><br><span class="line">star edge[maxn &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è°ƒç”¨getrootå‰åº”è¯¥åˆå§‹åŒ–Sï¼ï¼ï¼</span></span><br><span class="line"><span class="keyword">int</span> root = <span class="number">0</span>, S;</span><br><span class="line"><span class="keyword">int</span> vis[maxn], sze[maxn], mx[maxn];;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getroot</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> par)</span></span>&#123;</span><br><span class="line">    sze[u] = <span class="number">1</span>; mx[u] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = haed[u]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(vis[to] || to == par) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">getroot</span>(to, u);</span><br><span class="line">        sze[u] += sze[to];</span><br><span class="line">        mx[u] = <span class="built_in">max</span>(mx[u], sze[to]);</span><br><span class="line">    &#125;</span><br><span class="line">    mx[u] = <span class="built_in">max</span>(mx[u], S - sze[u]);</span><br><span class="line">    <span class="keyword">if</span>(mx[u] &lt; mx[root]) root = u;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; dis;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> par, <span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(d &gt; k) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[u]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(vis[to] || to == par) <span class="keyword">continue</span>;</span><br><span class="line">        dis.<span class="built_in">push_back</span>(d + <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">dfs</span>(to, u, d + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ ¹æ®é¢˜ç›®çš„æ•°æ®èŒƒå›´è¿›è¡Œä¿®æ”¹ï¼</span></span><br><span class="line"><span class="keyword">int</span> tong[<span class="number">50010</span>];</span><br><span class="line"><span class="comment">//è·å–ç»è¿‡uçš„ç­”æ¡ˆï¼Œè·¯å¾„é•¿åº¦æœ‰åŸºç¡€åç§»å€¼d</span></span><br><span class="line"><span class="function">ll <span class="title">fun</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    dis.<span class="built_in">clear</span>(); dis.<span class="built_in">push_back</span>(d); <span class="built_in">dfs</span>(u, <span class="number">0</span>, d);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>)dis.<span class="built_in">size</span>(); i++) <span class="keyword">if</span>(dis[i] &lt;= k) tong[dis[i]]++;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>)dis.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(dis[i] + dis[i] &lt; k) ans += tong[k - dis[i]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(k % <span class="number">2</span> == <span class="number">0</span> &amp;&amp; tong[k / <span class="number">2</span>]) ans += tong[k / <span class="number">2</span>] * <span class="number">1ll</span> * (tong[k / <span class="number">2</span>] - <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>)dis.<span class="built_in">size</span>(); i++) <span class="keyword">if</span>(dis[i] &lt;= k) tong[dis[i]]--;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//uæ˜¯é‡å¿ƒï¼Œè€ƒå¯Ÿä»¥ç»è¿‡uçš„è·¯å¾„é•¿åº¦</span></span><br><span class="line"><span class="function">ll <span class="title">sove</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">    <span class="comment">//å°é”uèŠ‚ç‚¹ï¼Œåˆ†æ²»åœ°å¯»æ‰¾å­æ ‘.</span></span><br><span class="line">    vis[u] = <span class="number">1</span>; ll ans = <span class="built_in">fun</span>(u, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[u]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(vis[to]) <span class="keyword">continue</span>;</span><br><span class="line">        ans -= <span class="built_in">fun</span>(to, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        S = sze[to]; root = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">getroot</span>(to, u);</span><br><span class="line">        ans += <span class="built_in">sove</span>(root);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="built_in">clr</span>(head, <span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;k);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> u, v; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">        <span class="built_in">add</span>(u, v); <span class="built_in">add</span>(v, u);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    mx[<span class="number">0</span>] = n; root = <span class="number">0</span>;</span><br><span class="line">    S = n; <span class="built_in">clr</span>(vis, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">getroot</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    ll ans = <span class="built_in">sove</span>(root);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="P2634"><a href="#P2634" class="headerlink" title="P2634"></a>P2634</h2><p>æŸ¥è¯¢è·¯å¾„é•¿åº¦ä¸ºä¸‰çš„å€æ•°çš„æ•°é‡</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">2e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">star</span>&#123;</span><span class="keyword">int</span> to, next, w;&#125;;</span><br><span class="line"><span class="keyword">int</span> head[maxn], top = <span class="number">0</span>;</span><br><span class="line">star edge[maxn &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, itn w)</span></span>&#123;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    edge[top].w = w;</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è°ƒç”¨getrootå‰åº”è¯¥åˆå§‹åŒ–Sï¼ï¼ï¼</span></span><br><span class="line"><span class="keyword">int</span> root = <span class="number">0</span>, S;</span><br><span class="line"><span class="keyword">int</span> vis[maxn], sze[maxn], mx[maxn];;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getroot</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> par)</span></span>&#123;</span><br><span class="line">    sze[u] = <span class="number">1</span>; mx[u] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = haed[u]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(vis[to] || to == par) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">getroot</span>(to, u);</span><br><span class="line">        sze[u] += sze[to];</span><br><span class="line">        mx[u] = <span class="built_in">max</span>(mx[u], sze[to]);</span><br><span class="line">    &#125;</span><br><span class="line">    mx[u] = <span class="built_in">max</span>(mx[u], S - sze[u]);</span><br><span class="line">    <span class="keyword">if</span>(mx[u] &lt; mx[root]) root = u;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ ¹æ®éœ€è¦çš„æ˜¯è¾¹æ•°è¿˜æ˜¯è¾¹æƒä¿®æ”¹1/edge[i].w</span></span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; dis;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> par, <span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[u]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(vis[to] || to == par) <span class="keyword">continue</span>;</span><br><span class="line">        dis.<span class="built_in">push_back</span>(d + edge[i].w);</span><br><span class="line">        <span class="built_in">dfs</span>(to, u, d + edge[i].w);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ ¹æ®é¢˜ç›®çš„æ•°æ®èŒƒå›´è¿›è¡Œä¿®æ”¹ï¼</span></span><br><span class="line"><span class="keyword">int</span> tong[<span class="number">3</span>];</span><br><span class="line"><span class="comment">//è·å–ç»è¿‡uçš„ç­”æ¡ˆï¼Œè·¯å¾„é•¿åº¦æœ‰åŸºç¡€åç§»å€¼d</span></span><br><span class="line"><span class="function">ll <span class="title">fun</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    dis.<span class="built_in">clear</span>(); dis.<span class="built_in">push_back</span>(d); <span class="built_in">dfs</span>(u, <span class="number">0</span>, d);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>)dis.<span class="built_in">size</span>(); i++) tong[dis[i] % <span class="number">3</span>]++;</span><br><span class="line">    </span><br><span class="line">    ans += tong[<span class="number">0</span>] * <span class="number">1ll</span> * tong[<span class="number">0</span>] + tong[<span class="number">1</span>] * tong[<span class="number">2</span>] * <span class="number">2</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">clr</span>(tong, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//uæ˜¯é‡å¿ƒï¼Œè€ƒå¯Ÿä»¥ç»è¿‡uçš„è·¯å¾„é•¿åº¦</span></span><br><span class="line"><span class="function">ll <span class="title">sove</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">    <span class="comment">//å°é”uèŠ‚ç‚¹ï¼Œåˆ†æ²»åœ°å¯»æ‰¾å­æ ‘.</span></span><br><span class="line">    vis[u] = <span class="number">1</span>; ll ans = <span class="built_in">fun</span>(u, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[u]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(vis[to]) <span class="keyword">continue</span>;</span><br><span class="line">        ans -= <span class="built_in">fun</span>(to, edge[i].w % <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">        S = sze[to]; root = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">getroot</span>(to, u);</span><br><span class="line">        ans += <span class="built_in">sove</span>(root);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="built_in">clr</span>(head, <span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> u, v, w; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;u, &amp;v, &amp;w);</span><br><span class="line">        <span class="built_in">add</span>(u, v, w); <span class="built_in">add</span>(v, u, w);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    mx[<span class="number">0</span>] = n; root = <span class="number">0</span>;</span><br><span class="line">    S = n; <span class="built_in">clr</span>(vis, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">getroot</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    ll ans = <span class="built_in">sove</span>(root);</span><br><span class="line">    ll d = <span class="built_in">gcd</span>(ans, n * <span class="number">1ll</span> * n);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld/%lld\n&quot;</span>, ans / d, n * <span class="number">1ll</span> * n / d);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>å½“å¤„ç†ä¸€äº›ä¸å­æ ‘æœ‰å…³çš„é—®é¢˜æ—¶ï¼Œå¯ä»¥é‡‡ç”¨ç‚¹åˆ†æ²»ï¼Œæ¯”è¾ƒå…¸å‹çš„é—®é¢˜å°±æ˜¯å¯¹æ ‘ä¸Šæ»¡è¶³ç‰¹å®šé™åˆ¶çš„è·¯å¾„çš„è®¡æ•°ã€‚</p><p>åœ¨ç‚¹åˆ†æ²»æ—¶ï¼Œæ¯æ¬¡é€šè¿‡é€‰å–å­æ ‘çš„é‡å¿ƒå°†å½“å‰å­æ ‘è¿›è¡Œåˆ’åˆ†ï¼Œä»è€Œå¯ä»¥åœ¨å­æ ‘ä¹‹é—´è¿›è¡Œå¤æ‚åº¦è¾ƒä¸ºä¼˜ç§€çš„ä¸€ç³»åˆ—æ“ä½œã€‚</p><h2 id="å°é—®é¢˜"><a href="#å°é—®é¢˜" class="headerlink" title="å°é—®é¢˜"></a>å°é—®é¢˜</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(sze[to] &lt; sze[u]) S = sze[to];</span><br><span class="line"><span class="keyword">else</span> S = sze[to] - sze[u];</span><br></pre></td></tr></table></figure><p>åœ¨æ›´æ–°å­æ ‘å¤§å°çš„æ—¶å€™æŒ‰é“ç†åº”è¯¥è¿™æ ·æ‰å¯¹ï¼Ÿï¼Ÿ</p><p>ä¸ºä½•æ´›è°·ä¸Šåƒç¯‡ä¸€å¾‹çš„æ˜¯ç›´æ¥<code>S=sze[to]</code>ï¼Ÿè«éå¯¹æ€»çš„æ—¶é—´å¤æ‚åº¦æ²¡æœ‰è¿‡å¤šçš„å½±å“ï¼Ÿ</p><p>ä¿®æ”¹è¿™ä¸€å¤„åå†æ¬¡æäº¤ä»æ˜¯TLEçš„TLEã€ACçš„ACâ€¦éå¸¸çš„ç¥ç§˜</p>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ ‘ </tag>
            
            <tag> ç‚¹åˆ†æ²» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cdqåˆæ­¥</title>
      <link href="/2021/02/01/cdq%E5%88%9D%E6%AD%A5/"/>
      <url>/2021/02/01/cdq%E5%88%9D%E6%AD%A5/</url>
      
        <content type="html"><![CDATA[<p>cdqåˆ†æ²» ä¸‰ç»´ååºé—®é¢˜</p><span id="more"></span><p><a href="http://rqdmap.top/2021/01/28/2020-2021Brazil-Subregional-Programming-Contest/#more">èµ·å›  åŠ¨æ€çš„åŒºé—´é‡å æŸ¥è¯¢</a></p><p>åœ¨åˆ†äº«é¢˜ç›®çš„æ—¶å€™å¬é—»æœ‰åŒå­¦è¯´cdqåˆ†æ²»ï¼Œä¹‹åä¾¿å»ç ”ç©¶äº†ä¸€ç•ªï¼Œå‘ç°cdqåˆ†æ²»çš„æ€æƒ³ä¸ä¹‹å‰è¿™é“åŠ¨æ€çš„åŒºé—´é‡å æŸ¥è¯¢æœ‰ç€å¼‚æ›²åŒå·¥ä¹‹å¦™ã€‚</p><p>ä»¥ç»å…¸çš„<a href="https://www.luogu.com.cn/problem/P3810">ä¸‰ç»´ååº</a>ä¸ºä¾‹ã€‚</p><p>å¯¹ä¸‰ä¸ªå€¼æŒ‰ç…§ç¬¬ä¸€ã€ç¬¬äºŒã€ç¬¬ä¸‰ä¼˜å…ˆçº§çš„é¡ºåºè¿›è¡Œå‡åºæ’åºï¼Œåœ¨æ’å¥½åºçš„æ–°åºåˆ—ä¸Šè¿›è¡Œ<strong>â€œå½’å¹¶â€</strong>ï¼Œå‡è®¾å½“å‰å¯¹åŒºé—´$[l, r]$è¿›è¡Œå½’å¹¶ã€‚é‚£ä¹ˆç”±äºæˆ‘ä»¬çš„<strong>è‰¯å¥½çš„æ’åºè§„åˆ™</strong>ï¼Œå¯ä»¥ä¿è¯$[mid + 1, r]$ä¸­çš„ä¸‰å…ƒç»„ä¸€å®šä¸ä¼šå¯¹åŒºé—´$[l, mid]$ä¸­çš„ä¸‰å…ƒç»„äº§ç”Ÿè´¡çŒ®ã€‚æ¢è¨€ä¹‹ï¼Œå¯èƒ½äº§ç”Ÿè´¡çŒ®çš„ä¸‰å…ƒç»„ä»¬è¦ä¹ˆåŒæ—¶å­˜åœ¨äºæŸä¸ªå­åŒºé—´å†…ï¼Œè¦ä¹ˆæ˜¯å·¦åŒºé—´å¯¹å³åŒºé—´äº§ç”Ÿè´¡çŒ®ã€‚å› è€Œæˆ‘ä»¬è¿›è¡ŒåŒæŒ‡é’ˆå½’å¹¶æ’åºï¼Œæ’åºæ—¶ä¸æ–­æ¯”è¾ƒçš„æ˜¯ä¸‰å…ƒç»„çš„$y$å±æ€§ï¼Œè€Œæ’å…¥ä¸‰å…ƒç»„æ—¶ç»´æŠ¤ä¸€é¢—ä»¥ä¸‰å…ƒç»„çš„$z$å±æ€§æ„æˆçš„æ”¯æŒ<code>åŒºé—´åŠ ï¼ŒåŒºé—´æ¸…é›¶ï¼ŒåŒºé—´æŸ¥è¯¢å’Œ</code>çš„æƒå€¼çº¿æ®µæ ‘ï¼Œé€šè¿‡åœ¨æƒå€¼çº¿æ®µæ ‘ä¸Šä¸æ–­åœ°æ›´æ–°ã€æŸ¥è¯¢æ¥ç»´æŠ¤æœ€ç»ˆçš„ç­”æ¡ˆã€‚</p><p>æœ‰ä¸¤ä¸ªå€¼çš„æ³¨æ„çš„ç‚¹ï¼š</p><ul><li>å¯èƒ½ä¼šå‡ºç°é‡å¤å…ƒç´ ï¼Œå› è€Œæˆ‘ä»¬è¦å¯¹åŸå§‹ä¸‰å…ƒç»„åºåˆ—å»é‡ï¼Œç»™é‡å¤çš„ä¸‰å…ƒç»„åŠ ä¸€ä¸ªæƒå€¼ï¼Œæœ€ååœ¨è®¡ç®—ç­”æ¡ˆçš„æ—¶å€™åˆ†åˆ«å¯¹ç›¸åŒçš„ä¸‰å…ƒç»„ä¹‹é—´å’Œä¸åŒçš„ä¸‰å…ƒç»„ä¹‹é—´ç»Ÿè®¡ç­”æ¡ˆã€‚</li><li><strong>â€œè‰¯å¥½çš„æ’åºè§„åˆ™â€æ˜¯å¾ˆé‡è¦çš„</strong>ã€‚æœ€å¼€å§‹æŒ‰ç…§ä¸ªäººçš„ç†è§£ä»…ä»…æŒ‰ç…§ä¸‰å…ƒç»„çš„$x$å±æ€§è¿›è¡Œæ’åºï¼Œä½†æ˜¯è¿™æ ·å°±æ— æ³•ä¿è¯å½’å¹¶æ—¶å³å„¿å­ä¸€å®šä¸å¯¹å·¦å„¿å­åšè´¡çŒ®ï¼Œä»è€Œä½¿cdqåˆ†æ²»å¤±å»äº†æ ¹æœ¬çš„ç†è®ºä¿è¯ã€‚</li></ul><p>** è™½ç„¶å€Ÿæ­¤çŸ¥é“äº†å¯¹æ‰€æœ‰åˆ†é‡éƒ½ç»´æŠ¤é¡ºåºçš„åºåˆ—æ˜¯å¾ˆæœ‰å¿…è¦çš„ï¼Œä½†æ˜¯å›å¤´å†å»çœ‹åŒºé—´é‡å çš„é—®é¢˜ï¼Œä»ç„¶ä¸ç”šç†è§£å‡ºç°åœ¨é‚£é¢˜ä¸­çš„é—®é¢˜ã€‚å› ä¸ºåœ¨é‚£é¢˜ä¸­ä¸éœ€è¦è€ƒè™‘å·¦å³å„¿å­å½¼æ­¤çš„è´¡çŒ®ï¼Œè€Œä»…ä»…åªéœ€è¦ä¸€ä¸ªé¡ºåºæ¥å»ºæ ‘è€Œå·²ã€‚qaqç¥ç§˜</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ls (p &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rs ((p &lt;&lt; 1) | 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mid ((l + r) &gt;&gt; 1)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="comment">//æƒå€¼çº¿æ®µæ ‘: å•ç‚¹ç½®å€¼ï¼ŒåŒºé—´æŸ¥è¯¢</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ST</span>&#123;</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">int</span> st[maxn &lt;&lt; <span class="number">2</span>];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(l == r &amp;&amp; l == k)&#123;</span><br><span class="line">            st[p] += x; <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(k &lt;= mid) <span class="built_in">add</span>(ls, l, mid, k, x);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">add</span>(rs, mid + <span class="number">1</span>, r, k, x);</span><br><span class="line">        st[p] = st[ls] + st[rs];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">clear</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(l == r &amp;&amp; l == k)&#123;</span><br><span class="line">            st[p] = <span class="number">0</span>; <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(k &lt;= mid) <span class="built_in">clear</span>(ls, l, mid, k);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">clear</span>(rs, mid + <span class="number">1</span>, r, k);</span><br><span class="line">        st[p] = st[ls] + st[rs];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(L &lt;= l &amp;&amp; r &lt;= R) <span class="keyword">return</span> st[p];</span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(L &lt;= mid) ans += <span class="built_in">query</span>(ls, l, mid, L, R);</span><br><span class="line">        <span class="keyword">if</span>(R &gt; mid) ans += <span class="built_in">query</span>(rs, mid + <span class="number">1</span>, r, L, R);</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;st;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NODE</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> x, y, z, w;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> NODE&amp; b)<span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(x != b.x) <span class="keyword">return</span> x &lt; b.x;</span><br><span class="line">        <span class="keyword">if</span>(y != b.y) <span class="keyword">return</span> y &lt; b.y;</span><br><span class="line">        <span class="keyword">return</span> z &lt; b.z;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> == (<span class="keyword">const</span> NODE &amp;b)<span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x == b.x &amp;&amp; y == b.y &amp;&amp; z == b.z;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">read</span><span class="params">()</span></span>&#123;<span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;x, &amp;y, &amp;z); w = <span class="number">1</span>;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">prt</span><span class="params">()</span></span>&#123;<span class="built_in">printf</span>(<span class="string">&quot;(%d %d %d) : %d\n&quot;</span>, x, y, z, w);&#125;</span><br><span class="line">&#125;;</span><br><span class="line">NODE temp[maxn], node[maxn];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> f[maxn];</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; vec[maxn &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> j)</span></span>&#123;<span class="keyword">return</span> node[i].y &lt; node[j].y;&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sove</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l == r)&#123;</span><br><span class="line">        vec[p].<span class="built_in">push_back</span>(l);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sove</span>(ls, l, mid);</span><br><span class="line">    <span class="built_in">sove</span>(rs, mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(i &lt; mid - l + <span class="number">1</span> &amp;&amp; j &lt; r - mid)&#123;</span><br><span class="line">        <span class="keyword">if</span>(node[vec[ls][i]].y &lt;= node[vec[rs][j]].y)&#123;</span><br><span class="line">            st.<span class="built_in">add</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">200000</span>, node[vec[ls][i]].z, node[vec[ls][i]].w);</span><br><span class="line">            vec[p].<span class="built_in">push_back</span>(vec[ls][i]);</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            f[vec[rs][j]] += st.<span class="built_in">query</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">200000</span>, <span class="number">1</span>, node[vec[rs][j]].z);</span><br><span class="line">            vec[p].<span class="built_in">push_back</span>(vec[rs][j]);</span><br><span class="line">            j++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(i &lt; mid - l + <span class="number">1</span>)&#123;</span><br><span class="line">        st.<span class="built_in">add</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">200000</span>, node[vec[ls][i]].z, node[vec[ls][i]].w);</span><br><span class="line">        vec[p].<span class="built_in">push_back</span>(vec[ls][i]);</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(j &lt; r - mid)&#123;</span><br><span class="line">        f[vec[rs][j]] += st.<span class="built_in">query</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">200000</span>, <span class="number">1</span>, node[vec[rs][j]].z);</span><br><span class="line">        vec[p].<span class="built_in">push_back</span>(vec[rs][j]);</span><br><span class="line">        j++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> x: vec[p]) st.<span class="built_in">clear</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">200000</span>, node[x].z);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ans[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="keyword">int</span> n, d; <span class="built_in">scnaf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;d);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) temp[i].<span class="built_in">read</span>();</span><br><span class="line">    <span class="built_in">sort</span>(temp + <span class="number">1</span>, tmep + <span class="number">1</span> + n);</span><br><span class="line">    <span class="keyword">int</span> m = <span class="number">0</span>;</span><br><span class="line">    node[++m] = temp[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(temp[i] == temp[i - <span class="number">1</span>]) node[m].w++;</span><br><span class="line">        <span class="keyword">else</span> node[++m] = temp[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">sove</span>(<span class="number">1</span>, <span class="number">1</span>, m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) f[i] += node[i].w - <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">fro</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) ans[f[i]] += node[i].w;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åˆ†æ²» </tag>
            
            <tag> cdqåˆ†æ²» </tag>
            
            <tag> ä¸‰ç»´ååº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020-2021Brazil-Subregional-Programming-Contest</title>
      <link href="/2021/01/28/2020-2021Brazil-Subregional-Programming-Contest/"/>
      <url>/2021/01/28/2020-2021Brazil-Subregional-Programming-Contest/</url>
      
        <content type="html"><![CDATA[<p>[toc]</p><span id="more"></span><h2 id="M-çº¿æ®µæ ‘-amp-äºŒåˆ†-å¤„ç†å¹³é¢ä¸Šçš„ä¸€ç±»æŠ•å½±é—®é¢˜"><a href="#M-çº¿æ®µæ ‘-amp-äºŒåˆ†-å¤„ç†å¹³é¢ä¸Šçš„ä¸€ç±»æŠ•å½±é—®é¢˜" class="headerlink" title="M çº¿æ®µæ ‘ &amp; äºŒåˆ† å¤„ç†å¹³é¢ä¸Šçš„ä¸€ç±»æŠ•å½±é—®é¢˜"></a>M çº¿æ®µæ ‘ &amp; äºŒåˆ† å¤„ç†å¹³é¢ä¸Šçš„ä¸€ç±»æŠ•å½±é—®é¢˜</h2><p><a href="http://202.182.108.237/WT03-B-rand-rqdmap.pdf">é¢˜è§£</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> itn M = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, q;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SEG</span>&#123;</span></span><br><span class="line">    ll x, y;</span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> SEG &amp;b) <span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> y &lt; b.y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">SEG seg[maxn];</span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ls (p &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rs ((p &lt;&lt; 1) | 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mid ((l + r) &gt;&gt; 1)</span></span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NODE</span>&#123;</span></span><br><span class="line">    ll x; <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> NODE &amp;b) <span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x &gt; b.x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">vector&lt;NODE&gt; st[maxn &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l == r)&#123;</span><br><span class="line">        st[p].<span class="built_in">push_back</span>(&#123;seg[l].x, seg[l].id&#125;);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(l == r) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="built_in">build</span>(ls, l, mid); <span class="built_in">build</span>(rs, mid + <span class="number">1</span>, r);</span><br><span class="line">    st[p].<span class="built_in">resize</span>(r - l + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">merge</span>(st[ls].<span class="built_in">begin</span>(), st[ls].<span class="built_in">end</span>(), st[rs].<span class="built_in">begin</span>(), st[rs].<span class="built_in">end</span>(), st[p].<span class="built_in">begin</span>());</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//åœ¨seg[l] - seg[r]ä¸­æŸ¥è¯¢é‚£äº›ï¼šåºå·è‡³å°‘ä¸ºlim, ä¸”æœ‰å¯èƒ½æœ‰äº¤é›†çš„æ‰€æœ‰çº¿æ®µ</span></span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; res;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> lim, ll y0)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(r &lt; lim) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="comment">//å¦‚æœè¿™ä¸€æ®µåŒºé—´å…¨éƒ¨æ»¡è¶³ï¼ˆæ„å‘³ç€å³ç«¯ç‚¹ä¸€å®š &gt; y0)</span></span><br><span class="line">    <span class="keyword">if</span>(l &gt;= lim)&#123;</span><br><span class="line">        <span class="keyword">int</span> top = (<span class="keyword">int</span>)st[p].<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = top - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">            <span class="keyword">if</span>(st[p][i].x &gt; y0) <span class="keyword">break</span>;</span><br><span class="line">            res.<span class="built_in">push_back</span>(st[p][i].id);</span><br><span class="line">            cnt++;</span><br><span class="line">            <span class="built_in">assert</span>(cnt &lt;= <span class="number">2000000</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">query</span>(ls, l, mid, lim, y0);</span><br><span class="line">    <span class="built_in">query</span>(rs, mid + <span class="number">1</span>, r, lim, y0);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;q);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        ll x, y; <span class="built_in">scanf</span>(<span class="string">&quot;%lld %lld &quot;</span>, &amp;x, &amp;y); y *= <span class="number">2</span>;</span><br><span class="line">        seg[i].x = y - x; seg[i].y = y + x; seg[i].id = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(seg + <span class="number">1</span>, seg + n + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> e = <span class="number">5782344</span>; ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; q; i++)&#123;</span><br><span class="line">        ll a, b; <span class="built_in">scanf</span>(<span class="string">&quot;%lld %lld&quot;</span>, &amp;a, &amp;b);</span><br><span class="line">        ll x, y;</span><br><span class="line">        x = <span class="number">-1</span> - ((ans + a) % M);</span><br><span class="line">        y = (ans + b) % M; y *= <span class="number">2</span>;</span><br><span class="line">        SEG temp; temp.x = <span class="number">1ll</span> &lt;&lt; <span class="number">60</span>; temp.y = y +x; tmep.id = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">int</span> lim = (<span class="keyword">int</span>)(<span class="built_in">lower_bound</span>(seg + <span class="number">1</span>, seg + n + <span class="number">1</span>, temp) - seg);</span><br><span class="line">        </span><br><span class="line">        res.<span class="built_in">clear</span>();</span><br><span class="line">        <span class="built_in">query</span>(<span class="number">1</span>, <span class="number">1</span>, n, lim, y - x);</span><br><span class="line">        <span class="built_in">sort</span>(res.<span class="built_in">begin</span>(), res.<span class="built_in">end</span>(), greater&lt;<span class="keyword">int</span>&gt;());</span><br><span class="line">        ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> x: res) ans = (ans * e % M + x) % M;</span><br><span class="line">         </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ‰ä¸€ä¸ªç¥ç§˜çš„åœ°æ–¹ï¼ŒæŒ‰ç…§L8çš„æ’åºæ–¹æ³•å¯ä»¥ACï¼Œä½†æ˜¯å¦‚æœæ”¹åŠ¨æˆ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> SEG &amp;b) <span class="keyword">const</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(y != b.y) <span class="keyword">return</span> y &lt; b.y;</span><br><span class="line">  <span class="keyword">return</span> x &lt; b.x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°±ä¼šç¦»å¥‡TLEï¼Œç»è¿‡assertæ£€æŸ¥æ˜¯æŸ¥å‡ºæ¥çš„æ•Œå†›æ€»æ•°è¶…è¿‡é¢˜ç›®çš„é™åˆ¶ï¼Œä»è€ŒTLEã€‚</p><p>æŒ‰ç…§é“ç†æ¥è¯´ï¼Œå¦‚æœä»…ä»…æ¯”è¾ƒyéƒ½èƒ½å¤ŸACï¼Œé‚£ä¹ˆå†åŠ ä¸Šç¬¬äºŒä¼˜å…ˆçº§æ¯”è¾ƒxä¹Ÿåº”è¯¥èƒ½å¤ŸACï¼Œæ¯•ç«ŸåŠ ä¸Šç¬¬äºŒä¼˜å…ˆçº§åªæ˜¯ä»…ä»…æ¯”è¾ƒyçš„ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œç„¶è€Œå´å±…ç„¶å‘ç”Ÿäº†è¿™æ ·çš„äº‹æƒ…ï¼Œè‡³ä»Šä¸è§£ã€‚</p><p>link to <a href="http://rqdmap.top/2021/02/01/cdqåˆæ­¥/">cdqåˆ†æ²»</a></p>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çº¿æ®µæ ‘ </tag>
            
            <tag> äºŒåˆ† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>poj-1222</title>
      <link href="/2021/01/18/poj-1222/"/>
      <url>/2021/01/18/poj-1222/</url>
      
        <content type="html"><![CDATA[<p>ç»™å‡ºä¸€ä¸ª5*6çš„01çŸ©é˜µï¼Œæ¯æŒ‰ä¸€ä¸ªæ ¼ç‚¹å°±ä¼šå°†è¯¥æ ¼ç‚¹åŠå…¶4ä¸ªæ–¹å‘ä¸Šçš„æ ¼ç‚¹ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰æ•°å€¼ç¿»è½¬ï¼Œè¯•ç»™å‡ºä¸€ä¸ªæ–¹æ¡ˆä½¿å¾—æœ€ç»ˆæ‰€æœ‰æ ¼ç‚¹å‡ä¸º0.</p><span id="more"></span><p>é«˜æ–¯æ¶ˆå…ƒç»å…¸ä¾‹é¢˜ï¼Œæ‹¿æ¥æµ‹è¯•ä¸€ä¸‹è‡ªå·±çš„æ¨¡ç‰ˆæ˜¯å¦æ­£ç¡®ã€‚</p><p>è¿™é¢˜æ¯”è¾ƒç²¾å¦™çš„åœ°æ–¹åœ¨äºå»ºæ–¹ç¨‹ï¼šå˜å…ƒæœ‰30ä¸ªï¼Œåˆ†åˆ«ä»£è¡¨5*6çŸ©é˜µä¸­æ˜¯å¦æŒ‰ä¸‹æ¯ä¸€ä¸ªæŒ‰é’®ã€‚è€Œæ‰€æœ‰æ“ä½œå®Œæˆåæ¯ä¸ªæ ¼ç‚¹çš„çŠ¶æ€æ˜¾ç„¶å¯ä»¥ç”¨è¿™30ä¸ªå˜å…ƒè¿›è¡Œçº¿æ€§è¡¨ç¤ºã€‚ä¸è¿‡è¿™é‡Œçš„åŠ æ³•åº”è¯¥æ˜ å°„ä¸ºå¼‚æˆ–+ï¼Œç¨å¾®ä¿®æ”¹ä¸€ä¸‹æ¿å­å¹¶ä¸”æ³¨æ„å¤šç»„æ•°æ®å³å¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">ä½¿ç”¨æŒ‡å—ï¼š</span></span><br><span class="line"><span class="comment">    è¯»å…¥&quot;æ•´å½¢&quot;å¢å¹¿çŸ©é˜µaï¼Œä¿®æ”¹è¡Œåˆ—ä¿¡æ¯equã€varã€‚</span></span><br><span class="line"><span class="comment">    ä»é›¶å¼€å§‹ç¼–å·ï¼Œåˆ™è¡Œä¸º[0, equ - 1], åˆ—ä¸º[0, var];</span></span><br><span class="line"><span class="comment">    è¿”å›å€¼ï¼š</span></span><br><span class="line"><span class="comment">        è¿”å›0è¯´æ˜æœ‰æ•´æ•°è§£ï¼Œç»“æœå­˜æ”¾åœ¨xæ•°ç»„ä¸­</span></span><br><span class="line"><span class="comment">        è¿”å›-2è¯´æ˜æœ‰æµ®ç‚¹è§£ï¼Œéœ€è¦ä¿®æ”¹æ•°æ®ç±»å‹å†è¿ç®—</span></span><br><span class="line"><span class="comment">        è¿”å›-1æ—¶æ— è§£</span></span><br><span class="line"><span class="comment">        è¿”å›æ­£æ•°kæ—¶è¯´æ˜æœ‰kä¸ªè‡ªç”±å˜å…ƒï¼Œè‡ªç”±å˜å…ƒå­˜æ”¾åœ¨flagä¸­ï¼›</span></span><br><span class="line"><span class="comment">Tips:</span></span><br><span class="line"><span class="comment">    å¤„ç†è¿‡ç¨‹å¯èƒ½çˆ†int</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e2</span>;</span><br><span class="line"><span class="comment">//æœ‰equä¸ªç­‰å¼ï¼Œvarä¸ªå˜é‡ï¼Œé‚£ä¹ˆå¢å¹¿çŸ©é˜µæœ‰equè¡Œï¼Œvar + 1åˆ—ï¼›æ¨¡ç‰ˆä¸­ä»0å¼€å§‹æ ‡å·ã€‚</span></span><br><span class="line"><span class="keyword">int</span> equ, var;</span><br><span class="line"><span class="keyword">int</span> a[maxn][maxn];</span><br><span class="line"><span class="comment">//xæ˜¯è§£é›†ï¼Œflagæ ‡è®°æ˜¯å¦è‡ªç”±</span></span><br><span class="line"><span class="keyword">int</span> x[maxn], flag[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gauss</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, j;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>, j = <span class="number">0</span>; i &lt; equ &amp;&amp; j &lt; var; i++, j++)&#123;</span><br><span class="line">        <span class="keyword">int</span> l = i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k = i + <span class="number">1</span>; k &lt; equ; k++) <span class="keyword">if</span>(<span class="built_in">abs</span>(a[k][j] &gt; a[l][j])) l = k;</span><br><span class="line">        <span class="keyword">if</span>(l != i) <span class="built_in">swap</span>(a[l], a[i]);</span><br><span class="line">        <span class="comment">//iè¡ŒåŠä»¥ä¸‹çš„è¯¥åˆ—å…¨ä¸º0ï¼Œè½¬è€Œå¤„ç†ä¸‹ä¸€åˆ—ã€‚</span></span><br><span class="line">        <span class="keyword">if</span>(a[i][j] == <span class="number">0</span>)&#123;</span><br><span class="line">            i--; <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k = i + <span class="number">1</span>; k &lt; equ; k++) <span class="keyword">if</span>(a[k][j])&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> col = j; col &lt;= var; col++) a[k][col] = a[k][col] ^ a[i][col];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¾ªç¯å®Œæˆåï¼Œiæ˜¯æœ‰æ•ˆè¡Œæ•°ï¼Œä¹Ÿå°±æ˜¯ç§©ï¼ˆï¼Ÿï¼‰ï¼›</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//(I)å­˜åœ¨(0, 0, ... ,0, k!=0)çš„ç»“æ„å­˜åœ¨ï¼Œå³æ— è§£,è¿”å›-1</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> k = i; k &lt; equ; k++) <span class="keyword">if</span>(a[k][var] != <span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//(II)å­˜åœ¨è‡ªç”±å˜å…ƒï¼Œè¿”å›å˜å…ƒæ•°é‡ï¼Œå¹¶ä¸”åœ¨flagæ•°ç»„ä¸­æ ‡è®°å‡ºæ‰€æœ‰çš„è‡ªç”±å˜å…ƒã€‚</span></span><br><span class="line">    <span class="keyword">if</span>(j &lt; var)&#123;</span><br><span class="line">        <span class="comment">//iæ˜¯ç§©ï¼Œ[0, i - 1]å‡ä¸ºéå…¨é›¶çš„è¡Œ</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k = i - <span class="number">1</span>; k &gt;= <span class="number">0</span>; k--)&#123;</span><br><span class="line">            <span class="keyword">int</span> cnt = <span class="number">0</span>, free_id = <span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> col = <span class="number">0</span>; col &lt; var; col++) <span class="keyword">if</span>(a[k][col] &amp;&amp; flag[col])&#123;</span><br><span class="line">                cnt++;</span><br><span class="line">                free_id = col;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//ä¸€å®šå­˜åœ¨è‡³å°‘ä¸€ä¸ªè‡ªç”±å˜å…ƒï¼Œä¸ç„¶ä¸€å®šä¼šè¢«å‘ä¸‹è¿‡ç¨‹æ¶ˆå»ã€‚</span></span><br><span class="line">            <span class="built_in">assert</span>(free_id != <span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//æœ‰ä¸¤ä¸ªåŠä»¥ä¸Šå˜å…ƒï¼Œé‚£ä¹ˆæ— æ³•ç¡®å®šè¿™äº›å˜å…ƒ</span></span><br><span class="line">            <span class="keyword">if</span>(cnt &gt;= <span class="number">2</span>) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æ³¨é‡ŠåŸå› :æ±‚è§£å˜å…ƒä¼šæ¶‰åŠåˆ°å°æ•°ï¼Ÿæ•…æ³¨é‡Šæ‰ï¼Œå®é™…æ“ä½œæ—¶æ ¹æ®å…·ä½“æƒ…å†µå¤„ç†</span></span><br><span class="line">            <span class="comment">// //åªå‰©ä¸€ä¸ªå˜å…ƒfree_idï¼Œå¯ä»¥æ±‚è§£å‡ºæ¥ã€‚</span></span><br><span class="line">            <span class="comment">// int temp = a[k][var];</span></span><br><span class="line">            <span class="comment">// for(int col = 0; col &lt; var; col++) if(a[k][col] &amp;&amp; col != free_id) temp -= a[k][col] * x[col];</span></span><br><span class="line">            <span class="comment">// x[free_id] = tmep / a[k][free_id];</span></span><br><span class="line"></span><br><span class="line">            flag[free_id] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> var - i;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//(III)æ±‚è§£æ–¹ç¨‹ï¼Œæ­¤æ—¶ä¿è¯æœ‰å”¯ä¸€è§£:å¦‚æœå…¨éƒ¨ä¸ºæ­£æ•´æ•°è§£ï¼Œè¿”å›0ï¼Œå¦‚æœå‡ºç°æµ®ç‚¹æ•°è§£ï¼Œè¿”å›-2ï¼›</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = var - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">        <span class="keyword">int</span> tmep = a[i][var];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; var; j++) <span class="keyword">if</span>(a[i][j]) tmep ^= a[i][j] * x[j];</span><br><span class="line">        x[i] = temp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">1</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> dy[] = &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">-1</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">valid</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x &gt;= <span class="number">0</span> &amp;&amp; y &gt;= <span class="number">0</span> &amp;&amp; x &lt; <span class="number">5</span> &amp;&amp; y &lt; <span class="number">6</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fun</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">30</span>; i++) &#123;</span><br><span class="line">        a[i][i] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> x = i / <span class="number">6</span>, y = i % <span class="number">6</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)&#123;</span><br><span class="line">            <span class="keyword">int</span> nx = x + dx[j], ny = y + dy[j];</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">valid</span>(nx, ny))&#123;</span><br><span class="line">                a[nx * <span class="number">6</span> + ny][i] = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// Fastin;</span></span><br><span class="line">    equ = var = <span class="number">30</span>;</span><br><span class="line">    TTT&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;PUZZLE #%d\n&quot;</span>, _);</span><br><span class="line">        <span class="keyword">int</span> top = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">clr</span>(a, <span class="number">0</span>); <span class="built_in">fun</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">30</span>; i++) <span class="built_in">scnaf</span>(<span class="string">&quot;%d&quot;</span>, a[top++] + <span class="number">30</span>);</span><br><span class="line">        <span class="built_in">assert</span>(<span class="built_in">gauss</span>() == <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        top = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">6</span>; j++) <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, x[top++]);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°å­¦ </tag>
            
            <tag> çº¿æ€§ä»£æ•° </tag>
            
            <tag> é«˜æ–¯æ¶ˆå…ƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021-XDU-å¯’å‡è®­ç»ƒ</title>
      <link href="/2021/01/17/2021-XDU-%E5%AF%92%E5%81%87%E8%AE%AD%E7%BB%83/"/>
      <url>/2021/01/17/2021-XDU-%E5%AF%92%E5%81%87%E8%AE%AD%E7%BB%83/</url>
      
        <content type="html"><![CDATA[<p>[toc]</p><span id="more"></span><h1 id="ï¼ˆä¸€ï¼‰"><a href="#ï¼ˆä¸€ï¼‰" class="headerlink" title="ï¼ˆä¸€ï¼‰"></a>ï¼ˆä¸€ï¼‰</h1><h2 id="A"><a href="#A" class="headerlink" title="A"></a>A</h2><h2 id="B"><a href="#B" class="headerlink" title="B"></a>B</h2><p>å­—ç¬¦ä¸²ä¸Šåšå¿«é€Ÿå¹‚ä¼˜åŒ–çš„dp</p><h2 id="C-ä¸‰ç»´å¹³é¢ä¸Šæ±‚æœ€é•¿çš„åŸºåº•é•¿åº¦"><a href="#C-ä¸‰ç»´å¹³é¢ä¸Šæ±‚æœ€é•¿çš„åŸºåº•é•¿åº¦" class="headerlink" title="C ä¸‰ç»´å¹³é¢ä¸Šæ±‚æœ€é•¿çš„åŸºåº•é•¿åº¦"></a>C ä¸‰ç»´å¹³é¢ä¸Šæ±‚æœ€é•¿çš„åŸºåº•é•¿åº¦</h2><h3 id="å¼±åŒ–ï¼šäºŒç»´å¹³é¢ä¸Šæ±‚æœ€é•¿çš„åŸºåº•é•¿åº¦"><a href="#å¼±åŒ–ï¼šäºŒç»´å¹³é¢ä¸Šæ±‚æœ€é•¿çš„åŸºåº•é•¿åº¦" class="headerlink" title="å¼±åŒ–ï¼šäºŒç»´å¹³é¢ä¸Šæ±‚æœ€é•¿çš„åŸºåº•é•¿åº¦"></a>å¼±åŒ–ï¼šäºŒç»´å¹³é¢ä¸Šæ±‚æœ€é•¿çš„åŸºåº•é•¿åº¦</h3><p><a href="https://codeforces.ml/gym/100959">Ké¢˜</a></p><p>å¦‚ä½•è¯´æ˜gcdæ¬§å‡ é‡Œå¾—ç®—æ³•çš„æ­£ç¡®æ€§ï¼Ÿç­‰ä»·äºè¯´æ˜$gcd(a, b) = gcd(b, a \% b)$ï¼š</p><p>åªè¦è¯´æ˜(a, b)çš„å…¬å› å­ä¸€å®šæ˜¯a%bçš„å› å­ï¼Œ(b, a % b)çš„å…¬å› å­ä¸€å®šæ˜¯açš„å› å­ã€‚è¿™æ ·ï¼ŒåŒæ–¹çš„å…¬å› å­å…¨ä½“å¿…ç„¶ç›¸åŒï¼Œè¿›è€Œgcdç›¸ç­‰ã€‚</p><p>é‚£ä¹ˆï¼Œåœ¨ä¸€èˆ¬çš„æ¬§å‡ é‡Œå¾—ç®—æ³•ä¸­ï¼Œå¿…é¡»è¦è¯æ˜ä¸Šè¿°çš„å¼å­ï¼Œå³$fun(a, b) = fun(b, a\%b)$</p><p>é«˜æ–¯æ•´æ•°æ˜¯å®éƒ¨ä¸è™šéƒ¨å‡ä¸ºæ•´æ•°çš„å¤æ•°ã€‚é¦–å…ˆå¦‚ä¸‹åœ°å®šä¹‰é«˜æ–¯æ•´æ•°çš„å”¯ä¸€å¸¦ä½™é™¤æ³•è¡¨ç¤ºï¼š</p><p>è®¾$\frac{a}{b} = x + iy$, ä¸€å®šå­˜åœ¨å”¯ä¸€çš„æ•´æ•°$m, n$ä½¿å¾—$m - 1/2 &lt; x &lt;=m + 1/2, n-1/2 &lt; y &lt;=n + 1/2$.</p><p>é‚£ä¹ˆå¸¦ä½™é™¤æ³•$a = bq +r, q =m+in$.</p><p>å®é™…åœ¨è¿ç®—æ—¶ï¼Œå¯¹ä¸¤ä¸ªå¤æ•°åšé™¤æ³•ï¼Œå°†å®éƒ¨è™šéƒ¨å››èˆäº”å…¥ï¼Œå°±å¾—åˆ°äº†å€æ•°qã€‚</p><p>æ¥ä¸‹æ¥å°è¯•è¯´æ˜ä¸Šè¿°çš„é™¤æ³•æ»¡è¶³æ¬§å‡ é‡Œå¾—ç®—æ³•çš„æ¡ä»¶ï¼š</p><p>ä»ç„¶è®¤ä¸ºè¿™é‡Œçš„$fun$å‡½æ•°æ˜¯æ‰¾äºŒè€…æœ€å¤§çš„å…¬å› å­ã€‚</p><p>ç”±äº$<C, +, *>$æ˜¯ç¯ï¼Œä¹˜æ³•å¯¹åŠ æ³•å¯åˆ†é…ï¼Œè¿ç®—æ»¡è¶³å°é—­æ€§ï¼Œå¾ˆå®¹æ˜“è¯æ˜ä¸¤è¾¹çš„å› å­å…¨ä½“ç›¸åŒã€‚</p><p>ï¼ˆ<del>æ‰‹ç®—è¯æ˜aã€bçš„å› å­ä¸€å®šæ˜¯a%bçš„å› å­ï¼Œå¤§æ¦‚åˆ©ç”¨äº†ä¸Šè¿°çš„å‡ ä¸ªæ€§è´¨ï¼Œä¸çŸ¥é“æ˜¯å¦æ­£ç¡®</del>ï¼‰</p><p>é‚£ä¹ˆé€šè¿‡æ¬§å‡ é‡Œå¾—ä¸æ–­è¾—è½¬ç›¸é™¤å°±å¯ä»¥å¾—åˆ°ç»™å‡ºçš„æ‰€æœ‰å‘é‡çš„æœ€å¤§å…¬å› å­ã€‚</p><p>å¾—å‡ºçš„è¿™ä¸ªâ€Gcdâ€å› å­ï¼Œå°±æ˜¯æˆ‘ä»¬è¦æ±‚çš„æœ€ç»ˆçš„åŸºåº•å‘é‡ã€‚æ— éœ€è€ƒè™‘è½¬åŒ–ä¸ºå¹³é¢åæ ‡ä¸Šçš„åŸºåº•ï¼Œç›´æ¥åˆ©ç”¨è¿™ä¸ªå‘é‡å°±å¯ä»¥å¾—çŸ¥éœ€è¦å‡ ä¸ªå‘é‡æ‰èƒ½æ„æˆä¸€ä¸ªé¢˜ç›®è¦æ±‚çš„â€æ­£æ–¹å½¢â€ï¼šå°†ç»™å‡ºçš„æ‰€æœ‰å‘é‡é™¤ä»¥è¯¥åŸºåº•ï¼ŒæŒ‰é“ç†å¯ä»¥å¾—åˆ°æ ‡å‡†çš„<strong>é«˜æ–¯æ•´æ•°</strong>ï¼Œå®éƒ¨å¯ä»¥çœ‹ä½œæ˜¯ä¸ºäº†è¡¨ç¤ºè¿™ä¸ªå‘é‡ï¼Œå®è½´åŸºåº•æ‰€éœ€è¦çš„æ•°é‡ï¼Œè™šéƒ¨å¯ä»¥çœ‹ä½œæ˜¯è™šè½´åŸºåº•æ‰€éœ€è¦çš„æ•°é‡ã€‚ä¸æ–­åœ°ç”¨æ¨ªçºµåæ ‡æ›´æ–°æœ€å¤§æœ€å°å€¼ï¼Œæœ€ååœ¨è¿™ä¸ªçŸ©å½¢åŒºåŸŸä¸­æœ€é•¿çš„è¾¹ï¼ˆå³é•¿æ–¹å½¢çš„é•¿ï¼‰ï¼Œè¿™å°±æ˜¯ä¸ºäº†è¡¨ç¤ºæ‰€æœ‰çš„å¤æ•°æ‰€éœ€è¦çš„æœ€å°‘çš„åŸºåº•æ•°é‡ï¼Œä¹Ÿå°±æ˜¯é¢˜ç›®è¦æ±‚ä¸­çš„Kã€‚æ˜¾ç„¶ï¼Œå› ä¸ºåŸºåº•æœ€å¤§ï¼Œç›¸åº”çš„Kå°±ä¼šæœ€å°ã€‚</p><p>æ­¤å¤–ï¼Œå› ä¸ºé¢˜ç›®è¿˜å…è®¸å˜åŒ–åŸºç¡€åç§»å€¼$(a, b)$ï¼Œæ‰€ä»¥ç»™å‡ºçš„nä¸ªå¤æ•°ä¸éœ€è¦å…¨éƒ¨ä½¿ç”¨ï¼Œå¯ä»¥è®¤ä¸ºæŸä¸€ä¸ªä¸ºåŸç‚¹ï¼Œè€ƒè™‘å‰©ä½™$n-1$ä¸ªå¯¹å®ƒçš„ç›¸å¯¹åæ ‡ï¼Œä½¿ç”¨ç›¸å¯¹åæ ‡å®Œæˆä¸Šè¿°è®¨è®ºçš„gcdç­‰æ“ä½œå³å¯ã€‚</p><p><del>å› ä¸ºçœ‹åˆ°äº†ä¸€ä»½ä»£ç ï¼Œåœ¨gcdä¸­æœ‰å››èˆäº”å…¥ï¼Œè€Œåœ¨å°†å‘é‡é™¤ä»¥æ ‡å‡†åŸºåº•åå¾—åˆ°çš„å•†ä¸Šä¹Ÿè¿›è¡Œäº†å››èˆäº”å…¥ï¼Œè®©äººä¸ç¦æ€€ç–‘è¿™ä¸€å¨å››èˆäº”å…¥åˆ°åº•éƒ½æ˜¯ä»€ä¹ˆã€‚äº‹å®ä¸Šï¼Œgcdçš„å››èˆäº”å…¥æ˜¯é«˜æ–¯æ•´æ•°é™¤æ³•æ‰€å†…åœ¨è¦æ±‚çš„ï¼Œè€Œå•†ä¸Šçš„å››èˆäº”å…¥æ˜¯ä¸ºäº†é˜²æ­¢doubleå¤æ•°é™¤æ³•çš„ç²¾åº¦é—®é¢˜ã€‚</del></p><p>æ­¤æ—¶ä¸ç¦èµå¹è¿™ä¸€ä»½ä¼˜ç¾çš„è‡ªå®šä¹‰é«˜æ–¯æ•´æ•°ç»“æ„çš„<a href="https://codeforces.ml/gym/100959/submission/30276053">ä»£ç </a>ã€‚ï¼ˆå¯èƒ½éœ€è¦coachæ‰èƒ½æŸ¥çœ‹ï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">GaussianInteger</span>&#123;</span></span><br><span class="line">    ll x, y;</span><br><span class="line">    <span class="function">ll <span class="title">norm</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> x * x + y * y;&#125;</span><br><span class="line">    GaussianInteger <span class="keyword">operator</span> + (<span class="keyword">const</span> GaussianInteger &amp;b)&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x + b.x, y + b.y&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    GaussianInteger <span class="keyword">operator</span> - (<span class="keyword">const</span> GaussianInteger &amp;b)&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x - b.x, y - b.y&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    GaussianInteger <span class="keyword">operator</span> * (<span class="keyword">const</span> GaussianInteger &amp;b)&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x * b.x - y * b.y, x * b.y + y * b.x&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//(ä¸“ç”¨! å› ä¸ºæ­¤å¤„bä¿è¯å¤§äº0)å››èˆäº”å…¥é™¤æ³•</span></span><br><span class="line">    <span class="comment">//é«˜æ–¯æ•´æ•°å•†çš„å®éƒ¨è™šéƒ¨åœ¨æŸä¸ªæ•´æ•°çš„**(-1/2, 1/2]**åŒºé—´ä¸­ã€‚</span></span><br><span class="line">    <span class="function">ll <span class="title">D</span><span class="params">(ll a, ll b)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(a &gt;= <span class="number">0</span>) <span class="keyword">return</span> (a % b) * <span class="number">2</span> &lt; b? a / b: a / b + <span class="number">1</span>;</span><br><span class="line">        a = -a; <span class="keyword">return</span> -((a % b) * <span class="number">2</span> &lt;= b? a / b: a / b + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    GaussianInteger <span class="keyword">operator</span> / (<span class="keyword">const</span> GaussianInteger &amp;b)&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="built_in">D</span>(x * b.x + y * b.y, x * b.x + y * b.y), <span class="built_in">D</span>(y * b.x - x * b.y, x * b.x + y * b.y)&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    GaussianInteger <span class="keyword">operator</span> % (<span class="keyword">const</span> GaussianInteger &amp;b)&#123;</span><br><span class="line">        GaussianInteger a = &#123;x, y&#125;;</span><br><span class="line">        <span class="keyword">return</span> a - a / b * b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">typedef</span> GaussianInteger NODE;</span><br><span class="line"><span class="function">NODE <span class="title">gcd</span><span class="params">(NODE a, NODE b)</span></span>&#123;<span class="keyword">return</span> !b.<span class="built_in">norm</span>()? a: <span class="built_in">gcd</span>(b, a % b);&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line">NODE node[maxn];</span><br><span class="line"></span><br><span class="line">ll xmi, xmx, ymi, ymx;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   Fastin;</span><br><span class="line">    <span class="keyword">int</span> n; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="built_in">scnaf</span>(<span class="string">&quot;%lld %lld&quot;</span>, &amp;node[i].x, &amp;node[i].y);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) node[i] = node[i] - node[<span class="number">0</span>];</span><br><span class="line">    NODE d = node[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; n; i++) d = <span class="built_in">gcd</span>(d, node[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++)&#123;</span><br><span class="line">        NODE p = node[i] / d;</span><br><span class="line">        xmi = <span class="built_in">min</span>(xmi, p.x); xmx = <span class="built_in">max</span>(xmx, p.x);</span><br><span class="line">        ymi = <span class="built_in">min</span>(ymi, p.y); ymx = <span class="built_in">max</span>(ymx, p.y);</span><br><span class="line">    &#125;</span><br><span class="line">    ll ans = <span class="built_in">max</span>(ymx - ymi + <span class="number">1</span>, xmx - xmi + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans - n);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ä¸‰ç»´ç©ºé—´ä¸Šåˆ©ç”¨å››å…ƒæ•°ï¼ˆç•™å‘ï¼‰"><a href="#ä¸‰ç»´ç©ºé—´ä¸Šåˆ©ç”¨å››å…ƒæ•°ï¼ˆç•™å‘ï¼‰" class="headerlink" title="ä¸‰ç»´ç©ºé—´ä¸Šåˆ©ç”¨å››å…ƒæ•°ï¼ˆç•™å‘ï¼‰"></a>ä¸‰ç»´ç©ºé—´ä¸Šåˆ©ç”¨å››å…ƒæ•°ï¼ˆç•™å‘ï¼‰</h3><p><del>æš‚æ—¶ä¸å¤ªæ„¿æ„èŠ±è´¹å¤ªå¤šæ—¶é—´å»ç ”ç©¶å››å…ƒæ•°çš„è‹¥å¹²è¡¨ç¤ºå½¢å¼ å› è€Œç•™å‘å¾…è¡¥ï¼ˆå¼ƒå‘ï¼ˆbushi</del></p><h2 id="D-æ— å‘å›¾ç”Ÿæˆæ ‘è®¡æ•°-amp-å…è®¸æ—‹è½¬ç½®æ¢"><a href="#D-æ— å‘å›¾ç”Ÿæˆæ ‘è®¡æ•°-amp-å…è®¸æ—‹è½¬ç½®æ¢" class="headerlink" title="D æ— å‘å›¾ç”Ÿæˆæ ‘è®¡æ•° &amp; å…è®¸æ—‹è½¬ç½®æ¢"></a>D æ— å‘å›¾ç”Ÿæˆæ ‘è®¡æ•° &amp; å…è®¸æ—‹è½¬ç½®æ¢</h2><h3 id="æ— å‘å›¾çŸ©é˜µæ ‘å®šç†"><a href="#æ— å‘å›¾çŸ©é˜µæ ‘å®šç†" class="headerlink" title="æ— å‘å›¾çŸ©é˜µæ ‘å®šç†"></a>æ— å‘å›¾çŸ©é˜µæ ‘å®šç†</h3><p>å›¾ä¸­ä¸å…è®¸è‡ªç¯ï¼Œå…è®¸é‡è¾¹ã€‚</p><p>å®šç†åŸºå°”éœå¤«çŸ©é˜µ$L(G) = D(G)-A(G)$ï¼Œåº¦æ•°çŸ©é˜µ$D_{ii}(G) =deg(i),D_{ij}=0,iâ‰ j$ï¼Œé‚»æ¥çŸ©é˜µ$A_{ij}(G)=A_{ji}(G)=#e(ij), iâ‰ j$ã€‚</p><p>é‚£ä¹ˆ$L(G)$çš„æ‰€æœ‰ä»£æ•°ä½™å­å¼å‡ç›¸åŒï¼Œä¸”ç­‰äºGçš„ç”Ÿæˆæ ‘æ•°é‡ã€‚</p><h3 id="Burnsideä¸Polyaå®šç†"><a href="#Burnsideä¸Polyaå®šç†" class="headerlink" title="Burnsideä¸Polyaå®šç†"></a>Burnsideä¸Polyaå®šç†</h3><p><strong>burnside</strong>ï¼šGæ˜¯Xçš„ç½®æ¢ç¾¤ï¼ŒCæ˜¯Xä¸­æ»¡è¶³å¦‚ä¸‹æ¡ä»¶çš„ç€è‰²é›†åˆï¼šå¯¹äºGä¸­æ‰€æœ‰çš„få’ŒCä¸­æ‰€æœ‰çš„céƒ½æœ‰$f*c$ä»åœ¨Cä¸­ï¼Œåˆ™Cä¸­éç­‰ä»·çš„ç€è‰²æ•°$N(G,C)=\frac{1}{|G|}\sum _{fâˆˆG}|C(f)|$ï¼Œå…¶ä¸­$C(f)$æ˜¯åœ¨fä½œç”¨ä¸‹ä½¿å¾—ç€è‰²cä¿æŒä¸å˜çš„æ‰€æœ‰ç€è‰²çš„é›†åˆã€‚</p><p><strong>polya</strong>: å¦‚æœä¸€ä¸ªç½®æ¢$f$æœ‰$Ïƒ_f$ä¸ªå¾ªç¯ï¼Œé‚£ä¹ˆå¯ä»¥æ ¹æ®å¾ªç¯å…·ä½“åœ°è®¡ç®—å‡ºä¸åŠ¨ç‚¹çš„æ•°é‡ï¼Œä»è€Œå¾—åˆ°ç­‰ä»·ç±»çš„æ•°é‡: $\frac 1 {|G|}\sum_ {fâˆˆG}m^{Ïƒ_f}$ï¼Œå…¶ä¸­mæ˜¯å¯é€‰é¢œè‰²çš„æ•°é‡ã€‚</p><p>polyaç»ƒä¹ é¢˜-&gt; <a href="https://www.cnblogs.com/hankers/archive/2012/08/03/2622231.html">è¿™é‡Œ</a></p><h2 id="E-æ¨è¡¨-amp-LIS"><a href="#E-æ¨è¡¨-amp-LIS" class="headerlink" title="E æ¨è¡¨ &amp; LIS"></a>E æ¨è¡¨ &amp; LIS</h2><h3 id="Diworthå®šç†"><a href="#Diworthå®šç†" class="headerlink" title="Diworthå®šç†"></a>Diworthå®šç†</h3><blockquote><p><strong>ä¸€ä¸ªåºåˆ—ä¸­ä¸‹é™å­åºåˆ—çš„æœ€å°‘åˆ’åˆ†æ•°ä¸ªæ•°ç­‰äºæœ€é•¿ä¸Šå‡å­åºåˆ—çš„é•¿åº¦ã€‚</strong></p><p><strong>ä¸€ä¸ªåºåˆ—ä¸­ä¸Šå‡å­åºåˆ—çš„æœ€å°‘åˆ’åˆ†æ•°ä¸ªæ•°ç­‰äºæœ€é•¿ä¸‹é™å­åºåˆ—çš„é•¿åº¦ã€‚</strong></p><p><strong>æ¯å¥ä¸­çš„å‰åä¸¤è€…äº’ä¸ºååºå…³ç³»ã€‚</strong></p></blockquote><h3 id="æ¨è¡¨"><a href="#æ¨è¡¨" class="headerlink" title="æ¨è¡¨"></a>æ¨è¡¨</h3><p>æ ‡å‡†æ¨è¡¨ä»å·¦å‘å³ã€ä»ä¸Šåˆ°ä¸‹æ ¼å­ä¸­çš„å…ƒç´ å¤§å°å‡æ˜¯é€’å¢çš„ã€‚</p><p><del>å¤§æ¦‚é•¿é˜¶æ¢¯çŠ¶ï¼Œä½†æ˜¯åšå®¢æ¯”è¾ƒåƒåœ¾ä¸å¤ªèƒ½ä¸Šä¼ å›¾æ‰€ä»¥ä»ç•¥</del></p><p>$1-n$æ„æˆæ¨è¡¨ä¸ªæ•°ä¸º$f(1) = 1, f(2)=2, f(n) = f(n-1)+(n-1)*f(n-2),n &gt;2$</p><p>å®šä¹‰æŸä¸ªæ–¹æ ¼çš„å‹¾é•¿ä¸º<code>è¯¥æ–¹æ ¼æ­£å³æ–¹æ–¹æ ¼æ•°+æ­£ä¸‹æ–¹æ–¹æ ¼æ•°+1</code>ï¼Œé‚£ä¹ˆå¦‚æœç»™å®šæ¨è¡¨çš„å½¢çŠ¶ï¼Œç”¨$1-n$å¡«å……æ¨è¡¨çš„æ‰€æœ‰æ–¹å¼æœ‰$\frac {n!}{\prod _{xæ˜¯æ¨è¡¨æ ¼å­}hook(x)}$ï¼Œè¿™è¢«ç§°ä¸ºå‹¾é•¿å…¬å¼ã€‚</p><p>æ¨è¡¨çš„å¯¹è¡Œæ’å…¥ï¼šè®¾è¦æ’å…¥xï¼Œä»ç¬¬ä¸€è¡Œå¼€å§‹ï¼Œåœ¨å½“å‰è¡Œä¸­æ‰¾ç¬¬ä¸€ä¸ªå¤§äºxçš„ä½ç½®ï¼Œå¦‚æœæ‰¾åˆ°äº†å°±ç”¨xæ›¿æ¢è¯¥å…ƒç´ yï¼Œå¹¶å°è¯•åœ¨ä¸‹ä¸€è¡Œæ’å…¥yï¼Œåå¤ä¸æ–­è¿›è¡Œï¼›å¦‚æœæ‰¾ä¸åˆ°è¿™æ ·çš„ä½ç½®ï¼Œå°±å°†å½“å‰çš„å€¼æ”¾åœ¨è¡Œæœ«ï¼Œç®—æ³•ç»“æŸã€‚</p><p>æ¨è¡¨çš„åˆ é™¤ï¼šå‡è®¾è¦åˆ é™¤$(x, y)$ï¼Œä¿è¯$(x, y)$æ˜¯è¾¹è§’ã€‚è®¾x = $S_{xy}$ï¼Œå¦‚æœxåœ¨ç¬¬ä¸€è¡Œï¼Œåˆ é™¤xç®—æ³•ç»“æŸï¼›ä¸ç„¶ï¼Œæ‰¾å‡ºæœ€å¤§çš„å°äºxçš„ä½ç½®ï¼Œç”¨xæ›¿æ¢è¯¥ä½ç½®ä¸Šçš„å…ƒç´ yï¼Œå†å°è¯•åœ¨ä¸Šä¸€è¡Œä¸­åˆ é™¤yï¼Œåå¤è¿›è¡Œã€‚</p><p><strong>æ¨è¡¨$P_x$ä¸LISã€LDSï¼š</strong></p><p>$P_x$ä¸­ç¬¬ä¸€è¡Œçš„é•¿åº¦å°±æ˜¯æ’åˆ—$X$çš„LISçš„é•¿åº¦ï¼Œç¬¬ä¸€åˆ—çš„é•¿åº¦æ˜¯å…¶LDSçš„é•¿åº¦</p><p>äº‹å®ä¸Šï¼Œå®šä¹‰k-LISåºåˆ—ä¸ºLISé•¿åº¦ä¸è¶…è¿‡kçš„åºåˆ—ï¼Œç±»ä¼¼åœ°å®šä¹‰k-LDSåºåˆ—ã€‚é‚£ä¹ˆæ¨è¡¨å‰kåˆ—çš„é•¿åº¦å°±æ˜¯æœ€é•¿çš„k-LISé•¿åº¦ã€‚</p><h3 id=""><a href="#" class="headerlink" title=" "></a> </h3><h3 id="æœ¬é¢˜"><a href="#æœ¬é¢˜" class="headerlink" title="æœ¬é¢˜"></a>æœ¬é¢˜</h3><p>ç»™å®šé•¿åº¦nï¼Œè¦æ±‚æ‰¾å‡ºæ»¡è¶³å¦‚ä¸‹æ¡ä»¶çš„é•¿ä¸ºnçš„æ’åˆ—ï¼šå­˜åœ¨ä¸¤ä¸ªé•¿åº¦ç›¸åŒä¸”æ— ç›¸äº¤å…ƒç´ çš„LISï¼Œç­”æ¡ˆå¯¹998244353å–æ¨¡ã€‚</p><p>ç”±äºdiworthå®šç†ï¼Œå¯ä»¥å¾—çŸ¥å°±æ˜¯è¦æ‰¾åŒ…å«ä¸€ä¸ªæ€»é•¿ä¸º2Lï¼ŒLDS=2ï¼ŒLIS=Lçš„å­åºåˆ—çš„åºåˆ—çš„ä¸ªæ•°ï¼Œè¿™ä¹Ÿå°±æ˜¯è¯´è¦æ‰¾é•¿åº¦ä¸ºnã€2_LDS=2Lã€LIS=Lçš„åºåˆ—çš„ä¸ªæ•°ã€‚è½¬æ¢åˆ°æ¨è¡¨ä¸Šæ¥ï¼Œæ¨è¡¨å¤§å°ä¸ºnï¼Œå‰ä¸¤è¡Œæ€»å…±åº”æœ‰2Lä¸ªå…ƒç´ ï¼Œç¬¬ä¸€è¡Œå¿…é¡»æœ‰ Lä¸ªå…ƒç´ ï¼Œä»è€Œç¬¬äºŒè¡Œä¹Ÿå°±å¿…é¡»æœ‰Lä¸ªå…ƒç´ ã€‚å°†æ•´æ•°nè¿›è¡Œæ‹†åˆ†åç”¨é’©å­å…¬å¼å³å¯å¾—çŸ¥å½“å‰å½¢çŠ¶çš„æ¨è¡¨çš„åˆæ³•æ•°é‡ã€‚åˆç”±äºä¸€å¯¹æ¨è¡¨å”¯ä¸€çš„ç¡®å®šä¸€ä¸ªæ’åˆ—ï¼Œé‚£ä¹ˆæœ€ç»ˆçš„æ’åˆ—æ•°åˆ™æ˜¯æ‰€æœ‰æ¨è¡¨åˆæ³•æ•°é‡çš„å¹³æ–¹ä¹‹å’Œã€‚</p><ol><li>æ²¡æœ‰ä»”ç»†ç ”è¯»2019å›½å®¶é›†è®­é˜Ÿè®ºæ–‡é›†ï¼Œå·äº†å‡ ä¸ªç»“è®ºå°±è·‘äº†</li><li>ä¸æ˜¯ç‰¹åˆ«æ˜ç™½åˆ©ç”¨diworthå®šç†å’Œæ¨è¡¨ç›¸å…³æ€§è´¨å¯¹é¢˜ç›®è¿›è¡Œçš„è½¬åŒ–</li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">onst <span class="keyword">int</span> M = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">const</span> itn maxn = <span class="number">1e2</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, l;</span><br><span class="line"><span class="keyword">int</span> a[maxn];</span><br><span class="line">ll ans = <span class="number">0</span>, pre[maxn], inv[maxn];</span><br><span class="line"><span class="function">ll <span class="title">fun</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> !x? inv[y]: inv[y] * pre[x - <span class="number">1</span>] % M;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å°†è¦æ”¾ç¬¬kå±‚,ä¸Šé™ä¸ºxï¼Œå‰©ä½™sumä¸ªæ ¼å­</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> x, <span class="keyword">int</span> sum)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(sum == <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="comment">//å¯¹ç¬¬iå±‚è€Œè¨€ï¼Œæ˜¾ç„¶æœ‰i-1ä¸ªä¸Šæ–¹çš„æ ¼å­ï¼Œå³è¾¹çš„æ ¼å­åˆ†åˆ«ä¸º0,1,...,a[i] - 1</span></span><br><span class="line">        <span class="comment">//i * (i + 1) * ... * (i + a[i] - 1)</span></span><br><span class="line">        ll res = pre[n];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++)&#123;</span><br><span class="line">            res *= <span class="built_in">fun</span>(i, i + a[i] - <span class="number">1</span>);</span><br><span class="line">            res %= M;</span><br><span class="line">        &#125;</span><br><span class="line">        ans += res; asn %= M;</span><br><span class="line">        <span class="built_in">prt</span>(a, k, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= sum &amp;&amp; i &lt;= x; i++)&#123;</span><br><span class="line">        a[k] = i;</span><br><span class="line">        <span class="built_in">dfs</span>(k + <span class="number">1</span>, i, sum - i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// Fastin;</span></span><br><span class="line">    <span class="keyword">int</span> n; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    pre[<span class="number">0</span>] = <span class="number">1</span>; inv[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">100</span>; i++)&#123;</span><br><span class="line">        pre[i] = pre[i - <span class="number">1</span>] * <span class="number">1ll</span> * i % M;</span><br><span class="line">        inv[i] = <span class="built_in">qp</span>(pre[i], M - <span class="number">2</span>, M);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i + i &lt;= n; i++)&#123;</span><br><span class="line">        a[<span class="number">0</span>] = a[<span class="number">1</span>] = i; l = i;</span><br><span class="line">        <span class="built_in">dfs</span>(<span class="number">2</span>, i, n - <span class="number">2</span> * i);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="K-å¯æŒä¹…åŒ–01çº¿æ®µæ ‘"><a href="#K-å¯æŒä¹…åŒ–01çº¿æ®µæ ‘" class="headerlink" title="K å¯æŒä¹…åŒ–01çº¿æ®µæ ‘"></a>K å¯æŒä¹…åŒ–01çº¿æ®µæ ‘</h2><p>æ”¯æŒåŒºé—´ç¿»è½¬ï¼Œå•ç‚¹ç½®å€¼ã€‚æ¯æ¬¡æ“ä½œå®Œåè¾“å‡ºæ•´ä¸ªåºåˆ—ä¸­1çš„ä¸ªæ•°ã€‚</p><p><del>è²Œä¼¼å¯æŒä¹…åŒ–çº¿æ®µæ ‘ä¸æ˜¯å¾ˆèƒ½æ”¯æŒç›´æ¥çš„åŒºé—´æ“ä½œï¼Ÿ</del></p><p>åœ¨è¿™é“é¢˜ä¸­ï¼Œå¦‚æœå‡ºç°åŒºé—´ç¿»è½¬çš„æ“ä½œï¼Œé‚£ä¹ˆå°†æ‰€æœ‰æœ‰å…³çš„å°çº¿æ®µéƒ½æ‰“ä¸Štagï¼ˆå®é™…æ˜¯å¼‚æˆ–åŠ 1ï¼‰ï¼Œå¹¶å°†ä»–ä»¬çš„ç»“æœéƒ½ç”¨$r - l + 1 - st[p]$æ¥ä»£æ›¿æœ¬èº«ï¼›è€Œå¦‚æœå‡ºç°äº†å•ç‚¹ç½®å€¼çš„æƒ…å†µï¼Œæ£€æŸ¥ä¸€è·¯ä¸Šé‡åˆ°çš„æ‰€æœ‰çš„çº¿æ®µçš„tagï¼Œå°†å°†è¦ç½®çš„å€¼xä¸æ–­åœ°å¼‚æˆ–ä¸Šè¿™äº›tagï¼Œä»¥æœ€ç»ˆçš„ç»“æœä½œä¸ºæœ€ç»ˆè¦ç½®çš„å€¼ã€‚è¿™æ˜¯å› ä¸ºï¼Œåœ¨ä¸€ä¸ªå·²ç»ç¿»è½¬è¿‡çš„çº¿æ®µä¸Šç½®å€¼ï¼ˆç„¶è€Œæ­¤æ—¶åªæ˜¯å¯¹è¿™ä¸ªå¤§çº¿æ®µæ‰“äº†tagï¼Œæ²¡æœ‰å®é™…åœ°ä¿®æ”¹å­çº¿æ®µï¼Œä¸ç„¶ä¼šTï¼‰ç­‰ä»·äºå°†è¦ç½®çš„å€¼å…ˆç¿»è½¬ï¼Œä¸æ–­å¾€ä¸‹èµ°ï¼Œç½®å¥½åå†å°†$st[ls] + st[rs]$çš„å€¼ç¿»è½¬ä¸€éåç½®å›æœ¬èº«ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>è¿™é‡Œçš„ç¿»è½¬tagå¿…é¡»è¦åœ¨ç›¸é‚»çš„ç‰ˆæœ¬ä¹‹é—´è¿›è¡Œç»§æ‰¿</strong>ï¼ä¸ç„¶å°±ä¼šå‘ç”Ÿç¿»è½¬ä¿¡æ¯é—æ¼çš„é—®é¢˜ã€‚</p><p>å¯¹äº01ä¸²çš„åŒºé—´ç¿»è½¬é—®é¢˜ï¼Œè¿™ç§å°†è¦ç½®çš„å€¼ç¿»è½¬çš„æ‰‹æ®µå¥½åƒæ˜¯ä¸€ä¸ªæ¯”è¾ƒé€šç”¨çš„æ‰‹æ³•ï¼Ÿå€¼å¾—å­¦ä¹ ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mid ((l + r) &gt;&gt; 1)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">2e7</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, q;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> root[<span class="number">100010</span>], version = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> st[manx], tag[maxn];</span><br><span class="line"><span class="keyword">int</span> ls[maxn], rs[maxn], top = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> now = top++;</span><br><span class="line">    <span class="keyword">if</span>(l == r) <span class="keyword">return</span> now;</span><br><span class="line">    ls[now] = <span class="built_in">build</span>(l, mid);</span><br><span class="line">    rs[now] = <span class="built_in">build</span>(mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="keyword">return</span> now;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">up</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    st[p] = st[ls[p]] + st[rs[p]];</span><br><span class="line">    <span class="keyword">if</span>(tag[p]) st[p] = r - l + <span class="number">1</span> - st[p];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">set</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> now = top++;</span><br><span class="line">    tag[now] = tag[p];</span><br><span class="line">    <span class="keyword">if</span>(l == r &amp;&amp; l == k)&#123;</span><br><span class="line">        st[now] = x;</span><br><span class="line">        <span class="keyword">return</span> now;</span><br><span class="line">    &#125;</span><br><span class="line">    x ^= tag[p];</span><br><span class="line">    ls[now] = ls[p]; rs[now] = rs[p];</span><br><span class="line">    <span class="keyword">if</span>(k &lt;= mid) ls[now] = <span class="built_in">set</span>(ls[p], l, mid, k, x);</span><br><span class="line">    <span class="keyword">else</span> rs[now] = <span class="built_in">set</span>(rs[p], mid + <span class="number">1</span>, r, k, x);</span><br><span class="line">    <span class="built_in">up</span>(now, l, r);</span><br><span class="line">    <span class="keyword">return</span> now;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> now = top++;</span><br><span class="line">    ls[now] = ls[p]; rs[now] = rs[p];</span><br><span class="line">    tag[now] = tag[p];</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= l &amp;&amp; r &lt;= R)&#123;</span><br><span class="line">        st[now] = r - l + <span class="number">1</span> - st[p];</span><br><span class="line">        tag[now] ^= <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> now;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= mid) ls[now] = <span class="built_in">update</span>(ls[p], l, mid, L, R);</span><br><span class="line">    <span class="keyword">if</span>(R &gt; mid) rs[now] = <span class="built_in">update</span>(rs[p], mid + <span class="number">1</span>, r, L, R);</span><br><span class="line">    <span class="built_in">up</span>(now, l, r);</span><br><span class="line">    <span class="keyword">return</span> now;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;n, &amp;m, &amp;q);</span><br><span class="line">    root[version++] = <span class="built_in">build</span>(<span class="number">0</span>, n * m - <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; q; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> op; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;op);</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> i, j; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;i, &amp;j); i--; j--;</span><br><span class="line">            root[version] = <span class="built_in">set</span>(root[version - <span class="number">1</span>], <span class="number">0</span>, n * m - <span class="number">1</span>, i * m + j, <span class="number">1</span>);</span><br><span class="line">            version++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">2</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> i, j; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;i, &amp;j); i--; j--;</span><br><span class="line">            root[version] = <span class="built_in">set</span>(root[version - <span class="number">1</span>], <span class="number">0</span>, n * m - <span class="number">1</span>, i * m + j, <span class="number">0</span>);</span><br><span class="line">            version++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">3</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> i; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;i);</span><br><span class="line">            root[version] = <span class="built_in">update</span>(root[version - <span class="number">1</span>], <span class="number">0</span>, n * m - <span class="number">1</span>, (i - <span class="number">1</span>) * m, i * m - <span class="number">1</span>);</span><br><span class="line">            version++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">int</span> x; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">            root[version] = root[x];</span><br><span class="line">            version++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, st[root[version - <span class="number">1</span>]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="ï¼ˆäºŒï¼‰"><a href="#ï¼ˆäºŒï¼‰" class="headerlink" title="ï¼ˆäºŒï¼‰"></a>ï¼ˆäºŒï¼‰</h1><h2 id="-1"><a href="#-1" class="headerlink" title=" "></a> </h2>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>å—çŠ¶DS</title>
      <link href="/2021/01/16/%E5%9D%97%E7%8A%B6DS/"/>
      <url>/2021/01/16/%E5%9D%97%E7%8A%B6DS/</url>
      
        <content type="html"><![CDATA[<p>[toc]</p><span id="more"></span><h1 id="åˆ†å—æ€æƒ³"><a href="#åˆ†å—æ€æƒ³" class="headerlink" title="åˆ†å—æ€æƒ³"></a>åˆ†å—æ€æƒ³</h1><h2 id="uva-12003-åŒºé—´æŸ¥è¯¢æ•°é‡-amp-å•ç‚¹ä¿®æ”¹"><a href="#uva-12003-åŒºé—´æŸ¥è¯¢æ•°é‡-amp-å•ç‚¹ä¿®æ”¹" class="headerlink" title="uva 12003 åŒºé—´æŸ¥è¯¢æ•°é‡ &amp; å•ç‚¹ä¿®æ”¹"></a><a href="https://onlinejudge.org/index.php?option=com_onlinejudge&amp;Itemid=8&amp;page=show_problem&amp;problem=3154">uva 12003</a> åŒºé—´æŸ¥è¯¢æ•°é‡ &amp; å•ç‚¹ä¿®æ”¹</h2><p>ç»™å‡ºåºåˆ—ï¼Œå†ç»™å‡ºè‹¥å¹²æ¬¡æ“ä½œ<code>&lt;l, r, x, u&gt;</code>ï¼Œè®°å½“å‰åºåˆ—åœ¨<code>[l, r]</code>ä¸­çš„å€¼ä¸¥æ ¼å°äºxçš„æ•°é‡ä¸ºcntï¼Œç½®å€¼<code>a[u] = k * cnt / (r - l + 1)</code>ï¼Œå…¶ä¸­kæ˜¯ä¸€ä¸ªæå‰ç»™å‡ºçš„å¸¸æ•°ã€‚</p><p>é—®è‹¥å¹²æ¬¡æ“ä½œåçš„åºåˆ—ã€‚</p><p><del>ç”šè‡³æ²¡æœ‰æƒ³åˆ°ä»€ä¹ˆå¸¸è§„çš„æ•°æ®ç»“æ„å¯ä»¥è§£å†³ï¼Ÿå¯èƒ½bitå¥—å¯æŒä¹…åŒ–ä¸»å¸­ğŸŒ²å¯ä»¥ã€‚</del></p><p>ç„¶åå†³å®šè½ä¸€å‘$O(m<em>S</em>logS)$ï¼Œå¯¹æ¯ä¸€å—ç»´æŠ¤ä¸€ä¸ªæœ‰åºåºåˆ—ï¼ŒæŸ¥è¯¢æ—¶$O(n/S *logS)$åœ°å¯¹æ¯ä¸€å—äºŒåˆ†çš„è¿›è¡ŒæŸ¥æ‰¾ï¼Œä¿®æ”¹æ—¶$O(SlogS)$åœ°é‡æ’åºå—ã€‚å–Sä¸º$sqrt(n)$å³å¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">3e5</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m, k;</span><br><span class="line"><span class="keyword">int</span> a[maxn];</span><br><span class="line"></span><br><span class="line"><span class="comment">//å—å¤§å°ä¸ºSï¼Œæœ‰cntä¸ªå—</span></span><br><span class="line"><span class="keyword">int</span> S, cnt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">blk_begin</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;<span class="keyword">return</span> x / S * S;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">blk_end</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;<span class="keyword">return</span> (x / S + <span class="number">1</span>) * S;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">blk_cnt</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;<span class="keyword">return</span> x / S;&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NODE</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> id; <span class="keyword">int</span> value;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> NODE &amp;b)<span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(value != b.value) <span class="keyword">return</span> value &lt; b.value;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> id &lt; b.id;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">vector&lt;NODE&gt;::iterator it;</span><br><span class="line">vector&lt;NODE&gt; vec[<span class="number">1000</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ini_block</span><span class="params">()</span></span>&#123;</span><br><span class="line">    S = (<span class="keyword">int</span>)<span class="built_in">sqrt</span>(n); cnt = <span class="built_in">ceil</span>(n, S);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">        vec[i / S].<span class="built_in">push_back</span>(&#123;i, a[i]&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cnt; i++) <span class="built_in">sort</span>(vec[i].<span class="built_in">begin</span>(), vec[i].<span class="built_in">end</span>());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŸ¥è¯¢åŒºé—´lï¼Œ rä¸­æœ‰å¤šå°‘ä¸ªæ•°å­—ä¸¥æ ¼å°äºx</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fun</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = l, j = <span class="built_in">blk_end</span>(l); i &lt; j; i++) <span class="keyword">if</span>(a[i] &lt; x) res++;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="built_in">blk_begin</span>(r); i &lt;= r; i++) <span class="keyword">if</span>(a[i] &lt; x) res++;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="built_in">blk_cnt</span>(l) + <span class="number">1</span>; i &lt; <span class="built_in">blk_cnt</span>(r); i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> left = <span class="number">0</span>, right = (<span class="keyword">int</span>)vec[i].<span class="built_in">size</span>() - <span class="number">1</span>, middle;</span><br><span class="line">        <span class="keyword">if</span>(vec[i][right].value &lt; x) res += (<span class="keyword">int</span>)vec[i].<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">whlie</span>(left &lt; right)&#123;</span><br><span class="line">                middle = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span>(vec[i][middle].value &gt;= x) right = middle;</span><br><span class="line">                <span class="keyword">else</span> left = middle + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            res += left;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="built_in">scnaf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;n, &amp;m, &amp;k);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a + i);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">ini_block</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> l, r, x, u; <span class="built_in">scnaf</span>(<span class="string">&quot;%d %d %d %d&quot;</span>, &amp;l, &amp;r, &amp;x, &amp;u);</span><br><span class="line">        l--; r--; u--;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="built_in">fun</span>(l, r, x);</span><br><span class="line">        <span class="keyword">int</span> temp = <span class="built_in">blk_cnt</span>(u);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;node: vec[tmep]) <span class="keyword">if</span>(node.id == u) a[u] = node.value = k * <span class="number">1ll</span> * res / (r - l + <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">sort</span>(vec[temp].<span class="built_in">begin</span>(), vec[temp].<span class="built_in">end</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, a[i]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="uva-11990-åŠ¨æ€åˆ é™¤æ’åˆ—å…ƒç´ å¹¶ä¸æ–­è¯¢é—®é€†åºå¯¹æ•°é‡"><a href="#uva-11990-åŠ¨æ€åˆ é™¤æ’åˆ—å…ƒç´ å¹¶ä¸æ–­è¯¢é—®é€†åºå¯¹æ•°é‡" class="headerlink" title="uva 11990 åŠ¨æ€åˆ é™¤æ’åˆ—å…ƒç´ å¹¶ä¸æ–­è¯¢é—®é€†åºå¯¹æ•°é‡"></a><a href="https://onlinejudge.org/index.php?option=com_onlinejudge&amp;Itemid=8&amp;page=show_problem&amp;category=0&amp;problem=3141&amp;mosmsg=Submission+received+with+ID+25956183">uva 11990</a> åŠ¨æ€åˆ é™¤æ’åˆ—å…ƒç´ å¹¶ä¸æ–­è¯¢é—®é€†åºå¯¹æ•°é‡</h2><p>ç»™å‡ºä¸€ä¸ªæ’åˆ—ï¼Œå¹¶ç»™å‡ºè‹¥å¹²æ¬¡åˆ é™¤æ“ä½œï¼Œæ¯æ¬¡æ“ä½œéƒ½åˆ å»æ’åˆ—ä¸­çš„ä¸€ä¸ªæ•°ï¼Œå¹¶è¦æ±‚è¾“å‡ºæ¯æ¬¡æ“ä½œåçš„é€†åºå¯¹æ•°é‡ã€‚</p><p>æœ‰äº†åˆ†å—æ€æƒ³çš„æŒ‡å¯¼<del>ä»¥åŠå‰ä¸€é¢˜é«˜å¤æ‚åº¦å´ACçš„ç»éªŒ</del> è¿™é¢˜å¾ˆå®¹æ˜“å°±å¯ä»¥å†™å‡ºæ¥åˆ†å—çš„ä»£ç </p><p>ä½†é¦–å…ˆå¾—ç”¨ä¸€äº›æ‰‹æ®µæ±‚å‡ºåºåˆ—çš„é€†åºå¯¹ä¸ªæ•°ï¼Œç„¶åå°±æ˜¯ä¸€äº›ç»†èŠ‚çš„æ³¨æ„ã€‚</p><p><strong>éœ€è¦æ³¨æ„å½“å¯èƒ½éå†åˆ°æœ€åä¸€ä¸ªå—æ—¶éœ€è¦æ³¨æ„ä¸èƒ½è¶Šç•Œï¼</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">int</span> a[maxn], pos[maxn];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> st[maxn &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ls (p &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rs ((p &lt;&lt; 1) | 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mid ((l + r) &gt;&gt; 1)</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">up</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;st[p] = st[ls] + st[rs];&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l == r &amp;&amp; l == k) &#123;st[p] = <span class="number">1</span>; <span class="keyword">return</span>; &#125;</span><br><span class="line">    <span class="keyword">if</span>(k &lt;= mid) <span class="built_in">update</span>(ls, l, mid, k);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">update</span>(rs, mid + <span class="number">1</span>, r, k);</span><br><span class="line">    <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= l &amp;&amp; r &lt;= R) <span class="keyword">return</span> st[p];</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= mid) ans += <span class="built_in">query</span>(ls, l, mid, L, R);</span><br><span class="line">    <span class="keyword">if</span>(R &gt; mid) ans += <span class="built_in">query</span>(rs, mid + <span class="number">1</span>, r, L, R);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">invPairs</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(a[i] + <span class="number">1</span> &lt;= n) ans += <span class="built_in">query</span>(<span class="number">1</span>, <span class="number">1</span>, n, a[i] + <span class="number">1</span>, n);</span><br><span class="line">        <span class="built_in">update</span>(<span class="number">1</span>, <span class="number">1</span>, n, a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//å—å¤§å°ä¸ºSï¼Œæœ‰cntä¸ªå—</span></span><br><span class="line"><span class="keyword">int</span> S, cnt;</span><br><span class="line"></span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt;::iterator it;</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; vec[<span class="number">1000</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ini_block</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++) vec[i].<span class="built_in">clear</span>();</span><br><span class="line">    S = (<span class="keyword">int</span>)<span class="built_in">sqrt</span>(n); cnt = <span class="built_in">ceil</span>(n, S);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">        vec[i / S].<span class="built_in">push_back</span>(a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cnt; i++) <span class="built_in">sort</span>(vec[i].<span class="built_in">begin</span>(), vec[i].<span class="built_in">end</span>());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> flag[maxn];</span><br><span class="line"><span class="comment">//åˆ é™¤a[pos]å…ƒç´ åï¼Œè¿”å›å› è€Œå˜åŒ–çš„é€†åºå¯¹çš„æ•°é‡</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fun</span><span class="params">(<span class="keyword">int</span> pos)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> blk = pos / S;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = blk * S, j = (blk + <span class="number">1</span>) * S; i &lt; j &amp;&amp; i &lt; n; i++) <span class="keyword">if</span>(!flag[i])&#123;</span><br><span class="line">        <span class="keyword">if</span>(i &lt; pos &amp;&amp; a[i] &gt; a[pos]) ans++;</span><br><span class="line">        <span class="keyword">if</span>(i &gt; pos &amp;&amp; a[i] &lt; a[pos]) ans++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; blk; i++) <span class="keyword">if</span>(!vec[i].<span class="built_in">empty</span>())&#123;</span><br><span class="line">        <span class="keyword">int</span> left = <span class="number">0</span>, right = (<span class="keyword">int</span>)vec[i].<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(vec[i][left] &gt; a[pos]) ans += right + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">int</span> middle;</span><br><span class="line">            <span class="keyword">while</span>(left &lt; right)&#123;</span><br><span class="line">                middle = (right + left + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span>(vec[i][middle] &lt; a[pos]) left = middle;</span><br><span class="line">                <span class="keyword">else</span> right = middle - <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            ans += (<span class="keyword">int</span>)vec[i].<span class="built_in">size</span>() - <span class="number">1</span> - left;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = blk + <span class="number">1</span>; i &lt; cnt; i++) <span class="keyword">if</span>(!vec[i].<span class="built_in">empty</span>())&#123;</span><br><span class="line">        <span class="keyword">int</span> left = <span class="number">0</span>, right = (<span class="keyword">int</span>)vec[i].<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(vec[i][right] &lt; a[pos]) ans += right + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">int</span> middle;</span><br><span class="line">            <span class="keyword">while</span>(left &lt; right)&#123;</span><br><span class="line">                middle = (right + left) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span>(vec[i][middle] &lt; a[pos]) left = middle + <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">else</span> right = middle;</span><br><span class="line">            &#125;</span><br><span class="line">            ans += left;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="keyword">while</span>(~<span class="built_in">scnaf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m))&#123;</span><br><span class="line">        <span class="built_in">clr</span>(st, <span class="number">0</span>); <span class="built_in">clr</span>(flag, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a + i);</span><br><span class="line">            pos[a[i]] = i;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">ini_block</span>();</span><br><span class="line">        ll ans = <span class="built_in">invPairs</span>(), temp = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123;</span><br><span class="line">            ans -= tmep;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">int</span> x; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">            temp = <span class="built_in">fun</span>(pos[x]);</span><br><span class="line">            <span class="keyword">for</span>(it = vec[pos[x] / S].<span class="built_in">begin</span>(); it != vec[pos[x] / S].<span class="built_in">end</span>(); it++) <span class="keyword">if</span>(*it == x) <span class="keyword">break</span>;</span><br><span class="line">            <span class="built_in">assert</span>(it != vec[pos[x]/ S].<span class="built_in">end</span>());</span><br><span class="line">            vec[pos[x] / S].<span class="built_in">erase</span>(it);</span><br><span class="line">            flag[pos[x]] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="sqrt-tree"><a href="#sqrt-tree" class="headerlink" title="sqrt tree"></a>sqrt tree</h1><p>ç»™å‡ºä¸€ä¸ªåºåˆ—$\{a_n\}$ä¸ä¸€ä¸ªæ»¡è¶³ç»“åˆå¾‹çš„è¿ç®—$<em>$ï¼Œå¦‚æœè¦å¯¹åŒºé—´$[l,r]$è¯¢é—®è®¡ç®—$a_l </em> a_{l+1}<em>â€¦</em>a_r$æ—¶ï¼Œsqrt treeå¯ä»¥åœ¨$O(nloglogn)$çš„æ—¶é—´ä¸å¤„ç†ï¼Œ$O1$çš„æ—¶é—´å†…å›ç­”ã€‚</p><p>è¿™æ£µæ ‘å¤§æ¦‚æ˜¯å¯¹æ¯ä¸€ä¸ªå—éƒ½ä¸æ–­åœ°åˆ†å—ï¼Œæœ€ç»ˆåˆ°è¾¾åªæœ‰ä¸€ä¸ªå…ƒç´ çš„å¶å­å—ã€‚å› ä¸ºç½‘ä¸Šåªæœ‰å¯¥å¯¥å‡ ç¯‡åšæ–‡ä»¥åŠ<a href="https://oi-wiki.org/ds/sqrt-tree/">oiwiki</a>ä¸Šçš„ä»‹ç»ï¼Œæ„Ÿè§‰ä¸æ˜¯ç‰¹åˆ«æœ‰ç”¨çš„çŸ¥è¯†ç‚¹ï¼ˆ<del>å¤§æ¦‚å¯èƒ½ç”¨äºå¡å¸¸æˆ–è€…å¤„ç†æ¯’ç˜¤é¢˜ç­‰</del>ï¼‰ï¼Œæ•…æš‚æ—¶å¼ƒå‘ã€‚</p><h1 id="ã€Œåˆ†å—ã€æ•°åˆ—åˆ†å—å…¥é—¨1-â€“-9-by-hzwer"><a href="#ã€Œåˆ†å—ã€æ•°åˆ—åˆ†å—å…¥é—¨1-â€“-9-by-hzwer" class="headerlink" title="ã€Œåˆ†å—ã€æ•°åˆ—åˆ†å—å…¥é—¨1 â€“ 9 by hzwer"></a><a href="http://hzwer.com/8053.html">ã€Œåˆ†å—ã€æ•°åˆ—åˆ†å—å…¥é—¨1 â€“ 9 by hzwer</a></h1>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åˆ†å— </tag>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020æ•°æ®åº“å®éªŒ</title>
      <link href="/2021/01/15/2020%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C/"/>
      <url>/2021/01/15/2020%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C/</url>
      
        <content type="html"><![CDATA[<p>å‰ç«¯ä½¿ç”¨htmlï¼Œåå°ä½¿ç”¨mysqlæ•°æ®åº“ï¼Œä½¿ç”¨phpå¤„ç†æ•°æ®åº“ï¼Œå®Œæˆæ•°æ®åº“è¯¾ç¨‹çš„å­¦ç±ç®¡ç†ç³»ç»Ÿå¤§ä½œä¸šã€‚</p><span id="more"></span><p>ç‰¹æ­¤è®°å½•ï¼Œæœ‰æœºä¼šçš„è¯è¿˜æ˜¯å¸Œæœ›å­¦ä¹ ä¸€ç•ªå…¨æ ˆçš„å†…å®¹ã€‚</p><p><del>åˆ«çš„ç­å¥½åƒåšçš„éƒ½ç»˜å£°ç»˜è‰²çš„ï¼Œæˆ‘ä»¬ç­éªŒæ”¶è€…åˆ™å¯¥å¯¥ï¼Œæˆ‘å¤ªèœäº†</del></p><p>[toc]</p><h1 id="å‰å°htmlæœåŠ¡"><a href="#å‰å°htmlæœåŠ¡" class="headerlink" title="å‰å°htmlæœåŠ¡"></a>å‰å°htmlæœåŠ¡</h1><p>å†™çš„éå¸¸ä¸‘é™‹ï¼Œå¾ˆå¤šå†—ä½™çš„ä»£ç ï¼Œè‡ªå·±ç¡®å®å®Œå…¨æ˜¯ä¸ªé—¨å¤–æ±‰qaq</p><p><del>æ²¡æœ‰css æˆ‘ä¸ä¼š</del></p><h2 id="mysql-html"><a href="#mysql-html" class="headerlink" title="mysql.html"></a>mysql.html</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span> æ•°æ®åº“å¤§ä½œä¸š<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span> å­¦ç±ç®¡ç†ç³»ç»Ÿ<span class="tag">&lt;/<span class="name">h1</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;fun0.html&quot;</span>&gt;</span> <span class="tag">&lt;<span class="name">h3</span>&gt;</span> admin<span class="tag">&lt;/<span class="name">h3</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;fun1.html&quot;</span>&gt;</span> <span class="tag">&lt;<span class="name">h3</span>&gt;</span> åŠŸèƒ½1: å½•å…¥å­¦ç”ŸåŸºæœ¬ä¿¡æ¯  <span class="tag">&lt;/<span class="name">h3</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;fun2.html&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">h3</span>&gt;</span> åŠŸèƒ½2: å½•å…¥å­¦ç”Ÿè¯¾ç¨‹æˆç»©<span class="tag">&lt;/<span class="name">h3</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;fun3.html&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">h3</span>&gt;</span> åŠŸèƒ½3: ä¸‰ç§æ–¹å¼æŸ¥è¯¢å­¦ç”ŸåŸºæœ¬ä¿¡æ¯<span class="tag">&lt;/<span class="name">h3</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;fun4.html&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">h3</span>&gt;</span> åŠŸèƒ½4: æŸ¥è¯¢å­¦ç”Ÿè¯¾ç¨‹ä¿¡æ¯<span class="tag">&lt;/<span class="name">h3</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;fun5.html&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">h3</span>&gt;</span> åŠŸèƒ½5: æŸ¥è¯¢å­¦ç”Ÿè¢«å“ªäº›è€å¸ˆæ•™è¿‡è¯¾<span class="tag">&lt;/<span class="name">h3</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;fun6.html&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">h3</span>&gt;</span> åŠŸèƒ½6: æŸ¥è¯¢å¿«è¦è¢«å¼€é™¤çš„å­¦ç”Ÿ<span class="tag">&lt;/<span class="name">h3</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="fun0-html"><a href="#fun0-html" class="headerlink" title="fun0.html"></a>fun0.html</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span> æ•°æ®åº“å¤§ä½œä¸š<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- &lt;script type=&quot;text/javascript&quot; src=&quot;../db.js&quot;&gt;&lt;/script&gt; --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;mysql.html&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">h1</span>&gt;</span> å­¦ç±ç®¡ç†ç³»ç»Ÿ<span class="tag">&lt;/<span class="name">h1</span>&gt;</span> <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span> <span class="attr">style</span>=<span class="string">&quot;margin-left: 2em&quot;</span>&gt;</span> æ˜¾ç¤ºæ‰€æœ‰è¡¨çš„ä¿¡æ¯:  <span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">style</span>=<span class="string">&quot;margin-left: 4em&quot;</span> <span class="attr">action</span>=<span class="string">&quot;mysql.php&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">value</span>=<span class="string">&quot;QUERY&quot;</span> <span class="attr">name</span>=<span class="string">&quot;op&quot;</span>&gt;</span>   </span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Query!&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span> <span class="attr">style</span>=<span class="string">&quot;margin-left: 2em&quot;</span>&gt;</span> æ‰§è¡Œä¸€å †sqlè¯­å¥  <span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">style</span>=<span class="string">&quot;margin-left: 4em&quot;</span> <span class="attr">action</span>=<span class="string">&quot;mysql.php&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">value</span>=<span class="string">&quot;DO&quot;</span> <span class="attr">name</span>=<span class="string">&quot;op&quot;</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">style</span>=<span class="string">&quot;height: 10em; width: 50em&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sql&quot;</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Submit!&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="fun1-html"><a href="#fun1-html" class="headerlink" title="fun1.html"></a>fun1.html</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span> æ•°æ®åº“å¤§ä½œä¸š<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- &lt;script type=&quot;text/javascript&quot; src=&quot;../db.js&quot;&gt;&lt;/script&gt; --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;mysql.html&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">h1</span>&gt;</span> å­¦ç±ç®¡ç†ç³»ç»Ÿ<span class="tag">&lt;/<span class="name">h1</span>&gt;</span> <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span> <span class="attr">style</span>=<span class="string">&quot;margin-left: 2em&quot;</span>&gt;</span> åŠŸèƒ½1: å½•å…¥å­¦ç”ŸåŸºæœ¬ä¿¡æ¯  <span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">style</span>=<span class="string">&quot;margin-left: 4em&quot;</span> <span class="attr">action</span>=<span class="string">&quot;mysql.php&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span> <span class="attr">name</span>=<span class="string">&quot;op&quot;</span>&gt;</span></span><br><span class="line">    å§“åï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>= <span class="string">&quot;sname&quot;</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    å­¦å·ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>= <span class="string">&quot;sno&quot;</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    æ€§åˆ«ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;ssex&quot;</span> <span class="attr">value</span>=<span class="string">&quot;male&quot;</span>&gt;</span>ç”· <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;ssex&quot;</span> <span class="attr">value</span>=<span class="string">&quot;femail&quot;</span>&gt;</span>å¥³<span class="tag">&lt;<span class="name">br</span>&gt;</span> </span><br><span class="line">    å‡ºç”Ÿå¹´æœˆï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sbirthyear&quot;</span>&gt;</span>å¹´<span class="tag">&lt;<span class="name">space</span>&gt;</span><span class="tag">&lt;/<span class="name">space</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sbirthmonth&quot;</span>&gt;</span>æœˆ<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    ç­çº§ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>= <span class="string">&quot;class&quot;</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Submit&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="fun2-html"><a href="#fun2-html" class="headerlink" title="fun2.html"></a>fun2.html</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span> æ•°æ®åº“å¤§ä½œä¸š<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- &lt;script type=&quot;text/javascript&quot; src=&quot;../db.js&quot;&gt;&lt;/script&gt; --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;mysql.html&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">h1</span>&gt;</span> å­¦ç±ç®¡ç†ç³»ç»Ÿ<span class="tag">&lt;/<span class="name">h1</span>&gt;</span> <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span> <span class="attr">style</span>=<span class="string">&quot;margin-left: 2em&quot;</span>&gt;</span> åŠŸèƒ½2: å½•å…¥å­¦ç”Ÿè¯¾ç¨‹æˆç»©  <span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">style</span>=<span class="string">&quot;margin-left: 4em&quot;</span> <span class="attr">action</span>=<span class="string">&quot;mysql.php&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">value</span>=<span class="string">&quot;2&quot;</span> <span class="attr">name</span>=<span class="string">&quot;op&quot;</span>&gt;</span>   </span><br><span class="line">    å­¦å·ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>= <span class="string">&quot;sno&quot;</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    è¯¾ç¨‹åï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>= <span class="string">&quot;cname&quot;</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    æˆç»©ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>= <span class="string">&quot;grade&quot;</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    æ˜¯å¦æ˜¯è¡¥è€ƒï¼Ÿæ˜¯<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;flag&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>&gt;</span> å¦ <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;flag&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0&quot;</span> <span class="attr">checked</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æäº¤&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="fun3-html"><a href="#fun3-html" class="headerlink" title="fun3.html"></a>fun3.html</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span> æ•°æ®åº“å¤§ä½œä¸š<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- &lt;script type=&quot;text/javascript&quot; src=&quot;../db.js&quot;&gt;&lt;/script&gt; --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;mysql.html&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">h1</span>&gt;</span> å­¦ç±ç®¡ç†ç³»ç»Ÿ<span class="tag">&lt;/<span class="name">h1</span>&gt;</span> <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span> <span class="attr">style</span>=<span class="string">&quot;margin-left: 2em&quot;</span>&gt;</span> åŠŸèƒ½3.1: æŒ‰ç…§å­¦å·æŸ¥è¯¢å­¦ç”Ÿä¿¡æ¯  <span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">style</span>=<span class="string">&quot;margin-left: 4em&quot;</span> <span class="attr">action</span>=<span class="string">&quot;mysql.php&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">value</span>=<span class="string">&quot;31&quot;</span> <span class="attr">name</span>=<span class="string">&quot;op&quot;</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sno&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æäº¤&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span> <span class="attr">style</span>=<span class="string">&quot;margin-left: 2em&quot;</span>&gt;</span> åŠŸèƒ½3.2: æŒ‰ç…§å§“åæŸ¥è¯¢å­¦ç”Ÿä¿¡æ¯  <span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">style</span>=<span class="string">&quot;margin-left: 4em&quot;</span> <span class="attr">action</span>=<span class="string">&quot;mysql.php&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">value</span>=<span class="string">&quot;32&quot;</span> <span class="attr">name</span>=<span class="string">&quot;op&quot;</span>&gt;</span>   </span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sname&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æäº¤&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span> <span class="attr">style</span>=<span class="string">&quot;margin-left: 2em&quot;</span>&gt;</span> åŠŸèƒ½3.3: æŒ‰ç…§ä¸“ä¸šæŸ¥è¯¢å­¦ç”Ÿä¿¡æ¯  <span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">style</span>=<span class="string">&quot;margin-left: 4em&quot;</span> <span class="attr">action</span>=<span class="string">&quot;mysql.php&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">value</span>=<span class="string">&quot;33&quot;</span> <span class="attr">name</span>=<span class="string">&quot;op&quot;</span>&gt;</span>   </span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;major&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æäº¤&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="fun4-html"><a href="#fun4-html" class="headerlink" title="fun4.html"></a>fun4.html</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span> æ•°æ®åº“å¤§ä½œä¸š<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- &lt;script type=&quot;text/javascript&quot; src=&quot;../db.js&quot;&gt;&lt;/script&gt; --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;mysql.html&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">h1</span>&gt;</span> å­¦ç±ç®¡ç†ç³»ç»Ÿ<span class="tag">&lt;/<span class="name">h1</span>&gt;</span> <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span> <span class="attr">style</span>=<span class="string">&quot;margin-left: 2em&quot;</span>&gt;</span> åŠŸèƒ½4: æŸ¥è¯¢å­¦ç”Ÿè¯¾ç¨‹æˆç»©  <span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">style</span>=<span class="string">&quot;margin-left: 4em&quot;</span> <span class="attr">action</span>=<span class="string">&quot;mysql.php&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">value</span>=<span class="string">&quot;4&quot;</span> <span class="attr">name</span>=<span class="string">&quot;op&quot;</span>&gt;</span>   </span><br><span class="line">    å­¦å·ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>= <span class="string">&quot;sno&quot;</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Submit&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="fun5-html"><a href="#fun5-html" class="headerlink" title="fun5.html"></a>fun5.html</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span> æ•°æ®åº“å¤§ä½œä¸š<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- &lt;script type=&quot;text/javascript&quot; src=&quot;../db.js&quot;&gt;&lt;/script&gt; --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;mysql.html&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">h1</span>&gt;</span> å­¦ç±ç®¡ç†ç³»ç»Ÿ<span class="tag">&lt;/<span class="name">h1</span>&gt;</span> <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span> <span class="attr">style</span>=<span class="string">&quot;margin-left: 2em&quot;</span>&gt;</span> åŠŸèƒ½5: æŸ¥è¯¢å­¦ç”Ÿè¢«å“ªäº›è€å¸ˆæ•™è¿‡è¯¾  <span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">style</span>=<span class="string">&quot;margin-left: 4em&quot;</span> <span class="attr">action</span>=<span class="string">&quot;mysql.php&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">value</span>=<span class="string">&quot;5&quot;</span> <span class="attr">name</span>=<span class="string">&quot;op&quot;</span>&gt;</span>   </span><br><span class="line">    å­¦å·ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>= <span class="string">&quot;sno&quot;</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æäº¤&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="fun6-html"><a href="#fun6-html" class="headerlink" title="fun6.html"></a>fun6.html</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span> æ•°æ®åº“å¤§ä½œä¸š<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- &lt;script type=&quot;text/javascript&quot; src=&quot;../db.js&quot;&gt;&lt;/script&gt; --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;mysql.html&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">h1</span>&gt;</span> å­¦ç±ç®¡ç†ç³»ç»Ÿ<span class="tag">&lt;/<span class="name">h1</span>&gt;</span> <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span> <span class="attr">style</span>=<span class="string">&quot;margin-left: 2em&quot;</span>&gt;</span> åŠŸèƒ½6: æŸ¥è¯¢æ‰€æœ‰å°†è¦/å·²ç»è¢«å¼€é™¤çš„å­¦ç”Ÿä¿¡æ¯  <span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">style</span>=<span class="string">&quot;margin-left: 4em&quot;</span> <span class="attr">action</span>=<span class="string">&quot;mysql.php&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">value</span>=<span class="string">&quot;6&quot;</span> <span class="attr">name</span>=<span class="string">&quot;op&quot;</span>&gt;</span>   </span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æŸ¥è¯¢&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="åå°phpæœåŠ¡"><a href="#åå°phpæœåŠ¡" class="headerlink" title="åå°phpæœåŠ¡"></a>åå°phpæœåŠ¡</h1><p><del>ä¼šè¢«sqlæ³¨å…¥ï¼Œå®¹æ˜“é­åˆ°æ¶æ„æ”»å‡»ï¼Œå®‰å…¨æ€§ä¸ºé›¶ã€‚</del></p><p>ç‰¹åœ°å†™äº†cppç¨‹åºæ¥ç”Ÿæˆæ’å…¥ã€æŸ¥è¯¢ã€ç»˜è¡¨ç­‰æ“ä½œæŒ‡ä»¤ã€‚</p><p>ä¸çŸ¥é“æœ‰æ²¡æœ‰åˆ«çš„ä»€ä¹ˆåŠæ³•æ¥å¼„çš„ç®€æ´æ¼‚äº®ä¸€äº›orz</p><p>è‡ªå·±å¯¹äºåç«¯ä¹Ÿæ˜¯å•¥ä¹Ÿä¸æ‡‚qaq</p><h2 id="mysql-php"><a href="#mysql-php" class="headerlink" title="mysql.php"></a>mysql.php</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;center&gt; &lt;a href=\&quot;mysql.html\&quot;&gt;&lt;h1&gt; å­¦ç±ç®¡ç†ç³»ç»Ÿ&lt;/h1&gt; &lt;/a&gt;&lt;/center&gt;&lt;br&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$conn</span> = mysqli_connect(<span class="string">&quot;localhost:3306&quot;</span>, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;xxxx&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$conn</span>) <span class="keyword">die</span>(<span class="string">&quot;è¿æ¥æ•°æ®åº“å¤±è´¥: &quot;</span> . mysqli_error(<span class="variable">$conn</span>));</span><br><span class="line"><span class="keyword">if</span>(!mysqli_query(<span class="variable">$conn</span>, <span class="string">&quot;use db&quot;</span>)) <span class="keyword">die</span>(<span class="string">&quot;é€‰æ‹©æ•°æ®åº“å¤±è´¥: &quot;</span> . mysqli_error(<span class="variable">$conn</span>));</span><br><span class="line"></span><br><span class="line"><span class="variable">$op</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;op&#x27;</span>];</span><br><span class="line"><span class="comment">//æŸ¥è¯¢æ‰€æœ‰è¡¨çš„æ‰€æœ‰ä¿¡æ¯ã€‚</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$op</span> == <span class="string">&#x27;QUERY&#x27;</span>)&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;h2&gt; æŸ¥è¯¢ç»“æœå¦‚ä¸‹æ‰€ç¤º: &lt;br&gt;&lt;br&gt;&lt;/h2&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$res</span> = mysqli_query(<span class="variable">$conn</span>, <span class="string">&quot;select * from classinfo&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="variable">$res</span>) <span class="keyword">die</span>(<span class="string">&quot;æ— æ³•è¯»å–æ•°æ®: &quot;</span> . mysqli_error(<span class="variable">$conn</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;h4&gt; ç­çº§--ä¸“ä¸šè¡¨classinfo&lt;br&gt;&lt;/h4&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;table border=&quot;1&quot;&gt;&lt;tr&gt;&lt;td&gt;class&lt;/td&gt;&lt;td&gt;major&lt;/td&gt;&lt;/tr&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="variable">$row</span> = mysqli_fetch_array(<span class="variable">$res</span>, MYSQLI_ASSOC))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;tr&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;class&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;major&#x27;]&#125;</span>&lt;/td&gt;&lt;/tr&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;/table&gt;&lt;br&gt;&lt;br&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$res</span> = mysqli_query(<span class="variable">$conn</span>, <span class="string">&quot;select * from course&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="variable">$res</span>) <span class="keyword">die</span>(<span class="string">&quot;æ— æ³•è¯»å–æ•°æ®: &quot;</span> . mysqli_error(<span class="variable">$conn</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;h4&gt; è¯¾ç¨‹--å­¦åˆ†è¡¨course &lt;br&gt;&lt;/h4&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;table border=&quot;1&quot;&gt;&lt;tr&gt;&lt;td&gt;cname&lt;/td&gt;&lt;td&gt;ccre&lt;/td&gt;&lt;/tr&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="variable">$row</span> = mysqli_fetch_array(<span class="variable">$res</span>, MYSQLI_ASSOC))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;tr&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;cname&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;ccre&#x27;]&#125;</span>&lt;/td&gt;&lt;/tr&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;/table&gt;&lt;br&gt;&lt;br&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$res</span> = mysqli_query(<span class="variable">$conn</span>, <span class="string">&quot;select * from stu&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="variable">$res</span>) <span class="keyword">die</span>(<span class="string">&quot;æ— æ³•è¯»å–æ•°æ®: &quot;</span> . mysqli_error(<span class="variable">$conn</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;h4&gt; å­¦ç”Ÿä¿¡æ¯è¡¨stu &lt;br&gt;&lt;/h4&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;table border=&quot;1&quot;&gt;&lt;tr&gt;&lt;td&gt;sno&lt;/td&gt;&lt;td&gt;sname&lt;/td&gt;&lt;td&gt;ssex&lt;/td&gt;&lt;td&gt;sbirthyear&lt;/td&gt;&lt;td&gt;sbirthmonth&lt;/td&gt;&lt;td&gt;class&lt;/td&gt;&lt;/tr&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="variable">$row</span> = mysqli_fetch_array(<span class="variable">$res</span>, MYSQLI_ASSOC))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;tr&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;sno&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;sname&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;ssex&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;sbirthyear&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;sbirthmonth&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;class&#x27;]&#125;</span>&lt;/td&gt;&lt;/tr&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;/table&gt;&lt;br&gt;&lt;br&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$res</span> = mysqli_query(<span class="variable">$conn</span>, <span class="string">&quot;select * from schedule&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="variable">$res</span>) <span class="keyword">die</span>(<span class="string">&quot;æ— æ³•è¯»å–æ•°æ®: &quot;</span> . mysqli_error(<span class="variable">$conn</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;h4&gt; åŸ¹å…»æ–¹æ¡ˆè¡¨schedule &lt;br&gt;&lt;/h4&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;table border=&quot;1&quot;&gt;&lt;tr&gt;&lt;td&gt;major&lt;/td&gt;&lt;td&gt;cname&lt;/td&gt;&lt;td&gt;iscompulsory&lt;/td&gt;&lt;td&gt;cdate&lt;/td&gt;&lt;/tr&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="variable">$row</span> = mysqli_fetch_array(<span class="variable">$res</span>, MYSQLI_ASSOC))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;tr&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;major&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;cname&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;iscompulsory&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;cdate&#x27;]&#125;</span>&lt;/td&gt;&lt;/tr&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;/table&gt;&lt;br&gt;&lt;br&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$res</span> = mysqli_query(<span class="variable">$conn</span>, <span class="string">&quot;select * from teaching&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="variable">$res</span>) <span class="keyword">die</span>(<span class="string">&quot;æ— æ³•è¯»å–æ•°æ®: &quot;</span> . mysqli_error(<span class="variable">$conn</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;h4&gt; å¸¦è¯¾æƒ…å†µè¡¨teaching&lt;br&gt;&lt;/h4&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;table border=&quot;1&quot;&gt;&lt;tr&gt;&lt;td&gt;class&lt;/td&gt;&lt;td&gt;cname&lt;/td&gt;&lt;td&gt;tname&lt;/td&gt;&lt;/tr&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="variable">$row</span> = mysqli_fetch_array(<span class="variable">$res</span>, MYSQLI_ASSOC))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;tr&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;class&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;cname&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;tname&#x27;]&#125;</span>&lt;/td&gt;&lt;/tr&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;/table&gt;&lt;br&gt;&lt;br&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$res</span> = mysqli_query(<span class="variable">$conn</span>, <span class="string">&quot;select * from sc&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="variable">$res</span>) <span class="keyword">die</span>(<span class="string">&quot;æ— æ³•è¯»å–æ•°æ®: &quot;</span> . mysqli_error(<span class="variable">$conn</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;h4&gt; é€‰è¯¾æˆç»©è¡¨teaching&lt;br&gt;&lt;/h4&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;table border=&quot;1&quot;&gt;&lt;tr&gt;&lt;td&gt;sno&lt;/td&gt;&lt;td&gt;cname&lt;/td&gt;&lt;td&gt;grade&lt;/td&gt;&lt;td&gt;æ˜¯å¦æ˜¯è¡¥è€ƒæˆç»©&lt;/td&gt;&lt;/tr&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="variable">$row</span> = mysqli_fetch_array(<span class="variable">$res</span>, MYSQLI_ASSOC))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;tr&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;sno&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;cname&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;grade&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;flag&#x27;]&#125;</span>&lt;/td&gt;&lt;/tr&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;/table&gt;&lt;br&gt;&lt;br&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;/center&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$op</span> == <span class="string">&#x27;DO&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$sql</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;sql&#x27;</span>];</span><br><span class="line">    <span class="comment">// if(!mysqli_query($conn, $sql)) die(&quot;DOå¤±è´¥: &quot; . mysqli_error($conn));</span></span><br><span class="line">    <span class="keyword">if</span>(!mysqli_multi_query(<span class="variable">$conn</span>, <span class="variable">$sql</span>)) <span class="keyword">die</span>(<span class="string">&quot;DOå¤±è´¥: &quot;</span> . mysqli_error(<span class="variable">$conn</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$op</span> == <span class="string">&#x27;1&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$sno</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;sno&#x27;</span>];</span><br><span class="line">    <span class="variable">$sname</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;sname&#x27;</span>];</span><br><span class="line">    <span class="variable">$ssex</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ssex&#x27;</span>];</span><br><span class="line">    <span class="variable">$sbirthyear</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;sbirthyear&#x27;</span>];</span><br><span class="line">    <span class="variable">$sbirthmonth</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;sbirthmonth&#x27;</span>];</span><br><span class="line">    <span class="variable">$class</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;class&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="variable">$sql</span> = <span class="string">&quot;insert into stu (sno, sname, ssex, sbirthyear, sbirthmonth, class) values(</span></span><br><span class="line"><span class="string">        &#x27;&quot;</span> .<span class="variable">$sno</span> .<span class="string">&quot;&#x27;,</span></span><br><span class="line"><span class="string">        &#x27;&quot;</span> .<span class="variable">$sname</span> .<span class="string">&quot;&#x27;,</span></span><br><span class="line"><span class="string">        &#x27;&quot;</span> .<span class="variable">$ssex</span> .<span class="string">&quot;&#x27;,</span></span><br><span class="line"><span class="string">        &#x27;&quot;</span> .<span class="variable">$sbirthyear</span> .<span class="string">&quot;&#x27;,</span></span><br><span class="line"><span class="string">        &#x27;&quot;</span> .<span class="variable">$sbirthmonth</span> .<span class="string">&quot;&#x27;,</span></span><br><span class="line"><span class="string">        &#x27;&quot;</span> .<span class="variable">$class</span> .<span class="string">&quot;&#x27;</span></span><br><span class="line"><span class="string">    )&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(!mysqli_query(<span class="variable">$conn</span>, <span class="variable">$sql</span>)) <span class="keyword">die</span>(<span class="string">&quot;æ“ä½œ1æ‰§è¡Œå¤±è´¥ï¼Œæ— æ³•æ’å…¥: &quot;</span> . mysqli_error(<span class="variable">$conn</span>));</span><br><span class="line">    <span class="comment">// echo $sql;</span></span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$op</span> == <span class="string">&#x27;2&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$sno</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;sno&#x27;</span>];</span><br><span class="line">    <span class="variable">$cname</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;cname&#x27;</span>];</span><br><span class="line">    <span class="variable">$grade</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;grade&#x27;</span>];</span><br><span class="line">    <span class="variable">$flag</span> =<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$fail</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$flag</span> == <span class="string">&#x27;1&#x27;</span>)&#123;</span><br><span class="line">        <span class="variable">$sql</span> = <span class="string">&quot;select * from sc where sno = &#x27;&quot;</span> .<span class="variable">$sno</span> .<span class="string">&quot;&#x27; AND cname = &#x27;&quot;</span> .<span class="variable">$cname</span> .<span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">        <span class="variable">$res</span> = mysqli_query(<span class="variable">$conn</span>, <span class="variable">$sql</span>);</span><br><span class="line">        <span class="keyword">while</span>(<span class="variable">$row</span> = mysqli_fetch_array(<span class="variable">$res</span>, MYSQLI_ASSOC))&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$row</span>[<span class="string">&#x27;flag&#x27;</span>] == <span class="number">1</span>)&#123;</span><br><span class="line">                <span class="variable">$fail</span> = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$row</span>[<span class="string">&#x27;grade&#x27;</span>] &gt; <span class="variable">$grade</span>)&#123;</span><br><span class="line">                <span class="variable">$fail</span> = <span class="number">2</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$fail</span> == <span class="number">1</span>) <span class="keyword">die</span>(<span class="string">&quot;&lt;center&gt;è¯¥å­¦ç”Ÿå·²ç»è¡¥è€ƒè¿‡ä¸€æ¬¡, ä¸å¾—å†æ¬¡è¡¥è€ƒ!&lt;/center&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$fail</span> == <span class="number">2</span>) <span class="keyword">die</span>(<span class="string">&quot;&lt;center&gt;è¯¥å­¦ç”Ÿè¡¥è€ƒæˆç»©ä¸å¦‚æ­£å¼è€ƒè¯•!ä¸äºˆä¿®æ”¹!&lt;/center&gt;&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$sql</span> = <span class="string">&quot;update sc</span></span><br><span class="line"><span class="string">        set grade = &#x27;&quot;</span> .<span class="variable">$grade</span> .<span class="string">&quot;&#x27;,</span></span><br><span class="line"><span class="string">        flag = &#x27;1&#x27;</span></span><br><span class="line"><span class="string">        where sno = &#x27;&quot;</span> .<span class="variable">$sno</span> .<span class="string">&quot;&#x27;</span></span><br><span class="line"><span class="string">        AND cname = &#x27;&quot;</span> .<span class="variable">$cname</span> .<span class="string">&quot;&#x27;</span></span><br><span class="line"><span class="string">        &quot;</span>;</span><br><span class="line">        <span class="comment">// echo $sql. &#x27;&lt;br&gt;&#x27;;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$sql</span> = <span class="string">&quot;insert into sc (sno, cname, grade, flag) values(</span></span><br><span class="line"><span class="string">            &#x27;&quot;</span> .<span class="variable">$sno</span> .<span class="string">&quot;&#x27;,</span></span><br><span class="line"><span class="string">            &#x27;&quot;</span> .<span class="variable">$cname</span> .<span class="string">&quot;&#x27;,</span></span><br><span class="line"><span class="string">            &#x27;&quot;</span> .<span class="variable">$grade</span> .<span class="string">&quot;&#x27;,</span></span><br><span class="line"><span class="string">            &#x27;&quot;</span> .<span class="variable">$flag</span> . <span class="string">&quot;&#x27;</span></span><br><span class="line"><span class="string">        )&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(!mysqli_query(<span class="variable">$conn</span>, <span class="variable">$sql</span>)) <span class="keyword">die</span>(<span class="string">&quot;æ’å…¥æˆç»©å¤±è´¥: &quot;</span> . mysqli_error(<span class="variable">$conn</span>));</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$op</span> == <span class="string">&#x27;31&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$sno</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;sno&#x27;</span>];</span><br><span class="line">    <span class="variable">$sql</span> = <span class="string">&quot;select * from stu where sno=&#x27;&quot;</span> .<span class="variable">$sno</span> .<span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">    <span class="variable">$res</span> = mysqli_query(<span class="variable">$conn</span>, <span class="variable">$sql</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="variable">$res</span>) <span class="keyword">die</span>(<span class="string">&quot;æ— æ³•è¯»å–æ•°æ®: &quot;</span> . mysqli_error(<span class="variable">$conn</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;h4&gt; å­¦ç”Ÿä¿¡æ¯è¡¨stu &lt;br&gt;&lt;/h4&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;table border=&quot;1&quot;&gt;&lt;tr&gt;&lt;td&gt;å­¦å·&lt;/td&gt;&lt;td&gt;å­¦ç”Ÿå§“å&lt;/td&gt;&lt;td&gt;æ€§åˆ«&lt;/td&gt;&lt;td&gt;å‡ºç”Ÿå¹´ä»½&lt;/td&gt;&lt;td&gt;å‡ºç”Ÿæœˆä»½&lt;/td&gt;&lt;td&gt;ç­çº§&lt;/td&gt;&lt;/tr&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="variable">$row</span> = mysqli_fetch_array(<span class="variable">$res</span>, MYSQLI_ASSOC))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;tr&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;sno&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;sname&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;ssex&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;sbirthyear&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;sbirthmonth&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;class&#x27;]&#125;</span>&lt;/td&gt;&lt;/tr&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;/table&gt;&lt;br&gt;&lt;br&gt;&lt;/center&gt;&#x27;</span>;</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$op</span> == <span class="string">&#x27;32&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$sname</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;sname&#x27;</span>];</span><br><span class="line">    <span class="variable">$sql</span> = <span class="string">&quot;select * from stu where sname=&#x27;&quot;</span> .<span class="variable">$sname</span> .<span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">    <span class="variable">$res</span> = mysqli_query(<span class="variable">$conn</span>, <span class="variable">$sql</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="variable">$res</span>) <span class="keyword">die</span>(<span class="string">&quot;æ— æ³•è¯»å–æ•°æ®: &quot;</span> . mysqli_error(<span class="variable">$conn</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;h4&gt; å­¦ç”Ÿä¿¡æ¯è¡¨stu &lt;br&gt;&lt;/h4&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;table border=&quot;1&quot;&gt;&lt;tr&gt;&lt;td&gt;å­¦å·&lt;/td&gt;&lt;td&gt;å­¦ç”Ÿå§“å&lt;/td&gt;&lt;td&gt;æ€§åˆ«&lt;/td&gt;&lt;td&gt;å‡ºç”Ÿå¹´ä»½&lt;/td&gt;&lt;td&gt;å‡ºç”Ÿæœˆä»½&lt;/td&gt;&lt;td&gt;ç­çº§&lt;/td&gt;&lt;/tr&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="variable">$row</span> = mysqli_fetch_array(<span class="variable">$res</span>, MYSQLI_ASSOC))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;tr&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;sno&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;sname&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;ssex&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;sbirthyear&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;sbirthmonth&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;class&#x27;]&#125;</span>&lt;/td&gt;&lt;/tr&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;/table&gt;&lt;br&gt;&lt;br&gt;&lt;/center&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$op</span> == <span class="string">&#x27;33&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$major</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;major&#x27;</span>];</span><br><span class="line">    <span class="variable">$sql</span> = <span class="string">&quot;select * from stu, classinfo where stu.class=classinfo.class AND classinfo.major = &#x27;&quot;</span> .<span class="variable">$major</span>. <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">    <span class="variable">$res</span> = mysqli_query(<span class="variable">$conn</span>, <span class="variable">$sql</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="variable">$res</span>) <span class="keyword">die</span>(<span class="string">&quot;æ— æ³•è¯»å–æ•°æ®: &quot;</span> . mysqli_error(<span class="variable">$conn</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;h4&gt; å­¦ç”Ÿä¿¡æ¯è¡¨stu &lt;br&gt;&lt;/h4&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;table border=&quot;1&quot;&gt;&lt;tr&gt;&lt;td&gt;å­¦å·&lt;/td&gt;&lt;td&gt;å­¦ç”Ÿå§“å&lt;/td&gt;&lt;td&gt;æ€§åˆ«&lt;/td&gt;&lt;td&gt;å‡ºç”Ÿå¹´ä»½&lt;/td&gt;&lt;td&gt;å‡ºç”Ÿæœˆä»½&lt;/td&gt;&lt;td&gt;ç­çº§&lt;/td&gt;&lt;/tr&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="variable">$row</span> = mysqli_fetch_array(<span class="variable">$res</span>, MYSQLI_ASSOC))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;tr&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;sno&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;sname&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;ssex&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;sbirthyear&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;sbirthmonth&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;class&#x27;]&#125;</span>&lt;/td&gt;&lt;/tr&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;/table&gt;&lt;br&gt;&lt;br&gt;&lt;/center&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$op</span> == <span class="string">&#x27;4&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$sno</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;sno&#x27;</span>];</span><br><span class="line">    <span class="variable">$sql</span>=<span class="string">&quot;select * from temp where sno=&#x27;&quot;</span> .<span class="variable">$sno</span>.<span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">    <span class="variable">$res</span> = mysqli_query(<span class="variable">$conn</span>, <span class="variable">$sql</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="variable">$res</span>) <span class="keyword">die</span>(<span class="string">&quot;æ— æ³•è¯»å–æ•°æ®: &quot;</span> . mysqli_error(<span class="variable">$conn</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;h4&gt; å­¦ç”Ÿæˆç»©å• &lt;br&gt;&lt;/h4&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;table border=&quot;1&quot;&gt;&lt;tr&gt;&lt;td&gt;è¯¾ç¨‹å&lt;/td&gt;&lt;td&gt;æ˜¯å¦å¿…ä¿®&lt;/td&gt;&lt;td&gt;è¯¾ç¨‹å¼€è¯¾æ—¶é—´&lt;/td&gt;&lt;td&gt;è¯¾ç¨‹å­¦åˆ†&lt;/td&gt;&lt;td&gt;è¯¾ç¨‹æˆç»©&lt;/td&gt;&lt;td&gt;æ˜¯å¦è¡¥è€ƒ&lt;/td&gt;&lt;/tr&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="variable">$row</span> = mysqli_fetch_array(<span class="variable">$res</span>, MYSQLI_ASSOC))&#123;</span><br><span class="line">        <span class="variable">$temp</span> = <span class="string">&quot;&lt;tr&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;cname&#x27;]&#125;</span>&lt;/td&gt; &lt;td&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$row</span>[<span class="string">&#x27;iscompulsory&#x27;</span>] == <span class="string">&#x27;1&#x27;</span>) <span class="variable">$temp</span> .= <span class="string">&quot;æ˜¯&quot;</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="variable">$temp</span> .= <span class="string">&quot;å¦&quot;</span>;</span><br><span class="line">        <span class="variable">$temp</span> .= <span class="string">&quot;&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;cdate&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;ccre&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;grade&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$row</span>[<span class="string">&#x27;flag&#x27;</span>] == <span class="number">1</span>) <span class="variable">$temp</span> .= <span class="string">&quot;æ˜¯&quot;</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="variable">$temp</span> .= <span class="string">&quot;å¦&quot;</span>;</span><br><span class="line">        <span class="variable">$temp</span> .= <span class="string">&quot;&lt;/td&gt;&lt;/tr&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$temp</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;/table&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$sql</span>=</span><br><span class="line">    <span class="string">&quot;select sno, sum(ccre * grade)/sum(ccre) aver</span></span><br><span class="line"><span class="string">    from temp</span></span><br><span class="line"><span class="string">    where iscompulsory=&#x27;1&#x27; AND sno=&#x27;&quot;</span> .<span class="variable">$sno</span> .<span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">    <span class="variable">$res</span> = mysqli_query(<span class="variable">$conn</span>, <span class="variable">$sql</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="variable">$res</span>) <span class="keyword">die</span>(<span class="string">&quot;æ— æ³•è¯»å–æ•°æ®: &quot;</span> . mysqli_error(<span class="variable">$conn</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;table border=&quot;1&quot;&gt;&lt;tr&gt;&lt;td&gt;å­¦å·&lt;/td&gt;&lt;td&gt;å¿…ä¿®å¹³å‡åˆ†&lt;/td&gt;&lt;/tr&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="variable">$row</span> = mysqli_fetch_array(<span class="variable">$res</span>, MYSQLI_ASSOC))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;tr&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;sno&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;aver&#x27;]&#125;</span>&lt;/td&gt;&lt;/tr&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;/table&gt;&#x27;</span>;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="variable">$sql</span>=</span><br><span class="line">    <span class="string">&quot;select sno, sum(ccre * grade)/sum(ccre) aver</span></span><br><span class="line"><span class="string">    from temp</span></span><br><span class="line"><span class="string">    where sno=&#x27;&quot;</span> .<span class="variable">$sno</span> .<span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">    <span class="variable">$res</span> = mysqli_query(<span class="variable">$conn</span>, <span class="variable">$sql</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="variable">$res</span>) <span class="keyword">die</span>(<span class="string">&quot;æ— æ³•è¯»å–æ•°æ®: &quot;</span> . mysqli_error(<span class="variable">$conn</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;table border=&quot;1&quot;&gt;&lt;tr&gt;&lt;td&gt;å­¦å·&lt;/td&gt;&lt;td&gt;æ€»å¹³å‡åˆ†&lt;/td&gt;&lt;/tr&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="variable">$row</span> = mysqli_fetch_array(<span class="variable">$res</span>, MYSQLI_ASSOC))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;tr&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;sno&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;aver&#x27;]&#125;</span>&lt;/td&gt;&lt;/tr&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;/table&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;/center&gt;&#x27;</span>;</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$op</span> == <span class="string">&#x27;5&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$sno</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;sno&#x27;</span>];</span><br><span class="line">    <span class="variable">$sql</span> = </span><br><span class="line">    <span class="string">&quot;select teaching.tname, teaching.cname</span></span><br><span class="line"><span class="string">    from stu, teaching, sc</span></span><br><span class="line"><span class="string">    where stu.class=teaching.class AND stu.sno=sc.sno AND sc.cname=teaching.cname</span></span><br><span class="line"><span class="string">    AND stu.sno=&#x27;&quot;</span> .<span class="variable">$sno</span>.<span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">    <span class="variable">$res</span> = mysqli_query(<span class="variable">$conn</span>, <span class="variable">$sql</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="variable">$res</span>) <span class="keyword">die</span>(<span class="string">&quot;æ— æ³•è¯»å–æ•°æ®: &quot;</span> . mysqli_error(<span class="variable">$conn</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;h4&gt; å­¦ç”Ÿ-æ•™å¸ˆè¡¨stu &lt;br&gt;&lt;/h4&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;table border=&quot;1&quot;&gt;&lt;tr&gt;&lt;td&gt;æ•™å¸ˆå§“å&lt;/td&gt;&lt;td&gt;è¯¾ç¨‹å&lt;/td&gt;&lt;/tr&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="variable">$row</span> = mysqli_fetch_array(<span class="variable">$res</span>, MYSQLI_ASSOC))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;tr&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;tname&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;cname&#x27;]&#125;</span>&lt;/td&gt;&lt;/tr&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;/table&gt;&lt;/center&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$op</span> == <span class="string">&#x27;6&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$sno</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;sno&#x27;</span>];</span><br><span class="line">    <span class="variable">$sql</span>=</span><br><span class="line">    <span class="string">&quot;select temp.sno , stu.sname, sum(temp.ccre) sumcre</span></span><br><span class="line"><span class="string">    from temp, stu</span></span><br><span class="line"><span class="string">    where temp.iscompulsory=&#x27;1&#x27; AND temp.grade &lt; 60 AND temp.sno=stu.sno</span></span><br><span class="line"><span class="string">    group by temp.sno</span></span><br><span class="line"><span class="string">    having sum(temp.ccre) &gt; 7&quot;</span>;</span><br><span class="line">    <span class="variable">$res</span> = mysqli_query(<span class="variable">$conn</span>, <span class="variable">$sql</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="variable">$res</span>) <span class="keyword">die</span>(<span class="string">&quot;æ— æ³•è¯»å–æ•°æ®: &quot;</span> . mysqli_error(<span class="variable">$conn</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;h4&gt; å­¦ç”Ÿå¼€é™¤è¡¨(å¿…ä¿®)&lt;br&gt;&lt;/h4&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;table border=&quot;1&quot;&gt;&lt;tr&gt;&lt;td&gt;å­¦å·&lt;/td&gt;&lt;td&gt;å­¦ç”Ÿå§“å&lt;/td&gt;&lt;td&gt;ä¸åŠæ ¼å­¦åˆ†&lt;/td&gt;&lt;/tr&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="variable">$row</span> = mysqli_fetch_array(<span class="variable">$res</span>, MYSQLI_ASSOC))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;tr&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;sno&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;sname&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;sumcre&#x27;]&#125;</span>&lt;/td&gt;&lt;/tr&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;/table&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="variable">$sql</span>=</span><br><span class="line">    <span class="string">&quot;select temp.sno , stu.sname, sum(temp.ccre) sumcre</span></span><br><span class="line"><span class="string">    from temp, stu</span></span><br><span class="line"><span class="string">    where temp.iscompulsory=&#x27;0&#x27; AND temp.grade &lt; 60 AND temp.sno=stu.sno</span></span><br><span class="line"><span class="string">    group by temp.sno</span></span><br><span class="line"><span class="string">    having sum(temp.ccre) &gt; 12&quot;</span>;</span><br><span class="line">    <span class="variable">$res</span> = mysqli_query(<span class="variable">$conn</span>, <span class="variable">$sql</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="variable">$res</span>) <span class="keyword">die</span>(<span class="string">&quot;æ— æ³•è¯»å–æ•°æ®: &quot;</span> . mysqli_error(<span class="variable">$conn</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;h4&gt; å­¦ç”Ÿå¼€é™¤è¡¨(é€‰ä¿®)&lt;br&gt;&lt;/h4&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;table border=&quot;1&quot;&gt;&lt;tr&gt;&lt;td&gt;å­¦å·&lt;/td&gt;&lt;td&gt;å­¦ç”Ÿå§“å&lt;/td&gt;&lt;td&gt;ä¸åŠæ ¼å­¦åˆ†&lt;/td&gt;&lt;/tr&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="variable">$row</span> = mysqli_fetch_array(<span class="variable">$res</span>, MYSQLI_ASSOC))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;tr&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;sno&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;sname&#x27;]&#125;</span>&lt;/td&gt;&lt;td&gt;<span class="subst">&#123;$row[&#x27;sumcre&#x27;]&#125;</span>&lt;/td&gt;&lt;/tr&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;/table&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span> <span class="keyword">die</span>(<span class="string">&quot;è¯·æ±‚çš„æ“ä½œç æœ‰è¯¯&quot;</span>);</span><br><span class="line"><span class="variable">$conn</span>-&gt;close();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;center&gt;&lt;br&gt;&quot;</span> . <span class="string">&quot;å®Œæˆ&quot;</span>. <span class="string">&quot;&lt;br&gt;&lt;/center&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰åç«¯ </tag>
            
            <tag> SQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CF-edu102</title>
      <link href="/2021/01/15/CF-edu102/"/>
      <url>/2021/01/15/CF-edu102/</url>
      
        <content type="html"><![CDATA[<p><strong><a href="https://codeforces.ml/contest/1473">Educational Codeforces Round 102 (Rated for Div. 2)</a></strong></p><span id="more"></span><p>[toc]</p><h2 id="B-æ°´é¢˜"><a href="#B-æ°´é¢˜" class="headerlink" title="B æ°´é¢˜"></a>B æ°´é¢˜</h2><p>ç®€å•çš„é¢˜ç›®å› ä¸ºå¿˜è®°è®¾ç½®a[n] = 0ä½œä¸ºå­—ç¬¦ä¸²<code>a[0, ..., n-1]</code>çš„ç»“å°¾å¯¼è‡´å¤šç»„æ•°æ®çš„æƒ…å†µä¸‹å‡ºç°ç¥ç§˜çš„é”™è¯¯ã€‚</p><p><del>å¤ªä¹…ä¸è®­ç»ƒå¯¼è‡´çŠ¶æ€éå¸¸å·®qaq</del></p><h2 id="D-æ°´é¢˜"><a href="#D-æ°´é¢˜" class="headerlink" title="D æ°´é¢˜"></a>D æ°´é¢˜</h2><p><del>ä¸ºä»€ä¹ˆæˆ‘è¦ç”¨çº¿æ®µæ ‘å†™ï¼Ÿï¼Ÿï¼Ÿ</del></p><p>å®é™…ä¸Šç®€å•åœ°ç»´æŠ¤åŒºé—´+-æ“ä½œæ‰€èƒ½å¾—åˆ°çš„æ•°å€¼åŒºé—´ï¼Œæ‰£å»ä¸­é—´ä¸€æ®µï¼Œåˆ©ç”¨å…¶åç§»é‡å³å¯å¾ˆå¿«çš„çŸ¥é“å·¦å³ä¸¤ç«¯çš„æ•°å€¼åŒºé—´ã€‚</p><h2 id="C-é€†åºå¯¹-amp-æ€ç»´é¢˜"><a href="#C-é€†åºå¯¹-amp-æ€ç»´é¢˜" class="headerlink" title="C é€†åºå¯¹ &amp; æ€ç»´é¢˜"></a>C é€†åºå¯¹ &amp; æ€ç»´é¢˜</h2><p>æœ€å¼€å§‹è€ƒè™‘åºåˆ—çš„ä»»æ„ä¸€ä¸ªçŠ¶æ€éƒ½å¯ä»¥é€šè¿‡äº¤æ¢ç›¸é‚»ä¸¤ä¸ªæ•°å€¼å¾—åˆ°ï¼ˆå³ä¸€è·¯å†’æ³¡è¿‡å»ï¼‰ï¼Œè€Œå¯¹äºä»…ä»…äº¤æ¢ç›¸é‚»ä¸¤é¡¹è¿™ä¸€æ“ä½œè€Œè¨€ï¼Œå®ƒä»…ä»…å½±å“è¿™ä¸¤é¡¹ï¼ˆä»¥åŠå…¶å¯èƒ½å­˜åœ¨äºå¦ä¸€è¾¹çš„å¯¹ç§°ï¼‰æœ¬èº«æ‰€è´¡çŒ®çš„é€†åºå¯¹ï¼Œè€Œé™¤äº†è¿™è‹¥å¹²é¡¹ä»¥å¤–ï¼Œå…¶ä½™çš„æ‰€æœ‰å€¼æ‰€è´¡çŒ®çš„é€†åºå¯¹å‡ä¸å˜ã€‚</p><p>ä½†æ˜¯ç»è¿‡â€ä¸€ç•ªæ¨æ•²â€ï¼Œå°†1 2 â€¦ 2 1å˜æˆ2 1 â€¦ 1 2ä¼šå¯¼è‡´é€†åºå¯¹çš„æ•°é‡å¢åŠ 1ã€‚ç»“æœå°±å¯¼è‡´è€½è¯¯äº†éå¸¸ä¹…çš„æ—¶é—´ã€‚<del>æˆ‘åœ¨ææ¯›ï¼Ÿ</del></p><p>æœ€ç»ˆè¿‡Dé¢˜åå†™Cæ€»ç®—å‘ç°é€†åºå¯¹æ•°é‡å¹¶ä¸ä¼šå˜åŒ–qaq</p><h2 id="E-æ‹†ç‚¹æœ€çŸ­è·¯"><a href="#E-æ‹†ç‚¹æœ€çŸ­è·¯" class="headerlink" title="E æ‹†ç‚¹æœ€çŸ­è·¯"></a>E æ‹†ç‚¹æœ€çŸ­è·¯</h2><p>åœºä¸Šå¤§æ¦‚ç ”ç©¶äº†ä¸€é˜µå­å°±è·‘å»çœ‹Fäº†   <del>è™½ç„¶æå®ŒCä¹Ÿæ²¡å‰©å¤šå°‘æ—¶é—´äº†</del></p><p>ä½†æ˜¯å›¾ä¸Šæ‹†ç‚¹æœ€çŸ­è·¯çš„æ€æƒ³æ€»æ˜¯ä¸èƒ½æ·±å…¥æˆ‘å¿ƒï¼Œä¹‹å‰çš„é•œé¢åå°„ä¾¿ä¹…ä¹…ä¸å¾—è¦é¢†ï¼Œé˜…è¯»é¢˜è§£åå´æ˜¯æç„¶å¤§æ‚Ÿã€‚</p><p>åœ¨è¿™é“é¢˜ä¸­ï¼Œè€ƒè™‘æœ€ç»ˆåˆ°æŸä¸ªç‚¹çš„ä¸€æ¡æœ€ä¼˜è·¯å¾„ï¼Œé‚£ä¹ˆè¿™æ¡è·¯ä¸Šä¸€å®šå­˜åœ¨ä¸€ä¸ªæœ€é•¿è¾¹å’Œæœ€çŸ­è¾¹ï¼Œæ ¹æ®é¢˜ç›®ç»™å‡ºçš„è·¯å¾„è·ç¦»å…¬å¼ï¼Œå¯ä»¥ç­‰ä»·åœ°è®¤ä¸ºè¿™æ¡æœ€é•¿è¾¹çš„è¾¹æƒä¸º0ï¼Œæœ€çŸ­è¾¹çš„è¾¹æƒä¸ºå…¶æœ¬èº«çš„ä¸¤å€ï¼Œè€Œå…¶ä½™çš„è¾¹æƒä¸å˜ã€‚</p><p>å› ä¸ºæœ€ä¼˜çš„è·ç¦»ç»“æœä¸€å®šå¦‚ä¸Šï¼Œæ‰€ä»¥å½“æ¯ä¸ªç‚¹éƒ½æœ‰è¿›è¡Œæ¾å¼›çš„æœºä¼šåï¼Œæœ€ç»ˆä¿ç•™åœ¨ç­”æ¡ˆä¸­çš„ä¸€å®šæ˜¯æœ€ä¼˜è·¯æ‰€å¸¦æ¥çš„æ¾å¼›ç»“æœã€‚</p><p>é‚£ä¹ˆå°†æ¯ä¸ªç‚¹æ‹†æˆ4ä¸ªçŠ¶æ€ï¼Œåˆ†åˆ«è¡¨ç¤ºæ˜¯å¦å–è¿‡æœ€é•¿è¾¹å’Œæœ€çŸ­è¾¹(2 * 2 = 4)ï¼Œè¾¹æ‰€å¸¦æ¥çš„æ¾å¼›åªä¼šå°†çŠ¶æ€ç‚¹ä»<code>æœªå–è¿‡æŸä¸€çŠ¶æ€</code> è½¬ç§»åˆ°<code>å–è¿‡æŸä¸€çŠ¶æ€</code>ï¼Œé‚£ä¹ˆåœ¨æ™®é€šçš„dijç®—æ³•ä¸­åœ¨NODEèŠ‚ç‚¹ä¸­æ·»åŠ ä¸€äº›æ–°çš„çŠ¶æ€ä¿¡æ¯ï¼Œæ¾å¼›æ—¶åŒæ—¶å°è¯•å‘æ‰€æœ‰å¯è¡Œçš„æ–¹å‘æ¾å¼›ã€‚æœ€ç»ˆåªè€ƒè™‘æ¯ä¸ªèŠ‚ç‚¹å¯¹åº”çŠ¶æ€<code>æ—¢å–æœ€é•¿è¾¹åˆå–æœ€çŸ­è¾¹</code>çš„è·ç¦»ï¼Œè¾“å‡ºå³å¯ã€‚</p><p>æœ‰ç‰¹æ®Šæƒ…å†µéœ€æ³¨æ„ï¼Œå½“å½“å‰è¾¹åˆæ˜¯æœ€é•¿è¾¹åˆæ˜¯æœ€çŸ­è¾¹æ—¶ï¼Œåº”è¯¥è®¤ä¸ºè¯¥è¾¹æƒä¸å˜ï¼Œä¸”çŠ¶æ€ç›´æ¥ä»0è½¬ç§»åˆ°3.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">8e5</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">star</span>&#123;</span><span class="keyword">int</span> to, next; ll w;&#125;;</span><br><span class="line"><span class="keyword">int</span> head[manx], top = <span class="number">0</span>;</span><br><span class="line">star edge[maxn &lt;&lt; <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> _add(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)&#123;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    edge[top].w = w;</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line">    _add(u, v, w);</span><br><span class="line">    _add(v, u, w);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ll dis[maxn][<span class="number">4</span>];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NODE</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> u, type; ll d;</span><br><span class="line">    <span class="built_in">NODE</span>(<span class="keyword">int</span> a, ll b, <span class="keyword">int</span> c)&#123;</span><br><span class="line">        u = a; </span><br><span class="line">        d = b;</span><br><span class="line">        type = c;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> NODE &amp;b) <span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> d &gt; b.d;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">priority_queue&lt;NODE&gt; pq;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å°è¯•å°†dæ›´æ–°åˆ°uç»“ç‚¹çš„typeç±»å‹ä¸Šã€‚</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> u, ll d, <span class="keyword">int</span> type)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(d &lt; dis[u][type])&#123;</span><br><span class="line">        dis[u][type] = d;</span><br><span class="line">        pq.<span class="built_in">push</span>(&#123;u, d, type&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dij</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">clr</span>(dis, <span class="number">0x3f</span>);</span><br><span class="line"></span><br><span class="line">    dis[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    pq.<span class="built_in">push</span>(&#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>&#125;);</span><br><span class="line">    <span class="keyword">while</span>(!pq.<span class="built_in">empty</span>())&#123;</span><br><span class="line">        NODE tmep = pq.<span class="built_in">top</span>(); pq.<span class="built_in">pop</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> now = temp.u, type = tmep.type;</span><br><span class="line"></span><br><span class="line">        ll d = tmep.d;</span><br><span class="line">        <span class="keyword">if</span>(d &gt; dis[now][type]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = haed[now]; ~i; i = edge[i].next)&#123;</span><br><span class="line">            <span class="keyword">int</span> to = edge[i].to;</span><br><span class="line">            <span class="built_in">update</span>(to, d + edge[i].w, type);</span><br><span class="line">            <span class="keyword">if</span>(type == <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="built_in">update</span>(to, d + <span class="number">2</span> * edge[i].w, <span class="number">2</span>);</span><br><span class="line">                <span class="built_in">update</span>(to, d + <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">                <span class="built_in">update</span>(to, d + edge[i].w, <span class="number">3</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(type == <span class="number">1</span>)</span><br><span class="line">                <span class="built_in">update</span>(to, d + <span class="number">2</span> * edge[i].w, <span class="number">3</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(type == <span class="number">2</span>)</span><br><span class="line">                <span class="built_in">update</span>(to, d + <span class="number">0</span>, <span class="number">3</span>);</span><br><span class="line">        &#125;   </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;  </span></span><br><span class="line">    <span class="built_in">clr</span>(head, <span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> u, v, w;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;u, &amp;v, &amp;w);</span><br><span class="line">        <span class="built_in">add</span>(u, v, w);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dij</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++) <span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>, dis[i][<span class="number">3</span>]); <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="F-æµ-amp-å»ºå›¾æŠ€å·§"><a href="#F-æµ-amp-å»ºå›¾æŠ€å·§" class="headerlink" title="F æµ &amp; å»ºå›¾æŠ€å·§"></a>F æµ &amp; å»ºå›¾æŠ€å·§</h2><p><del>åœºä¸Šæƒ³äº†å¥½ä¸€é˜µå­ï¼Œå°è¯•æƒ³è¿‡æ˜¯æµç®—æ³•ï¼Œä½†æ˜¯è‡ªå·±æµç®—æ³•éå¸¸çš„èœï¼Œæ ¹æœ¬æ²¡æœ‰æƒ³åˆ°æ€ä¹ˆå»ºå›¾ã€‚</del></p><p>æ€»ä½“æ¥è¯´æ˜¯åˆ©ç”¨æœ€å¤§æµç®—æ³•æ±‚è§£ç”±ä¾èµ–å…³ç³»æ‰€å¸¦æ¥çš„<strong>æœ€å°ä»£ä»·</strong>ã€‚</p><p>æ„é€ è¿™æ ·çš„å›¾:</p><p>å¯¹äºæ‰€æœ‰bi&gt;0çš„ç‚¹ï¼Œæ·»åŠ ç½‘ç»œæµè¾¹<code>&lt;s, i, bi&gt;</code>ï¼›å¯¹äºbi&lt;=0çš„ç‚¹ï¼Œåˆ™æ·»åŠ ç½‘ç»œæµè¾¹<code>&lt;i, t, -bi&gt;</code>ï¼›å…¶ä¸­sã€tæ˜¯æºç‚¹å’Œæ±‡ç‚¹</p><p>å†æ·»åŠ è¿™æ ·çš„è¾¹ï¼šæŒ‡å®šjï¼Œéå†æ‰€æœ‰çš„$x=1,2,â€¦,a[j]$, æ‰¾å‡ºå…·æœ‰xå€¼ä¸”è·ç¦»jæœ€è¿‘çš„$i(i &lt; j)$ï¼Œæ·»åŠ è¾¹<code>&lt;j, i, inf&gt;</code></p><p>æœ‰äº†è¿™å¼ å›¾ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—çŸ¥å¦‚ä¸‹çš„ä¿¡æ¯ï¼š</p><p>å¦‚æœæƒ³è¦é€‰å–è‹¥å¹²çš„æ­£å€¼ï¼Œè¿™äº›æ­£å€¼ä¹‹é—´å¯èƒ½å­˜åœ¨ä¾èµ–å…³ç³»ï¼Œå¹¶ä¸”å¯¹äºè¯¥ä¾èµ–å…³ç³»æˆä¸ºä¸€ä¸ªé—­åŒ…ï¼ˆï¼Ÿï¼‰ï¼ˆ<del>å°é—­ä¸”ä¸å…¶ä»–æ­£å€¼ä¸å­˜åœ¨ä¾èµ–å…³ç³»ï¼Ÿ</del>ï¼‰ï¼Œé‚£ä¹ˆæ˜¾ç„¶æˆ‘ä»¬é€‰å–è¿™äº›æ­£å€¼æ‰€æ„¿æ„æ”¯ä»˜çš„<strong>æœ€å¤šä»£ä»·</strong>å°±æ˜¯è¿™äº›å€¼ä¹‹å’Œï¼Œå³ä¸æºç‚¹ç›¸è¿çš„æ‰€æœ‰è¾¹çš„è¾¹æƒå’Œï¼ˆæ­¤æ—¶ä¹Ÿæ„å‘³ç€å®Œå…¨ä¸å–è¿™äº›æ­£å€¼ï¼‰ï¼Œæ›´ä¼˜çš„æƒ…å†µä¾¿æ˜¯å–è¿™äº›æ­£å€¼å¸¦æ¥çš„è´Ÿè´¡çŒ®ä¸åŠè¿™äº›æ­£å€¼ä¹‹å’Œï¼Œæ­¤æ—¶è¦ä»˜å‡ºçš„ä»£ä»·å°±æ˜¯é‚£äº›ä¸æ±‡ç‚¹ä¹‹é—´ç›¸è¿çš„è¾¹çš„è¾¹æƒå’Œã€‚è€Œå°†è¿™ä¸€ç°‡ç°‡çš„æ­£å€¼é—­åŒ…å…¨éƒ¨æ±‡èšåˆ°åŒä¸€ä¸ªæºç‚¹ä¸Šï¼Œé‚£ä¹ˆä¸€æ¬¡çš„æœ€å¤§æµå°±å¯ä»¥å¾—çŸ¥é€‰å–æ‰€æœ‰æ­£å€¼æ‰€éœ€è¦ä»˜å‡ºçš„æœ€å°ä»£ä»·ã€‚</p><p>æœ€ç»ˆçš„ç»“æœå°±æ˜¯æ­£biä¹‹å’Œå‡å»å›¾ä¸Šçš„æœ€å¤§æµã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> itn maxn = <span class="number">3e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxe = <span class="number">3e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> ll inf = <span class="number">1ll</span> &lt;&lt; <span class="number">60</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">star</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> to, next; ll w;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">int</span> head[maxn], top = <span class="number">0</span>;</span><br><span class="line">star edge[maxe &lt;&lt; <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span> </span>&#123;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    edge[top].w = w;</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> d[maxn], cur[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t, ll flow)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (flow == <span class="number">0</span> || s == t)</span><br><span class="line">        <span class="keyword">return</span> flow;</span><br><span class="line"></span><br><span class="line">    ll res = <span class="number">0</span>, f;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = cur[s]; ~i; i = edge[i].next) &#123;</span><br><span class="line">        cur[s] = i;</span><br><span class="line">        <span class="keyword">if</span> (d[edge[i].to] == d[s] + <span class="number">1</span>) &#123;</span><br><span class="line">            f = <span class="built_in">dfs</span>(edge[i].to, t, <span class="built_in">min</span>(flow, (ll)edge[i].w));</span><br><span class="line">            edge[i].w -= f;</span><br><span class="line">            edge[i ^ <span class="number">1</span>].w += f;</span><br><span class="line">            res += f;</span><br><span class="line">            flow -= f;</span><br><span class="line">            <span class="keyword">if</span> (flow == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">queue&lt;<span class="keyword">int</span>&gt; q, q0;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">bfs</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">clr</span>(d, <span class="number">0</span>);</span><br><span class="line">    q = q0;</span><br><span class="line">    q.<span class="built_in">push</span>(s);</span><br><span class="line">    cur[s] = head[s];</span><br><span class="line">    d[s] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (!q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="keyword">int</span> now = q.<span class="built_in">front</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = head[now]; ~i; i = edge[i].next)</span><br><span class="line">            <span class="keyword">if</span> (!d[edge[i].to] &amp;&amp; edge[i].w &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                cur[edge[i].to] = head[edge[i].to];</span><br><span class="line">                d[edge[i].to] = d[now] + <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span> (edge[i].to == t)</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                q.<span class="built_in">push</span>(edge[i].to);</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">dinic</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t)</span> </span>&#123;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">bfs</span>(s, t)) ans += <span class="built_in">dfs</span>(s, t, inf);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> a[maxn], b[maxn];</span><br><span class="line"><span class="keyword">int</span> pre[<span class="number">110</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="built_in">clr</span>(head, <span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">clr</span>(pre, <span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> n; <span class="built_in">scnaf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n); </span><br><span class="line">    <span class="built_in">fro</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a + i);</span><br><span class="line">    <span class="built_in">fro</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, b + i);</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(b[i] &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            ans += b[i];</span><br><span class="line">            <span class="built_in">add</span>(n, i, b[i]);</span><br><span class="line">            <span class="built_in">add</span>(i, n, <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">add</span>(i, n + <span class="number">1</span>, -b[i]);</span><br><span class="line">            <span class="built_in">add</span>(n + <span class="number">1</span>, i, <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= a[i]; j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(pre[j] != <span class="number">-1</span> &amp;&amp; a[i] % j == <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="built_in">add</span>(i, pre[j], <span class="number">0x3f3f3f3f</span>);</span><br><span class="line">                <span class="built_in">add</span>(pre[j], i, <span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        pre[a[i]] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    ans -= <span class="built_in">dinic</span>(n, n + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æœ€çŸ­è·¯ </tag>
            
            <tag> é€†åºå¯¹ </tag>
            
            <tag> æ‹†ç‚¹æœ€çŸ­è·¯ </tag>
            
            <tag> ç½‘ç»œæµ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®ä¿¡å°ç¨‹åº</title>
      <link href="/2020/12/07/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
      <url>/2020/12/07/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/</url>
      
        <content type="html"><![CDATA[<p>è®°ä¸€æ¬¡å¾®ä¿¡å°ç¨‹åºçš„æ­å»ºè¿‡ç¨‹ã€‚</p><p>å‰ç«¯wxml+wxss+jsï¼Œåç«¯apache2+php+mysql</p><p>å°½ç®¡ä¸ºäº†å®Œæˆå¾®ä¿¡å°ç¨‹åºçš„åŸºæœ¬åŠŸèƒ½åªéœ€è¦ç•¥çŸ¥ä¸Šè¿°å†…å®¹çš„çš®æ¯›å³å¯ï¼Œä½†æ˜¯ä»é›¶å¼€å§‹ä»ç„¶æ˜¯è¿‡ç¨‹åå·ï¼ŒèŠ±è´¹äº†è®¸å¤šå¤œæ™šæ‰ç•¥æœ‰æˆæ•ˆï¼›æ•…ç‰¹æ­¤è®°å½•ã€‚</p><p>[toc]</p><span id="more"></span><h2 id="åç«¯apacheæœåŠ¡å™¨çš„é…ç½®"><a href="#åç«¯apacheæœåŠ¡å™¨çš„é…ç½®" class="headerlink" title="åç«¯apacheæœåŠ¡å™¨çš„é…ç½®"></a>åç«¯apacheæœåŠ¡å™¨çš„é…ç½®</h2><h3 id="apache2"><a href="#apache2" class="headerlink" title="apache2"></a>apache2</h3><p>æœ€åˆä¸çŸ¥é“ä»å“ªé‡Œå®‰è£…äº†ä¸€ä¸ªä¸å¸¦æœ‰<code>mysqli</code>åº“çš„apache2ï¼Œå¯¼è‡´æˆ‘é¡¶ç€è¶…é•¿çš„å»¶è¿Ÿåœ¨æœåŠ¡å™¨ä¿®äº†ä¸€å¹´è¿˜æ˜¯ä¸çŸ¥é“æ€ä¹ˆæå‡ºæ¥ã€‚</p><p>æœ€åæ ¹æ®å¦å¤–ä¸€ç¯‡åšæ–‡æ‰§è¡Œäº†ä¸€ä¸ªå®‰è£…è®¸å¤šæ‹“å±•çš„æŒ‡ä»¤ï¼ŒæˆåŠŸå®‰è£…ä¸Šmysqli.</p><h3 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h3><p>å®‰è£…mysqlæ¯”è¾ƒä¸€å¸†é£é¡ºï¼›æ³¨æ„ä¿®æ”¹ä¹‹æ‰“ç®—ç”¨äºè¿œç¨‹è®¿é—®æœåŠ¡å™¨çš„ç”¨æˆ·ä¸ºæœ€é«˜æƒé™ï¼ŒåŒæ—¶åŠ ä¸Šå¯†ç ä»¥é˜²æ­¢æ¶æ„ç ´åï¼ˆè™½ç„¶åº”è¯¥å¹¶æ²¡æœ‰äººä¼šæ‰“ç®—ç ´åæˆ‘è¿™ä¸ªä»€ä¹ˆéƒ½æ²¡æœ‰çš„æœåŠ¡å™¨ï¼‰ã€‚</p><h3 id="php"><a href="#php" class="headerlink" title="php"></a>php</h3><p><del>ç¡®å®æ˜¯æ²¡æœ‰æƒ³åˆ°0202å¹´äº†è¿˜è¦ç”¨php</del></p><p><del>ä¸è¿‡è¿™å¯èƒ½æ˜¯å› ä¸ºæˆ‘ä»æ¥æ²¡æœ‰æ¥è§¦è¿‡åç«¯æœåŠ¡å™¨ï¼Œæ‰ä¸€åº¦è§è¯†æµ…è–„åœ°ä»¥ä¸ºphpæ˜¯ä¸Šå¤æ—¶æœŸæ‰å­˜åœ¨çš„æœåŠ¡å™¨è¯­è¨€ã€‚</del></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$servername</span> = <span class="string">&quot;xxx:3306&quot;</span>;</span><br><span class="line"><span class="variable">$username</span> = <span class="string">&quot;root&quot;</span>;</span><br><span class="line"><span class="variable">$password</span> = <span class="string">&quot;xxx&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$age</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;age&#x27;</span>];</span><br><span class="line"><span class="comment">//$age = 15;</span></span><br><span class="line"><span class="variable">$id</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="comment">//$id = &quot;215100test&quot;;</span></span><br><span class="line"><span class="comment">// åˆ›å»ºè¿æ¥</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$conn</span> = mysqli_connect(<span class="variable">$servername</span>, <span class="variable">$username</span>, <span class="variable">$password</span>);</span><br><span class="line"><span class="comment">// æ£€æµ‹è¿æ¥</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$conn</span>-&gt;connect_error) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;è¿æ¥å¤±è´¥&quot;</span>);</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">//å‘æ•°æ®åº“ä¸­æ’å…¥æ•°æ®</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;INSERT INTO main(age, id) VALUES (&quot;</span> .<span class="variable">$age</span> .<span class="string">&quot;,  &#x27;&quot;</span> .<span class="variable">$id</span>.<span class="string">&quot;&#x27;)&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(mysqli_query(<span class="variable">$conn</span>, <span class="string">&quot;use temp;&quot;</span>) == <span class="literal">TRUE</span>)</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;CHANGE SUCCED; &quot;</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">die</span>(<span class="string">&quot;changed failed&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (mysqli_query(<span class="variable">$conn</span>, <span class="variable">$sql</span>) === <span class="literal">TRUE</span>)</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;succeed&quot;</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">echo</span> <span class="string">&quot;Error creating database: &quot;</span>;</span><br><span class="line"><span class="variable">$conn</span>-&gt;close();</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªæˆåŠŸçš„phpç¨‹åºã€‚å¯ä»¥ç›´æ¥é€šè¿‡è®¿é—®ipåœ°å€+å­ç½‘é¡µåç§°å¾—åˆ°successçš„æ¶ˆæ¯ã€‚</p><p>å¹¶ä¸”<strong>å®è·µè¯æ˜ï¼ŒL21çš„useæŒ‡ä»¤æ˜¯å¿…è¦çš„ï¼Œè¿™æ˜¯mysqlå¯¹äºinsertæ‰€è¦æ±‚ä¿è¯çš„ã€‚</strong></p><h3 id="å®ç°wxappä¸­è®°è´¦æœ¬æ•°æ®çš„ä¸Šä¼ å’Œä¸‹è½½"><a href="#å®ç°wxappä¸­è®°è´¦æœ¬æ•°æ®çš„ä¸Šä¼ å’Œä¸‹è½½" class="headerlink" title="å®ç°wxappä¸­è®°è´¦æœ¬æ•°æ®çš„ä¸Šä¼ å’Œä¸‹è½½"></a>å®ç°wxappä¸­è®°è´¦æœ¬æ•°æ®çš„ä¸Šä¼ å’Œä¸‹è½½</h3><p>åœ¨å®è·µä¸­ï¼Œå› ä¸ºæœ€ç»ˆæ–°å»ºäº†ä¸€ä¸ª<code>wxapp</code>çš„æ•°æ®åº“ç”¨äºå®æˆ˜ï¼Œä½†rootæƒé™åªåœ¨ä¹‹å‰æµ‹è¯•æ—¶ä¿®æ”¹ä¸ºæœ€é«˜è¿‡ï¼Œå¯¼è‡´useæŒ‡ä»¤ä¸€ç›´ä¸æˆåŠŸã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GRANT ALL PRIVILEGES ON *.* TO &#x27;root&#x27;@&#x27;192.168.1.100&#x27; IDENTIFIED BY &#x27;$å¯†ç &#x27; WITH GRANT OPTION;</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure><h2 id="å‰ç«¯wxappçš„é…ç½®"><a href="#å‰ç«¯wxappçš„é…ç½®" class="headerlink" title="å‰ç«¯wxappçš„é…ç½®"></a>å‰ç«¯wxappçš„é…ç½®</h2><h3 id="åˆæ­¥æˆåŠŸåœ°å®ç°wx-requestæŒ‡ä»¤"><a href="#åˆæ­¥æˆåŠŸåœ°å®ç°wx-requestæŒ‡ä»¤" class="headerlink" title="åˆæ­¥æˆåŠŸåœ°å®ç°wx.requestæŒ‡ä»¤"></a>åˆæ­¥æˆåŠŸåœ°å®ç°wx.requestæŒ‡ä»¤</h3><p><del>çº¿å½¢çš„markdownæ–‡æœ¬ç»“æ„æ˜¾ç„¶æ˜¯å¾ˆéš¾è¡¨ç°å‡ºæˆ‘åœ¨å¹¶è¡Œç ”ç©¶è¿™ä¸¤å—çš„æ—¶é—´é¡ºåºçš„ï¼Œä½†æ˜¯ä¹Ÿåªèƒ½ä»¥æ­¤è¿›è¡Œç²—ç•¥çš„è®°å½•ã€‚</del></p><p>åˆæ­¥æ„å»ºå®Œç¬¬ä¸€ä¸ªphpæŸ¥è¯¢ç¨‹åºåï¼Œæœ€è¿«åˆ‡æƒ³å»å®ç°çš„å½“ç„¶æ˜¯<code>wx.request</code>æŒ‡ä»¤ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">wx.request(&#123;</span><br><span class="line">      <span class="attr">url</span>: <span class="string">&#x27;http://xxx/wxapp.php&#x27;</span>,</span><br><span class="line">      <span class="attr">data</span>:&#123;</span><br><span class="line">        <span class="attr">age</span>: <span class="number">11415</span>,</span><br><span class="line">        <span class="attr">id</span>: <span class="string">&#x27;230302&#x27;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">success</span>: <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;OK&quot;</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(res.data)</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">fail</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;NO&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>æœ€å¼€å§‹ä¸€ç›´è¢«å„ç§å¥‡æ€ªçš„é”™è¯¯å¡æ­»ï¼Œè¯´æˆ‘æŸ¥è¯¢å¤±è´¥ã€‚</p><p>ç»è¿‡æ£€æŸ¥åå‘ç°ï¼Œé¦–å…ˆè¦æŠŠphpä¸­çš„useæŒ‡ä»¤åŠ ä¸Šï¼Œèƒ½å¤Ÿå®Œæˆä¸Šè¿°é€šè¿‡webæµè§ˆå™¨è®¿é—®ã€‚ç„¶ååˆæŠ±é”™è¯´æˆ‘çš„urlæ˜¯æ— æ•ˆçš„ï¼Œç¿»é˜…äº†ç½‘å‹çš„åšå®¢æ‰å‘ç°ä¸èƒ½ç›´æ¥å°†ipåœ°å€å†™å…¥urlï¼Œè€Œè¦åŠ ä¸Š<code>http://</code>ï¼Œå®åœ¨æ˜¯éå¸¸çš„ç¥å¥‡ã€‚å› ä¸ºæ²¡æœ‰å¥½å¥½å­¦ä¹ è®¡ç®—æœºç½‘ç»œï¼Œå¹¶ä¸”åªæ£€éªŒäº†<code>https://$ipåœ°å€/wxwapp.php</code>æ˜¯æ— æ³•è®¿é—®çš„ï¼Œæ²¡æœ‰è€ƒè™‘åˆ°<a href="http://æ˜¯é»˜è®¤çš„ç½‘ç»œåè®®ï¼Œå¯¼è‡´å¡äº†éå¸¸å¤šçš„æ—¶é—´ã€‚">http://æ˜¯é»˜è®¤çš„ç½‘ç»œåè®®ï¼Œå¯¼è‡´å¡äº†éå¸¸å¤šçš„æ—¶é—´ã€‚</a></p><h3 id="wx-navigateTo"><a href="#wx-navigateTo" class="headerlink" title="wx.navigateTo"></a>wx.navigateTo</h3><p>è¯¥æŒ‡ä»¤å¯ä»¥ä»ä¸€ä¸ªé¡µé¢è·³è½¬åˆ°å¦ä¸€ä¸ªç•Œé¢ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå…¶ä¸­çš„urlä¸èƒ½å¡«å†™tabBarï¼Œå¹¶ä¸”url<strong>ä¸éœ€è¦åŠ ä»»ä½•åç¼€</strong>!</p><h3 id="jsä¸­è‡ªå®šä¹‰sortçš„æ¯”è¾ƒæ–¹æ³•"><a href="#jsä¸­è‡ªå®šä¹‰sortçš„æ¯”è¾ƒæ–¹æ³•" class="headerlink" title="jsä¸­è‡ªå®šä¹‰sortçš„æ¯”è¾ƒæ–¹æ³•"></a>jsä¸­è‡ªå®šä¹‰sortçš„æ¯”è¾ƒæ–¹æ³•</h3><blockquote><p>è‹¥ a å°äº bï¼Œåœ¨æ’åºåçš„æ•°ç»„ä¸­ a åº”è¯¥å‡ºç°åœ¨ b ä¹‹å‰ï¼Œåˆ™è¿”å›ä¸€ä¸ªå°äº 0 çš„å€¼ã€‚<br>è‹¥ a ç­‰äº bï¼Œåˆ™è¿”å› 0ã€‚<br>è‹¥ a å¤§äº bï¼Œåˆ™è¿”å›ä¸€ä¸ªå¤§äº 0 çš„å€¼ã€‚<br><strong>æ³¨æ„ï¼šbçš„å€¼æ˜¯æ•°ç»„éå†åˆ°çš„å½“å‰å€¼ï¼Œaæ˜¯æ•°ç»„éå†åˆ°çš„ä¸‹ä¸€ä¸ªå€¼ï¼ˆå³bçš„ä¸‹ä¸€ä¸ªï¼‰</strong></p></blockquote><p>???æ‰€ä»¥è¯´ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ç§ç¥ç§˜çš„æ–¹æ³•</p><p>éš¾æ€ªæˆ‘ç›´æ¥returnä¸€ä¸ªä¸ç­‰å¼å›å»æ€»æ˜¯å‡ºé”™</p><p>jsä¸­éœ€è¦return3ç§å€¼ï¼Œæ‰€ä»¥è¦ç”¨å‡å·</p><p><del>orz</del></p><h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><h3 id="mysqliéƒ¨åˆ†è¯­æ³•"><a href="#mysqliéƒ¨åˆ†è¯­æ³•" class="headerlink" title="mysqliéƒ¨åˆ†è¯­æ³•"></a>mysqliéƒ¨åˆ†è¯­æ³•</h3><p>åˆ›å»ºæ•°æ®åº“ï¼š<code>create database $name;</code></p><p>é€‰æ‹©æ•°æ®åº“ï¼š<code>use $name;</code></p><p>æŸ¥è¯¢æ•°æ®åº“ä¸­æœ‰å“ªäº›æ•°æ®è¡¨ï¼š<code>show tables;</code></p><p>å±•ç¤ºä¸€ä¸ªæ•°æ®è¡¨ï¼š<code>desc $TableName;</code></p><p>ä¿®æ”¹æ•°æ®è¡¨ä¸­çš„åˆ—:<code>alter table $tableName change $åŸåç§° $æ–°åç§° $æ•°æ®ç±»å‹</code></p><p>åˆ é™¤è¡¨ä¸­è¡Œä¿¡æ¯ï¼š<code>delete from $tableName [where...]</code></p><p>æ’¤é”€ä¸»é”®: <code>ALTER TABLE $tableName DROP PRIMARY KEY</code></p><h3 id="cashflow-php"><a href="#cashflow-php" class="headerlink" title="cashflow.php"></a>cashflow.php</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$conn</span> = mysqli_connect(<span class="string">&quot;xxx&quot;</span>, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;xxx&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$conn</span>)</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&quot;é“¾æ¥å¤±è´¥ï¼&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!mysqli_query(<span class="variable">$conn</span>, <span class="string">&quot;use wxapp&quot;</span>)) <span class="keyword">die</span>(<span class="string">&quot;æ•°æ®åº“é€‰æ‹©å¤±è´¥ï¼&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$op</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;op&#x27;</span>];</span><br><span class="line"><span class="variable">$title</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;title&#x27;</span>];</span><br><span class="line"><span class="variable">$id</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$subtitle</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;subtitle&#x27;</span>];</span><br><span class="line"><span class="variable">$cost</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;cost&#x27;</span>];</span><br><span class="line"><span class="variable">$date</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;date&#x27;</span>];</span><br><span class="line"><span class="variable">$time</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;time&#x27;</span>];</span><br><span class="line"><span class="variable">$typeindex</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;typeindex&#x27;</span>];</span><br><span class="line"><span class="variable">$hasLocation</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;hasLocation&#x27;</span>];</span><br><span class="line"><span class="variable">$errMsy</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;errMsy&#x27;</span>];</span><br><span class="line"><span class="variable">$locationName</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;locationName&#x27;</span>];</span><br><span class="line"><span class="variable">$locationAddress</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;locationAddress&#x27;</span>];</span><br><span class="line"><span class="variable">$latitude</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;latitude&#x27;</span>];</span><br><span class="line"><span class="variable">$longitude</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;longitude&#x27;</span>];</span><br><span class="line"><span class="variable">$submitTime</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;submitTime&#x27;</span>];</span><br><span class="line"><span class="variable">$old_submitTime</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;old_submitTime&#x27;</span>];</span><br><span class="line"><span class="variable">$openId</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;openId&#x27;</span>];</span><br><span class="line"><span class="variable">$flag</span>= <span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">INFO</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$title</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$id</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$subtitle</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cost</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$date</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$time</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$typeindex</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$hasLocation</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$errMsy</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$locationName</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$locationAddress</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$latitude</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$longitude</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$submitTime</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$json</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="variable">$data</span> = <span class="keyword">array</span>();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$op</span> == <span class="string">&#x27;INSERT&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$sql</span> = <span class="string">&quot;insert into cashflow (title, id, subtitle, cost, date, time, typeindex, hasLocation, errMsy, locationName, locationAddress, latitude, longitude, submitTime, openId, flag) values(</span></span><br><span class="line"><span class="string">        &#x27;&quot;</span> .<span class="variable">$title</span>. <span class="string">&quot;&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;&quot;</span> .<span class="variable">$id</span>. <span class="string">&quot;&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;&quot;</span> .<span class="variable">$subtitle</span>. <span class="string">&quot;&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;&quot;</span> .<span class="variable">$cost</span>. <span class="string">&quot;&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;&quot;</span> .<span class="variable">$date</span>. <span class="string">&quot;&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;&quot;</span> .<span class="variable">$time</span>. <span class="string">&quot;&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;&quot;</span> .<span class="variable">$typeindex</span>. <span class="string">&quot;&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;&quot;</span> .<span class="variable">$hasLocation</span>. <span class="string">&quot;&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;&quot;</span> .<span class="variable">$errMsy</span>. <span class="string">&quot;&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;&quot;</span> .<span class="variable">$locationName</span>. <span class="string">&quot;&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;&quot;</span> .<span class="variable">$locationAddress</span>. <span class="string">&quot;&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;&quot;</span> .<span class="variable">$latitude</span>. <span class="string">&quot;&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;&quot;</span> .<span class="variable">$longitude</span>. <span class="string">&quot;&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;&quot;</span> .<span class="variable">$submitTime</span>. <span class="string">&quot;&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;&quot;</span> .<span class="variable">$openId</span>. <span class="string">&quot;&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;&quot;</span> .<span class="variable">$flag</span>. <span class="string">&quot;&#x27;</span></span><br><span class="line"><span class="string">    )&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(!mysqli_query(<span class="variable">$conn</span>, <span class="variable">$sql</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Insert failed!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">echo</span> <span class="string">&quot;Insert OK!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$op</span> == <span class="string">&#x27;UPDATE&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$sql</span> = <span class="string">&quot;update cashflow set</span></span><br><span class="line"><span class="string">    subtitle=&#x27;&quot;</span> .<span class="variable">$subtitle</span>. <span class="string">&quot;&#x27;, </span></span><br><span class="line"><span class="string">    cost=&#x27;&quot;</span> .<span class="variable">$cost</span>. <span class="string">&quot;&#x27;, </span></span><br><span class="line"><span class="string">    date=&#x27;&quot;</span> .<span class="variable">$date</span>. <span class="string">&quot;&#x27;, </span></span><br><span class="line"><span class="string">    time=&#x27;&quot;</span> .<span class="variable">$time</span>. <span class="string">&quot;&#x27;, </span></span><br><span class="line"><span class="string">    typeindex=&#x27;&quot;</span> .<span class="variable">$typeindex</span>. <span class="string">&quot;&#x27;, </span></span><br><span class="line"><span class="string">    hasLocation=&#x27;&quot;</span> .<span class="variable">$hasLocation</span>. <span class="string">&quot;&#x27;, </span></span><br><span class="line"><span class="string">    errMsy=&#x27;&quot;</span> .<span class="variable">$errMsy</span>. <span class="string">&quot;&#x27;, </span></span><br><span class="line"><span class="string">    locationName=&#x27;&quot;</span> .<span class="variable">$locationName</span>. <span class="string">&quot;&#x27;, </span></span><br><span class="line"><span class="string">    locationAddress=&#x27;&quot;</span> .<span class="variable">$locationAddress</span>. <span class="string">&quot;&#x27;,</span></span><br><span class="line"><span class="string">    latitude=&#x27;&quot;</span> .<span class="variable">$latitude</span>. <span class="string">&quot;&#x27;, </span></span><br><span class="line"><span class="string">    longitude=&#x27;&quot;</span> .<span class="variable">$longitude</span>. <span class="string">&quot;&#x27;, </span></span><br><span class="line"><span class="string">    submitTime=&#x27;&quot;</span> .<span class="variable">$submitTime</span>. <span class="string">&quot;&#x27;</span></span><br><span class="line"><span class="string">    where openId=&#x27;&quot;</span> .<span class="variable">$openId</span>. <span class="string">&quot;&#x27; &amp;&amp; title=&#x27;&quot;</span> .<span class="variable">$title</span>. <span class="string">&quot;&#x27; &amp;&amp; id=&#x27;&quot;</span> .<span class="variable">$id</span>. <span class="string">&quot;&#x27; &amp;&amp; submitTime=&#x27;&quot;</span> .<span class="variable">$old_submitTime</span>. <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(mysqli_query(<span class="variable">$conn</span>, <span class="variable">$sql</span>) != <span class="literal">true</span>) <span class="keyword">die</span>(<span class="string">&quot;Update failed!&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">echo</span> <span class="string">&quot;Update OK!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$op</span> == <span class="string">&#x27;DELETE&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$sql</span> = <span class="string">&quot;delete from cashflow</span></span><br><span class="line"><span class="string">    where submitTime=&#x27;&quot;</span> .<span class="variable">$submitTime</span>. <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(mysqli_query(<span class="variable">$conn</span>, <span class="variable">$sql</span>) != <span class="literal">true</span>) <span class="keyword">die</span>(<span class="string">&quot;Delte failed!&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">echo</span> <span class="string">&quot;Delete OK!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$op</span> == <span class="string">&#x27;DELETEBOOK&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$sql</span> = <span class="string">&quot;delete from cashflow</span></span><br><span class="line"><span class="string">    where id=&#x27;&quot;</span> .<span class="variable">$id</span>. <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(mysqli_query(<span class="variable">$conn</span>, <span class="variable">$sql</span>) != <span class="literal">true</span>) <span class="keyword">die</span>(<span class="string">&quot;DelteBook failed!&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">echo</span> <span class="string">&quot;DeleteBook OK!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$op</span> == <span class="string">&#x27;QUERY&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$res</span> = mysqli_query(<span class="variable">$conn</span>, <span class="string">&quot;select * from cashflow where openId=&#x27;&quot;</span> .<span class="variable">$openId</span>. <span class="string">&quot;&#x27;&quot;</span>);</span><br><span class="line">    <span class="comment">// $res = mysqli_query($conn, &quot;select * from cashflow&quot;);</span></span><br><span class="line">    <span class="keyword">if</span>(!<span class="variable">$res</span>) <span class="keyword">die</span>(<span class="string">&quot;Query failed!&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(<span class="variable">$row</span> = mysqli_fetch_array(<span class="variable">$res</span>))&#123;</span><br><span class="line">            <span class="variable">$info</span> = <span class="keyword">new</span> INFO();</span><br><span class="line">            <span class="variable">$info</span>-&gt;title = <span class="variable">$row</span>[<span class="string">&quot;title&quot;</span>];</span><br><span class="line">            <span class="variable">$info</span>-&gt;id = <span class="variable">$row</span>[<span class="string">&quot;id&quot;</span>];</span><br><span class="line">            <span class="variable">$info</span>-&gt;subtitle = <span class="variable">$row</span>[<span class="string">&quot;subtitle&quot;</span>];</span><br><span class="line">            <span class="variable">$info</span>-&gt;cost = <span class="variable">$row</span>[<span class="string">&quot;cost&quot;</span>];</span><br><span class="line">            <span class="variable">$info</span>-&gt;date = <span class="variable">$row</span>[<span class="string">&quot;date&quot;</span>];</span><br><span class="line">            <span class="variable">$info</span>-&gt;time = <span class="variable">$row</span>[<span class="string">&quot;time&quot;</span>];</span><br><span class="line">            <span class="variable">$info</span>-&gt;typeindex = <span class="variable">$row</span>[<span class="string">&quot;typeindex&quot;</span>];</span><br><span class="line">            <span class="variable">$info</span>-&gt;hasLocation = <span class="variable">$row</span>[<span class="string">&quot;hasLocation&quot;</span>];</span><br><span class="line">            <span class="variable">$info</span>-&gt;errMsy = <span class="variable">$row</span>[<span class="string">&quot;errMsy&quot;</span>];</span><br><span class="line">            <span class="variable">$info</span>-&gt;locationName = <span class="variable">$row</span>[<span class="string">&quot;locationName&quot;</span>];</span><br><span class="line">            <span class="variable">$info</span>-&gt;locationAddress = <span class="variable">$row</span>[<span class="string">&quot;locationAddress&quot;</span>];</span><br><span class="line">            <span class="variable">$info</span>-&gt;latitude = <span class="variable">$row</span>[<span class="string">&quot;latitude&quot;</span>];</span><br><span class="line">            <span class="variable">$info</span>-&gt;longitude = <span class="variable">$row</span>[<span class="string">&quot;longitude&quot;</span>];</span><br><span class="line">            <span class="variable">$info</span>-&gt;submitTime = <span class="variable">$row</span>[<span class="string">&quot;submitTime&quot;</span>];</span><br><span class="line">            <span class="variable">$info</span>-&gt;flag = <span class="variable">$row</span>[<span class="string">&quot;flag&quot;</span>];</span><br><span class="line">            <span class="variable">$data</span>[] = <span class="variable">$info</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$json</span> = json_encode(<span class="variable">$data</span>);</span><br><span class="line">        <span class="comment">// echo &quot;&#123;&quot;.&#x27;&quot;data&quot;&#x27;.&quot;:&quot;.$json.&quot;&#125;&quot;;</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$json</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$op</span> == <span class="string">&#x27;RENAME&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$sql</span> = <span class="string">&quot;update cashflow set</span></span><br><span class="line"><span class="string">    title = &#x27;&quot;</span> .<span class="variable">$title</span>. <span class="string">&quot;&#x27;</span></span><br><span class="line"><span class="string">    where openId = &#x27;&quot;</span> .<span class="variable">$openId</span>. <span class="string">&quot;&#x27; &amp;&amp; id = &#x27;&quot;</span> .<span class="variable">$id</span>. <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!mysqli_query(<span class="variable">$conn</span>, <span class="variable">$sql</span>)) <span class="keyword">die</span>(<span class="string">&quot;Rename failed!&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">echo</span> <span class="string">&quot;Rename OK!&quot;</span>;</span><br><span class="line">    <span class="comment">// echo $sql; die;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$op</span> == <span class="string">&#x27;INSERTCOL&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$sql</span> = <span class="string">&quot;insert into cashflow (title, id, flag, submitTime, openId) values(</span></span><br><span class="line"><span class="string">        &#x27;&quot;</span> .<span class="variable">$title</span>. <span class="string">&quot;&#x27;,</span></span><br><span class="line"><span class="string">        &#x27;&quot;</span> .<span class="variable">$id</span>. <span class="string">&quot;&#x27;,</span></span><br><span class="line"><span class="string">        &#x27;&quot;</span> .<span class="variable">$flag</span>. <span class="string">&quot;&#x27;,</span></span><br><span class="line"><span class="string">        &#x27;&quot;</span> .<span class="variable">$submitTime</span>. <span class="string">&quot;&#x27;,</span></span><br><span class="line"><span class="string">        &#x27;&quot;</span> .<span class="variable">$openId</span>. <span class="string">&quot;&#x27;</span></span><br><span class="line"><span class="string">        )&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(!mysqli_query(<span class="variable">$conn</span>, <span class="variable">$sql</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;InsertCol failed!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">echo</span> <span class="string">&quot;InsertCol OK!&quot;</span>;</span><br><span class="line">    <span class="comment">// echo $sql; die;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">die</span>(<span class="string">&quot;Invalid Input!&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$conn</span>-&gt;close();</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> wxapp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰åç«¯ </tag>
            
            <tag> PHP </tag>
            
            <tag> SQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020-ccpc-weihai</title>
      <link href="/2020/11/21/2020-ccpc-weihai/"/>
      <url>/2020/11/21/2020-ccpc-weihai/</url>
      
        <content type="html"><![CDATA[<p>[toc]</p><span id="more"></span><h2 id="G-çº¿æ®µæ ‘-åŒºé—´ä¿®æ”¹ã€å–æ¨¡ï¼ŒåŒºé—´å“ˆå¸Œå’ŒæŸ¥è¯¢"><a href="#G-çº¿æ®µæ ‘-åŒºé—´ä¿®æ”¹ã€å–æ¨¡ï¼ŒåŒºé—´å“ˆå¸Œå’ŒæŸ¥è¯¢" class="headerlink" title="G çº¿æ®µæ ‘ åŒºé—´ä¿®æ”¹ã€å–æ¨¡ï¼ŒåŒºé—´å“ˆå¸Œå’ŒæŸ¥è¯¢"></a>G çº¿æ®µæ ‘ åŒºé—´ä¿®æ”¹ã€å–æ¨¡ï¼ŒåŒºé—´å“ˆå¸Œå’ŒæŸ¥è¯¢</h2><p>éœ€è¦ç»´æŠ¤ä¸€ä¸ªæ”¯æŒåŒºé—´åŠ 1å¹¶å¯¹å›ºå®šæ¨¡æ•°å–æ¨¡ã€åŒºé—´å“ˆå¸ŒæŸ¥è¯¢çš„çº¿æ®µæ ‘</p><p>å¼€å±€å°±æƒ³å†™çš„ä¸€é“é¢˜ï¼Œå†™åˆ°æœ€åè‰°éš¾è°ƒå‡ºæ¥åwa7ï¼Œæœ€ç»ˆæ”¾å¼ƒä¸Šæœºè¾…åŠ©é˜Ÿå‹çœ‹åˆ«çš„é¢˜</p><p>æ™šä¸Šå›å»åˆè°ƒäº†å¾ˆä¹…ï¼Œå‘ç°äº†å‡ ä¸ªé”™è¯¯</p><ul><li>çº¿æ®µæ ‘å“ˆå¸Œå†™é”™äº†ï¼Œåœ¨æ±‚å“ˆå¸Œå’Œçš„æ—¶å€™ä¸åƒæ™®é€šçš„çº¿æ®µæ ‘åŒºé—´å’Œä¸€æ ·ï¼ŒæŸ¥è¯¢å“ˆå¸Œå’Œæ—¶æŸ¥è¯¢çš„åŒºé—´[L, R]æ˜¯éœ€è¦<strong>åŠ¨æ€å˜åŒ–</strong>çš„ï¼Œå¿…é¡»ä¿è¯<code>L</code>è¢«ä¸æ–­åœ°æˆªæ–­ï¼Œæ‰èƒ½ä¿è¯ç®—æ³•çš„æ­£ç¡®æ€§</li><li>çœ¼ç›æ¯”è¾ƒçï¼Œå‰ç¼€å’Œpre[]å¯¹M(65536)å–æ¨¡äº†</li><li>æœ€å¼€å§‹çš„purify(å°†é‚£äº›è¶…è¿‡65536çš„ä½ç½®å–æ¨¡)å†™æŒ«äº†ï¼Œåœ¨<strong>ç»ˆæ­¢æ¡ä»¶(l == r)ä¹‹å‰å°±è°ƒç”¨äº†downå‡½æ•°</strong>ã€‚è°ƒäº†ä¸€å¹´æ‰å‘ç°åŸæ¥æ˜¯è¿™é‡Œæœ‰é—®é¢˜ï¼šå¦‚æœåœ¨ç»ˆæ­¢æ¡ä»¶ä¹‹å‰å°±è°ƒç”¨downå‡½æ•°ï¼Œè¿™ä¼šå¯¼è‡´åœ°å€çš„è¶Šç•Œè®¿é—®ã€‚å› ä¸ºståªå¼€äº†4å€ç©ºé—´ï¼Œæ‰€ä»¥å¦‚æœåœ¨é‚£ç§è¾¹è§’å¶å­ç»“ç‚¹ï¼ˆåœ¨æ»¡äºŒå‰æ ‘ä¸Šå¤šä¸€ä¸ªèŠ‚å¤–ç”Ÿæçš„ç»“æ„ï¼‰ä»ç„¶å°è¯•downä¸‹å»ï¼Œå°±ä¼šè®¿é—®åˆ°8å€çš„ä½ç½®ï¼åœ¨CFå±…ç„¶æ²¡æœ‰å‘ç”ŸREæŠ¥è­¦ï¼Œä»¥è‡³äºæˆ‘ä¸€åº¦æ€€ç–‘æ˜¯è‡ªå·±ç®—æ³•å†™é”™äº†ï¼Œå…¶å®æ˜¯ç©ºé—´çš„è®¡ç®—é”™è¯¯å¯¼è‡´äº†UKEã€‚</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ls (p &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rs ((p &lt;&lt; 1) | 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mid ((l + r) &gt;&gt; 1)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">5e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">65536</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> pp = <span class="number">999983</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1000237529</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> a[maxn];</span><br><span class="line">ll tag1[maxn &lt;&lt; <span class="number">2</span>], st2[maxn &lt;&lt; <span class="number">2</span>], st[maxn &lt;&lt; <span class="number">2</span>];</span><br><span class="line">ll po[maxn], pre[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">up</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    st[p] = st[ls] + st[rs] * po[mid - l + <span class="number">1</span>] % mod; st[p] %= mod;</span><br><span class="line">    st2[p] = <span class="built_in">max</span>(st2[ls], st2[rs]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l == r &amp;&amp; l == k)&#123;</span><br><span class="line">        st[p] = st2[p] = x;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(k &lt;= mid) <span class="built_in">build</span>(ls, l, mid, k, x);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">build</span>(rs, mid + <span class="number">1</span>, r, k, x);</span><br><span class="line">    <span class="built_in">up</span>(p, l, r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">down</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(tag1[p])&#123;</span><br><span class="line">        tag1[ls] += tag1[p];</span><br><span class="line">        tag1[rs] += tag1[p];</span><br><span class="line">        </span><br><span class="line">        st[ls] += pre[mid - l] * tag1[p] % mod; st[ls] %= mod;</span><br><span class="line">        st[rs] += pre[r - mid - <span class="number">1</span>] * tag1[p] % mod; st[rs] %= mod;</span><br><span class="line">        </span><br><span class="line">        st2[ls] += tag1[p];</span><br><span class="line">        st2[rs] += tag1[p];</span><br><span class="line">        </span><br><span class="line">        tag1[p] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= l &amp;&amp; r &lt;= R)&#123;</span><br><span class="line">        st[p] += pre[r - l]; st[p] %= mod;</span><br><span class="line">        st2[p]++; tag1[p]++;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">down</span>(p, l, r);</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= mid) <span class="built_in">udpate</span>(ls, l, mid, L, R);</span><br><span class="line">    <span class="keyword">if</span>(R &gt; mid) <span class="built_in">update</span>(rs, mid + <span class="number">1</span>, r, L ,R);</span><br><span class="line">    <span class="built_in">up</span>(p, l, r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">purify</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(st2[p] &lt; M) <span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">down</span>(p, l, r);</span><br><span class="line">    <span class="keyword">if</span>(l == r)&#123;</span><br><span class="line">        st[p] %= M; st2[p] %= M;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(st2[ls] &gt;= M) <span class="built_in">purify</span>(ls, l, mid);</span><br><span class="line">    <span class="keyword">if</span>(st2[rs] &gt;= M) <span class="built_in">purify</span>(rs, mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="built_in">up</span>(p, l, r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">hsh</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= l &amp;&amp; r &lt;= R) <span class="keyword">return</span> st[p];</span><br><span class="line">    <span class="built_in">down</span>(p, l, r);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(R &lt;= mid) <span class="keyword">return</span> <span class="built_in">hsh</span>(ls, l, mid, L, R);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(L &gt; mid) <span class="keyword">return</span> <span class="built_in">hsh</span>(rs, mid + <span class="number">1</span>, r, L, R);</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        ll ans = <span class="built_in">hsh</span>(ls, l, mid, L, mid);</span><br><span class="line">        ans += <span class="built_in">hsh</span>(rs, mid + <span class="number">1</span>, r, mid + <span class="number">1</span>, R) * po[mid - L + <span class="number">1</span>] % mod;</span><br><span class="line">        ans %= mod;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//   Fastin;</span></span><br><span class="line">    po[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; maxn; i++) po[i] = po[i - <span class="number">1</span>] * <span class="number">1ll</span> * pp % mod;</span><br><span class="line">    pre[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; maxn; i++) pre[i] = pre[i - <span class="number">1</span>] + po[i], pre[i] %= mod;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> n, m; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a + i);</span><br><span class="line">        <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n, i, a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span>(m--)&#123;</span><br><span class="line">        <span class="keyword">int</span> op; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;op);</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> l, r; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;l, &amp;r);</span><br><span class="line">            <span class="built_in">update</span>(<span class="number">1</span>, <span class="number">1</span>, n, l, r);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">int</span> l, r, k; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;l, &amp;r, &amp;k);</span><br><span class="line">            <span class="built_in">purify</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">            </span><br><span class="line">            ll res1 = <span class="built_in">hsh</span>(<span class="number">1</span>, <span class="number">1</span>, n, l, l + k - <span class="number">1</span>);</span><br><span class="line">            ll res2 = <span class="built_in">hsh</span>(<span class="number">1</span>, <span class="number">1</span>, n, r, r + k - <span class="number">1</span>);</span><br><span class="line">            <span class="built_in">puts</span>(res1 == res2? <span class="string">&quot;yes&quot;</span>: <span class="string">&quot;no&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="L-åˆ†ç»„èƒŒåŒ…-amp-LCM"><a href="#L-åˆ†ç»„èƒŒåŒ…-amp-LCM" class="headerlink" title="L åˆ†ç»„èƒŒåŒ… &amp; LCM"></a>L åˆ†ç»„èƒŒåŒ… &amp; LCM</h2><p>ç»™å‡ºnï¼Œæ„é€ æŸç§æ‹†åˆ†$p_1+p_2+â€¦+p_k = n$ï¼Œä½¿å¾—$lcm(p_1, p_2, â€¦, p_k)$æœ€å¤§ã€‚</p><p>å¯ä»¥è¯æ˜ï¼Œå½“${p_i}$ä¸¤ä¸¤äº’ç´ æ—¶ï¼Œå…¶lcmä¸€å®šæœ€å¤§ï¼š</p><p>å¯¹äºä»»æ„ä¸€ç»„æ‹†åˆ†ï¼Œå¦‚æœå­˜åœ¨$gcd(a, b) = d&gt;=2$ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡æå–å‡ºdå¾—åˆ°ä¸€ä¸ªæ–°çš„æ‹†åˆ†æ–¹æ³•ï¼Œä½¿å¾—lcmä¸å˜ï¼Œä½†æ˜¯å…ƒç´ å’Œå˜å°ã€‚</p><p>å¦å¤–ï¼Œå¦‚æœå­˜åœ¨æŸä¸ªå…ƒç´ æ˜¯è‹¥å¹²ç´ å› å­çš„ä¹˜ç§¯ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ‹†åˆ†è¯¥å…ƒç´ æˆè‹¥å¹²çš„å°æ•°å­—ï¼Œä½¿å¾—lcmä¸å˜ã€å…ƒç´ å’Œå˜å°ã€‚</p><p>é€šè¿‡ä¸Šè¿°ä¸¤ç§æ›´æ–°å¾—åˆ°åçš„æ–°åºåˆ—çš„æƒ…å†µä¸€å®šä¸åŠ£äºåŸåºåˆ—ï¼Œé‚£ä¹ˆä¸æ–­è¿›è¡Œè¿™æ ·çš„æ“ä½œï¼Œæœ€ç»ˆä¸€å®šä¼šå¾—åˆ°ä¸¤ä¸¤äº’ç´ çš„åºåˆ—ã€‚ï¼ˆè¿™ä¸€ç‚¹æ˜¯æ˜¾ç„¶çš„ï¼Œå› ä¸ºä¸Šè¿°ä¸¤ç§æ“ä½œå‡æ˜¯å•å‘çš„ï¼Œä¸”ä¸å¯èƒ½æ„æˆç¯ï¼‰</p><p>è¿™æ ·å³å¯è¯´æ˜ï¼Œä¸¤ä¸¤äº’ç´ çš„æƒ…å†µä¸€å®šä¸ä¼šåŠ£äºä»»æ„çš„å…¶ä»–æ‹†åˆ†æ–¹æ³•ã€‚</p><p>é‚£ä¹ˆåˆ†ç»„èƒŒåŒ…ï¼Œå¯¹ç´ æ•°è¿›è¡Œåˆ†ç»„ï¼Œéšä¾¿æ³¡ä¸€ä¸‹å°±è¿‡äº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">3e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> prime[maxn], top = <span class="number">0</span>, vis[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">euler</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= <span class="number">30000</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!vis[i]) prime[top++] = i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; top &amp;&amp; prime[j] * i &lt;= <span class="number">30000</span>; j++)&#123;</span><br><span class="line">            vis[prime[j] * i] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i % prime[j] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">double</span> dp[maxn], w[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// Fastin;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">euler</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">30000</span>; i++) w[i] = <span class="built_in">log</span>(i);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//éå†æ‰€æœ‰çš„ç»„</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; top; i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> n = <span class="number">30000</span>; n &gt;= <span class="number">1</span>; n--)&#123;</span><br><span class="line">            ll p = prime[i];</span><br><span class="line">            <span class="comment">//ç”¨ç»™å®šç»„ä¸­çš„æ‰€æœ‰ç‰©å“æ¥å°è¯•æ›´æ–°å½“å‰é‡é‡ã€‚</span></span><br><span class="line">            <span class="keyword">while</span>(p &lt;= n)&#123;</span><br><span class="line">                dp[n] = <span class="built_in">max</span>(dp[n], dp[n - p] + w[p]);</span><br><span class="line">                p *= prime[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    TTT&#123;</span><br><span class="line">        <span class="keyword">int</span> n; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n); <span class="built_in">printf</span>(<span class="string">&quot;%.9f\n&quot;</span>, dp[n]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çº¿æ®µæ ‘ </tag>
            
            <tag> åˆ†ç»„èƒŒåŒ… </tag>
            
            <tag> æ•°è®º </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>opencup-gym102391</title>
      <link href="/2020/11/11/opencup-gym102391/"/>
      <url>/2020/11/11/opencup-gym102391/</url>
      
        <content type="html"><![CDATA[<p>[toc]</p><span id="more"></span><h2 id="J-RQD-IGVAæ ‘-æ ‘ä¸ŠDSU"><a href="#J-RQD-IGVAæ ‘-æ ‘ä¸ŠDSU" class="headerlink" title="J RQD-IGVAæ ‘ æ ‘ä¸ŠDSU"></a>J <del>RQD-IGVAæ ‘</del> æ ‘ä¸ŠDSU</h2><p>æœ€å¼€å§‹ä»¥ä¸ºé™©æ®µé•¿åº¦è·Ÿnæ— å…³ï¼Œæ‰€ä»¥åŠ äº†æ ¹[1, n]çš„çº¿æ®µè¿›å»å°±WAåˆ°æ­»ï¼Œåæ¥æ”¹æˆ[1, 1000000]å³å¯ã€‚</p><p>å¤§æ¦‚æ˜¯å«dsu on treeï¼Œå¯ä»¥å¤„ç†ä¸€äº›ä¸å­æ ‘æœ‰å…³çš„è¯¢é—®ï¼Œå¤æ‚åº¦Onlogn</p><p><del>å¯æƒœIGVAä¸çŸ¥é“åœºä¸Šä»€ä¹ˆåœ°æ–¹å†™æŒ«äº† åœºå10åˆ†é’ŸAäº†</del></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">3e5</span> + <span class="number">10</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">int</span> n, w[maxn];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">star</span>&#123;</span><span class="keyword">int</span> to, next;&#125;;</span><br><span class="line"><span class="keyword">int</span> head[maxn], top = <span class="number">0</span>;</span><br><span class="line">star edge[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NODE</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> l, r, w;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> NODE &amp;b) <span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(l != b.l) <span class="keyword">return</span> l &lt; b.l;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> r &gt; b.r;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">vector&lt;NODE&gt; vec;</span><br><span class="line">priority_queue&lt;ll&gt; pq[maxn];</span><br><span class="line"><span class="keyword">int</span> conv[maxn];</span><br><span class="line">vector&lt;ll&gt; temp;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//åˆå¹¶è¾¹iå’Œè¾¹jçš„ä¼˜å…ˆé˜Ÿåˆ—ï¼Œæ”¾åˆ°ié‡Œé¢</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> i , <span class="keyword">int</span> j)</span></span>&#123;</span><br><span class="line">    temp.<span class="built_in">clear</span>();</span><br><span class="line">    <span class="keyword">if</span>(pq[conv[i]].<span class="built_in">size</span>() &lt; pq[conv[j]].<span class="built_in">size</span>()) <span class="built_in">swap</span>(conv[i], conv[j]);</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">while</span>(!pq[conv[j]].<span class="built_in">empty</span>())&#123;</span><br><span class="line">        temp.<span class="built_in">push_back</span>(pq[conv[i]].<span class="built_in">top</span>() + pq[conv[j]].<span class="built_in">top</span>());</span><br><span class="line">        pq[conv[i]].<span class="built_in">pop</span>(); pq[conv[j]].<span class="built_in">pop</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> x: temp) pq[conv[i]].<span class="built_in">push</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sove</span><span class="params">(<span class="keyword">int</span> now)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[now]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="built_in">sove</span>(edge[i].to);</span><br><span class="line">        <span class="built_in">merge</span>(now, edge[i].to);</span><br><span class="line">    &#125;</span><br><span class="line">    pq[conv[now]].<span class="built_in">push</span>(vec[now].w);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">stack&lt;<span class="keyword">int</span>&gt; sta;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// Fastin;</span></span><br><span class="line">    <span class="built_in">clr</span>(head, <span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> u, v, w; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;u, &amp;v, &amp;w);</span><br><span class="line">        vec.<span class="built_in">push_back</span>(&#123;u, v, w&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    vec.<span class="built_in">push_back</span>(&#123;<span class="number">1</span>, <span class="number">1000000</span>, <span class="number">0</span>&#125;);</span><br><span class="line">    <span class="built_in">sort</span>(vec.<span class="built_in">begin</span>(), vec.<span class="built_in">end</span>());</span><br><span class="line"> </span><br><span class="line">    sta.<span class="built_in">push</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> top = sta.<span class="built_in">top</span>();</span><br><span class="line">        <span class="keyword">while</span>(!(vec[top].l &lt;= vec[i].l &amp;&amp; vec[i].r &lt;= vec[top].r))&#123;</span><br><span class="line">            sta.<span class="built_in">pop</span>(); </span><br><span class="line">            <span class="keyword">if</span>(sta.<span class="built_in">empty</span>())&#123;<span class="keyword">while</span>(<span class="number">1</span>);&#125;;</span><br><span class="line">            top = sta.<span class="built_in">top</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">add</span>(top, i); sta.<span class="built_in">push</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">for</span>(itn i = <span class="number">0</span>; i &lt;= n; i++) conv[i] = i;</span><br><span class="line">    <span class="built_in">sove</span>(<span class="number">0</span>);</span><br><span class="line">  </span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!pq[conv[<span class="number">0</span>]].<span class="built_in">empty</span>())&#123;</span><br><span class="line">            ans += pq[conv[<span class="number">0</span>]].<span class="built_in">top</span>(); pq[conv[<span class="number">0</span>]].<span class="built_in">pop</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="I-æœ€å°ç›´å¾„ç”Ÿæˆæ ‘-MDST"><a href="#I-æœ€å°ç›´å¾„ç”Ÿæˆæ ‘-MDST" class="headerlink" title="I æœ€å°ç›´å¾„ç”Ÿæˆæ ‘ MDST"></a>I æœ€å°ç›´å¾„ç”Ÿæˆæ ‘ MDST</h2><p>ä¸ºäº†æ±‚è§£MDSTï¼Œå°±éœ€è¦æ±‚è§£ç»å¯¹ä¸­å¿ƒæ‰€åœ¨çš„ä½ç½®ã€‚ç»å¯¹ä¸­å¿ƒä¸ä¸€å®šåœ¨èŠ‚ç‚¹ä¸Šï¼Œå¯ä»¥åœ¨è¾¹ä¸Šã€‚</p><p>å½“é€‰å®šæŸæ¡è¾¹<u, v>åï¼Œmin(æŸç‚¹åˆ°uçš„è·ç¦»ï¼ŒæŸç‚¹åˆ°vçš„è·ç¦»)æ˜¯ä¸€ä¸ªå•å³°å‡½æ•°<code>^</code>ï¼ŒæŠŠæ‰€æœ‰çš„ç‚¹çš„å±±å³°å‡½æ•°æ”¾åˆ°ä¸€å¼ å›¾ä¸­ï¼Œé‚£ä¹ˆåº”è¯¥ä»æœ€é¡¶ç«¯çš„æŠ˜çº¿ä¸­æ‰¾ä¸€ä¸ªæœ€ä½ç‚¹ã€‚å› ä¸ºä¼šå‡ºç°å±±å³°å®Œå…¨è¢«å¦ä¸€ä¸ªå±±å³°åµŒå¥—çš„æƒ…å†µï¼Œæ‰€ä»¥å°†æ‰€æœ‰ç‚¹æŒ‰ç…§åˆ°uçš„è·ç¦»æ’å‡åºï¼Œæœ‰æ„ä¹‰çš„æŠ˜ç‚¹ä¸€å®šæ˜¯è¢«é‚£äº›åˆ°vè·ç¦»å‘ˆé™åºçš„ç‚¹ã€‚ä»¥æ­¤å°±å¯ä¸æ–­éå†ä¸Šè¿°æŠ˜çº¿ï¼Œæ‰¾åˆ°ç»å¯¹ä¸­å¿ƒæ‰€åœ¨çš„è¾¹ã€‚</p><p>æ‰¾åˆ°ç”Ÿæˆæ ‘çš„ç»å¯¹ä¸­å¿ƒåï¼Œå³å¯dijstraæˆ–å…¶ä»–ä»€ä¹ˆåŠæ³•æ‰¾åˆ°æœ€çŸ­è·¯å¾„ç”Ÿæˆæ ‘ã€‚é€šè¿‡æ•°å­¦è®¡ç®—ï¼Œå¯ä»¥çŸ¥é“ä¸­å¿ƒåœ¨è·ç¦»uç‚¹$ans - 2 * dis[i][rk[i][now]]$çš„ä½ç½®ï¼Œå¾ˆå¿«çš„å¯ä»¥çŸ¥é“è·ç¦»vç‚¹çš„è·ç¦»ã€‚é‚£ä¹ˆä»¥ç»å¯¹ä¸­å¿ƒä¸ºèµ·ç‚¹è·‘dijstraï¼Œå°±ç­‰ä»·äºå°†uç‚¹å’Œvç‚¹æ›´æ–°ä¸ºä¸­å¿ƒåˆ°å…¶çš„è·ç¦»ï¼Œå…¶ä½™è®¾ç½®ä¸ºinfã€‚ä¸ºäº†é¿å…é™¤ä»¥2çš„æµ®ç‚¹æ•°å‡ºç°ï¼Œå°†æ‰€æœ‰çš„æƒå€¼æ‰©å¤§ä¸º2å€å³å¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">5e2</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> ll inf = <span class="number">1ll</span> &lt;&lt; <span class="number">60</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line">ll a[maxn][manx], dis[maxn][maxn];</span><br><span class="line"><span class="keyword">int</span> rk[maxn][maxn];</span><br><span class="line"></span><br><span class="line">ll ans; <span class="keyword">int</span> ansi, ansj;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NODE</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to; ll d;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> NODE &amp;b) <span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> d &gt; b.d;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">priority_queue&lt;NODE&gt; pq;</span><br><span class="line">ll D[maxn], dx; <span class="keyword">int</span> par[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getpath</span><span class="params">()</span></span>&#123;</span><br><span class="line">    D[ansi] = dx;  pq.<span class="built_in">push</span>(&#123;ansi, D[ansi]&#125;); </span><br><span class="line">    <span class="keyword">if</span>(ansi != ansj)&#123; </span><br><span class="line">        D[ansj] = <span class="number">2</span> * a[ansi][ansj] - dx; pq.<span class="built_in">push</span>(&#123;ansj, D[ansj]&#125;); par[ansj] = ansi;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(!pq.<span class="built_in">empty</span>())&#123;</span><br><span class="line">        NODE temp = pq.<span class="built_in">top</span>(); pq.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">int</span> to = temp.to; ll d = temp.d;</span><br><span class="line">        <span class="keyword">if</span>(d &gt; D[to]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="keyword">if</span>(D[i] &gt; d + <span class="number">2</span> * a[to][i])&#123;</span><br><span class="line">            D[i] = d + <span class="number">2</span> * a[to][i];</span><br><span class="line">            par[i] = to;</span><br><span class="line">            pq.<span class="built_in">push</span>(&#123;i, D[i]&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// Fastin;</span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++) a[i][j] = dis[i][j] = inf;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) dis[i][i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> u, v, w; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;u, &amp;v, &amp;w);</span><br><span class="line">        a[u][v] = a[v][u] = w;</span><br><span class="line">        dis[u][v] = dis[v][u] = <span class="built_in">min</span>(dis[u][v], <span class="number">1ll</span> * w);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= n; k++) <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++) <span class="keyword">if</span>(i != j)</span><br><span class="line">        dis[i][j] = <span class="built_in">min</span>(dis[i][j], dis[i][k] + dis[k][j]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++) rk[i][j] = j;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">sort</span>(rk[i] + <span class="number">1</span>, rk[i] + <span class="number">1</span> + n, [i](<span class="keyword">int</span> a, <span class="keyword">int</span> b)-&gt;<span class="keyword">bool</span>&#123;<span class="keyword">return</span> dis[i][a] &lt; dis[i][b];&#125;);</span><br><span class="line">    ans = inf;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++) <span class="keyword">if</span>(i != j &amp;&amp; a[i][j] != inf)&#123;</span><br><span class="line">        <span class="built_in">update</span>(dis[i][rk[i][n]] * <span class="number">2</span>, i, i);</span><br><span class="line">        <span class="built_in">update</span>(dis[j][rk[j][n]] * <span class="number">2</span>, j, j);</span><br><span class="line">        <span class="keyword">int</span> pre = n;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> now = n - <span class="number">1</span>; now &gt;= <span class="number">1</span>; now--)&#123;</span><br><span class="line">            <span class="keyword">if</span>(dis[j][rk[i][now]] &gt; dis[j][rk[i][pre]])&#123;</span><br><span class="line">                ll temp = dis[j][rk[i][pre]] + dis[i][rk[i][now]] + a[i][j];</span><br><span class="line">                <span class="keyword">if</span>(temp &lt; ans)&#123;</span><br><span class="line">                    ans = tmep;</span><br><span class="line">                    ansi = i; ansj = j;</span><br><span class="line">                    dx = ans - <span class="number">2</span> * dis[i][rk[i][now]];</span><br><span class="line">                &#125;</span><br><span class="line">                pre = now; </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) D[i] = inf;</span><br><span class="line">    <span class="built_in">getpath</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="keyword">if</span>(par[i]) <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, i, par[i], a[i][par[i]]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ ‘ </tag>
            
            <tag> DSU on tree </tag>
            
            <tag> MDST </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>chanllage</title>
      <link href="/2020/11/03/chanllage/"/>
      <url>/2020/11/03/chanllage/</url>
      
        <content type="html"><![CDATA[<p>æœ‰ä¸€äº›æœ‰è¶£ä½†æ˜¯å¤§æ¦‚éœ€è¦é«˜æ·±æ•°å­¦çŸ¥è¯†çš„è®¡ç®—æœºé—®é¢˜æ‚¬è€Œæœªå†³ï¼Œç‰¹æ­¤è®°å½•ã€‚</p><span id="more"></span><h3 id="å¼ å¸†çŒœæƒ³"><a href="#å¼ å¸†çŒœæƒ³" class="headerlink" title="å¼ å¸†çŒœæƒ³"></a>å¼ å¸†çŒœæƒ³</h3><h3 id="å“ˆå¸Œå†²çªæ¦‚ç‡"><a href="#å“ˆå¸Œå†²çªæ¦‚ç‡" class="headerlink" title="å“ˆå¸Œå†²çªæ¦‚ç‡"></a><a href="http://rqdmap.top/2020/10/28/2020-ccpc-qinhuangdao/#more">å“ˆå¸Œå†²çªæ¦‚ç‡</a></h3><p>æœ‰ç­‰å¼$(a_1^k+a_2^k+â€¦+a_n^k) \% 2^{64}=(b_1^k+b_2^k+â€¦+b_n^k)\% 2^{64}$ï¼Œ</p><p>å®šä¹‰â€œå†²çªâ€œä¸ºï¼šæ»¡è¶³ä¸Šè¿°ç­‰å¼çš„ä¸¤ä¸ªå¤šé‡é›†åˆ{an}{bn}ä¸å®Œå…¨ç›¸åŒã€‚</p><p>å¸Œæœ›è¯´æ˜ï¼šå½“nä¸º1e5çš„çº§åˆ«æ—¶ï¼Œk=2æ—¶å†²çªæ¦‚ç‡æé«˜ï¼Œè€Œå½“k&gt;=3æ—¶å†²çªçš„æ¦‚ç‡å°±ä¼šé™ä½åˆ°ä¸€ä¸ªå¯ä»¥æ¥å—çš„ç¨‹åº¦ã€‚</p><p>é›†åˆ{an}{bn}çš„å…ƒç´ å¯èƒ½å¯ä»¥è®¤ä¸ºæ˜¯åœ¨[0, 2^64)å‡åŒ€åˆ†å¸ƒçš„ï¼Œä¸è¿‡è¿™ä¸€ç‚¹æ²¡æœ‰ä»”ç»†è€ƒç©¶ï¼Œä¹Ÿæ²¡æœ‰é€ è‹¥å¹²æ•°æ®è¿›è¡Œæ£€éªŒã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ‚¬è€Œæœªå†³ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>2020-ccpc-qinhuangdao</title>
      <link href="/2020/10/28/2020-ccpc-qinhuangdao/"/>
      <url>/2020/10/28/2020-ccpc-qinhuangdao/</url>
      
        <content type="html"><![CDATA[<p>[toc]</p><span id="more"></span><h2 id="K-æ ‘dp"><a href="#K-æ ‘dp" class="headerlink" title="K æ ‘dp"></a>K æ ‘dp</h2><p>åœºä¸Šæƒ³äº†ä¸€ä¸ªä¸å¤ªå¯¹çš„æ’åºåŠæ³•ï¼ŒçœŸæ­£çš„æ’åºæ–¹æ³•åº”è¯¥æ˜¯å°†å­æ ‘æŒ‰ç…§æœ€æ·±æ·±åº¦ä»ä½åˆ°é«˜è¿›è¡Œæ’åºã€‚ç„¶åéšä¾¿ç»´æŠ¤ä¸€ä¸ªdpæ•°ç»„è¡¨ç¤ºä»æ ¹èŠ‚ç‚¹æ´¾é£è‹¥å¹²å£«å…µéå†å®Œiå­æ ‘æ‰€éœ€è¦çš„æœ€å°æ—¶é—´ï¼Œæ¯æ¬¡å°è¯•ç”¨å­æ ‘çš„ç»“æœæ›´æ–°ä»–ä»¬å…±åŒçˆ¶èŠ‚ç‚¹çš„ä¿¡æ¯ï¼š</p><ul><li>å¦‚æœæŸèŠ‚ç‚¹æ˜¯å¶å­ï¼Œé‚£ä¹ˆç”¨å…¶æ·±åº¦ä½œä¸ºç»“æœï¼›</li><li>å¦‚æœæŸèŠ‚ç‚¹ä¸æ˜¯å¶å­ï¼Œå°†å­æ ‘æŒ‰ç…§ä¸Šè¿°é¡ºåºæ’åºåï¼Œè€ƒè™‘å­æ ‘v1å¯èƒ½å¯¹v2é€ æˆçš„è´¡çŒ®ï¼šå½“height[v1] + 2 &lt;= dep[v2]ï¼Œé‚£ä¹ˆä»v1çš„å£«å…µåŸè·¯è¿”å›ä¼šæ¯”é‡æ–°æ´¾é£ä¸€ä¸ªäººè¿‡æ¥æ›´ä¼˜ï¼Œå°†ç»“æœå‡å»å·®å€¼ï¼Œä¸æ–­é‡å¤æ›´æ–°ã€‚æ¯æ¬¡åªéœ€è¦è€ƒè™‘å­æ ‘$i$å¯¹å­æ ‘${i + 1}$çš„è´¡çŒ®ï¼Œè¿™æ˜¯å› ä¸ºå­æ ‘åºåˆ—æ˜¯å•è°ƒçš„ï¼Œä¸€æ—¦åˆ°æŸä¸ªä½ç½®åé‡æ–°æ´¾é£æ›´ä¼˜ï¼Œä¹‹åçš„æ‰€æœ‰ä½ç½®ä¹Ÿä¸€å®šæ˜¯é‡æ–°æ´¾é£æ›´ä¼˜ã€‚</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> manx = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">star</span>&#123;</span><span class="keyword">int</span> to, next;&#125;;</span><br><span class="line"><span class="keyword">int</span> head[maxn], top = <span class="number">0</span>;</span><br><span class="line">star edge[maxn &lt;&lt; <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> dep[maxn], height[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> par)</span></span>&#123;</span><br><span class="line">    height[x] = <span class="number">0</span>; </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[x]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(to == par) <span class="keyword">continue</span>;</span><br><span class="line">        dep[to] = dep[x] + <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(to, x);</span><br><span class="line">        height[x] = <span class="built_in">max</span>(height[x], height[to] + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä»æ ¹ç»“ç‚¹æ´¾é£è‹¥å¹²äººï¼Œéå†å®Œiå­æ ‘æ‰€éœ€è¦çš„æœ€å°ä»£ä»·å³ä¸ºdp[i]</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;<span class="keyword">return</span> height[x] &lt; height[y];&#125;</span><br><span class="line">ll dp[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sove</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> par)</span></span>&#123;</span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; vec;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[now]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        itn to = edge[i].to; <span class="keyword">if</span>(to == par) <span class="keyword">continue</span>;</span><br><span class="line">        vec.<span class="built_in">push_back</span>(to);</span><br><span class="line">        <span class="built_in">sove</span>(to, now);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(vec.<span class="built_in">begin</span>(), vec.<span class="built_in">end</span>(), cmp);</span><br><span class="line">    <span class="keyword">if</span>(vec.<span class="built_in">empty</span>()) dp[now] = dep[now];</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">int</span> top = (<span class="keyword">int</span>)vec.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> x: vec) dp[now] += dp[x];</span><br><span class="line">        <span class="built_in">fro</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; top; i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(height[vec[i - <span class="number">1</span>]] + <span class="number">2</span> &lt;= dep[vec[i]])&#123; </span><br><span class="line">                dp[now] -= dep[vec[i]] - height[vec[i - <span class="number">1</span>]] - <span class="number">2</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// Fastin;</span></span><br><span class="line">    <span class="keyword">int</span> _; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;_); <span class="built_in">fro</span>(<span class="keyword">int</span> __ = <span class="number">1</span>; __ &lt;= _; __++)&#123;</span><br><span class="line">        top = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> n; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">            dp[i] = height[i] = dep[i] = <span class="number">0</span>;</span><br><span class="line">            head[i] = <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> x; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">            <span class="built_in">add</span>(x, i); <span class="built_in">add</span>(i, x);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">sove</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Case #%d: %d\n&quot;</span>, __, dp[<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="J-å“ˆå¸Œä¸ç»„åˆæ•°å­¦"><a href="#J-å“ˆå¸Œä¸ç»„åˆæ•°å­¦" class="headerlink" title="J å“ˆå¸Œä¸ç»„åˆæ•°å­¦"></a>J å“ˆå¸Œä¸ç»„åˆæ•°å­¦</h2><p>æ„Ÿè°¢å†¯ä½¬çš„æŒ‡ç‚¹qaq ä¸ç„¶æˆ‘å¯èƒ½ä¸€å¹´éƒ½è°ƒä¸å‡ºæ¥è¿™é¢˜â€¦sro flukehnâ€¦.</p><p>é¢˜æ„è¯»æ˜ç™½åå‰©ä½™çš„å°±æ¯”è¾ƒç®€å•äº†ï¼Œå…ˆOnéå†é•¿åº¦d,å¯¹äºæ¯ä¸€æ®µé•¿åº¦å…ˆå¤„ç†å‡ºæ¥ä¸€ç§ç»„åˆæƒ…å†µï¼Œå¤æ‚åº¦å¤§æ¦‚æ˜¯Ologï¼›æ¥ä¸‹æ¥ä¸æ–­åœ°ç§»åŠ¨æ®‹ä½™çš„å°åŒºé—´rï¼Œæ¯æ¬¡ç§»åŠ¨åªä¼šå½±å“åˆ°ä¸Šä¸€æ¬¡åˆ’åˆ†çš„æŸä¸€ä¸ªdåŒºé—´ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åªå°†æŸä¸€æ®µåŒºé—´çš„æ¬¡æ•°å‡ä¸€ï¼Œç„¶åå¯¹æ–°åŒºé—´çš„æ¬¡æ•°åŠ ä¸€å³å¯ï¼›å¦‚æœä½¿ç”¨map/unordered_mapç­‰å®¹å™¨ï¼Œé‚£ä¹ˆå¤æ‚åº¦å¤§æ¦‚å°±æ˜¯$log^2$ï¼Œæ€»å¤æ‚åº¦$nlog^2$ã€‚</p><p>å¯¹å­—ç¬¦ä¸²çš„å“ˆå¸Œé‡‡ç”¨ä¼ ç»Ÿå“ˆå¸Œå³å¯ï¼Œå¯¹ä¸åŒå­—ç¬¦ä¸²çš„ç»„åˆçŠ¶æ€æˆ‘é‡‡ç”¨äº†å¹³æ–¹æ³•ã€‚å¹³æ–¹æ³•æ¯”è¾ƒå¥½å†™ï¼ŒåŒæ—¶æ“ä½œå¯é€†ï¼Œå€¼å¾—ä¸€è¯•ã€‚ç„¶è€Œæœ€åå‘ç°å¹³æ–¹æ³•çš„å†²çªæ¦‚ç‡æé«˜ï¼Œè¿éšæœºæ•°æ®éƒ½æ— æ³•å®Œç¾è·‘è¿‡ï¼›æ¢æˆ3æ–¹å’Œ4æ–¹å³å¯é¡ºåˆ©ACã€‚</p><p>æœ‰ä¸€äº›å€¼å¾—æ³¨æ„çš„ç‚¹ï¼š</p><ul><li>å­—ç¬¦ä¸²hashå¯ä»¥é‡‡ç”¨ullè‡ªç„¶æº¢å‡ºçš„åŠæ³•ï¼Œå¦‚æœæŒ‡å®šç´ æ•°ä¸æ–­å–æ¨¡ä¼šå¾ˆæ…¢ï¼Œå¦‚æœé‡åˆ°ä¸€äº›å¸¸æ•°æ¯”è¾ƒç´§çš„é¢˜ç›®å°±ä¼šTæ­»(<del>æ¯”å¦‚è¿™é“é¢˜å¦‚æœä¸ç”¨è‡ªç„¶æº¢å‡ºå¤§æ¦‚å°±ä¼šTLE</del>)</li><li>unorder_set/unordered_mapçš„clear()æ–¹æ³•ä¼šæ¯”ç›´æ¥.swapä¸€ä¸ªæ–°çš„ç©ºå®¹å™¨æ…¢å¾ˆå¤š<del>åœ¨è¿™é¢˜ä¸­çœŸçš„å¾ˆå¤š</del>ã€‚æœ‰çŒœæµ‹æ˜¯è¯´clear()ä¸ä¼šæ¸…ç©ºç¼“å­˜ï¼Œå¯¼è‡´ä¹‹åçš„å“ˆå¸Œè¡¨å…ƒç´ ç›¸è·è¾ƒè¿œï¼ŒæŸ¥è¯¢èµ·æ¥å°±ä¼šæ…¢å¾ˆå¤šï¼Ÿ</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">cosnt itn manx = <span class="number">3e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> itn M = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">const</span> itn pp = <span class="number">23333333</span>;</span><br><span class="line"><span class="keyword">int</span> n; </span><br><span class="line"><span class="keyword">char</span> s[maxn];</span><br><span class="line"></span><br><span class="line">ull hsh[maxn], po[manx];</span><br><span class="line">ll fac[maxn], facinv[maxn], inv[maxn];</span><br><span class="line"> </span><br><span class="line"><span class="comment">//è¿”å›å­—ç¬¦ä¸²s[l..r]çš„hshå€¼</span></span><br><span class="line"><span class="function">ull <span class="title">gethsh</span><span class="params">(<span class="keyword">int</span> l ,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    ull ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(l == <span class="number">0</span>) ans = hsh[r];</span><br><span class="line">    <span class="keyword">else</span> ans = hsh[r] - hsh[l - <span class="number">1</span>];</span><br><span class="line">    ans = ans * po[n - l]; </span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//sså­˜ç»“æœ</span></span><br><span class="line">unordered_set&lt;ull&gt; sts;</span><br><span class="line"><span class="comment">//è®°å½•æŸç§æ‰‹ä¸²å‡ºç°è¿‡å¤šå°‘æ¬¡ï¼Œ</span></span><br><span class="line">unordered_map&lt;ull, <span class="keyword">int</span>&gt; mp;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//åˆ©ç”¨mapæ•°ç»„ï¼Œæ›´æ–°ç»“æœåˆ°ssä¸­</span></span><br><span class="line"><span class="function">ll <span class="title">getans</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n = <span class="number">0</span>; ll ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> x: mp) <span class="keyword">if</span>(x.second &gt; <span class="number">0</span>)&#123;</span><br><span class="line">        ans *= facinv[x.second]; ans %= M;</span><br><span class="line">        n += x.second;</span><br><span class="line">    &#125;</span><br><span class="line">    ans = ans * fac[n] % M; </span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// Fastin;</span></span><br><span class="line">    po[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">300000</span>; i++) po[i] = po[i - <span class="number">1</span>] * pp;</span><br><span class="line"></span><br><span class="line">    fac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">fro</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">300000</span>; i++) fac[i] = fac[i - <span class="number">1</span>] * i % M;</span><br><span class="line">    facinv[<span class="number">300000</span>] = <span class="built_in">qp</span>(fac[<span class="number">300000</span>], M - <span class="number">2</span>, M);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">300000</span> - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) facinv[i] = facinv[i + <span class="number">1</span>] * (i + <span class="number">1</span>) % M;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">300000</span>; i++) inv[i] = <span class="built_in">qp</span>(i, M - <span class="number">2</span>, M);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> __; <span class="built_in">scnaf</span>(<span class="string">&quot;%d&quot;</span>, &amp;__); <span class="keyword">for</span>(<span class="keyword">int</span> _ = <span class="number">1</span>; _ &lt;= __; _++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s); n = (<span class="keyword">int</span>)<span class="built_in">strlen</span>(s);</span><br><span class="line">        hsh[<span class="number">0</span>] = s[<span class="number">0</span>] - <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++)&#123;</span><br><span class="line">            hsh[i] = hsh[i - <span class="number">1</span>] + (s[i] - <span class="string">&#x27;a&#x27;</span>) * po[i];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ll ans = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">//é€‰å–é•¿åº¦ä¸ºdçš„å•ä¸ªé¡¹é“¾</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> d = <span class="number">1</span>; d &lt;= n; d++)&#123;</span><br><span class="line">            unordered_set&lt;ull&gt; sts0;</span><br><span class="line">            unordered_map&lt;ull, <span class="keyword">int</span>&gt; mp0;</span><br><span class="line">            sts.<span class="built_in">swap</span>(sts0);</span><br><span class="line">            mp.<span class="built_in">swap</span>(mp0);</span><br><span class="line">            <span class="comment">//åˆå§‹åŒ– </span></span><br><span class="line">            ull K = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> now = <span class="number">0</span>; now + d - <span class="number">1</span> &lt; n; now += d)&#123;</span><br><span class="line">                ull value = <span class="built_in">gethsh</span>(now, now + d - <span class="number">1</span>);</span><br><span class="line">                mp[value]++;</span><br><span class="line">                K += value * value * value * value;</span><br><span class="line">            &#125;</span><br><span class="line">            ll temp = <span class="built_in">getans</span>();</span><br><span class="line">            ans += temp; sts.<span class="built_in">insert</span>(K); </span><br><span class="line">            <span class="keyword">if</span>(n % d)&#123;</span><br><span class="line">                <span class="keyword">int</span> r = n % d; <span class="keyword">int</span> pos = n / d * d;</span><br><span class="line">                <span class="comment">//[pos, pos + r - 1]</span></span><br><span class="line">                <span class="comment">//å¾€å‰ç§»åŠ¨ä¸€æ¬¡ï¼Œå‡å»[pos - d, pos - 1]ï¼ŒåŠ ä¸Š[pos + r - d, pos + r - 1];</span></span><br><span class="line">                <span class="keyword">while</span>(pos &gt;= d)&#123;</span><br><span class="line">                    ull value = <span class="built_in">gethsh</span>(pos - d, pos - <span class="number">1</span>);</span><br><span class="line">                    ll bias = mp[value];</span><br><span class="line"></span><br><span class="line">                    mp[value]--;</span><br><span class="line">                    K -= value * value * value * value;</span><br><span class="line"></span><br><span class="line">                    value = <span class="built_in">gethsh</span>(pos + r - d, pos + r - <span class="number">1</span>);</span><br><span class="line">                    mp[value]++;</span><br><span class="line">                    bias = bias * inv[mp[value]] % M;</span><br><span class="line">                    K += value * value * value * value;</span><br><span class="line"></span><br><span class="line">                    temp = temp * bias % M;</span><br><span class="line">                    <span class="keyword">if</span>(sts.<span class="built_in">count</span>(K) == <span class="number">0</span>)&#123;</span><br><span class="line">                        sts.<span class="built_in">insert</span>(K);</span><br><span class="line">                        ans += temp; ans %= M;</span><br><span class="line">                    &#125;</span><br><span class="line">                    pos -= d;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Case #%d: %lld\n&quot;</span>, _, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="I-æ•°è®º-amp-è¾—è½¬ç›¸é™¤-çº¿æ€§ç©ºé—´åŸºåº•"><a href="#I-æ•°è®º-amp-è¾—è½¬ç›¸é™¤-çº¿æ€§ç©ºé—´åŸºåº•" class="headerlink" title="I æ•°è®º&amp;è¾—è½¬ç›¸é™¤ çº¿æ€§ç©ºé—´åŸºåº•"></a>I æ•°è®º&amp;è¾—è½¬ç›¸é™¤ çº¿æ€§ç©ºé—´åŸºåº•</h2><p>åœºä¸Šæƒ³äº†ä¸ª(0, y)(x, 0)çš„åŸºåº•ï¼Œä½†æ˜¯éå¸¸é—æ†¾è¿™ç§åŸºåº•è™½ç„¶éå¸¸ç®€æ´ï¼Œå´åªé€‚ç”¨äºå®æ•°åŸŸä¸­ï¼Œåœ¨æ•´æ•°é¢†åŸŸä¸­è¿™ç§åŸºåº•å¹¶ä¸èƒ½å¥æ•ˆã€‚</p><p>è€ƒè™‘è¾—è½¬ç›¸é™¤æ³•ï¼Œä½¿ç”¨å½¢å¦‚(0, y0), (x1, y1)çš„åŸºåº•ï¼Œè¿™æ ·æ—¢èƒ½å¤Ÿå¼ æˆä¸€ä¸ªäºŒç»´å¹³é¢ï¼Œåˆèƒ½å¤Ÿ<strong>ä¸ä¸¢å¤±ã€ä¸æ‰©å¼ åŸæœ‰åŸºåº•çš„è¡¨ç¤ºèŒƒå›´</strong>ã€‚æ¯æ¬¡åŠ å…¥ä¸€ä¸ªå…ƒç´ (x, y)åªéœ€è¦å°†(x1, y1)å’Œ(x, y)åšè¾—è½¬ç›¸é™¤ï¼Œæ¶ˆå»å…¶ä¸­æŸä¸€ä¸ªå‘é‡çš„xåˆ†é‡ï¼Œå†å°†è¯¥å‘é‡çš„yåˆ†é‡ä¸(0, y0)çš„yåˆ†é‡åšgcdå°±èƒ½å¾—åˆ°ä¸€ä¸ªèåˆçš„åŸºåº•ï¼Œç”¨è¿™ä¸ªæ–°åŸºåº•å°±èƒ½å¤Ÿç­‰ä»·åœ°è¡¨ç¤ºåŸæœ‰çš„ä¸¤ä¸ªå‘é‡ã€‚</p><p><del>æœ‰ä¸€äº›åœ°æ–¹å¾—å°å¿ƒå¤„ç†ï¼Œä¸ç„¶ä¸ä»…ä¼šçˆ†intç”šè‡³ä¼šçˆ†longlong</del></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;pair&lt;ll, ll&gt;&gt; vec;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fun</span><span class="params">(pair&lt;ll, ll&gt; &amp;p1, pair&lt;ll, ll&gt; &amp;p2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(p1.first)&#123;</span><br><span class="line">        ll d = p2.first / p1.first;</span><br><span class="line">        p2.first -= d * p1.first;</span><br><span class="line">        p2.second -= d * p1.second;</span><br><span class="line">        <span class="built_in">swap</span>(p1, p2);</span><br><span class="line">    &#125;</span><br><span class="line">    p1.second = <span class="built_in">abs</span>(p1.second);</span><br><span class="line">    p2.second %= p1.second;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(ll u, ll v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(vec.<span class="built_in">empty</span>()) vec.<span class="built_in">push_back</span>(&#123;u, v&#125;);</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        pair&lt;ll, ll&gt; temp; temp.first = u; temp.second = v;</span><br><span class="line">        <span class="built_in">assert</span>(vec.<span class="built_in">size</span>() &lt;= <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">if</span>(vec.<span class="built_in">size</span>() == <span class="number">1</span>)&#123;</span><br><span class="line">            vec.<span class="built_in">push_back</span>(temp);</span><br><span class="line">            <span class="built_in">fun</span>(vec[<span class="number">0</span>], vec[<span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">fun</span>(vec[<span class="number">1</span>], tmep);</span><br><span class="line">            <span class="built_in">assert</span>(vec[<span class="number">0</span>].first == vec[<span class="number">1</span>].first &amp;&amp; vec[<span class="number">0</span>].first == <span class="number">0</span>);</span><br><span class="line">            vec[<span class="number">0</span>].second = <span class="built_in">abs</span>(<span class="built_in">gcd</span>(vec[<span class="number">0</span>].second, vec[<span class="number">1</span>].second));</span><br><span class="line">            temp.second %= vec[<span class="number">0</span>].second; </span><br><span class="line">            vec[<span class="number">1</span>] = temp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(ll x, ll y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x == <span class="number">0</span> &amp;&amp; y == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(vec.<span class="built_in">empty</span>()) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(vec.<span class="built_in">size</span>() == <span class="number">1</span>) <span class="keyword">return</span> vec[<span class="number">0</span>].first * y == vec[<span class="number">0</span>].second * x;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(x % vec[<span class="number">1</span>].first) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        y -= x / vec[<span class="number">1</span>].first * vec[<span class="number">1</span>].second;</span><br><span class="line">        <span class="keyword">if</span>(y % vec[<span class="number">0</span>].second == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// Fastin;</span></span><br><span class="line">    <span class="keyword">int</span> TT; <span class="built_in">scnaf</span>(<span class="string">&quot;%d&quot;</span>, &amp;TT); </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> cas = <span class="number">1</span>; cas &lt;= TT; cas++)&#123;</span><br><span class="line">        ll ans = <span class="number">0</span>; vec.<span class="built_in">clear</span>();</span><br><span class="line">        <span class="keyword">int</span> q; <span class="built_in">scnaf</span>(<span class="string">&quot;%d&quot;</span>, &amp;q); <span class="keyword">while</span>(q--)&#123;</span><br><span class="line">            <span class="keyword">int</span> op; <span class="built_in">scnaf</span>(<span class="string">&quot;%d&quot;</span>, &amp;op);</span><br><span class="line">            <span class="keyword">if</span>(op == <span class="number">1</span>)&#123;</span><br><span class="line">                <span class="keyword">int</span> x, y; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;x, &amp;y);</span><br><span class="line">                <span class="keyword">if</span>(x == <span class="number">0</span> &amp;&amp; y == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">                <span class="comment">//ä¿è¯åŠ å…¥æœ‰æ„ä¹‰çš„å‘é‡ã€‚</span></span><br><span class="line">                <span class="built_in">add</span>(x, y);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">int</span> x, y, w; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;x, &amp;y, &amp;w);</span><br><span class="line">                ans += w * <span class="built_in">query</span>(x, y);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Case #%d: %lld\n&quot;</span>, cas, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="H-è®¡æ•°-DP"><a href="#H-è®¡æ•°-DP" class="headerlink" title="H è®¡æ•° DP"></a>H è®¡æ•° DP</h2><p>é¦–å…ˆå­¦ä¹ äºåšå®¢ <a href="https://www.cnblogs.com/CzxingcHen/p/13892671.html">ç‚¹æˆ‘</a>, ç„¶è€Œè°ƒäº†ä¸€ä¸‹åˆå‘ç°ä»–è®²çš„ååˆ†æ™¦æ¶©ï¼Œè‡ªå·±çš„ç†è§£æ˜¯é”™è¯¯çš„ã€‚</p><p>æ¥ä¸‹æ¥ä¾¿ä»Linqiçš„åšå®¢ä¸­æ‰¾åˆ°äº†ä¸€ç§æ¼‚äº®çš„è¯´æ˜ï¼Œ<a href="https://www.cnblogs.com/linqi05/p/13860846.html">è¿™é‡Œ</a></p><p>å¯¹äºè¦æ±‚çš„è¿™ç§<strong>å¹³æ–¹</strong>å’Œå¼ï¼Œä¸€ç§å¸¸è§çš„è½¬åŒ–æ˜¯è½¬åŒ–æˆ$\sum _{1â‰¤i,jâ‰¤n}[a[i] = a[j] = k],$ å…¶ä¸­kç»™å®šã€‚é‚£ä¹ˆå¯¹äºæŸä¸ªkè€Œè¨€ï¼Œæˆ‘ä»¬åªè¦åœ¨æ‰€æœ‰çš„åˆæ³•åºåˆ—ä¸­æ‰¾å‡ºæ‰€æœ‰çš„è¿™ç§åºåˆ—å¯¹æ•°å³å¯ã€‚</p><p>é€šè¿‡<code>ç¬¬ä¸€ä¸ªå‡ºç°æ•°å€¼kçš„ä½ç½®</code>æ¥åˆ’åˆ†ä¸€ç°‡åºåˆ—ï¼Œè¿™ä¸€ç°‡åºåˆ—å¯ä»¥é€šè¿‡ä¸€äº›ç»Ÿä¸€çš„æ‰‹æ®µè¿›è¡Œè®¡æ•°ã€‚</p><p>é¦–å…ˆé¢„å¤„ç†å‡ºä¸¤ä¸ªè®¡æ•°dpæ•°ç»„ï¼š</p><ul><li>$dp1[i][j]$è¡¨ç¤ºæ‰€æœ‰åºåˆ—a1, a2,â€¦,ai, a0=0ä¸­æ»¡è¶³$pi=j$çš„æ‰€æœ‰åˆæ³•åºåˆ—çš„ä¸ªæ•°</li><li>dp$2[i][j]$è¡¨ç¤ºæ‰€æœ‰åºåˆ—a1, a2,â€¦,ai, a0=jä¸­åˆæ³•åºåˆ—çš„ä¸ªæ•°ã€‚</li></ul><p>é‚£ä¹ˆå¯¹ä¸€ç°‡åºåˆ—è®¡æ•°ï¼ˆè®°posä¸ºç¬¬ä¸€ä¸ªå‡ºç°kçš„ä½ç½®ï¼‰æ—¶åˆ†4ç§æƒ…å†µè€ƒè™‘:</p><ul><li>ä¸¤ä¸ªæ•°å‡é€‰æ‹©pos</li><li>ä¸€ä¸ªæ•°é€‰æ‹©posã€å¦ä¸€ä¸ªæ•°ä¸é€‰æ‹©pos</li><li>ä¸¤ä¸ªæ•°å‡é€‰æ‹©posåçš„æŸä¸€ä¸ªä½ç½®</li><li>ä¸¤ä¸ªä½ç½®ä¸åŒä¸”å‡ä¸é€‰æ‹©pos</li></ul><p>æƒ…å†µ1æ˜¾ç„¶å¯¹åº”$dp2[n - pos][t] * dp[pos - 1][t - 1]$ã€‚</p><p>æƒ…å†µ23éƒ½æ˜¯åœ¨(pos, n]ä¸­é€‰æ‹©äº†ä¸€ä¸ªä½ç½®ï¼Œé‚£ä¹ˆåªéœ€è¦è€ƒè™‘é•¿åº¦ä¸ºn-pos-1çš„åˆæ³•åºåˆ—ä¸ªæ•°å³å¯ã€‚<strong>è¿™æ˜¯å› ä¸ºå¯ä»¥é€šè¿‡æ’å…¥/åˆ é™¤ä¸€ä¸ªä½ç½®çš„å…ƒç´ æ¥ä¸åŸåºåˆ—è¿›è¡Œä¸€ä¸€æ˜ å°„</strong>ã€‚ç»“æœå‡æ˜¯$ (n - pos) * dp2[n - pos - 1][t]$ï¼Œè€Œè¿™ä¸¤ç§æƒ…å†µä¸€å…±æœ‰3ç§å¯èƒ½çš„ç¬¬ä¸€ä¸ªé€‰æ‹©æƒ…å†µï¼Œå› è€Œä¸Šè¿°è¡¨è¾¾å¼ä¹˜ä»¥3åè´¡çŒ®è¿›ç­”æ¡ˆã€‚</p><p>æƒ…å†µ4ä¸æƒ…å†µ23ç±»ä¼¼ï¼Œä¸åŒçš„ä»…ä»…æ˜¯åœ¨(pos, n]ä¸­é€‰æ‹©äº†ä¸¤ä¸ªæ•°ï¼Œå› è€Œç»“æœä¸ºï¼š$ (n - pos) <em> (n - pos - 1) </em> dp2[n - pos - 2][t]$</p><p>æ®æ­¤ï¼Œå³å¯$O(n^2)$åœ°å¾—å‡ºæ‰€æœ‰çš„ç»“æœã€‚</p><p><del>sro zlq!</del></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">cosnt <span class="keyword">int</span> maxn = <span class="number">3e3</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, M;</span><br><span class="line">ll dp[maxn][maxn], dp2[maxn][maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">ini</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">clr</span>(dp, <span class="number">0</span>); <span class="built_in">clr</span>(dp2, <span class="number">0</span>); </span><br><span class="line">    dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++)&#123;</span><br><span class="line">        dp[i][j] = dp[i - <span class="number">1</span>][j - <span class="number">1</span>] + j * dp[i - <span class="number">1</span>][j] % M;</span><br><span class="line">        dp[i][j] %= M;</span><br><span class="line">    &#125;    </span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++) dp2[<span class="number">0</span>][i] = <span class="number">1</span>;</span><br><span class="line">    dp2[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">1</span>; dp2[<span class="number">1</span>][n] = n; <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) dp2[<span class="number">1</span>][i] = i + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++) <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++)&#123;</span><br><span class="line">        dp2[i][j] = dp2[i - <span class="number">1</span>][j + <span class="number">1</span>] + dp2[i - <span class="number">1</span>][j] * j % M;</span><br><span class="line">        dp2[i][j] %= M;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// Fastin;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> TT; <span class="built_in">scnaf</span>(<span class="string">&quot;%d&quot;</span>, &amp;TT); </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> cas = <span class="number">1</span>; cas &lt;= TT; cas++)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Case #%d:\n&quot;</span>, cas);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;M);</span><br><span class="line">        <span class="built_in">ini</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> t = <span class="number">1</span>; t &lt;= n; t++)&#123;</span><br><span class="line">            ll temp = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> pos = t; pos &lt;= n; pos++)&#123;</span><br><span class="line">                ll ans = dp2[n - pos][t];</span><br><span class="line">                <span class="keyword">if</span>(pos &lt;= n - <span class="number">1</span>) ans = (ans + <span class="number">3ll</span> * (n - pos) % M * dp2[n - pos - <span class="number">1</span>][t] % M) % M;</span><br><span class="line">                <span class="keyword">if</span>(pos &lt;= n - <span class="number">2</span>) ans = (ans + (n - pos) * <span class="number">1ll</span> * (n - pos - <span class="number">1</span>) % M * dp2[n - pos - <span class="number">2</span>][t] % M) % M;</span><br><span class="line">                ans = ans * dp[pos - <span class="number">1</span>][t - <span class="number">1</span>] % M;</span><br><span class="line">                tmep += ans; temp %= M;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>, temp);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ ‘dp </tag>
            
            <tag> å­—ç¬¦ä¸²å“ˆå¸Œ </tag>
            
            <tag> ç»„åˆè®¡æ•° </tag>
            
            <tag> çº¿æ€§åŸºåº• </tag>
            
            <tag> è¾—è½¬ç›¸é™¤ </tag>
            
            <tag> è®¡æ•°DP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019-SWERC</title>
      <link href="/2020/10/17/2019-SWERC/"/>
      <url>/2020/10/17/2019-SWERC/</url>
      
        <content type="html"><![CDATA[<p>[toc]</p><span id="more"></span><p><strong>å‚è€ƒåšå®¢ï¼š</strong></p><p><a href="https://www.cnblogs.com/heyuhhh/p/12941654.html">https://www.cnblogs.com/heyuhhh/p/12941654.html</a></p><h3 id="K-å›¾ä¸Šçš„è·¯å¾„å­˜åœ¨é—®é¢˜-gt-å»ºåå›¾è¿›è¡ŒæŸ“è‰²"><a href="#K-å›¾ä¸Šçš„è·¯å¾„å­˜åœ¨é—®é¢˜-gt-å»ºåå›¾è¿›è¡ŒæŸ“è‰²" class="headerlink" title="K å›¾ä¸Šçš„è·¯å¾„å­˜åœ¨é—®é¢˜(?) -&gt;å»ºåå›¾è¿›è¡ŒæŸ“è‰²"></a>K å›¾ä¸Šçš„è·¯å¾„å­˜åœ¨é—®é¢˜(?) -&gt;å»ºåå›¾è¿›è¡ŒæŸ“è‰²</h3><p>å»ºåå›¾ï¼Œç”¨rotçš„æ¯ä¸ªé‚»ç‚¹å»å¯¹æ•´å¼ å›¾æŸ“è‰²ï¼Œè¢«æŸ“è‰²çš„ç‚¹å°±æ„å‘³ç€å¯ä»¥èµ°åˆ°è¯¥é¢œè‰²æ‰€ä»£è¡¨çš„é‚»ç‚¹ã€‚æˆ‘ä»¬å…è®¸æ¯ä¸ªç‚¹æœ€å¤šè¢«æŸ“è‰²ä¸¤æ¬¡ï¼Œè¿™æ˜¯å› ä¸ºrotçš„é‚»ç‚¹ä¸€æ—¦è¢«è¶…è¿‡ä¸€ä¸ªç‚¹æŸ“è‰²ï¼Œé‚£ä¹ˆå°±ä¸€å®šä¸åˆæ³•ï¼›æ‰€ä»¥å¯¹å›¾ä¸­æ¯ä¸ªç‚¹è€Œè¨€ï¼Œå¦‚æœå…¶è¢«æŸ“è‰²æ¬¡æ•°å¤§äºç­‰äº2ï¼Œé‚£ä¹ˆå…¶å‡ºè¾¹æ‰€å¯¹åº”çš„ä¸€ç³»åˆ—ç‚¹çš„æ›´æ–°ä¹Ÿå·²ç»éƒ½å®Œæˆï¼Œå†æ¬¡æŸ“è‰²å¢åŠ æŸ“è‰²æ¬¡æ•°æ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œå¹¶ä¸ä¼šæ”¹å˜â€œä¸åˆæ³•â€è¿™ä¸€æ€§è´¨ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ä¸ºäº†é¿å…åœ¨ä¸€äº›ç¯è·¯ä¸­ç»•æ­»ï¼Œæ¯æ¬¡åº”è¯¥åˆ¤æ–­ä¸€ä¸‹å½“å‰ç‚¹æ˜¯å¦å·²ç»è¢«å½“å‰é¢œè‰²æŸ“è¿‡ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m, rot;</span><br><span class="line"><span class="keyword">int</span> head[maxn], top = <span class="number">0</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">star</span>&#123;</span><span class="keyword">int</span> to, next;&#125;;</span><br><span class="line">star edge[maxn &lt;&lt; <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">set&lt;<span class="keyword">int</span>&gt; ans, res;</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; vec[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> sze = (<span class="keyword">int</span>)vec[now].<span class="built_in">size</span>();</span><br><span class="line">    <span class="keyword">if</span>(sze == <span class="number">2</span>) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(sze == <span class="number">1</span> &amp;&amp; vec[now][<span class="number">0</span>] == c) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        vec[now].<span class="built_in">push_back</span>(c);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = head[now]; ~i; i = edge[i].next)&#123;</span><br><span class="line">            <span class="keyword">if</span>(edge[i].to == rot) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="built_in">dfs</span>(edge[i].to, c);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// Fastin;  </span></span><br><span class="line">    <span class="built_in">clr</span>(head, <span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;n, &amp;m, &amp;rot);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> u, v; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">        <span class="built_in">add</span>(v, u);</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[rot]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        ans.<span class="built_in">insert</span>(edge[i].to);</span><br><span class="line">        <span class="built_in">dfs</span>(edge[i].to, edge[i].to);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> x: ans) <span class="keyword">if</span>((vec[x].<span class="built_in">size</span>() == <span class="number">1</span> &amp;&amp; vec[x][<span class="number">0</span>] == x)) res.<span class="built_in">insert</span>(x);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, (<span class="keyword">int</span>)res.<span class="built_in">size</span>());</span><br><span class="line">    <span class="built_in">fro</span>(<span class="keyword">int</span> x: res) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, x);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="A-äºŒç»´ä»·å€¼dijstra-åœ¨ä¸€ç»´è·¯å¾„æƒå€¼å’Œæœ‰ä¸Šé™çš„æ¡ä»¶ä¸‹æ±‚å¦ä¸€ç»´çš„æœ€çŸ­è·¯"><a href="#A-äºŒç»´ä»·å€¼dijstra-åœ¨ä¸€ç»´è·¯å¾„æƒå€¼å’Œæœ‰ä¸Šé™çš„æ¡ä»¶ä¸‹æ±‚å¦ä¸€ç»´çš„æœ€çŸ­è·¯" class="headerlink" title="A äºŒç»´ä»·å€¼dijstra(åœ¨ä¸€ç»´è·¯å¾„æƒå€¼å’Œæœ‰ä¸Šé™çš„æ¡ä»¶ä¸‹æ±‚å¦ä¸€ç»´çš„æœ€çŸ­è·¯)"></a>A äºŒç»´ä»·å€¼dijstra(åœ¨ä¸€ç»´è·¯å¾„æƒå€¼å’Œæœ‰ä¸Šé™çš„æ¡ä»¶ä¸‹æ±‚å¦ä¸€ç»´çš„æœ€çŸ­è·¯)</h3><p>å¤æ‚åº¦å¤§æ¦‚æ˜¯$EBlog{EB}$ï¼ŒEæ˜¯å›¾ä¸­è¾¹æ•°ï¼ŒBæ˜¯è·ç¦»çš„ä¸Šé™ã€‚</p><p>ç®€å•åœ°ä¿®æ”¹ä¸€ä¸‹dijstraå³å¯ï¼Œä½†æ˜¯å†™èµ·æ¥æ„Ÿè§‰åˆé•¿åˆéº»çƒ¦ã€‚</p><p><del>sro åœºä¸Š1Açš„IGVA</del></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">POINT</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> x, y;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">read</span><span class="params">()</span></span>&#123;<span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;x, &amp;y);&#125;</span><br><span class="line">&#125;;</span><br><span class="line">POINT p[manx], s, t;</span><br><span class="line"><span class="keyword">int</span> b, c[maxn], type, n;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> head[maxn], top = <span class="number">0</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">star</span>&#123;</span><span class="keyword">int</span> from, to, next, dis, w, op;&#125;;</span><br><span class="line">star edge[maxn &lt;&lt; <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getdis</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> rdis = (p[u].x - p[v].x) * (p[u].x - p[v].x) + (p[u].y - p[v].y) * (p[u].y - p[v].y);</span><br><span class="line">    <span class="keyword">int</span> dis = <span class="built_in">max</span>(<span class="number">0</span>, (<span class="keyword">int</span>)<span class="built_in">sqrt</span>(rdis) - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">while</span>(dis * dis &lt; rdis) dis++;</span><br><span class="line">    <span class="keyword">return</span> dis;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> op)</span></span>&#123;</span><br><span class="line">    <span class="comment">//ä»¥opçš„æ–¹å¼è¿æ¥ä¸€æ¡è·¯å¾„</span></span><br><span class="line">    edge[top].from = u;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].op = op;</span><br><span class="line">    edge[top].next= head[u];</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">    edge[i].dis = <span class="built_in">getdis</span>(edge[i].from, edge[i].to);</span><br><span class="line">    edge[i].w = edge[i].dis * c[edge[i].op];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//dis[i][j]è¡¨ç¤ºä»såˆ°è¾¾iç‚¹ã€è·ç¦»èŠ±è´¹ä¸ºjæ—¶çš„æœ€å°ç¢³æ’æ”¾é‡</span></span><br><span class="line"><span class="keyword">int</span> dis[maxn][<span class="number">110</span>];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NODE</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> v, dis, w;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> NODE&amp; b)<span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(w != b.w) <span class="keyword">return</span> w &gt; b.w;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> dis &gt; b.dis;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">priority_queue&lt;NODE&gt; pq;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dij</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">clr</span>(dis, <span class="number">0x3f</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> d = <span class="built_in">getdis</span>(n, i); <span class="keyword">if</span>(d &gt; b) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">int</span> w = d * c[<span class="number">0</span>];</span><br><span class="line">        pq.<span class="built_in">push</span>(&#123;i, d, w&#125;);</span><br><span class="line">        dis[i][d] = w;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(!pq.<span class="built_in">empty</span>())&#123;</span><br><span class="line">        NODE temp = pq.<span class="built_in">top</span>(); pq.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">int</span> d = temp.dis, w = tmep.w, v = temp.v;</span><br><span class="line">        <span class="keyword">if</span>(w &gt; dis[v][d]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = head[v]; ~i; i = edge[i].next) </span><br><span class="line">        <span class="keyword">if</span>(edge[i].dis + d &lt;= b)&#123;</span><br><span class="line">            <span class="keyword">if</span>(edge[i].w + w &lt; dis[edge[i].to][d + edge[i].dis])&#123;</span><br><span class="line">                dis[edge[i].to][d + edge[i].dis] = edge[i].w + w;</span><br><span class="line">                pq.<span class="built_in">push</span>(&#123;edge[i].to, d + edge[i].dis, edge[i].w + w&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="keyword">for</span>(<span class="keyword">int</span> d = <span class="number">0</span>; d &lt;= b; d++)&#123;</span><br><span class="line">        <span class="keyword">int</span> dd = <span class="built_in">getdis</span>(i, n + <span class="number">1</span>); <span class="keyword">if</span>(d + dd &gt; b) <span class="keyword">break</span>;</span><br><span class="line">        ans = <span class="built_in">min</span>(ans, dis[i][d] + dd * c[<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">getdis</span>(n, n + <span class="number">1</span>) &lt;= b) ans = <span class="built_in">min</span>(ans, <span class="built_in">getdis</span>(n, n + <span class="number">1</span>) * c[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">if</span>(ans == <span class="number">0x3f3f3f3f</span>) ans = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// Fastin;  </span></span><br><span class="line">    <span class="built_in">clr</span>(head, <span class="number">-1</span>);</span><br><span class="line">    s.<span class="built_in">read</span>(); t.<span class="built_in">read</span>();</span><br><span class="line">    <span class="built_in">scnaf</span>(<span class="string">&quot;%d&quot;</span>, &amp;b);</span><br><span class="line">    <span class="built_in">scnaf</span>(<span class="string">&quot;%d&quot;</span>, c);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;type);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= type; i++) <span class="built_in">scnaf</span>(<span class="string">&quot;%d&quot;</span>, c + i);</span><br><span class="line">    <span class="built_in">scnaf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">        p[i].<span class="built_in">read</span>();</span><br><span class="line">        <span class="keyword">int</span> l; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;l);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; l; j++)&#123;</span><br><span class="line">            <span class="keyword">int</span> v, op; <span class="built_in">scnaf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;v, &amp;op);</span><br><span class="line">            <span class="built_in">add</span>(i, v, op); <span class="built_in">add</span>(v, i, op);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">fro</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; top; i++) <span class="built_in">update</span>(i);</span><br><span class="line">    p[n] = s; p[n + <span class="number">1</span>] = t;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">dij</span>());</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="J-å¡ç‰¹å…°æ•°è®¡æ•°é—®é¢˜"><a href="#J-å¡ç‰¹å…°æ•°è®¡æ•°é—®é¢˜" class="headerlink" title="J å¡ç‰¹å…°æ•°è®¡æ•°é—®é¢˜"></a>J å¡ç‰¹å…°æ•°è®¡æ•°é—®é¢˜</h3><p>ä¸­åºéå†ä¸€æ£µæ ‘ï¼Œç»™å‡ºå…¶æ·±åº¦åºåˆ—ï¼Œä¸”æ»¡è¶³æ ‘ä¸ŠæŸä¸ªèŠ‚ç‚¹çš„æ·±åº¦ä¸€å®šä¸ä½äºå…¶çˆ¶èŠ‚ç‚¹çš„æ·±åº¦ã€‚</p><p>å®¹æ˜“æƒ³åˆ°n^3çš„ç®—æ³•ï¼Œä½†å…¶å®è¿™ç§å½¢å¼æ˜¯å¡ç‰¹å…°æ•°çš„ä¸€ä¸ªè¡¨è¾¾å½¢å¼ï¼Œå³</p><p>$c_0c_{n-1} +c_1c_{n - 2} + c_2c_{n-3} +â€¦+c_{n-1}c_0=c_n$</p><p>$c_0 = c_1=1$</p><p>åœ¨å½“å‰åŒºé—´ä¸­ï¼Œå¦‚æœæœ€å°å€¼ä¸ºmï¼Œä¸”å…¶æ•°é‡ä¸ºkä¸ªï¼Œé‚£ä¹ˆè¿™äº›æœ€å°å€¼ä¸€å®šæ„æˆæ ‘çš„ä¸Šå±‚æ¡†æ¶ï¼Œå…¶ç§æ•°å°±æ˜¯c[k]ï¼›å¹¶ä¸”æ— è®ºä¸Šå±‚æ¡†æ¶çš„ç»“æ„å¦‚ä½•ï¼Œå¯¹äºé‚£äº›è¢«åˆ’åˆ†å¼€æ¥çš„æ›´æ·±çš„åŒºåŸŸï¼Œåªéœ€è¦é€’å½’åœ°æ±‚è§£å¹¶ä¸”ä¹˜ä¸Šå…¶ç§æ•°å³å¯ã€‚</p><p><del>è„‘è¡¥äº†ä¸€ä¸ªçº¿æ®µæ ‘çš„æ¯”è¾ƒè‰çš„nlognçš„ç®—æ³•ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰å®ç°å°±çœ‹åˆ°äº†ä¸€ä¸ªOnçš„å¤„ç†åŠæ³•</del></p><p>ç»´æŠ¤ä¸€ä¸ªå•è°ƒå¢çš„å•è°ƒæ ˆï¼Œæ ˆä¸­å…ƒç´ ä¸º&lt;æ•°å€¼å¤§å°ï¼Œå‡ºç°æ¬¡æ•°&gt;ã€‚æ¯æ¬¡å½“ä¸€ä¸ªè¾ƒå°çš„æ•°å­—è¿›å…¥åï¼Œå°±å°†é‚£äº›å¤ªé«˜çš„ç‚¹å¼¹æ ˆï¼Œä»–ä»¬çš„â€œè¾–åŸŸâ€å·²ç»è¢«åˆ‡æ–­ï¼Œæ ¹æ®å…¶ä¸ªæ•°å³å¯æ›´æ–°ç»“æœã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1000000007</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> inv[maxn];</span><br><span class="line"><span class="keyword">int</span> c[maxn];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NODE</span>&#123;</span><span class="keyword">int</span> num, times;&#125;;</span><br><span class="line">NODE node[maxn]; <span class="keyword">int</span> top = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(top == <span class="number">0</span>)&#123;</span><br><span class="line">        node[top].times = <span class="number">1</span>;</span><br><span class="line">        node[top].num = x;</span><br><span class="line">        top++;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">assert</span>(node[top - <span class="number">1</span>].num &lt;= x);</span><br><span class="line">    <span class="keyword">if</span>(node[top - <span class="number">1</span>].num &lt; x)&#123;</span><br><span class="line">        node[top].num = x;</span><br><span class="line">        node[top].times = <span class="number">1</span>;</span><br><span class="line">        top++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> node[top - <span class="number">1</span>].times++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// Fastin;  </span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; maxn; i++) inv[i] = (<span class="keyword">int</span>)<span class="built_in">qp</span>(i, M - <span class="number">2</span>, M);</span><br><span class="line">    c[<span class="number">0</span>] = <span class="number">1</span>; </span><br><span class="line">    <span class="built_in">fro</span>(itn i = <span class="number">0</span>; i &lt; <span class="number">1000005</span>; i++)&#123;</span><br><span class="line">        c[i + <span class="number">1</span>] = (<span class="keyword">int</span>)(<span class="number">1LL</span> * c[i] * (<span class="number">4</span> * i + <span class="number">2</span>) % M * inv[i + <span class="number">2</span>] % M);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    ll ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> n; <span class="built_in">scnaf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="built_in">fro</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> x; </span><br><span class="line">        <span class="keyword">if</span>(i != n) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x); <span class="keyword">else</span> x = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">if</span>(top == <span class="number">0</span> || node[top - <span class="number">1</span>].num &lt;= x) <span class="built_in">push</span>(x);</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">while</span>(top &amp;&amp; node[top - <span class="number">1</span>].num &gt; x)&#123;</span><br><span class="line">                ans *= c[node[top - <span class="number">1</span>].times]; </span><br><span class="line">                ans %= M;</span><br><span class="line">                top--;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">push</span>(x);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="H-åˆ†æ®µæ‰“è¡¨"><a href="#H-åˆ†æ®µæ‰“è¡¨" class="headerlink" title="H åˆ†æ®µæ‰“è¡¨"></a>H åˆ†æ®µæ‰“è¡¨</h3><p>åœºä¸ŠæŒ‰é“ç†åº”è¯¥æ˜¯åŠæ¨åŠå°±<del>å®åˆ™è§‚çœ‹é¢˜è§£</del>å³å¯å‘ç°Såºåˆ—å…·æœ‰å‘¨æœŸæ€§ã€‚</p><p>æœ¬æ¥æ‰“ç®—ç”¨hashæ‰¾å‡ºå¾ªç¯åœ°å‘¨æœŸå’Œèµ·ç‚¹ï¼Œç„¶è€Œåœ¨1e8ä¸‹ç›´æ¥æ…¢åˆ°çˆ†ç‚¸ã€‚</p><p>ä½¿ç”¨äº†IGVAæ•™çš„åºåˆ—å¿«æ…¢æŒ‡é’ˆæ³•å³å¯Onåœ°æ‰¾å‡ºå¾ªç¯èŠ‚çš„ä¿¡æ¯ã€‚</p><p>èµ·ç‚¹å’Œå¾ªç¯å‘¨é¢˜éƒ½åœ¨1e8çš„çº§åˆ«ï¼Œè€ƒè™‘åˆ†æ®µæ‰“è¡¨ã€‚</p><p>ä»¤$n = p*m + r$, mæ˜¯è‡ªå·±é€‰å®šçš„ä¸€ä¸ªæ¨¡æ•°ã€‚åªå°†æ•´é™¤äºmçš„ä¸‹æ ‡å¯¹åº”æ•°çš„ç›¸å…³ä¿¡æ¯è¿›è¡Œå­˜å‚¨ï¼ŒæŸ¥è¯¢æ—¶å³å¯O(r)åœ°æŸ¥è¯¢ã€‚</p><p>ç„¶è€Œä¸€ç›´TLEï¼Œæ‰æƒŠè§‰nå¯ä»¥ç­‰äº0â€¦..?   <del>orz</del></p><p>æ”¹äº†ä¹‹åé£å¿«è¿‡å»äº†</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> ll M = <span class="number">1ll</span> &lt;&lt; <span class="number">40</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">fun</span><span class="params">(ll x)</span></span>&#123;</span><br><span class="line">    ll ans = (x + (x &gt;&gt; <span class="number">20</span>) + <span class="number">12345</span>) % M;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mm = <span class="number">5e5</span>;</span><br><span class="line">ll a[<span class="number">10000</span>] = &#123;&#125;;</span><br><span class="line">ll b[<span class="number">10000</span>] = &#123;&#125;;</span><br><span class="line">ll cnta[<span class="number">10000</span>] = &#123;&#125;;</span><br><span class="line">ll cntb[<span class="number">10000</span>] = &#123;&#125;;</span><br><span class="line">ll cnt0 = <span class="number">91029304</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// Fastin;</span></span><br><span class="line">    <span class="comment">// Fastout; </span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// int n = 1e9;</span></span><br><span class="line">    <span class="comment">// int p = 0, q = 1;</span></span><br><span class="line">    <span class="comment">// ll r1 = 0x600dcafe, r2 = fun(r1);</span></span><br><span class="line">    <span class="comment">// while(p &lt;= n &amp;&amp; q &lt;= n &amp;&amp; r1 != r2)&#123;</span></span><br><span class="line">    <span class="comment">//     p++; q += 2;</span></span><br><span class="line">    <span class="comment">//     r1 = fun(r1);</span></span><br><span class="line">    <span class="comment">//     r2 = fun(fun(r2));</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="comment">// if(p &gt; n || q &gt; n) puts(&quot;orz&quot;);</span></span><br><span class="line">    <span class="comment">// else printf(&quot;%d %d: %lld\n&quot;, p, q, r1);</span></span><br><span class="line">    <span class="comment">//364258417 728516835: 1613948613</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="comment">// int cnt = 1;</span></span><br><span class="line">    <span class="comment">// ll res = fun(1613948613);</span></span><br><span class="line">    <span class="comment">// while(res != 1613948613)&#123;</span></span><br><span class="line">    <span class="comment">//     cnt++;</span></span><br><span class="line">    <span class="comment">//     res = fun(res);</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="comment">// printf(&quot;%lld\n&quot;, cnt);</span></span><br><span class="line">    <span class="comment">//T: 182129209</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ll period = 182129209;</span></span><br><span class="line">    <span class="comment">// ll start = 364258417 - period;</span></span><br><span class="line">    <span class="comment">// ll r1 = 0x600dcafe;</span></span><br><span class="line">    <span class="comment">// while(start--) r1 = fun(r1);</span></span><br><span class="line">    <span class="comment">// start = 364258417 - period;</span></span><br><span class="line">    <span class="comment">// ll r2 = 1613948613, end = 364258417;</span></span><br><span class="line">    <span class="comment">// while(r1 != r2)&#123;</span></span><br><span class="line">    <span class="comment">//     start++; end++;</span></span><br><span class="line">    <span class="comment">//     r1 = fun(r1); r2 = fun(r2);</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="comment">// printf(&quot;%d %d: %lld\n&quot;, start, end, r1);</span></span><br><span class="line">    <span class="comment">//350125310 532254519: 516914</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    ll start = <span class="number">350125310</span>, period = <span class="number">182129209</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ll p = 0, s = 0x600dcafe, cnt = 0;</span></span><br><span class="line">    <span class="comment">// while(p &lt; start)&#123;</span></span><br><span class="line">    <span class="comment">//     cnt += s % 2 == 0;</span></span><br><span class="line">    <span class="comment">//     if(p % mm == 0)&#123;</span></span><br><span class="line">    <span class="comment">//         a[p / mm] = s;</span></span><br><span class="line">    <span class="comment">//         cnta[p / mm] = cnt;</span></span><br><span class="line">    <span class="comment">//     &#125;</span></span><br><span class="line">         </span><br><span class="line">    <span class="comment">//      s = fun(s); p++;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="comment">// ll cnt0 = 0;</span></span><br><span class="line">    <span class="comment">// p -= start;</span></span><br><span class="line">    <span class="comment">// while(p &lt; period)&#123;</span></span><br><span class="line">    <span class="comment">//     cnt += s % 2 == 0;</span></span><br><span class="line">    <span class="comment">//     cnt0 += s % 2 == 0;</span></span><br><span class="line">    <span class="comment">//     if(p % mm == 0)&#123;</span></span><br><span class="line">    <span class="comment">//         b[p / mm] = s;</span></span><br><span class="line">    <span class="comment">//         cntb[p / mm] = cnt;</span></span><br><span class="line">    <span class="comment">//     &#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//     s = fun(s); p++;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="comment">// // printf(&quot;%lld\n&quot;, cnt0);</span></span><br><span class="line">    <span class="comment">// for(int i = 0; i &lt; 10000; i++) printf(&quot;%lld, &quot;, a[i]); </span></span><br><span class="line">    <span class="comment">// printf(&quot;\n&quot;);</span></span><br><span class="line">    <span class="comment">// for(int i = 0; i &lt; 10000; i++) printf(&quot;%lld, &quot;, b[i]);</span></span><br><span class="line">    <span class="comment">// printf(&quot;\n&quot;);</span></span><br><span class="line">    <span class="comment">// for(int i = 0; i &lt; 10000; i++) printf(&quot;%lld, &quot;, cnta[i]); </span></span><br><span class="line">    <span class="comment">// printf(&quot;\n&quot;);</span></span><br><span class="line">    <span class="comment">// for(int i = 0; i &lt; 10000; i++) printf(&quot;%lld, &quot;, cntb[i]);</span></span><br><span class="line">    <span class="comment">// printf(&quot;\n&quot;);</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    ll n; <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;n); </span><br><span class="line">    <span class="keyword">if</span>(n == <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;0&quot;</span>); <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    n--;</span><br><span class="line">    <span class="keyword">if</span>(n &lt; start)&#123;</span><br><span class="line">        ll res = a[n / mm];</span><br><span class="line">        ll ans = cnta[n / mm];</span><br><span class="line">        n %= mm;</span><br><span class="line">        <span class="keyword">while</span>(n--)&#123;</span><br><span class="line">            res = <span class="built_in">fun</span>(res);</span><br><span class="line">            ans += res % <span class="number">2</span> == <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        n -= start;</span><br><span class="line">        ll p = n / period;</span><br><span class="line">        n %= period;</span><br><span class="line">        ll res = b[n / mm];</span><br><span class="line">        ll ans = cntb[n / mm] + p * cnt0;</span><br><span class="line">        n %= mm;</span><br><span class="line">        <span class="keyword">while</span>(n--)&#123;</span><br><span class="line">            res = <span class="built_in">fun</span>(res);</span><br><span class="line">            ans += res % <span class="number">2</span> == <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="L-æš´åŠ›-amp-normal-game"><a href="#L-æš´åŠ›-amp-normal-game" class="headerlink" title="L æš´åŠ› &amp; normal game"></a>L æš´åŠ› &amp; normal game</h3><p>ä¸ºäº†è¡¥è¿™é¢˜é‡æ–°ä»æºå¤´ä¸Šå­¦ä¹ äº†ä¸€ç•ªSGå®šç†ç›¸å…³ï¼Œå¹¶èŠ±è´¹äº†è¾ƒå¤šçš„æ—¶é—´å­¦ä¹ misere gameçš„è§£æ³•ï¼Ÿä½†æ˜¯å¥½åƒæ”¶æ•ˆé¢‡å¾®ï¼Œä¸å¦‚ä»¥é¢˜ä»£å­¦ï¼Œæœ€è¿‘æ‰“ç®—å¼€å‡ å¥—åšå¼ˆè®ºä¸“é¢˜ä½œä¸ºè®­ç»ƒï¼Œä»¥ä¾¿äºåˆ‡å®åœ°æŒæ¡å„ç§normal playçš„ä¸€èˆ¬è§£æ³•ï¼Œå¹¶å°è¯•å­¦ä¹ misere gameçš„ç›¸å…³çŸ¥è¯†ã€‚</p><p>åœ¨æœ¬é¢˜ä¸­ï¼Œé¢˜ç›®ä¿è¯ä¸¤å—æ¹¿åœ°é—´è·ä¸å°äº3ï¼Œé‚£ä¹ˆå¯ä»¥å•ç‹¬åœ°å¤„ç†æ¯ä¸€å—ï¼›è€Œåœ¨æ¯ä¸€å—ä¸­ï¼Œåªæœ‰é‚£äº›è¿ç»­çš„ç©ºåœ°æ‰éœ€è¦è¢«åˆ’åˆ†ä¸ºä¸€ä¸ªå•ç‹¬çš„normal playï¼Œ<del>ä¸ç„¶å¯é€‰çŠ¶æ€è¿‡å¤šï¼Œä¼šTLE/MLE åçŸ¥åè§‰çš„æˆ‘é”™äº†10å‘æ‰æ„è¯†åˆ°è¿™ä¸ªé—®é¢˜</del>ï¼Œè¿™æ ·æ•´ä¸ªé—®é¢˜å°±è¢«åˆ’åˆ†æˆäº†è‹¥å¹²ä¸ªnormal playçš„ç»„åˆï¼Œå¼‚æˆ–ä¸Šå…¶sgå€¼å³å¾—åˆ°æ¯æ¸¸æˆçš„sgå€¼ã€‚å…·ä½“åˆ°å¯¹æŸä¸€ä¸ªå­æ¸¸æˆæ±‚è§£æ—¶ï¼Œè®°å¿†åŒ–æœç´¢å³å¯ï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆæŠ€æœ¯éš¾åº¦ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">15</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">char</span> s[maxn][maxn];</span><br><span class="line"><span class="keyword">int</span> vis[maxn][maxn];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> dx[<span class="number">4</span>] = &#123;<span class="number">1</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> dy[<span class="number">4</span>] = &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">-1</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">in</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x &gt;= <span class="number">1</span> &amp;&amp; y &gt;= <span class="number">1</span> &amp;&amp; x &lt;= n &amp;&amp; y &lt;= n &amp;&amp; s[x][y] != <span class="string">&#x27;x&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¿è¯è¿›å…¥vecçš„ç©ºåœ°åªæœ‰ä¸€æ¬¡</span></span><br><span class="line">vector&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt; vec, now;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> nx = x + dx[i], ny = y + dy[i];</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">in</span>(nx, ny) &amp;&amp; !vis[nx][ny])&#123;</span><br><span class="line">            <span class="keyword">if</span>(s[nx][ny] == <span class="string">&#x27;.&#x27;</span>)&#123;</span><br><span class="line">                vis[nx][ny] = <span class="number">2</span>;</span><br><span class="line">                vec.<span class="built_in">push_back</span>(&#123;nx, ny&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                vis[nx][ny] = <span class="number">1</span>;</span><br><span class="line">                <span class="built_in">dfs</span>(nx, ny);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> top;</span><br><span class="line">unordered_map&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; sg;</span><br><span class="line"><span class="keyword">int</span> tong[<span class="number">100</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sove</span><span class="params">(<span class="keyword">int</span> sts, vector&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt; &amp;vec)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(sg[sts] != <span class="number">-1</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; top; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(sts &amp; <span class="number">1</span> &lt;&lt; i) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span>(sg[sts | <span class="number">1</span> &lt;&lt; i] == <span class="number">-1</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> fail = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; top; j++) <span class="keyword">if</span>(sts &amp; <span class="number">1ll</span> &lt;&lt; j)&#123;</span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">abs</span>(vec[i].first - vec[j].first) + <span class="built_in">abs</span>(vec[i].second - vec[j].second) &lt;= <span class="number">1</span>)&#123;fail = <span class="number">1</span>; <span class="keyword">break</span>;&#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(fail) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="built_in">sove</span>(sts | <span class="number">1</span> &lt;&lt; i, vec);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= top; i++) tong[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; top; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(sts &amp; <span class="number">1</span> &lt;&lt; i) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span>(sg[sts | <span class="number">1</span> &lt;&lt; i] != <span class="number">-1</span>) tong[sg[sts | <span class="number">1</span> &lt;&lt; i]] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> l; <span class="keyword">for</span>(l = <span class="number">0</span>; l &lt; top; l++) <span class="keyword">if</span>(tong[l] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">    sg[sts] = l;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">split</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    vis[x][y] = <span class="number">1</span>; now.<span class="built_in">push_back</span>(&#123;x, y&#125;);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> nx = x + dx[i], ny = y + dy[i];</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">in</span>(nx, ny) &amp;&amp; vis[nx][ny] == <span class="number">2</span>) <span class="built_in">split</span>(nx, ny);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// Fastin;</span></span><br><span class="line">    <span class="built_in">scnaf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n); <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scnaf</span>(<span class="string">&quot;%s&quot;</span>, s[i] + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">fro</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++) <span class="keyword">if</span>(s[i][j] == <span class="string">&#x27;*&#x27;</span> &amp;&amp; !vis[i][j])&#123;</span><br><span class="line">        vec.<span class="built_in">clear</span>();</span><br><span class="line">        <span class="built_in">dfs</span>(i, j); <span class="keyword">int</span> N = (<span class="keyword">int</span>)vec.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) <span class="keyword">if</span>(vis[vec[i].first][vec[i].second] == <span class="number">2</span>)&#123;</span><br><span class="line">            now.<span class="built_in">clear</span>();</span><br><span class="line">            <span class="built_in">split</span>(vec[i].first, vec[i].second);</span><br><span class="line">            top = (<span class="keyword">int</span>)now.<span class="built_in">size</span>();</span><br><span class="line">            <span class="keyword">for</span>(itn i = <span class="number">0</span>; i &lt; <span class="number">1</span> &lt;&lt; top; i++) sg[i] = <span class="number">-1</span>;</span><br><span class="line">            <span class="built_in">sove</span>(<span class="number">0</span>, now); ans ^= sg[<span class="number">0</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(ans? <span class="string">&quot;First player will win&quot;</span>: <span class="string">&quot;Second player will win&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æœ€çŸ­è·¯ </tag>
            
            <tag> å¡ç‰¹å…°æ•° </tag>
            
            <tag> åˆ†æ®µæ‰“è¡¨ </tag>
            
            <tag> åšå¼ˆè®º </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019-icpc-taipei</title>
      <link href="/2020/10/04/2019-icpc-taipei/"/>
      <url>/2020/10/04/2019-icpc-taipei/</url>
      
        <content type="html"><![CDATA[<p>[toc]</p><span id="more"></span><h2 id="I-å·²çŸ¥ä¸¤æ•°å·®ï¼Œæ±‚æ‰€æœ‰å¯èƒ½çš„åŸæœ¬çš„åºåˆ—"><a href="#I-å·²çŸ¥ä¸¤æ•°å·®ï¼Œæ±‚æ‰€æœ‰å¯èƒ½çš„åŸæœ¬çš„åºåˆ—" class="headerlink" title="I å·²çŸ¥ä¸¤æ•°å·®ï¼Œæ±‚æ‰€æœ‰å¯èƒ½çš„åŸæœ¬çš„åºåˆ—"></a>I å·²çŸ¥ä¸¤æ•°å·®ï¼Œæ±‚æ‰€æœ‰å¯èƒ½çš„åŸæœ¬çš„åºåˆ—</h2><p>åŸåºåˆ—é•¿åº¦å°äºç­‰äº62ï¼Œåºåˆ—å€¼å°äº1000ä¸”ä¸¤ä¸¤ä¸åŒã€‚</p><p>å¦‚æœå·²ç»è¿˜åŸå‡ºäº†åŸåºåˆ—ä¸­çš„$i$ä¸ªå€¼ï¼Œé‚£ä¹ˆé™¤å»è¿™iä¸ªå€¼ä¸¤ä¸¤çš„å·®ä¹‹åï¼Œå·®å€¼é›†åˆä¸­æœ€å¤§çš„æ•°ä¾¿å¯ä»¥åŸºæœ¬ç¡®å®šä¸‹æ¥ï¼šè¿™ä¸ªæ•°ä¸€å®šæ˜¯åŸåºåˆ—ä¸­çš„æŸä¸ªæ•°ä¸a[1] = 0æˆ–è€…a[n]ä½œå·®å¾—åˆ°çš„ï¼Œè¿™ç‚¹ç”±â€œæœ€å¤§â€ä¿è¯ã€‚</p><p>é‚£ä¹ˆæ£€æŸ¥è¿™ä¸ªæœ€å¤§çš„æ•°å‡ºç°çš„æ¬¡æ•°ï¼Œå¦‚æœæ¬¡æ•°è¶…è¿‡2ï¼Œåˆ™ä¸æ»¡è¶³ä¸¤ä¸¤ä¸åŒçš„è¦æ±‚ï¼›å¦‚æœæ¬¡æ•°ä¸º2ï¼Œç›´æ¥æ ¹æ®a[1], a[n]å¯ä»¥æ›´æ–°ä¸¤ä¸ªå€¼è¿›è¡ŒåŸåºåˆ—ï¼›å¦‚æœæ¬¡æ•°ä»…ä¸º1ï¼Œåˆ™éœ€è¦åˆ†åˆ«é€’å½’è€ƒè™‘ä¸€ç•ªã€‚</p><p>æ¯æ¬¡æ’å…¥ä¸€ä¸ªæ–°å€¼çš„æ—¶å€™è¦è¿›è¡Œè‹¥å¹²åˆ¤æ–­ </p><p><del>å¯èƒ½å› æ­¤æ¡ä»¶è¾ƒä¸ºä¸¥è‹›ï¼Ÿå¯¼è‡´æ¬¡æ•°ä»…ä¸º1çš„2^né€’å½’ä¹Ÿåœ¨å¯ä»¥æ¥å—çš„èŒƒå›´ä¹‹å†…ï¼›å…·ä½“æ¬¡æ•°è¯æ˜å¹¶æ²¡æœ‰å¤ªæƒ³å¾—åˆ°</del></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">5e3</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, a[maxn], M;</span><br><span class="line">multiset&lt;<span class="keyword">int</span>, greater&lt;<span class="keyword">int</span>&gt;&gt; s, temp;</span><br><span class="line">multiset&lt;<span class="keyword">int</span>, greater&lt;<span class="keyword">int</span>&gt;&gt;::iterator it;</span><br><span class="line"></span><br><span class="line">set&lt;<span class="keyword">int</span>&gt; res;</span><br><span class="line">vector&lt;set&lt;<span class="keyword">int</span>&gt;&gt; ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sove</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//ä»sé›†åˆä¸­æŒ‘é€‰ä¸€ä¸ªè¿›è¡Œå°è¯•æ„é€ </span></span><br><span class="line">    <span class="keyword">if</span>(s.<span class="built_in">empty</span>())&#123;ans.<span class="built_in">push_back</span>(res); <span class="keyword">return</span>;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> now = *s.<span class="built_in">begin</span>(); <span class="keyword">int</span> cnt = (<span class="keyword">int</span>)s.<span class="built_in">count</span>(now);</span><br><span class="line">    <span class="keyword">if</span>(cnt &gt; <span class="number">2</span>) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(cnt == <span class="number">2</span>)&#123;</span><br><span class="line">        <span class="keyword">int</span> x = now, y = M - now;</span><br><span class="line">        <span class="comment">//ä¿è¯ä¸¤ä¸¤ä¸åŒ</span></span><br><span class="line">        <span class="keyword">if</span>(res.<span class="built_in">find</span>(x) != res.<span class="built_in">end</span>() || res.<span class="built_in">find</span>(y) != res.<span class="built_in">end</span>()) <span class="keyword">return</span>;</span><br><span class="line">        </span><br><span class="line">        temp = s; <span class="keyword">int</span> fail = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">//éå†é‚£äº›å·²ç»ç¡®å®šå¥½çš„å€¼</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> pre: res)&#123;</span><br><span class="line">            it = temp.<span class="built_in">find</span>(<span class="built_in">abs</span>(pre - x));</span><br><span class="line">            <span class="keyword">if</span>(it == temp.<span class="built_in">end</span>())&#123;fail = <span class="number">1</span>; <span class="keyword">break</span>;&#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;temp.<span class="built_in">erase</span>(it);&#125;</span><br><span class="line"></span><br><span class="line">            it = temp.<span class="built_in">find</span>(<span class="built_in">abs</span>(pre - y));</span><br><span class="line">            <span class="keyword">if</span>(it == temp.<span class="built_in">end</span>())&#123;fail = <span class="number">1</span>; <span class="keyword">break</span>;&#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;temp.<span class="built_in">erase</span>(it);&#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(fail) <span class="keyword">return</span> ;</span><br><span class="line">        it = temp.<span class="built_in">find</span>(<span class="built_in">abs</span>(x - y));</span><br><span class="line">        <span class="keyword">if</span>(it == temp.<span class="built_in">end</span>()) <span class="keyword">return</span> ;</span><br><span class="line">        temp.<span class="built_in">erase</span>(it); </span><br><span class="line"></span><br><span class="line">        s = temp; res.<span class="built_in">insert</span>(x); res.<span class="built_in">insert</span>(y);</span><br><span class="line">        <span class="built_in">sove</span>(); res.<span class="built_in">erase</span>(x); res.<span class="built_in">erase</span>(y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">//ä¸ªæ•°ä¸º1</span></span><br><span class="line">        multiset&lt;<span class="keyword">int</span>, greater&lt;<span class="keyword">int</span>&gt;&gt; s0 = s;</span><br><span class="line">        <span class="keyword">int</span> x = now;</span><br><span class="line">        <span class="keyword">if</span>(res.<span class="built_in">find</span>(x) == res.<span class="built_in">end</span>())&#123;</span><br><span class="line">            <span class="keyword">int</span> fail = <span class="number">0</span>; temp = s0;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">auto</span> pre: res)&#123;</span><br><span class="line">                it = temp.<span class="built_in">find</span>(<span class="built_in">abs</span>(x - pre));</span><br><span class="line">                <span class="keyword">if</span>(it == temp.<span class="built_in">end</span>())&#123;fail = <span class="number">1</span>; <span class="keyword">break</span>;&#125;</span><br><span class="line">                <span class="keyword">else</span> temp.<span class="built_in">erase</span>(it);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(!fail)&#123;</span><br><span class="line">                res.<span class="built_in">insert</span>(x); s = temp; <span class="built_in">sove</span>();</span><br><span class="line">                res.<span class="built_in">erase</span>(x);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        x = M - now;</span><br><span class="line">        <span class="keyword">if</span>(res.<span class="built_in">find</span>(x) == res.<span class="built_in">end</span>())&#123;</span><br><span class="line">            <span class="keyword">int</span> fail = <span class="number">0</span>; temp = s0;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">auto</span> pre: res)&#123;</span><br><span class="line">                it = temp.<span class="built_in">find</span>(<span class="built_in">abs</span>(x - pre));</span><br><span class="line">                <span class="keyword">if</span>(it == temp.<span class="built_in">end</span>())&#123;fail = <span class="number">1</span>; <span class="keyword">break</span>;&#125;</span><br><span class="line">                <span class="keyword">else</span> temp.<span class="built_in">erase</span>(it);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(!fail)&#123;</span><br><span class="line">                res.<span class="built_in">insert</span>(x); s = temp; <span class="built_in">sove</span>();</span><br><span class="line">                res.<span class="built_in">erase</span>(x);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// Fastin;</span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n); <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n * (n - <span class="number">1</span>) / <span class="number">2</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> x; <span class="built_in">scnaf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x); s.<span class="built_in">insert</span>(x);</span><br><span class="line">        <span class="keyword">if</span>(x &gt; <span class="number">999</span>)&#123; <span class="built_in">puts</span>(<span class="string">&quot;0&quot;</span>); <span class="keyword">return</span> <span class="number">0</span>;&#125;</span><br><span class="line">        M = <span class="built_in">max</span>(M, x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>((<span class="keyword">int</span>)s.<span class="built_in">count</span>(M) &gt; <span class="number">1</span>)&#123; <span class="built_in">puts</span>(<span class="string">&quot;0&quot;</span>); <span class="keyword">return</span> <span class="number">0</span>;&#125;</span><br><span class="line"></span><br><span class="line">    a[n] = M; s.<span class="built_in">erase</span>(a[n]); res.<span class="built_in">insert</span>(<span class="number">0</span>); res.<span class="built_in">insert</span>(M);</span><br><span class="line">    <span class="built_in">sove</span>();</span><br><span class="line">    <span class="keyword">int</span> top = (<span class="keyword">int</span>)(<span class="built_in">unique</span>(ans.<span class="built_in">begin</span>(), ans.<span class="built_in">end</span>()) - ans.<span class="built_in">begin</span>());</span><br><span class="line">    <span class="built_in">sort</span>(ans.<span class="built_in">begin</span>(), ans.<span class="built_in">begin</span>() + top);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, top);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; top; i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> x: ans[i]) <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, x);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="luogu-ä¸¤æ•°å’Œ"><a href="#luogu-ä¸¤æ•°å’Œ" class="headerlink" title="luogu ä¸¤æ•°å’Œ"></a>luogu ä¸¤æ•°å’Œ</h3><p>ç»™å‡ºä¸¤æ•°å’Œï¼Œé—®æ˜¯å¦å­˜åœ¨ä¸€ä¸ªå¯è¡ŒåŸåºåˆ—ã€‚</p><p>åŸåºåˆ—é•¿åº¦ä¸è¶…è¿‡10.</p><p>å°†ä¸¤æ•°å’Œçš„é›†åˆä»å°åˆ°å¤§å¼€å§‹è€ƒè™‘ï¼Œé€šè¿‡æœ€å°çš„å’Œæ•°å¯ä»¥æšä¸¾å‡ºa[1], a[2]çš„å€¼ï¼Œæ¥ä¸‹æ¥åœ¨é›†åˆä¸­åˆ é™¤è¿™äº›å€¼ï¼Œå‰©ä¸‹çš„å…ƒç´ ä¸­æœ€å°å€¼å¿…ç„¶å°±æ˜¯a[1]+a[3]ï¼Œæ®æ­¤å¯ä»¥å¾—åˆ°a[3]çš„å€¼ï¼Œé‡å¤æ“ä½œå³å¯ä¸æ–­å‘åæ„é€ ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">multiset&lt;<span class="keyword">int</span>&gt; s0, s;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> a[<span class="number">20</span>];</span><br><span class="line">multiset&lt;<span class="keyword">int</span>&gt;::iterator it;</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; vec;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">     Fastin;</span><br><span class="line">    <span class="keyword">int</span> n; </span><br><span class="line">    <span class="keyword">while</span>(~<span class="built_in">scnaf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n))&#123;</span><br><span class="line">        s0.<span class="built_in">clear</span>();</span><br><span class="line">        <span class="built_in">fro</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n * (n - <span class="number">1</span>) / <span class="number">2</span>; i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> x; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x); s0.<span class="built_in">insert</span>(x);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">int</span> ok = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(a[<span class="number">1</span>] = <span class="number">0</span>; a[<span class="number">1</span>] &lt;= *s0.<span class="built_in">begin</span>() - a[<span class="number">1</span>]; a[<span class="number">1</span>]++)&#123;</span><br><span class="line">            <span class="keyword">int</span> fail = <span class="number">0</span>;</span><br><span class="line">            s = s0;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++)&#123;</span><br><span class="line">                a[i] = *s.<span class="built_in">begin</span>() - a[<span class="number">1</span>];</span><br><span class="line">                <span class="keyword">if</span>(a[i] &lt; <span class="number">0</span> || a[i] &lt; a[i - <span class="number">1</span>])&#123;fail = <span class="number">1</span>; <span class="keyword">break</span>;&#125;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; i; j++)&#123;</span><br><span class="line">                    it = s.<span class="built_in">find</span>(a[j] + a[i]);</span><br><span class="line">                    <span class="keyword">if</span>(it == s.<span class="built_in">end</span>())&#123;fail = <span class="number">1</span>; <span class="keyword">break</span>;&#125;</span><br><span class="line">                    s.<span class="built_in">erase</span>(it);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(fail) <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(!fail)&#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">printf</span>(<span class="string">&quot;%d%c&quot;</span>, a[i], <span class="string">&quot; \n&quot;</span>[i == n]);</span><br><span class="line">                ok = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(!ok) <span class="built_in">puts</span>(<span class="string">&quot;Impossible&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ„é€  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScript</title>
      <link href="/2020/09/18/JavaScript%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
      <url>/2020/09/18/JavaScript%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<p>[toc]</p><span id="more"></span><h1 id="åŸºæœ¬è¯­æ³•"><a href="#åŸºæœ¬è¯­æ³•" class="headerlink" title="åŸºæœ¬è¯­æ³•"></a>åŸºæœ¬è¯­æ³•</h1><h2 id="æ•°æ®å˜é‡ä¸ç±»å‹"><a href="#æ•°æ®å˜é‡ä¸ç±»å‹" class="headerlink" title="æ•°æ®å˜é‡ä¸ç±»å‹"></a>æ•°æ®å˜é‡ä¸ç±»å‹</h2><p>JSä¸­æ•´æ•°å’Œæµ®ç‚¹æ•°ç»Ÿä¸€å¯¹å¾…ï¼Œç”šè‡³å¯ä»¥å¯¹æµ®ç‚¹æ•°åš<code>%</code>è¿ç®—ï¼Œä½†æ˜¯æ•´æ•°æ•°å€¼çš„èŒƒå›´æ˜¯<code>[-2^53, 2^53]</code><del>éå¸¸ç¥ç§˜</del></p><p>è¡¨è¾¾ä¸€ä¸ªå­—ç¬¦ä¸²æ—¢å¯ä»¥ç”¨<code>&#39;</code>ä¹Ÿå¯ä»¥ç”¨<code>&quot;</code>ã€‚</p><p>JSæœ‰ç¼ºé™·çš„ä¸€ç‚¹åœ¨äºï¼Œä½¿ç”¨ç›¸ç­‰è¿ç®—ç¬¦<code>==</code>æ—¶ï¼Œå¯ä»¥å¯¹ä¸åŒç±»å‹çš„å…ƒç´ è¿›è¡Œæ¯”è¾ƒï¼Œè¿™å¾€å¾€ä¼šå¯¼è‡´å¥‡æ€ªçš„ç»“æœï¼›ä¸ºæ­¤ï¼Œå»ºè®®æ€»æ˜¯ä½¿ç”¨<code>===</code>è¿™ä¸€ç›¸ç­‰è¿ç®—ç¬¦ï¼Œè¯¥è¿ç®—ç¬¦ä¼šå…ˆæ¯”è¾ƒç±»å‹æ˜¯å¦ç›¸åŒï¼Œä¸åŒåˆ™è¿”å›<code>false</code>ï¼Œç›¸åŒå†æ¯”è¾ƒå˜é‡æ˜¯å¦ç›¸åŒã€‚</p><p>æµ®ç‚¹æ•°çš„ç›¸ç­‰æ¯”è¾ƒä¾ç„¶è¦è®¾ç½®<code>eps</code>ï¼Œ<del>è€Œä¸”æˆ‘æ€€ç–‘jsä¸­çš„ç²¾åº¦å¯èƒ½æ¯”doubleåƒåœ¾å¾ˆå¤š</del></p><p>jsä¸­<code>null</code>è¡¨ç¤ºä¸€ä¸ªâ€œç©ºâ€çš„å€¼ï¼Œè¿™å’ŒCä¸­nullè¡¨ç¤º0ä¸åŒã€‚</p><p>å»ºè®®é€šè¿‡<code>[]</code>æ¥åˆ›å»ºä¸€ä¸ªæ•°ç»„ï¼Œä¸‹æ ‡ä¸€æ ·ä»0å¼€å§‹ã€‚</p><p>å¯¹è±¡çš„å®šä¹‰æ–¹å¼ä¸C++ç±»ä¼¼ã€‚</p><p>å˜é‡é€šè¿‡<code>var</code>æ¥å£°æ˜ï¼Œå› å…¶ç±»å‹ä¸å›ºå®šï¼Œå› è€Œè¿™ç§è¯­è¨€ç§°ä¸º<code>åŠ¨æ€è¯­è¨€</code></p><p>ä¸ºäº†æ˜¾ç¤ºå˜é‡çš„å€¼ï¼Œå¯ä»¥ä½¿ç”¨è¯­å¥<code>console.log(variable)</code></p><p>å¦‚æœæ²¡æœ‰ä½¿ç”¨<code>`var</code>æ¥å£°æ˜ä¸€ä¸ªå˜é‡ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šæˆä¸ºä¸€ä¸ªå…¨å±€å˜é‡ã€‚å¯ä»¥é€šè¿‡<code>&#39;use strict&#39;</code>æ¥å¼ºåˆ¶åŠ ä¸Š<code>var</code>å…³é”®å­—ã€‚</p><h2 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²"></a>å­—ç¬¦ä¸²</h2><p>å¯ä»¥é€šè¿‡<code>&#39;\x41&#39;</code>åå…­è¿›åˆ¶åœ°è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œé€šè¿‡<code>\u4e2d</code>è¡¨ç¤ºä¸€ä¸ªunicodeå­—ç¬¦ã€‚</p><p>åœ¨è¾“å…¥å¤šè¡Œå­—ç¬¦ä¸²çš„æ—¶å€™ä¸ºäº†é¿å…è¾ƒå¤š<code>&#39;\n&#39;</code>å¸¦æ¥çš„éº»çƒ¦ï¼Œå¯ä»¥ä½¿ç”¨<code>` </code>æ¥è¡¨ç¤ºå¤šè¡Œå­—ç¬¦ä¸²ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">`å¤š</span></span><br><span class="line"><span class="string">è¡Œ</span></span><br><span class="line"><span class="string">å­—ç¬¦ä¸²`</span>;</span><br></pre></td></tr></table></figure><p>ä¼—æ‰€å‘¨çŸ¥C++å¯ä»¥ä½¿ç”¨<code>+</code>æ¥è¿æ¥è‹¥å¹²ä¸ªstringï¼Œjsæ›´è¿›ä¸€æ­¥å¯ä»¥ä½¿ç”¨<code>æ¨¡ç‰ˆå­—ç¬¦ä¸²</code>æ¥è¿æ¥å­—ç¬¦ä¸²ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="string">&#x27;rqdmap&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> age = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">var</span> mes = <span class="string">`Hello <span class="subst">$&#123;name&#125;</span>, you are <span class="subst">$&#123;age&#125;</span> years old`</span>;</span><br><span class="line"><span class="built_in">console</span>.log(mes);</span><br></pre></td></tr></table></figure><p>å¿…é¡»ä½¿ç”¨<code>` </code>ï¼Œä½¿ç”¨<code>&#39;</code>å’Œ<code>&quot;</code>å‡æ— æ³•æˆåŠŸæ˜¾ç¤ºå­—ç¬¦ä¸²çš„åŸæœ¬ä¿¡æ¯ã€‚</p><p>é€šè¿‡<code>s.length</code>æ¥è·å¾—å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚</p><p>é€šè¿‡ä¸‹æ ‡å¯ä»¥è¿›è¡Œéšæœºè®¿é—®å­—ç¬¦ä¸²çš„ä»»æ„ä½ç½®ï¼Œä½†éœ€è¦æ³¨æ„<strong>è¶Šç•Œè®¿é—®ä¸ä¼šæŠ¥é”™ï¼Œåªä¼šè¿”å›undefined</strong></p><p>jsä¸­çš„å­—ç¬¦ä¸²æ˜¯ä¸å¯é€šè¿‡ç´¢å¼•å€¼è¿›è¡Œæ”¹å˜çš„ <del>å¤§æ¦‚æ˜¯å› ä¸ºC++ç›´æ¥æ“ä½œåœ°å€è€Œè¿™é‡Œä¸çŸ¥é“å®ç°äº†ä»€ä¹ˆåˆ«çš„ç»“æ„</del></p><p>ä½†æ˜¯å¯ä»¥é€šè¿‡å†æ¬¡èµ‹å€¼æ”¹å˜æ•´ä¸ªå­—ç¬¦ä¸²çš„å€¼ã€‚</p><p><strong>å¸¸ç”¨çš„ä¸€äº›æ“ä½œæ–¹æ³•</strong></p><p>toUpperCase()</p><p>toLowerCase()</p><p>indexOf(â€œxxxxâ€): æœç´¢å­ä¸²åœ¨ä¸»ä¸²ä¸­çš„ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰æœç´¢åˆ°è¿”å›-1</p><p>substring(int a): ä»ç´¢å¼•aå¼€å§‹åˆ°å­—ç¬¦ä¸²ç»“æŸ</p><p>substring(int a, int b): è¿”å›å­ä¸²<code>[s[a], s[b])</code></p><h2 id="æ•°ç»„"><a href="#æ•°ç»„" class="headerlink" title="æ•°ç»„"></a>æ•°ç»„</h2><p>jsä¸­çš„æ•°ç»„å…ƒç´ å¯ä»¥æ˜¯ä¸åŒç±»å‹ï¼Œé€šè¿‡ç´¢å¼•è¿›è¡Œè®¿é—®ã€‚</p><p>ç›´æ¥ç»™<code>array.length</code>è¿›è¡Œèµ‹å€¼ä¼šå¯¼è‡´æ•°ç»„çš„é•¿åº¦å‘ç”Ÿå˜åŒ–ã€‚</p><p>å¯ä»¥é€šè¿‡ç´¢å¼•å€¼æ”¹å˜æ•°ç»„çš„æŸä¸ªå…ƒç´ ã€‚</p><p><del>è‡³æ­¤å¯ä»¥æ¨æ–­å‡ºjsä¸­çš„å­—ç¬¦ä¸²ä¸æ˜¯<code>å­—ç¬¦çš„æ•°ç»„</code>ï¼Œè€Œæ˜¯ä¸€ä¸ªåŸºæœ¬çš„ç±»å‹</del></p><p>å¦‚æœè¶Šç•Œèµ‹å€¼ä¹Ÿä¼šå¯¼è‡´æ•°ç»„çš„é•¿åº¦å‘ç”Ÿæ”¹å˜ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">arr[<span class="number">5</span>] = <span class="string">&#x27;x&#x27;</span>;</span><br><span class="line">arr; <span class="comment">// arrå˜ä¸º[1, 2, 3, undefined, undefined, &#x27;x&#x27;]</span></span><br></pre></td></tr></table></figure><p><del>è¿™ç§ç‰¹æ€§ä¸çŸ¥é“æ˜¯å¥½æ˜¯å</del></p><p><strong>å¸¸ç”¨æ“ä½œ</strong></p><p>indeOf: ä¸stringä¸­çš„indexOfç±»ä¼¼</p><p>slice: ä¸substringç±»ä¼¼ï¼›å¦‚æœä¸ç»™sliceä¼ ä»»ä½•å‚æ•°ï¼Œå°±ä¼šæ•´ä¸ªæˆªå–è¯¥æ•°ç»„ï¼Œæ®æ­¤å¯ä»¥å¾ˆå®¹æ˜“çš„å®Œæˆæ•°ç»„çš„å¤åˆ¶ã€‚</p><p>push/pop: å¯¹æ•°ç»„çš„ç»“å°¾è¿›è¡Œæ·»/åˆ å…ƒç´ </p><p>unshift/shiftï¼šå¯¹æ•°ç»„çš„å¤´éƒ¨è¿›è¡Œæ·»/åˆ å…ƒç´ </p><p>pushå’Œunshiftå¯ä»¥ä¸€æ¬¡æ·»åŠ è‹¥å¹²ä¸ªå…ƒç´ ï¼Œè€Œpopå’Œshiftåªèƒ½åˆ å»ä¸€ä¸ªå…ƒç´ ï¼›å¦‚æœç©ºæ•°ç»„ç»§ç»­åˆ é™¤ï¼Œä¸ä¼šæŠ¥é”™è€Œä¼šè¿”å›undefined.</p><p>sort: æŒ‰é»˜è®¤é¡ºåºæ’åº</p><p>reverse: åè½¬</p><p><strong>splice</strong>: ä»æŒ‡å®šçš„ç´¢å¼•åˆ é™¤è‹¥å¹²å…ƒç´ ï¼Œç„¶åå†ä»è¯¥ä½ç½®åŠ å…¥è‹¥å¹²å…ƒç´ ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="string">&#x27;Microsoft&#x27;</span>, <span class="string">&#x27;Apple&#x27;</span>, <span class="string">&#x27;Yahoo&#x27;</span>, <span class="string">&#x27;AOL&#x27;</span>, <span class="string">&#x27;Excite&#x27;</span>, <span class="string">&#x27;Oracle&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»ç´¢å¼•2å¼€å§‹åˆ é™¤3ä¸ªå…ƒç´ ,ç„¶åå†æ·»åŠ ä¸¤ä¸ªå…ƒç´ :</span></span><br><span class="line">arr.splice(<span class="number">2</span>, <span class="number">3</span>, <span class="string">&#x27;Google&#x27;</span>, <span class="string">&#x27;Facebook&#x27;</span>); <span class="comment">// è¿”å›åˆ é™¤çš„å…ƒç´  [&#x27;Yahoo&#x27;, &#x27;AOL&#x27;, &#x27;Excite&#x27;]</span></span><br><span class="line">arr; <span class="comment">// [&#x27;Microsoft&#x27;, &#x27;Apple&#x27;, &#x27;Google&#x27;, &#x27;Facebook&#x27;, &#x27;Oracle&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åªåˆ é™¤,ä¸æ·»åŠ :</span></span><br><span class="line">arr.splice(<span class="number">2</span>, <span class="number">2</span>); <span class="comment">// [&#x27;Google&#x27;, &#x27;Facebook&#x27;]</span></span><br><span class="line">arr; <span class="comment">// [&#x27;Microsoft&#x27;, &#x27;Apple&#x27;, &#x27;Oracle&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åªæ·»åŠ ,ä¸åˆ é™¤:</span></span><br><span class="line">arr.splice(<span class="number">2</span>, <span class="number">0</span>, <span class="string">&#x27;Google&#x27;</span>, <span class="string">&#x27;Facebook&#x27;</span>); <span class="comment">// è¿”å›[],å› ä¸ºæ²¡æœ‰åˆ é™¤ä»»ä½•å…ƒç´ </span></span><br><span class="line">arr; <span class="comment">// [&#x27;Microsoft&#x27;, &#x27;Apple&#x27;, &#x27;Google&#x27;, &#x27;Facebook&#x27;, &#x27;Oracle&#x27;]</span></span><br></pre></td></tr></table></figure><p>concat: æ•°ç»„æ‹¼æ¥</p><p>concatå¯ä»¥æ¥å—ä»»æ„å¤šä¸ªå…ƒç´ ï¼Œå¹¶ä¸”å°†æ¥æ”¶åˆ°çš„arrayä¸æ–­æ‹†å¼€ã€å°†å…¶å…ƒç´ æ‹¼æ¥å…¥åŸæ•°ç»„ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>];</span><br><span class="line">arr.concat(<span class="number">1</span>, <span class="number">2</span>, [<span class="number">3</span>, <span class="number">4</span>]); <span class="comment">// [&#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;, 1, 2, 3, 4]</span></span><br></pre></td></tr></table></figure><p>joinï¼šå°†æ•°ç»„çš„æ¯ä¸ªå…ƒç´ ç”¨æŒ‡å®šçš„å­—ç¬¦ä¸²è¿›è¡Œè¿æ¥ï¼Œå¦‚æœå…ƒç´ ä¸æ˜¯å­—ç¬¦ä¸²åˆ™ä¼šå…ˆè‡ªåŠ¨å°†å…¶è½¬æ¢æˆå­—ç¬¦ä¸²ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">arr.join(<span class="string">&#x27;-&#x27;</span>); <span class="comment">// &#x27;A-B-C-1-2-3&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="å¯¹è±¡"><a href="#å¯¹è±¡" class="headerlink" title="å¯¹è±¡"></a>å¯¹è±¡</h2><p>JavaScriptçš„å¯¹è±¡æ˜¯ä¸€ç§æ— åºçš„é›†åˆæ•°æ®ç±»å‹ï¼Œå®ƒç”±è‹¥å¹²é”®å€¼å¯¹ç»„æˆã€‚</p><p>å¦‚æœæŸä¸ªå±æ€§åä¸­å«æœ‰ç‰¹æ®Šå­—ç¬¦ï¼Œå¯ä»¥é€šè¿‡<code>object[&#39;å±æ€§å&#39;]</code>æ¥è¿›è¡Œè®¿é—®ï¼›å½“ç„¶å»ºè®®æŒ‰ç…§è§„èŒƒè¿›è¡Œå‘½åï¼Œè¿™æ ·å°±å¯ä»¥ç›´æ¥é€šè¿‡<code>.</code>æ“ä½œç¬¦è¿›è¡Œè®¿é—®äº†ã€‚</p><p>ç±»ä¼¼çš„ï¼Œå¦‚æœè®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„å±æ€§ï¼Œé‚£ä¹ˆä¼šè¿”å›undefined.</p><p>ç”±äºjsçš„å¯¹è±¡æ˜¯åŠ¨æ€å±æ€§ï¼Œæ‰€ä»¥å¯ä»¥å¾ˆå®¹æ˜“ä¸ºä¸€ä¸ªå¯¹è±¡å¢æ·»/åˆ é™¤å±æ€§ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xiaoming = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;å°æ˜&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line">xiaoming.age; <span class="comment">// undefined</span></span><br><span class="line">xiaoming.age = <span class="number">18</span>; <span class="comment">// æ–°å¢ä¸€ä¸ªageå±æ€§</span></span><br><span class="line">xiaoming.age; <span class="comment">// 18</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> xiaoming.age; <span class="comment">// åˆ é™¤ageå±æ€§</span></span><br><span class="line">xiaoming.age; <span class="comment">// undefined</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> xiaoming[<span class="string">&#x27;name&#x27;</span>]; <span class="comment">// åˆ é™¤nameå±æ€§</span></span><br><span class="line">xiaoming.name; <span class="comment">// undefined</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> xiaoming.school; <span class="comment">// åˆ é™¤ä¸€ä¸ªä¸å­˜åœ¨çš„schoolå±æ€§ä¹Ÿä¸ä¼šæŠ¥é”™</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥ä½¿ç”¨<code>in</code>æ¥åˆ¤æ–­ä¸€ä¸ªå±æ€§æ˜¯å¦åœ¨ä¸€ä¸ªå¯¹è±¡ä¸­ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xiaoming = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;å°æ˜&#x27;</span>,</span><br><span class="line">    <span class="attr">birth</span>: <span class="number">1990</span>,</span><br><span class="line">    <span class="attr">school</span>: <span class="string">&#x27;No.1 Middle School&#x27;</span>,</span><br><span class="line">    <span class="attr">height</span>: <span class="number">1.70</span>,</span><br><span class="line">    <span class="attr">weight</span>: <span class="number">65</span>,</span><br><span class="line">    <span class="attr">score</span>: <span class="literal">null</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="string">&#x27;name&#x27;</span> <span class="keyword">in</span> xiaoming; <span class="comment">// true</span></span><br><span class="line"><span class="string">&#x27;grade&#x27;</span> <span class="keyword">in</span> xiaoming; <span class="comment">// false</span></span><br></pre></td></tr></table></figure><p>ä¸è¿‡inä¹Ÿä¼šåˆ¤æ–­é‚£äº›ç»§æ‰¿æ¥çš„å±æ€§ï¼Œä¸ºäº†åˆ¤æ–­å¯¹è±¡è‡ªèº«æ‰€æ‹¥æœ‰çš„å±æ€§ï¼Œå¯ä»¥ä½¿ç”¨<code>hasOwnProperty()</code>æ–¹æ³•ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xiaoming = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;å°æ˜&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line">xiaoming.hasOwnProperty(<span class="string">&#x27;name&#x27;</span>); <span class="comment">// true</span></span><br><span class="line">xiaoming.hasOwnProperty(<span class="string">&#x27;toString&#x27;</span>); <span class="comment">// false</span></span><br></pre></td></tr></table></figure><h2 id="è¯­å¥ç»“æ„"><a href="#è¯­å¥ç»“æ„" class="headerlink" title="è¯­å¥ç»“æ„"></a>è¯­å¥ç»“æ„</h2><p>åœ¨<code>if</code>è¯­å¥ä¸­ï¼ŒjsæŠŠ<code>null</code>, <code>undefined</code>, <code>0</code>, <code>NaN</code>å’Œ<code>&#39;&#39;</code>è§†ä¸ºfalseï¼Œå…¶ä½™å‡è§†ä¸ºtrue</p><p>å¾ªç¯è¯­å¥ç»“æ„ä¸C++ç±»ä¼¼ï¼Œå¯ä»¥åœ¨forè¯­å¥åˆå§‹åŒ–å€¼çš„ä½ç½®å®šä¹‰å˜é‡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨è‡ªå¢è‡ªå‡è¿ç®—ç¬¦ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨<code>+=</code>ç³»åˆ—è¿ç®—ç¬¦ã€‚</p><p>ç±»ä¼¼äºC++çš„èŒƒå›´forè¯­å¥ï¼Œjsæœ‰for inè¯­å¥ï¼Œç”¨äºå°†å¯¹è±¡ã€æ•°ç»„çš„<code>å±æ€§</code>å…¨éƒ¨åˆ—å‡ºæ¥ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Jack&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">20</span>,</span><br><span class="line">    <span class="attr">city</span>: <span class="string">&#x27;Beijing&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> o) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(key); <span class="comment">// &#x27;name&#x27;, &#x27;age&#x27;, &#x27;city&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœæƒ³è¦è¿‡æ»¤æ‰çˆ¶ç±»çš„å±æ€§ï¼Œå¯ä»¥åœ¨å¾ªç¯åé¢åŠ ä¸€å¥<code>o.hasOwnProperty(key)</code>çš„åˆ¤æ–­è¯­å¥ã€‚</p><p><strong>å¯¹arrayè¿›è¡Œ<code>for in</code>å¾ªç¯æ—¶ï¼Œæ•°ç»„çš„ç´¢å¼•è¢«è®¤ä¸ºæ˜¯å…¶å±æ€§ï¼Œå¾ªç¯å¾—åˆ°çš„ä¸æ˜¯<code>number</code>è€Œæ˜¯<code>string</code>ï¼</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i <span class="keyword">in</span> a) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(i); <span class="comment">// &#x27;0&#x27;, &#x27;1&#x27;, &#x27;2&#x27;</span></span><br><span class="line">    <span class="built_in">console</span>.log(a[i]); <span class="comment">// &#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Mapä¸Set"><a href="#Mapä¸Set" class="headerlink" title="Mapä¸Set"></a>Mapä¸Set</h2><p>æœ‰ä¸¤ç§æ–¹æ³•å¯¹Mapè¿›è¡Œåˆå§‹åŒ–</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åˆ©ç”¨äºŒç»´æ•°ç»„åˆå§‹åŒ–ä¸€ä¸ªMap</span></span><br><span class="line"><span class="keyword">var</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>([[<span class="string">&#x27;Michael&#x27;</span>, <span class="number">95</span>], [<span class="string">&#x27;Bob&#x27;</span>, <span class="number">75</span>], [<span class="string">&#x27;Tracy&#x27;</span>, <span class="number">85</span>]]);</span><br><span class="line">m.get(<span class="string">&#x27;Michael&#x27;</span>); <span class="comment">// 95</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¹Ÿå¯ä»¥åˆå§‹åŒ–ä¸€ä¸ªç©ºMapï¼Œç„¶ååˆ©ç”¨ä»¥ä¸‹æ–¹æ³•æ·»åŠ å…ƒç´ ã€‚</span></span><br><span class="line"><span class="keyword">var</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>(); <span class="comment">// ç©ºMap</span></span><br><span class="line">m.set(<span class="string">&#x27;Adam&#x27;</span>, <span class="number">67</span>); <span class="comment">// æ·»åŠ æ–°çš„key-value</span></span><br><span class="line">m.set(<span class="string">&#x27;Bob&#x27;</span>, <span class="number">59</span>);</span><br><span class="line">m.has(<span class="string">&#x27;Adam&#x27;</span>); <span class="comment">// æ˜¯å¦å­˜åœ¨key &#x27;Adam&#x27;: true</span></span><br><span class="line">m.get(<span class="string">&#x27;Adam&#x27;</span>); <span class="comment">// 67</span></span><br><span class="line">m.delete(<span class="string">&#x27;Adam&#x27;</span>); <span class="comment">// åˆ é™¤key &#x27;Adam&#x27;</span></span><br><span class="line">m.get(<span class="string">&#x27;Adam&#x27;</span>); <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure><p>ä¸€ä¸ªé”®åªèƒ½å¯¹åº”ä¸€ä¸ªå€¼ï¼Œæ‰€ä»¥å¤šæ¬¡å¯¹ä¸€ä¸ªé”®èµ‹å€¼ä¼šè¦†ç›–æ‰ä¹‹å‰çš„å€¼ã€‚</p><p>ç±»ä¼¼åœ°ï¼Œå¯ä»¥åˆå§‹åŒ–ä¸€ä¸ªç©ºSetæˆ–è€…ç”¨ä¸€ç»´æ•°ç»„åˆå§‹åŒ–ä¸€ä¸ªSetã€‚é‡å¤å…ƒç´ è‡ªåŠ¨è¢«åˆ é™¤ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</span><br><span class="line">s.add(<span class="number">4</span>);</span><br><span class="line">s; <span class="comment">// Set &#123;1, 2, 3, 4&#125;</span></span><br><span class="line">s.add(<span class="number">4</span>);</span><br><span class="line">s; <span class="comment">// ä»ç„¶æ˜¯ Set &#123;1, 2, 3, 4&#125;</span></span><br><span class="line">s.delete(<span class="number">4</span>);</span><br><span class="line">s; <span class="comment">// Set&#123;1, 2, 3&#125;</span></span><br></pre></td></tr></table></figure><h2 id="iterable"><a href="#iterable" class="headerlink" title="iterable"></a>iterable</h2><p>é€šè¿‡<code>for ... of ...</code>å¾ªç¯å¯ä»¥éå†å…·æœ‰<code>iterable</code>ç±»å‹çš„é›†åˆã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>];</span><br><span class="line"><span class="keyword">var</span> s = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>]);</span><br><span class="line"><span class="keyword">var</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>([[<span class="number">1</span>, <span class="string">&#x27;x&#x27;</span>], [<span class="number">2</span>, <span class="string">&#x27;y&#x27;</span>], [<span class="number">3</span>, <span class="string">&#x27;z&#x27;</span>]]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> x <span class="keyword">of</span> a) &#123; <span class="comment">// éå†Array</span></span><br><span class="line">    <span class="built_in">console</span>.log(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> x <span class="keyword">of</span> s) &#123; <span class="comment">// éå†Set</span></span><br><span class="line">    <span class="built_in">console</span>.log(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> x <span class="keyword">of</span> m) &#123; <span class="comment">// éå†Map</span></span><br><span class="line">    <span class="built_in">console</span>.log(x[<span class="number">0</span>] + <span class="string">&#x27;=&#x27;</span> + x[<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è€Œä»¥å¾€çš„<code>for in</code>å°±æ— æ³•éå†setå’Œmapã€‚</p><p><strong><code>for in</code>å¾ªç¯è®¿é—®çš„æ˜¯å¯¹è±¡çš„å±æ€§ï¼Œè€Œ<code>for of</code>åªå¾ªç¯é›†åˆæœ¬èº«çš„å…ƒç´ ã€‚</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>];</span><br><span class="line">a.name = <span class="string">&#x27;Hello&#x27;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> x <span class="keyword">in</span> a) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(x); <span class="comment">// &#x27;0&#x27;, &#x27;1&#x27;, &#x27;2&#x27;, &#x27;name&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>];</span><br><span class="line">a.name = <span class="string">&#x27;Hello&#x27;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> x <span class="keyword">of</span> a) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(x); <span class="comment">// &#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h1><h2 id="å‡½æ•°å®šä¹‰"><a href="#å‡½æ•°å®šä¹‰" class="headerlink" title="å‡½æ•°å®šä¹‰"></a>å‡½æ•°å®šä¹‰</h2><p>ä¸åŒäºC++ï¼Œjsä¸­å‡½æ•°ä¸å®šä¹‰è¿”å›å€¼ç±»å‹ï¼Œç›´æ¥ç”¨functionè¿›è¡Œå®šä¹‰å³å¯ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">abs</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> a &lt; <span class="number">0</span>? -a: a;&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœå‡½æ•°æ²¡æœ‰è¿”å›å€¼ï¼Œé‚£ä¹ˆè¯¥å‡½æ•°ä¹Ÿä¼šè¿”å›undefined.</p><p>æ­¤å¤–ï¼Œjsä¸­å‡½æ•°ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ä»¥ä¸‹çš„åŒ¿åå‡½æ•°å®šä¹‰ä¸€ä¸ªå‡½æ•°</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> abs = <span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> a &lt; <span class="number">0</span>? -a: a;&#125;;</span><br></pre></td></tr></table></figure><p>ä¸è¿‡ç”±äºç¬¬äºŒç§æ–¹æ³•æ˜¯èµ‹å€¼è¯­å¥ï¼Œæ‰€ä»¥è®°å¾—åŠ ä¸Š<code>;</code></p><h2 id="å‡½æ•°è°ƒç”¨"><a href="#å‡½æ•°è°ƒç”¨" class="headerlink" title="å‡½æ•°è°ƒç”¨"></a>å‡½æ•°è°ƒç”¨</h2><p>jsä¼ å…¥å‚æ•°çš„æ•°é‡ä¸è¢«ä¸¥æ ¼çš„é™åˆ¶ï¼šå¦‚æœå¤šäºéœ€è¦çš„æ•°é‡ï¼Œé‚£ä¹ˆå¤šä½™çš„å°†ä¸ä¼šè¢«ä½¿ç”¨ï¼›å¦‚æœå°‘äºéœ€è¦çš„æ•°é‡ï¼Œå‡½æ•°ä¸­çš„å‚æ•°ä¼šæ”¶åˆ°<code>undefined</code>ã€‚</p><p>æœ‰ä¸€ç§æ–¹æ³•å¯ä»¥åˆ¤æ–­æ˜¯å¦æ”¶åˆ°<code>undefined</code>ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> abs = <span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">typeof</span> a !== <span class="string">&#x27;number&#x27;</span>) <span class="keyword">throw</span> <span class="string">&#x27;Not a number&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> a &lt; <span class="number">0</span>? -a: a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨å‡½æ•°å†…éƒ¨å¯ä»¥ä½¿ç”¨<strong><code>arguments</code></strong>æ¥æŒ‡å‘æ‰€æœ‰çš„ä¼ å…¥å‚æ•°ï¼Œargumentä¹Ÿæœ‰å±æ€§<code>length</code>ï¼Œå¯ä»¥ç”¨lengthæ¥åˆ¤æ–­ä¼ å…¥çš„å‚æ•°æ˜¯å¦è¶³å¤Ÿã€‚</p><p>å¦‚æœä¼ å…¥çš„å‚æ•°è¿‡å¤šï¼Œå¯ä»¥ä½¿ç”¨ES6æ ‡å‡†å¼•å…¥çš„<code>rest</code>å‚æ•°ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">a, b, ...rest</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;a = &#x27;</span> + a);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;b = &#x27;</span> + b);</span><br><span class="line">    <span class="built_in">console</span>.log(rest);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foo(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line"><span class="comment">// ç»“æœ:</span></span><br><span class="line"><span class="comment">// a = 1</span></span><br><span class="line"><span class="comment">// b = 2</span></span><br><span class="line"><span class="comment">// Array [ 3, 4, 5 ]</span></span><br><span class="line"></span><br><span class="line">foo(<span class="number">1</span>);</span><br><span class="line"><span class="comment">// ç»“æœ:</span></span><br><span class="line"><span class="comment">// a = 1</span></span><br><span class="line"><span class="comment">// b = undefined</span></span><br><span class="line"><span class="comment">// Array []</span></span><br></pre></td></tr></table></figure><p>restå¿…é¡»å†™åœ¨æœ€åï¼Œå¹¶ç”¨<code>...</code>æ ‡ç¤ºã€‚</p><p>jsä¼šè‡ªåŠ¨åœ¨è¡Œæœ«æ·»åŠ åˆ†å·ï¼Œæ‰€ä»¥è¦æ³¨æ„returnå’Œå…¶è¿”å›å€¼ä¸è¦æ¢è¡Œåˆ†éš”ã€‚</p><h3 id="å˜é‡ä½œç”¨åŸŸ"><a href="#å˜é‡ä½œç”¨åŸŸ" class="headerlink" title="å˜é‡ä½œç”¨åŸŸ"></a>å˜é‡ä½œç”¨åŸŸ</h3><p>æ‰“å¼€<code>&#39;use strict&#39;</code>åå°±ç¦æ­¢ä¸åŠ varå£°æ˜å˜é‡ï¼Œé‚£ä¹ˆvarå˜é‡ä½œç”¨åŸŸåªåœ¨å½“å‰å‡½æ•°å†…ã€‚</p><p>å¦‚æœåµŒå¥—çš„å†…å±‚å‡½æ•°æœ‰ä¸å¤–å±‚åŒåçš„å˜é‡ï¼Œä¸C++ä¸€æ ·çš„è¦†ç›–è§„åˆ™æ˜¯æˆç«‹çš„ã€‚</p><h4 id=""><a href="#" class="headerlink" title=" "></a> </h4><p>JSåœ¨å‡½æ•°ä¸­æœ‰<strong>å˜é‡æå‡</strong>è¿™ä¸€ç‰¹æ€§ï¼Œåœ¨è¿è¡Œå‡½æ•°å‰æ‰«ææ•´ä¸ªå‡½æ•°ï¼Œå°†å˜é‡çš„å£°æ˜æå‡åˆ°å‡½æ•°çš„æœ€å‰é¢ã€‚</p><p><del>æ‰€ä»¥å¯ä»¥å†™ä¸€äº›å¿«ä¹çš„æ¯’ç˜¤ä»£ç </del></p><p>å¦‚æœä¸åœ¨ä»»ä½•å‡½æ•°å†…å£°æ˜ä¸€ä¸ªå˜é‡ï¼Œé‚£ä¹ˆè¯¥å˜é‡å°±æ˜¯å…¨å±€å˜é‡ã€‚å…¨å±€å˜é‡è¢«ç»‘å®šåœ¨äº†JSé»˜è®¤çš„ä¸€ä¸ªå…¨å±€å¯¹è±¡<code>window</code>çš„å±æ€§ä¸Šã€‚å› è€Œå¯ä»¥é€šè¿‡<code>window.</code>æ¥è®¿é—®ä¸€ä¸ªå…¨å±€å˜é‡ã€‚</p><p>å½“å¤šä¸ªæ–‡ä»¶åŒæ—¶å·¥ä½œæ—¶ï¼Œä¸ºäº†é¿å…å…¨å±€å˜é‡å‘½åçš„å†²çªï¼Œå¯ä»¥å°†æ‰€æœ‰çš„å…¨å±€å˜é‡ç»‘å®šåœ¨ä¸€ä¸ªå…¨å±€å˜é‡ä¸Šï¼Œè¿™æ ·å°±å¯ä»¥å®ç°â€œå‘½åç©ºé—´â€œçš„å·¥ä½œã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å”¯ä¸€çš„å…¨å±€å˜é‡MYAPP:</span></span><br><span class="line"><span class="keyword">var</span> MYAPP = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…¶ä»–å˜é‡:</span></span><br><span class="line">MYAPP.name = <span class="string">&#x27;myapp&#x27;</span>;</span><br><span class="line">MYAPP.version = <span class="number">1.0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…¶ä»–å‡½æ•°:</span></span><br><span class="line">MYAPP.foo = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;foo&#x27;</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>äº‹å®ä¸Šï¼Œå› ä¸ºå‡½æ•°å†…çš„å˜é‡ä¼šè¢«æå‡åˆ°é¦–éƒ¨ï¼Œæ‰€ä»¥å¦‚ä¸‹çš„C++é£æ ¼ä»£ç å¹¶ä¸èƒ½å®Œæˆå®ƒæœ¬æ¥æƒ³å®Œæˆçš„åŠŸèƒ½ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"> <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">1</span>; i &lt;= n; i++) </span><br><span class="line">      <span class="comment">//do something;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸ºæ­¤ï¼ŒES6å¼•å…¥æ–°çš„å…³é”®å­—<code>let</code>,å¯ä»¥å£°æ˜ä¸€ä¸ªå—çº§ä½œç”¨åŸŸçš„å˜é‡ï¼Œåˆ©ç”¨letå…³é”®å­—å°±å¯ä»¥å®Œæˆä¸Šè¿°çš„æ“ä½œäº†ã€‚</p><p>ES6ä¹Ÿå¼•å…¥äº†<code>const</code>æ¥å£°åä¸€ä¸ªå¸¸é‡ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> pi = <span class="number">3.14</span>;</span><br></pre></td></tr></table></figure><h3 id="è§£æ„èµ‹å€¼"><a href="#è§£æ„èµ‹å€¼" class="headerlink" title="è§£æ„èµ‹å€¼"></a>è§£æ„èµ‹å€¼</h3><p>è¿™æ˜¯ES6å¼•å…¥çš„ä¸€ç§å¯ä»¥å¯¹å¤šä¸ªå˜é‡åŒæ—¶èµ‹å€¼çš„è¯­æ³•ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç›´æ¥å¯¹ä¸‰ä¸ªå˜é‡è¿›è¡Œèµ‹å€¼</span></span><br><span class="line"><span class="keyword">var</span> [x, y, z] = [<span class="string">&#x27;hello&#x27;</span>, <span class="string">&#x27;JavaScript&#x27;</span>, <span class="string">&#x27;ES6&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¦‚æœå³å€¼æœ‰åµŒå¥—ï¼Œé‚£ä¹ˆå¤šä¸ªå˜é‡ä¹‹é—´ä¹Ÿè¦ä¿æŒæ ¼å¼ä¸€è‡´ã€‚</span></span><br><span class="line"><span class="keyword">let</span> [x, [y, z]] = [<span class="string">&#x27;hello&#x27;</span>, [<span class="string">&#x27;JavaScript&#x27;</span>, <span class="string">&#x27;ES6&#x27;</span>]];</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¯ä»¥å¿½ç•¥æ‰æŸäº›å…ƒç´ </span></span><br><span class="line"><span class="keyword">let</span> [, , z] = [<span class="string">&#x27;hello&#x27;</span>, <span class="string">&#x27;JavaScript&#x27;</span>, <span class="string">&#x27;ES6&#x27;</span>]; </span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ä»ä¸€ä¸ªå¯¹è±¡ä¸­æŠ½å–å‡ºè‹¥å¹²å±æ€§è¿›è¡Œèµ‹å€¼</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;å°æ˜&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">20</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="string">&#x27;male&#x27;</span>,</span><br><span class="line">    <span class="attr">passport</span>: <span class="string">&#x27;G-12345678&#x27;</span>,</span><br><span class="line">    <span class="attr">school</span>: <span class="string">&#x27;No.4 middle school&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> &#123;name, age, passport&#125; = person;</span><br></pre></td></tr></table></figure><p>å¦‚æœä½¿ç”¨äº†ä¸å­˜åœ¨çš„å±æ€§åå°†ä¼šè·å¾—<code>undefined</code></p><p>å¯ä»¥é€šè¿‡å¦‚ä¸‹è¯­å¥å°†æŸå±æ€§çš„å€¼èµ‹å€¼åˆ°å¦ä¸€ä¸ªåç§°çš„å±æ€§ä¸Š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> &#123;name, <span class="attr">passport</span>:id&#125; = person;</span><br></pre></td></tr></table></figure><p>è§£æ„èµ‹å€¼ä¹Ÿå¯ä»¥è®¾ç½®é»˜è®¤å€¼ï¼Œé¿å…äº§ç”Ÿ<code>undefined</code>çš„é—®é¢˜</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;å°æ˜&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">20</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="string">&#x27;male&#x27;</span>,</span><br><span class="line">    <span class="attr">passport</span>: <span class="string">&#x27;G-12345678&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚æœpersonå¯¹è±¡æ²¡æœ‰singleå±æ€§ï¼Œé»˜è®¤èµ‹å€¼ä¸ºtrue:</span></span><br><span class="line"><span class="keyword">var</span> &#123;name, single = <span class="literal">true</span>&#125; = person;</span><br></pre></td></tr></table></figure><p>å¦‚æœæƒ³è¦å¯¹å·²ç»å£°æ˜è¿‡çš„å˜é‡åšè§£æ„èµ‹å€¼ï¼Œéœ€é‡‡ç”¨å¦‚ä¸‹å½¢å¼<del>æˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆ</del></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(&#123;x, y&#125; = &#123; <span class="attr">name</span>: <span class="string">&#x27;å°æ˜&#x27;</span>, <span class="attr">x</span>: <span class="number">100</span>, <span class="attr">y</span>: <span class="number">200</span>&#125;);</span><br></pre></td></tr></table></figure><h2 id="å‡½æ•°æ–¹æ³•"><a href="#å‡½æ•°æ–¹æ³•" class="headerlink" title="å‡½æ•°æ–¹æ³•"></a>å‡½æ•°æ–¹æ³•</h2><p>åœ¨JSä¸­å¯ä»¥ä½¿ç”¨å¦‚ä¸‹è¯­æ³•å®šä¹‰ä¸€ä¸ªå¯¹è±¡ä¸“ç”¨çš„æ–¹æ³•ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xiaoming = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;å°æ˜&#x27;</span>,</span><br><span class="line">    <span class="attr">birth</span>: <span class="number">1990</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> y = <span class="keyword">new</span> <span class="built_in">Date</span>().getFullYear();</span><br><span class="line">        <span class="keyword">return</span> y - <span class="built_in">this</span>.birth;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å¯¹è±¡ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€ç§â€œå…¨å±€æ–¹æ³•â€ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getage</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> y = <span class="keyword">new</span> <span class="built_in">Date</span>().getFullYear();</span><br><span class="line">    <span class="keyword">return</span> y - <span class="built_in">this</span>.birth;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> xiaoming = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;å°æ˜&#x27;</span>, <span class="attr">birth</span>: <span class="number">1990</span>,</span><br><span class="line">    <span class="attr">age</span>: getage,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(xiaoming.age());</span><br></pre></td></tr></table></figure><p>å¥½å¤„åœ¨äºå¯ä»¥æŒ‰éœ€ä½¿ç”¨â€œå…¨å±€æ–¹æ³•â€ï¼Œä½†æ˜¯å¦‚æœä¸åŠ ä»»ä½•å¯¹è±¡çš„è°ƒç”¨äº†è¿™ä¸ªæ–¹æ³•åˆ™ä¼šè¿”å›<code>undefined</code>ã€‚è¿™æ˜¯å› ä¸ºè¯¥å¯¹è±¡é»˜è®¤æˆä¸º<code>window</code>ï¼Œæ–¹æ³•ä¸­çš„thisæŒ‡å‘äº†windowã€‚ä¸ºäº†è§£å†³thisçš„æ­£ç¡®æŒ‡å‘é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡<code>strict</code>æ¨¡å¼æ¥ä½¿å¾—è¿™ç§æƒ…å†µä¸‹thisæ€»æŒ‡å‘<code>undefined</code>æ¥åŠæ—¶çš„æŠ¥é”™é¿å…è¯¥é—®é¢˜ã€‚</p><p>æ­¤å¤–ï¼Œåœ¨å¯¹è±¡æŸä¸ªæ–¹æ³•ä¸­çš„å­æ–¹æ³•ï¼Œæ— æ³•é€šè¿‡<code>this</code>æŒ‡å‘åŸå¯¹è±¡ï¼Œåªä¼šæŒ‡å‘<code>undefined</code>ï¼Œå®é™…ä½¿ç”¨æ—¶å¯ä»¥é€šè¿‡åˆ›å»ºå±€éƒ¨å˜é‡æ¥è§£å†³ã€‚</p><p>å¯ä»¥åˆ©ç”¨<strong>apply</strong>æ–¹æ³•æ¥æ‰‹åŠ¨æŒ‡å®šå…¨å±€æ–¹æ³•çš„thiså¯¹è±¡å¹¶ç»™å‡ºå‚æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getAge</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> y = <span class="keyword">new</span> <span class="built_in">Date</span>().getFullYear();</span><br><span class="line">    <span class="keyword">return</span> y - <span class="built_in">this</span>.birth;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> xiaoming = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;å°æ˜&#x27;</span>,</span><br><span class="line">    <span class="attr">birth</span>: <span class="number">1990</span>,</span><br><span class="line">    <span class="attr">age</span>: getAge</span><br><span class="line">&#125;;</span><br><span class="line">getAge.apply(xiaoming, []); <span class="comment">// 25, thisæŒ‡å‘xiaoming, å‚æ•°ä¸ºç©º</span></span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå¯¹è±¡åï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä¸­å…ƒç´ ä¸ºè¦ä¼ å…¥ç»™å‡½æ•°çš„å‚æ•°ã€‚</p><p>æ–¹æ³•<strong>call</strong>ä¸applyåŸºæœ¬ç±»ä¼¼ï¼Œå”¯ä¸€ä¸åŒçš„åœ°æ–¹åœ¨äºcallå°†å‡½æ•°éœ€è¦çš„å‚æ•°ä¸€ä¸ªä¸ªåˆ—å‡ºä¸ºå½¢å‚ã€‚</p><p>åˆ©ç”¨applyå¯ä»¥å¯¹åŸå‡½æ•°è¿›è¡ŒåŠ â€œå£³â€</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> oldfun = fun;</span><br><span class="line"><span class="built_in">window</span>.fun = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="comment">//dosomething</span></span><br><span class="line">  <span class="keyword">return</span> oldfun.apply(xxx, [...])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><del>vscodeå¯èƒ½æ²¡æœ‰é…ç½®å®Œå¤‡ï¼Œå¯¼è‡´window.xxxxç³»åˆ—å‡½æ•°æ— æ³•åœ¨vscodeæ‰§è¡Œï¼›ç„¶è€Œåˆ‡æ¢åˆ°chromeçš„æ§åˆ¶å°ä¾¿å¯ä»¥é¡ºåˆ©æ‰§è¡Œã€‚</del></p><blockquote><p><code>window</code> is a browser thing that doesnâ€™t exist on Node.</p></blockquote><h2 id="é«˜é˜¶å‡½æ•°"><a href="#é«˜é˜¶å‡½æ•°" class="headerlink" title="é«˜é˜¶å‡½æ•°"></a>é«˜é˜¶å‡½æ•°</h2><p>é«˜é˜¶å‡½æ•°æ˜¯æŒ‡æ¥å—å…¶ä»–å‡½æ•°ä½œä¸ºå‚é‡çš„å‡½æ•°ã€‚</p><p>å¹¶é™„ä¸Šå›è°ƒå‡½æ•°çš„ä¸€ä¸ªè§£é‡Š: <strong>A â€œcallbackâ€ is any function that is called by another function which takes the first function as a parameter.</strong> </p><h2 id="mapæ–¹æ³•"><a href="#mapæ–¹æ³•" class="headerlink" title="mapæ–¹æ³•"></a>mapæ–¹æ³•</h2><p>æŒ‡å®šä¸€ä¸ªæ˜ å°„æ–¹æ³•ï¼Œé€šè¿‡mapæ–¹æ³•å°†åŸæœ¬çš„å…ƒç´ ä¸€ä¸€è¿›è¡Œç½®æ¢ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pow</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> a * a;&#125;</span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line"><span class="built_in">console</span>.log(arr.map(pow));</span><br><span class="line"><span class="comment">//[ 1, 4, 9, 16 ]</span></span><br></pre></td></tr></table></figure><h2 id="reduceæ–¹æ³•"><a href="#reduceæ–¹æ³•" class="headerlink" title="reduceæ–¹æ³•"></a>reduceæ–¹æ³•</h2><p>æŒ‡å®šä¸€ä¸ªå¿…é¡»ä¼ å…¥2ä¸ªå…ƒç´ çš„æ–¹æ³•ï¼Œå°†åºåˆ—å‰ä¸¤é¡¹æŒ‰ç…§è¯¥æ–¹æ³•åšè¿ç®—åçš„ç»“æœç»§ç»­ä¸ç¬¬ä¸‰ä¸ªå…ƒç´ åšè¿ç®—ï¼Œå…¶åä»¥æ­¤ç±»æ¨ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[x1, x2, x3, x4].reduce(f) = f(f(f(x1, x2), x3), x4)</span><br></pre></td></tr></table></figure><p>ç»™å‡ºä¸€äº›å®ä¾‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>];</span><br><span class="line">arr.reduce(<span class="function"><span class="keyword">function</span> (<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;); <span class="comment">// 25</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>];</span><br><span class="line">arr.reduce(<span class="function"><span class="keyword">function</span> (<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x * <span class="number">10</span> + y;</span><br><span class="line">&#125;); <span class="comment">// 13579</span></span><br></pre></td></tr></table></figure><p><del>JSä¸­å¦‚ä½•å°†å­—ç¬¦è½¬åŒ–ä¸ºæ•´æ•°ï¼Ÿ</del></p><p>å¦‚æœä¸ä½¿ç”¨parseIntç³»åˆ—æ–¹æ³•ï¼š</p><ol><li><p>ä½¿ç”¨Number(c) - Number(â€˜0â€™)æ¥ç±»ä¼¼äºC++çš„è½¬åŒ–ä¸ºInt</p></li><li><p>é€šè¿‡è¿ç®—ç¬¦è‡ªåŠ¨è§£æå­—ç¬¦ä¸²ä¸ºæ•°å€¼</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> s = <span class="string">&#x27;12345&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> arr = <span class="keyword">new</span> <span class="built_in">Array</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; s.length; i++)  arr[i] = s[i] * <span class="number">1</span>;</span><br><span class="line"><span class="comment">//[ 1, 2, 3, 4, 5 ]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; s.length; i++)  arr[i] = s[i] - <span class="number">0</span>;</span><br><span class="line"><span class="comment">//[ 1, 2, 3, 4, 5 ]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ— æ³•é€šè¿‡&#x27;+&#x27;å°†å­—ç¬¦ä¸²è§£æä¸ºæ•°å€¼ï¼</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; s.length; i++)  arr[i] = s[i] + <span class="number">0</span>;</span><br><span class="line"><span class="comment">//[ &#x27;10&#x27;, &#x27;20&#x27;, &#x27;30&#x27;, &#x27;40&#x27;, &#x27;50&#x27; ]</span></span><br></pre></td></tr></table></figure></li></ol><p>å¦‚æœæƒ³è¦ä½¿ç”¨è¿™ç±»ä¸æ˜¯å¾ˆçŸ¥é“å®ç°åŸç†çš„å†…ç½®å‡½æ•°æ—¶ï¼Œå°±å¯èƒ½ä¼šäº§ç”Ÿå¦‚ä¸‹æ„æƒ³ä¸åˆ°ç»“æœã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log([<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>].map(<span class="built_in">parseInt</span>));</span><br><span class="line"><span class="comment">//[ 1, NaN, NaN ]</span></span><br></pre></td></tr></table></figure><p>è¿™æ˜¯å› ä¸º<code>parseInt()</code>å®é™…ä¼šæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯è¡¨è¾¾å¼å­—ç¬¦ä¸²ï¼Œç¬¬äºŒä¸ªæ˜¯åŸºæ•°ã€‚è€Œåœ¨ä½¿ç”¨mapä¼ å…¥æ—¶ä¼šå°†å­—ç¬¦ä½œä¸ºå­—ç¬¦ä¸²è¡¨è¾¾å¼ã€åºå·ä¸ºåŸºæ•°ä¼ å…¥parstIntå‡½æ•°ï¼Œé‚£ä¹ˆå°±æ— æ³•æ­£ç¡®è§£æ{â€˜2â€™, 1}å’Œ{â€˜3â€™, 2}è¡¨è¾¾å¼äº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>åŠå…¬æ¥¼biu</title>
      <link href="/2020/09/04/%E5%8A%9E%E5%85%AC%E6%A5%BCbiu/"/>
      <url>/2020/09/04/%E5%8A%9E%E5%85%AC%E6%A5%BCbiu/</url>
      
        <content type="html"><![CDATA[<p>ç»™å‡ºä¸€å¼ å›¾ï¼Œæ±‚å‡ºå…¶è¡¥å›¾æ‰€æœ‰è”é€šå—çš„ä¸ªæ•°åŠå…¶å¤§å°ã€‚</p><span id="more"></span><h3 id="é»‘æš—çˆ†ç‚¸OJ-1098"><a href="#é»‘æš—çˆ†ç‚¸OJ-1098" class="headerlink" title="é»‘æš—çˆ†ç‚¸OJ 1098"></a><a href="https://darkbzoj.tk/problem/1098">é»‘æš—çˆ†ç‚¸OJ 1098</a></h3><p>å®¹æ˜“æƒ³åˆ°$O(n^2)$çš„ç®—æ³•ï¼šå¯¹äºæ¯ä¸€ä¸ªç‚¹ï¼Œæšä¸¾æ‰€æœ‰é‚»ç‚¹æ‰“ä¸Šæ ‡è®°ï¼Œç„¶åæ‰¾é‚£äº›æ²¡æœ‰è¢«æ‰“ä¸Šæ ‡è®°çš„ç‚¹ï¼Œå°†è¿™äº›ç‚¹åŠ å…¥åˆ°ä¸€ä¸ªè”é€šå—ä¸­ã€‚</p><p>å¦‚æœä½¿ç”¨é“¾è¡¨ï¼Œå¯ä»¥å°†å¤æ‚åº¦ä¼˜åŒ–åˆ°$O(n + m)$ï¼Œéå¸¸çš„ç¥å¥‡ã€‚</p><p><del>æœ¬æ¥æ˜¯éå¸¸çš„ç¥ç§˜ï¼Œåæ¥qkoå­¦é•¿ç»™æˆ‘è®²äº†ä¸‹å°±å˜å¾—éå¸¸ç¥å¥‡äº† orz</del></p><p>é“¾è¡¨ä¼˜åŒ–åçš„æ€»ä½“æ€è·¯ä¸ä¸Šç±»ä¼¼ï¼Œæšä¸¾æ¯ä¸€ä¸ªç‚¹ï¼Œå°†é‚»ç‚¹æ‰“ä¸Šæ ‡è®°ï¼Œæ¥ä¸‹æ¥åœ¨é“¾è¡¨ä¸­æ‰¾é‚£äº›æ²¡æœ‰è¢«æ ‡è®°è¿‡çš„ç‚¹åŠ å…¥åˆ°è”é€šå—ä¸­ã€‚è¿™é‡Œæˆ‘ä»¬ç»´æŠ¤é“¾è¡¨ä¸­çš„å…ƒç´ ä¸ºå¯èƒ½æˆä¸ºè¯¥ç‚¹æ‰€åœ¨è”é€šå—çš„é‚£äº›å…ƒç´ ï¼Œè¿™æ„å‘³ç€å¯¹äºé‚£äº›å·²ç»åŠ å…¥å…¶ä»–è”é€šå—æˆ–æ˜¯å·²ç»è¢«åŠ å…¥åˆ°å½“å‰è”é€šå—çš„å…ƒç´ ä¸ä¼šå†è¢«è€ƒè™‘ã€‚æ¯æ¬¡æˆ‘ä»¬å°†é‚£äº›å…ƒç´ åŠ å…¥åˆ°è”é€šå—ä¸­åï¼Œå°±å°†ä»–ä»¬åœ¨é“¾è¡¨ä¸­åˆ å»ï¼Œè¿™æ ·å°±å¯ä»¥ç»´æŠ¤ä¸Šè¿°çš„æ€§è´¨ã€‚</p><p>åˆçœ‹æ€»æ„Ÿè§‰ä¼šè¢«å¡åˆ°$O(n^2)$ï¼Œå› ä¸ºæŸä¸ªç‚¹å¦‚æœè¿äº†å¾ˆå¤šä¸ªé‚»è¾¹ï¼Œé‚£ä¹ˆåœ¨é“¾è¡¨ä¸­å°±æœ‰å¯èƒ½ä¼šéå†åˆ°æœ€åä¸€ä¸ªå…ƒç´ æ‰åªèƒ½åˆ æ‰1ä¸ªå…ƒç´ ã€‚é‚£ä¹ˆä¼šæˆä¸º$O(n^2)$å—ï¼Œåº”è¯¥æ˜¯ä¸ä¼šçš„ã€‚</p><p>æŒ‰ç…§æˆ‘æœ€å¼€å§‹ç²—æµ…çš„æƒ³æ³•æ˜¯ï¼Œå¦‚æœç‚¹æ•°nå’Œè¾¹æ•°måŒé˜¶ï¼Œé‚£ä¹ˆä¸å¯èƒ½ä¼šæœ‰å¾ˆå¤šè¿™ç§è”é€šæ€§æå¼ºçš„ç‚¹ï¼Œä»è€ŒOnçš„éå†é“¾è¡¨çš„æ¬¡æ•°ä¹Ÿä¸ä¼šå¾ˆå¤šã€‚ä¸è¿‡è¿™æ ·çš„è§£é‡Šç»ˆå½’æœ‰ç‚¹ç‰µå¼ºï¼Œé—®äº†qkoå­¦é•¿åå¾—çŸ¥äº†ä¸€ç§æ›´ä¼˜ç¾çš„è¯´æ˜æ–¹æ³•ï¼šè€ƒå¯Ÿé“¾è¡¨ä¸­æ¯ä¸ªç‚¹è¢«éå†è¿‡çš„æ¬¡æ•°ã€‚æ ¹æ®è¡¥å›¾çš„å®šä¹‰ï¼ŒæŸä¸ªç‚¹æœ€å¤šåªä¼šè¢«å†—ä½™éå†$O(m_i)$æ¬¡ï¼Œ$m_i$è¡¨ç¤ºièŠ‚ç‚¹çš„è¾¹çš„ä¸ªæ•°ã€‚å› ä¸ºå¦‚æœæœ‰ä¸€æ¡ä¸è¿æ¥è¯¥ç‚¹çš„ç‚¹æ­£åœ¨è¿›è¡Œæ‰©æ•£æ“ä½œï¼Œé‚£ä¹ˆè¯¥ç‚¹å› ä¸ºä¸ä¸å…¶ç›¸è¿ï¼Œä¸€å®šä¼šå°†å…¶åŠ å…¥åˆ°è¡¥å›¾è”é€šå—ä¸­ï¼Œä¹‹åä¾¿ä¼šåœ¨é“¾è¡¨ä¸­åˆ å»è¯¥èŠ‚ç‚¹çš„ä¿¡æ¯ã€‚åªæœ‰é‚£äº›ä¸å…¶åŸæœ¬ç›¸è¿çš„ç‚¹åœ¨æ‰©æ•£è¿‡ç¨‹ä¸­æ‰ä¼šä¿ç•™è¿™äº›é‚»ç‚¹ä¸åˆ å»ã€‚é‚£ä¹ˆæ€»å…±è®¿é—®é“¾è¡¨çš„æ¬¡æ•°æ˜¾ç„¶å°±æ˜¯$O(m)$äº†ã€‚</p><p>å¦ä¸€æ–¹é¢ï¼Œæšä¸¾æ¯ä¸ªç‚¹è¿›è¡Œè”é€šå—æ‰©æ•£çš„æ—¶é—´ä¸º$O(n)$ï¼Œæ‰€ä»¥æ€»å…±æ—¶é—´å¤æ‚åº¦ä¸º$O(n + m)$ã€‚</p><p>orz</p><p>å¤ªå·§å¦™äº†</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span> + <span class="number">10</span>, maxe = <span class="number">2e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">star</span>&#123;</span><span class="keyword">int</span> to, next;&#125;;</span><br><span class="line"><span class="keyword">int</span> head[maxn], top = <span class="number">0</span>;</span><br><span class="line">star edge[maxe &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">list&lt;<span class="keyword">int</span>&gt; ls;</span><br><span class="line">queue&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"><span class="keyword">int</span> vis[maxn];</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="built_in">clr</span>(head, <span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m); <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> u, v; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">        <span class="built_in">add</span>(u, v); <span class="built_in">add</span>(v, u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) ls.<span class="built_in">push_back</span>(i);</span><br><span class="line">    <span class="keyword">while</span>(!ls.<span class="built_in">empty</span>())&#123;</span><br><span class="line">        q.<span class="built_in">push</span>(ls.<span class="built_in">front</span>()); ls.<span class="built_in">pop_front</span>();</span><br><span class="line">        <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())&#123;</span><br><span class="line">            <span class="keyword">int</span> now = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>(); cnt++;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = head[now]; ~i; i = edge[i].next)&#123;</span><br><span class="line">                <span class="keyword">int</span> to = edge[i].to;</span><br><span class="line">                vis[to] = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            list&lt;<span class="keyword">int</span>&gt;::iterator it = ls.<span class="built_in">begin</span>();</span><br><span class="line">            <span class="keyword">while</span>(it != ls.<span class="built_in">end</span>())&#123;</span><br><span class="line">                <span class="keyword">if</span>(vis[*it])&#123;vis[*it] = <span class="number">0</span>; it++;&#125;</span><br><span class="line">                <span class="keyword">else</span>&#123;q.<span class="built_in">push</span>(*it); ls.<span class="built_in">erase</span>(it++);&#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ans.<span class="built_in">push_back</span>(cnt);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> top = (<span class="keyword">int</span>)ans.<span class="built_in">size</span>();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, top);</span><br><span class="line">    <span class="built_in">sort</span>(ans.<span class="built_in">begin</span>(), ans.<span class="built_in">end</span>());</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; top; i++)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, ans[i]);</span><br><span class="line">        <span class="built_in">printf</span>(i != top - <span class="number">1</span>? <span class="string">&quot; &quot;</span>: <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å›¾è®º </tag>
            
            <tag> é“¾è¡¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>24point</title>
      <link href="/2020/09/02/24point/"/>
      <url>/2020/09/02/24point/</url>
      
        <content type="html"><![CDATA[<p>24ç‚¹å°æ¸¸æˆ~</p><span id="more"></span><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line">      </span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unordered_set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;random&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;chrono&gt;</span></span></span><br><span class="line">     </span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cassert&gt;</span></span></span><br><span class="line">      </span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> itn int</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fro for</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> scnaf scanf</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sacnf scanf</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> manx maxn</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pritnf printf</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Fastin freopen(<span class="meta-string">&quot;in.txt&quot;</span>, <span class="meta-string">&quot;r&quot;</span>, stdin)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Fastout freopen(<span class="meta-string">&quot;out.txt&quot;</span>, <span class="meta-string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> min(a, b) ((a) &lt; (b)? (a): (b))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> max(a, b) ((a) &gt; (b)? (a): (b))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lowbit(x) ((x) &amp; (-x))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ceil(n, p) (((n) +(p) - 1) / (p))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DBG(x) (void)(cout &lt;&lt; <span class="meta-string">&quot;L&quot;</span> &lt;&lt; __LINE__ &lt;&lt; <span class="meta-string">&quot;: &quot;</span> &lt;&lt; #x &lt;&lt; <span class="meta-string">&quot; = &quot;</span> &lt;&lt;( x) &lt;&lt; <span class="meta-string">&#x27;\n&#x27;</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> clr(a, x) memset((a), x, sizeof (a))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TTT int __; scanf(<span class="meta-string">&quot;%d&quot;</span>, &amp;__); while(__--)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> a[<span class="number">5</span>], b[<span class="number">5</span>], p[<span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NODE</span>&#123;</span></span><br><span class="line">    string s; <span class="keyword">double</span> w;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> NODE&amp; b)<span class="keyword">const</span>&#123;<span class="keyword">return</span> s &lt; b.s;&#125;</span><br><span class="line">&#125;;</span><br><span class="line">set&lt;NODE&gt; s[<span class="number">5</span>][<span class="number">5</span>];</span><br><span class="line"><span class="comment">//å¤„ç†[left, right]çš„å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sove</span><span class="params">(<span class="keyword">int</span> left, <span class="keyword">int</span> right)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(left &gt; right) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">if</span>(left == right)&#123;</span><br><span class="line">        NODE temp;</span><br><span class="line">        temp.s = <span class="built_in">to_string</span>(a[left]); temp.w = a[left];</span><br><span class="line">        s[left][right].<span class="built_in">insert</span>(temp);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = left; i &lt;= right - <span class="number">1</span>; i++)&#123;</span><br><span class="line">        <span class="built_in">sove</span>(left, i); <span class="built_in">sove</span>(i + <span class="number">1</span>, right);</span><br><span class="line">        NODE temp;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> x: s[left][i]) <span class="keyword">for</span>(<span class="keyword">auto</span> y: s[i + <span class="number">1</span>][right])&#123;</span><br><span class="line">            temp.s = x.s; <span class="keyword">if</span>(left != i) temp.s = <span class="string">&quot;(&quot;</span> + temp.s + <span class="string">&quot;)&quot;</span>;</span><br><span class="line">            temp.s += <span class="string">&quot;+&quot;</span>; temp.w = x.w + y.w;</span><br><span class="line">            <span class="keyword">if</span>(i + <span class="number">1</span> != right) temp.s += <span class="string">&quot;(&quot;</span> + y.s + <span class="string">&quot;)&quot;</span>;</span><br><span class="line">            <span class="keyword">else</span> temp.s += y.s;</span><br><span class="line">            s[left][right].<span class="built_in">insert</span>(temp);</span><br><span class="line">            </span><br><span class="line">            temp.s = x.s; <span class="keyword">if</span>(left != i) temp.s = <span class="string">&quot;(&quot;</span> + temp.s + <span class="string">&quot;)&quot;</span>;</span><br><span class="line">            temp.s += <span class="string">&quot;-&quot;</span>; temp.w = x.w - y.w;</span><br><span class="line">            <span class="keyword">if</span>(i + <span class="number">1</span> != right) temp.s += <span class="string">&quot;(&quot;</span> + y.s + <span class="string">&quot;)&quot;</span>;</span><br><span class="line">            <span class="keyword">else</span> temp.s += y.s;</span><br><span class="line">            s[left][right].<span class="built_in">insert</span>(temp);</span><br><span class="line">            </span><br><span class="line">            temp.s = x.s; <span class="keyword">if</span>(left != i) temp.s = <span class="string">&quot;(&quot;</span> + temp.s + <span class="string">&quot;)&quot;</span>;</span><br><span class="line">            temp.s += <span class="string">&quot;*&quot;</span>; temp.w = x.w * y.w;</span><br><span class="line">            <span class="keyword">if</span>(i + <span class="number">1</span> != right) temp.s += <span class="string">&quot;(&quot;</span> + y.s + <span class="string">&quot;)&quot;</span>;</span><br><span class="line">            <span class="keyword">else</span> temp.s += y.s;</span><br><span class="line">            s[left][right].<span class="built_in">insert</span>(temp);</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span>(y.w == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">            temp.s = x.s; <span class="keyword">if</span>(left != i) temp.s = <span class="string">&quot;(&quot;</span> + temp.s + <span class="string">&quot;)&quot;</span>;</span><br><span class="line">            temp.s += <span class="string">&quot;/&quot;</span>; temp.w = x.w / y.w;</span><br><span class="line">            <span class="keyword">if</span>(i + <span class="number">1</span> != right) temp.s += <span class="string">&quot;(&quot;</span> + y.s + <span class="string">&quot;)&quot;</span>;</span><br><span class="line">            <span class="keyword">else</span> temp.s += y.s;</span><br><span class="line">            s[left][right].<span class="built_in">insert</span>(temp);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line">set&lt;string&gt; ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">4</span>; i++) <span class="built_in">scnaf</span>(<span class="string">&quot;%d&quot;</span>, b + i);</span><br><span class="line">    p[<span class="number">1</span>] = <span class="number">1</span>; p[<span class="number">2</span>] = <span class="number">2</span>; p[<span class="number">3</span>] = <span class="number">3</span>; p[<span class="number">4</span>] = <span class="number">4</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">do</span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">5</span>; j++) s[i][j].<span class="built_in">clear</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">4</span>; i++) a[i] = b[p[i]];</span><br><span class="line">        <span class="built_in">sove</span>(<span class="number">1</span>, <span class="number">4</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> x: s[<span class="number">1</span>][<span class="number">4</span>]) <span class="keyword">if</span>(<span class="built_in">abs</span>(x.w - <span class="number">24</span>) &lt;= eps)&#123;</span><br><span class="line">            ans.<span class="built_in">insert</span>(x.s);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">while</span>(<span class="built_in">next_permutation</span>(p + <span class="number">1</span>, p + <span class="number">5</span>));</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(ans.<span class="built_in">empty</span>()) <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">for</span>(<span class="keyword">auto</span> s: ans) cout &lt;&lt; s &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Search </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019-XDU-onsite</title>
      <link href="/2020/09/02/2019-XDU-onsite/"/>
      <url>/2020/09/02/2019-XDU-onsite/</url>
      
        <content type="html"><![CDATA[<p>1427 qkoçš„å®å¯æ¢¦ ï¼ˆå·²è¡¥ï¼‰</p><p>1428 qkoçš„ä¸²</p><p>1429 qkoçš„è¿›åŒ–å…¬å¼</p><p>1430 qkoçš„æ ‘</p><span id="more"></span><p>[toc]</p><h2 id="1427-setå¯¹æœ‰åºé“¾çš„ç»´æŠ¤"><a href="#1427-setå¯¹æœ‰åºé“¾çš„ç»´æŠ¤" class="headerlink" title="1427 setå¯¹æœ‰åºé“¾çš„ç»´æŠ¤"></a>1427 setå¯¹æœ‰åºé“¾çš„ç»´æŠ¤</h2><p>setä¸­æ¯ä¸ªèŠ‚ç‚¹æ‹¥æœ‰æœ€å°æ”»å‡»åŠ›å’Œæœ€å¤§æ”»å‡»åŠ›ï¼Œä¿è¯setä¸­ä¸€å®šæ»¡è¶³ä¸¥æ ¼çš„ååºå…³ç³»ï¼Œå³ä¿è¯ä¸¤ä¸ªå…ƒç´ ä¹‹é—´ä¸€å®šæœ‰æŸå…ƒç´ çš„æœ€å¤§å€¼å…¨éƒ¨å°äºå¦ä¸€ä¸ªå…ƒç´ çš„æœ€å°å€¼ã€‚</p><p>åˆå§‹å°†1å·å®å¯æ¢¦æ’å…¥åˆ°setä¸­ï¼Œç„¶åéå†2-nå®å¯æ¢¦ï¼Œé€šè¿‡lower_boundå’Œupper_boundæ¥è·å¾—setä¸­â€œç›¸ç­‰â€œçš„é‚£äº›å…ƒç´ ã€‚è¿™é‡Œçš„ç›¸ç­‰æ„å‘³ç€ä¸å­˜åœ¨ä¸¥æ ¼çš„ååºå…³ç³»ï¼Œé‚£ä¹ˆä¹Ÿå°±æ„å‘³ç€ä¸¤è€…äº’ç›¸å¯ä»¥å‡»è´¥ï¼Œä»è€Œè¿™äº›å…ƒç´ éƒ½å¯ä»¥ä¸ç¬¬iä¸ªå…ƒç´ äº’ç›¸å¯è¾¾ï¼Œåº”è¯¥åˆå¹¶æˆä¸€ä¸ªSCCã€‚éå†æ‰€æœ‰è¿™äº›ç›¸ç­‰çš„å…ƒç´ ï¼Œå°†ä¿¡æ¯è¿›è¡Œä¸æ–­åˆå¹¶ï¼Œæœ€åå°†æ–°å…ƒç´ å†æ’å…¥åˆ°setä¸­ï¼Œè¿™æ ·å°±å¯ä»¥ä¿è¯setä¸­çš„ä¸¥æ ¼ååºå…³ç³»ï¼Œè¾“å‡ºç»“æœæ—¶å°†æœ€åä¸€ä¸ªå…ƒç´ çš„ä¸ªæ•°è¾“å‡ºå³å¯ã€‚</p><p>ç®—æ³•éå¸¸ç²¾å¦™ï¼Œç”±å…¶æ˜¯åˆ©ç”¨setè¿›è¡Œåˆå¹¶å’ŒæŸ¥è¯¢çš„æ“ä½œå€¼å¾—å­¦ä¹ ï¼</p><p><del>åŸæ¥setå¯ä»¥ç”¨lower/upper_boundæ¥è¿›è¡ŒäºŒåˆ†ï¼Œä¹‹å‰æˆ‘è¿˜åœ¨è‹¦æ¼åœ°æƒ³æ€ä¹ˆæ‰èƒ½åœ¨setä¸­è¿›è¡ŒäºŒåˆ†ï¼Œorz</del></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> manx = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> a[maxn][<span class="number">15</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, k;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NODE</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> m[<span class="number">10</span>], M[<span class="number">10</span>], size;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (NODE <span class="keyword">const</span> &amp;b)<span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++) <span class="keyword">if</span>(M[i] &gt; b.m[i]) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;node[maxn];</span><br><span class="line">set&lt;NODE&gt; s;</span><br><span class="line">set&lt;NODE&gt;::iterator p, q, it;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;k);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; k; j++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, node[i].m + j); node[i].size = <span class="number">1</span>;</span><br><span class="line">        node[i].M[j] = node[i].m[j];</span><br><span class="line">    &#125;</span><br><span class="line">    s.<span class="built_in">insert</span>(node[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++)&#123;</span><br><span class="line">        NODE temp = node[i];</span><br><span class="line">        p = s.<span class="built_in">lower_bound</span>(temp);</span><br><span class="line">        q = s.<span class="built_in">upper_bound</span>(temp);</span><br><span class="line">        it = p;</span><br><span class="line">        <span class="keyword">while</span>(it != q)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++)&#123;</span><br><span class="line">                temp.m[i] = <span class="built_in">min</span>(temp.m[i], it-&gt;m[i]);</span><br><span class="line">                temp.M[i] = <span class="built_in">max</span>(temp.M[i], it-&gt;M[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            temp.size += it-&gt;size;</span><br><span class="line">            s.<span class="built_in">erase</span>(it++);</span><br><span class="line">        &#125;</span><br><span class="line">        s.<span class="built_in">insert</span>(temp);</span><br><span class="line">        <span class="keyword">if</span>(i &gt;= <span class="number">1</span>) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, s.<span class="built_in">rbegin</span>()-&gt;size);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> set </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020-ç‰›å®¢å¤šæ ¡-10</title>
      <link href="/2020/08/25/2020-%E7%89%9B%E5%AE%A2%E5%A4%9A%E6%A0%A1-10/"/>
      <url>/2020/08/25/2020-%E7%89%9B%E5%AE%A2%E5%A4%9A%E6%A0%A1-10/</url>
      
        <content type="html"><![CDATA[<p>[toc]</p><span id="more"></span><h3 id="C-æ€ç»´-amp-æ ‘"><a href="#C-æ€ç»´-amp-æ ‘" class="headerlink" title="C æ€ç»´ &amp; æ ‘"></a>C æ€ç»´ &amp; æ ‘</h3><h4 id="C-Namomo-2C"><a href="#C-Namomo-2C" class="headerlink" title="C* Namomo 2C"></a>C* <a href="https://namomo.top:8081/contest/2/problem/C">Namomo 2C</a></h4><p>åŒºé—´å‡1ï¼Œä»£ä»·ä¸ºé•¿åº¦çš„å¹³æ–¹ï¼Œé—®å°†åŒºé—´æ“ä½œä¸ºå…¨0çš„æœ€å°ä»£ä»·å’Œæœ€å¤§ä»£ä»·ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line">      </span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unordered_set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;random&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;chrono&gt;</span></span></span><br><span class="line">     </span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cassert&gt;</span></span></span><br><span class="line">      </span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> itn int</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fro for</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> scnaf scanf</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sacnf scanf</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Fastin freopen(<span class="meta-string">&quot;in.txt&quot;</span>, <span class="meta-string">&quot;r&quot;</span>, stdin)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Fastout freopen(<span class="meta-string">&quot;out.txt&quot;</span>, <span class="meta-string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> manx maxn</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lowbit(x) ((x) &amp; (-x))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ceil(n, p) (((n) +(p) - 1) / (p))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DBG(x) (void)(cout &lt;&lt; <span class="meta-string">&quot;L&quot;</span> &lt;&lt; __LINE__ &lt;&lt; <span class="meta-string">&quot;: &quot;</span> &lt;&lt; #x &lt;&lt; <span class="meta-string">&quot; = &quot;</span> &lt;&lt;( x) &lt;&lt; <span class="meta-string">&#x27;\n&#x27;</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> clr(a, x) memset((a), x, sizeof (a))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> min(a, b) ((a) &lt; (b)? (a): (b))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> max(a, b) ((a) &gt; (b)? (a): (b))</span></span><br><span class="line">     </span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">     </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">   <span class="keyword">int</span> ng=<span class="number">0</span>,x=<span class="number">0</span>;</span><br><span class="line">   <span class="keyword">char</span> ch=<span class="built_in">getchar</span>();</span><br><span class="line">   <span class="keyword">for</span>(;ch&lt;<span class="string">&#x27;0&#x27;</span> || ch&gt;<span class="string">&#x27;9&#x27;</span>;ch=<span class="built_in">getchar</span>()) ng|=ch==<span class="string">&#x27;-&#x27;</span>;</span><br><span class="line">   <span class="keyword">for</span>(;ch&gt;=<span class="string">&#x27;0&#x27;</span> &amp;&amp; ch&lt;=<span class="string">&#x27;9&#x27;</span>;ch=<span class="built_in">getchar</span>()) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+ch-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">   <span class="keyword">return</span> ng?-x:x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*------------------------------------------------------------------------------------*/</span></span><br><span class="line"><span class="function">ll <span class="title">gcd</span><span class="params">(ll x, ll y)</span></span>&#123;<span class="keyword">return</span> !x? y: <span class="built_in">gcd</span>(y % x, x);&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exgcd</span><span class="params">(ll a, ll b, ll &amp;x, ll &amp;y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!b)&#123;x = <span class="number">1</span>; y = <span class="number">0</span>;<span class="keyword">return</span>;&#125;</span><br><span class="line">    <span class="built_in">exgcd</span>(b, a % b, y, x); y -= a / b * x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">qp</span><span class="params">(ll a, ll p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(p &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    ll ans = <span class="number">1</span>; <span class="keyword">while</span>(p)&#123;<span class="keyword">if</span>(p &amp; <span class="number">1</span>) ans = ans * a ; a = a * a; p &gt;&gt;= <span class="number">1</span>;&#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">qp</span><span class="params">(ll a, ll p, ll M)</span></span>&#123;</span><br><span class="line">    ll ans = <span class="number">1</span>; <span class="keyword">while</span>(p)&#123; <span class="keyword">if</span>(p &amp; <span class="number">1</span>) ans = ans * a % M; a = a * a % M; p &gt;&gt;= <span class="number">1</span>;&#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*------------------------------------------------------------------------------------*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">5e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> a[maxn], b[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">cal</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;<span class="keyword">return</span> (r - l) * <span class="number">1ll</span> * (r - l) % M;&#125;</span><br><span class="line"></span><br><span class="line">stack&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt; sta;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="keyword">int</span> n; <span class="built_in">scnaf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a + i); a[n + <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n + <span class="number">1</span>; i++) b[i] = a[i] - a[i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">while</span>(b[n + <span class="number">1</span>] == <span class="number">0</span>) n--;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> p = <span class="number">1</span>, q = <span class="number">1</span>; <span class="keyword">while</span>(b[q] &gt;= <span class="number">0</span>) q++;</span><br><span class="line">    <span class="keyword">while</span>(p &lt;= n + <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(b[p] + b[q] &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            ans += -b[q] * <span class="built_in">cal</span>(p, q); ans %= M;</span><br><span class="line">            b[p] += b[q];</span><br><span class="line">            q++; <span class="keyword">while</span>(q &lt;= n + <span class="number">1</span> &amp;&amp; b[q] &gt;= <span class="number">0</span>) q++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(b[p] + b[q] == <span class="number">0</span>)&#123;</span><br><span class="line">            ans += b[p] * <span class="built_in">cal</span>(p, q); ans %= M;</span><br><span class="line">            p++; q++; <span class="keyword">while</span>(p &lt;= n + <span class="number">1</span> &amp;&amp; b[p] &lt; <span class="number">0</span>) p++; <span class="keyword">while</span>(q &lt;= n + <span class="number">1</span> &amp;&amp; b[q] &gt;= <span class="number">0</span>) q++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            ans += b[p] * <span class="built_in">cal</span>(p, q); ans %= M;</span><br><span class="line">            b[q] += b[p];</span><br><span class="line">            p++; <span class="keyword">while</span>(p &lt;= n + <span class="number">1</span> &amp;&amp; b[p] &lt; <span class="number">0</span>) p++;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>, ans % M);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n + <span class="number">1</span>; i++) b[i] = a[i] - a[i - <span class="number">1</span>];</span><br><span class="line">    ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n + <span class="number">1</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(b[i] &gt; <span class="number">0</span>) sta.<span class="built_in">push</span>(&#123;i, b[i]&#125;);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(b[i] &lt; <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">                pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; now = sta.<span class="built_in">top</span>(); sta.<span class="built_in">pop</span>();</span><br><span class="line">                <span class="keyword">if</span>(now.second + b[i] &lt; <span class="number">0</span>)&#123;</span><br><span class="line">                    ans += now.second * <span class="built_in">cal</span>(now.first, i); ans %= M;</span><br><span class="line">                    b[i] += now.second;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span>&#123;</span><br><span class="line">                    ans += -b[i] * <span class="built_in">cal</span>(now.first, i); ans %= M;</span><br><span class="line">                    now.second += b[i];</span><br><span class="line">                    sta.<span class="built_in">push</span>(now);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="I-æ„é€ "><a href="#I-æ„é€ " class="headerlink" title="I æ„é€ "></a>I æ„é€ </h3><p><del>è™½ç„¶æ„Ÿè§‰è¿˜æ˜¯è¯´ä¸å¤ªæ¸…æ¥šqaq</del></p><p>å‡è®¾å½“å‰å°†è¦å¼•å…¥ç¬¬iä¸ªäººè¿›å…¥æ¯”èµ›ï¼Œè€ƒè™‘åœ¨æœ€ä¼˜çš„æ„é€ ä¸‹ï¼Œä¹‹å‰åœ¨åœºçš„$i - 1$ä¸ªäººä¸­<strong>æœ€å¤š</strong>æœ‰å¤šå°‘ä¸ªäººå¯ä»¥ä¸ç¬¬iäººæ¯”èµ›ã€‚å¦‚æœå·²æœ‰$j-1$ä¸ªäººè·Ÿiäººæ¯”è¿‡èµ›ï¼Œç¬¬jäººå°†è¦è·Ÿiäººæ¯”èµ›ï¼Œåˆ™è¿™æ¬¡å¯¹å†³å¯¹äºé‚£äº›å·²ç»æ¯”è¿‡èµ›çš„$j-1$äººæ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œè¿™äº›äººæœ€ç»ˆéƒ½ä¼šå› æ­¤å¤šç­‰å¾…ä¸€å¤©ï¼›è€Œå¦‚æœjäººä¸ä¸iäººæ¯”èµ›ï¼Œé‚£ä¹ˆä¸‹ä¸€è½®æ“ä½œ(<strong>æœ€å¤š</strong>æ„å‘³ç€ä¸ä¼šå†è€ƒè™‘$j + 1$äººçš„æƒ…å†µ)å°±æ˜¯å¼•å…¥ç¬¬$i+1$äººï¼Œè¿™ä¹Ÿå°±è¯´æ˜å¦‚æœè¿™æ¬¡ä¸æ¯”èµ›ï¼Œä¹‹åå°šæœªå¼•å…¥çš„$n-i$ä¸ªäººçš„è¿›åœºæ—¶é—´éƒ½ä¼šæå‰ä¸€å¤©ã€‚é‚£ä¹ˆæˆ‘ä»¬æ¯”è¾ƒä¸¤ä¸ªæ—¶é—´ï¼Œå¦‚æœ$j - 1&lt; n - i$ï¼Œå°±é€‰æ‹©æ¯”èµ›ï¼Œä¸ç„¶åˆ™ä¸æ¯”èµ›ã€‚å¯ä»¥ç›´æ¥é¡ºåºå°†jä»1åˆ°i -1è¿›è¡Œæšä¸¾è€ƒè™‘ï¼ŒåŸå› éå¸¸ç¥ç§˜ï¼Œæˆ‘æ„Ÿè§‰æˆ‘å¯èƒ½ä¸å¤ªç†è§£ã€‚å½“ä¸Šè¿°è¿‡ç¨‹é‡å¤æ“ä½œå®Œæˆåï¼Œå°†é‚£äº›æ²¡æœ‰æ¯”è¿‡çš„èµ›å†å…¨éƒ¨å®‰æ’ä¸Šå³å¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">3e2</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">bool</span> vis[maxn][maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Fastin;</span><br><span class="line">    TTT&#123;</span><br><span class="line">        <span class="built_in">clr</span>(vis, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">int</span> n; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; i; j++) <span class="keyword">if</span>(j - <span class="number">1</span> &lt; n - i)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, j, i);</span><br><span class="line">            vis[j][i] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="keyword">for</span>(<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt;= n; j++) <span class="keyword">if</span>(!vis[i][j])</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, i, j);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ„é€  </tag>
            
            <tag> æ ‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020-hduå¤šæ ¡-3</title>
      <link href="/2020/07/28/2020-hdu%E5%A4%9A%E6%A0%A1-3/"/>
      <url>/2020/07/28/2020-hdu%E5%A4%9A%E6%A0%A1-3/</url>
      
        <content type="html"><![CDATA[<p>[toc]</p><span id="more"></span><h2 id="1004-å‰ç¼€å’Œdp"><a href="#1004-å‰ç¼€å’Œdp" class="headerlink" title="1004 å‰ç¼€å’Œdp"></a>1004 å‰ç¼€å’Œdp</h2><p>é¢„å¤„ç†å‡ºå‰ç¼€å’Œï¼Œå‰ç¼€å’Œç›¸åŒçš„ä¸¤ä¸ªç‚¹ä¹‹é—´å°±å¯ä»¥åˆå¹¶æˆä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„æ•°ã€‚</p><p>ä»åå¾€å‰åˆ©ç”¨å‰ç¼€å’Œå³å¯dpå¤„ç†å‡ºæœ€å¤šçš„ä¸ªæ•°ã€‚</p><h2 id="1009-æ¨¡æ‹Ÿæ‹¬å·åŒ¹é…"><a href="#1009-æ¨¡æ‹Ÿæ‹¬å·åŒ¹é…" class="headerlink" title="1009 æ¨¡æ‹Ÿæ‹¬å·åŒ¹é…"></a>1009 æ¨¡æ‹Ÿæ‹¬å·åŒ¹é…</h2><p>å‡ºç°æœªé…å¯¹çš„å³æ‹¬å·å°±ç”¨æœ€å·¦è¾¹çš„<code>*</code>å»åŒ¹é…ï¼Œå‡ºç°æœªé…å¯¹çš„å·¦æ‹¬å·å°±ç”¨æœ€å³è¾¹çš„<code>*</code>å»åŒ¹é…ã€‚</p><p><del>å·®ä¸å¤šæ˜¯è¿™æ ·</del></p><h2 id="1005-å¹¶æŸ¥é›†-amp-è®¡æ•°"><a href="#1005-å¹¶æŸ¥é›†-amp-è®¡æ•°" class="headerlink" title="1005 å¹¶æŸ¥é›†&amp;è®¡æ•°"></a>1005 å¹¶æŸ¥é›†&amp;è®¡æ•°</h2><p>å…ˆç»Ÿè®¡ä¸€ä¸‹æ‰€æœ‰ç‚¹é›†åœ¨æ— è¾¹æ—¶çš„anså€¼ï¼Œç„¶åæ¯è¿ä¸¤ä¸ªè”é€šå—ï¼Œå°±å°†è¿™ä¸¤ä¸ªè”é€šå—ä¹‹é—´ä¹‹å‰ä¼šäº§ç”Ÿçš„è´¡çŒ®å…¨éƒ¨å‡å»å³å¯ã€‚</p><p>ä¸¤ä¸ªè”é€šå—å¯èƒ½äº§ç”Ÿçš„æƒ…å†µæœ‰ï¼š</p><ul><li><p>1å·è´¡çŒ®ä¸€ä¸ª1ï¼Œ2å·è´¡çŒ®ä¸€ä¸ª2ï¼Œåœ¨å‰©ä½™å…¶ä»–æ‰€æœ‰ç‚¹ä¸­æ‰¾ä¸€ä¸ª2</p></li><li><p>1å·è´¡çŒ®ä¸€ä¸ª2ï¼Œ2å·è´¡çŒ®ä¸€ä¸ª1ï¼Œåœ¨å‰©ä½™å…¶ä»–æ‰€æœ‰ç‚¹ä¸­æ‰¾ä¸€ä¸ª2</p></li><li><p>1å·è´¡çŒ®ä¸€ä¸ª2ï¼Œ2å·è´¡çŒ®ä¸€ä¸ª2ï¼Œåœ¨å‰©ä½™ç‚¹ä¸­éšæ„æ‰¾ä¸€ä¸ª</p></li></ul><p>é‚£ä¹ˆéšä¾¿æä¸€ä¸‹å°±è¡Œäº†ã€‚</p><p><del>æ³¨æ„ä¸è¦çˆ†int æˆ‘æ˜¯sbæˆ‘æ˜¯sbæˆ‘æ˜¯sbâ€¦</del></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> itn maxn = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> par[maxn];</span><br><span class="line">ll cnt2[maxn], cnt1[maxn], s1, s2;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;<span class="keyword">return</span> x == par[x]? x: par[x] = <span class="built_in">find</span>(par[x]);&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> r1 = <span class="built_in">find</span>(x), r2 = <span class="built_in">find</span>(y);</span><br><span class="line">    <span class="built_in">assert</span>(r1 != r2);</span><br><span class="line">    par[r2] = r1;</span><br><span class="line">    cnt2[r1] += cnt2[r2]; cnt1[r1] += cnt1[r2];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line"><span class="comment">//    Fastout;</span></span><br><span class="line">    <span class="keyword">int</span> t; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;t);  <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        <span class="keyword">int</span> n; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n); s1 = s2 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> x; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">            par[i] = i;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span>(x == <span class="number">1</span>)&#123;cnt1[i] = <span class="number">1</span>;cnt2[i] = <span class="number">0</span>; s1++;&#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;cnt2[i] = <span class="number">1</span>; cnt1[i] = <span class="number">0</span>; s2++;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        ll ans = s1 * s2 * (s2 - <span class="number">1</span>) / <span class="number">2</span> % M + s2 * (s2 - <span class="number">1</span>) * (s2 - <span class="number">2</span>) / <span class="number">6</span> % M; ans %= M;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> u, v; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">            <span class="keyword">int</span> r1 = <span class="built_in">find</span>(u), r2 = <span class="built_in">find</span>(v);</span><br><span class="line">            ll res = (cnt1[r1] * cnt2[r2] + cnt2[r1] * cnt1[r2]) * (s2 - cnt2[r1] - cnt2[r2])</span><br><span class="line">                + (cnt2[r1] * cnt2[r2]) * (s1 + s2 - cnt1[r1] - cnt2[r1] - cnt1[r2] - cnt2[r2]);</span><br><span class="line">            res %= M;</span><br><span class="line">            ans -= res; ans = (ans % M + M) % M;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">            <span class="built_in">merge</span>(u, v);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="1007-è¾¹æƒéšæœºå‡åŒ€åˆ†å¸ƒçš„å®Œå…¨å›¾ä¸Šé—®é¢˜"><a href="#1007-è¾¹æƒéšæœºå‡åŒ€åˆ†å¸ƒçš„å®Œå…¨å›¾ä¸Šé—®é¢˜" class="headerlink" title="1007 è¾¹æƒéšæœºå‡åŒ€åˆ†å¸ƒçš„å®Œå…¨å›¾ä¸Šé—®é¢˜"></a>1007 è¾¹æƒéšæœºå‡åŒ€åˆ†å¸ƒçš„å®Œå…¨å›¾ä¸Šé—®é¢˜</h2><p>å½“Vä¸EåŒé˜¶æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å †ä¼˜åŒ–çš„dijç®—æ³•$O(ElogE)$</p><p><del>ç”¨æ–æ³¢é‚£å¥‘å †å¯ä»¥é™ä½åˆ°$O(VlogV+E)$ ä¸ä¼š</del></p><p>å½“å®Œå…¨å›¾æ—¶ï¼Œåˆ™åº”è¯¥ä½¿ç”¨æœ´ç´ çš„dijç®—æ³•$O(n^2)$</p><p>åœ¨è¿™é“é¢˜ä¸­ï¼Œå› ä¸ºè¾¹æƒéšæœºå‡åˆ†åˆ†å¸ƒï¼Œæ‰€ä»¥æœ€çŸ­è·¯å¾„ä¸ä¼šå¾ˆé•¿(ä¸ªæ•°æ„ä¹‰ä¸Š)ã€‚åŒæ—¶æˆ‘ä»¬å‘ç°ï¼Œå¦‚æœä¸å µå¡å½“å‰æœ€çŸ­è·¯å¾„ä¸­çš„æŸä¸€æ¡è¾¹ï¼Œé‚£ä¹ˆä¿®æ”¹å…¶ä»–è¾¹æ˜¯ä¸ä¼šå½±å“ç»“æœçš„ã€‚å› è€Œæˆ‘ä»¬è·‘æœ€çŸ­è·¯ç®—æ³•ï¼Œæšä¸¾è·¯å¾„ä¸Šæ¯ä¸€æ¡è¾¹æ¥å µå¡ï¼Œé€’å½’åœ°åœ¨æ–°å›¾ä¸­å†æ¬¡è·‘æœ€çŸ­è·¯ï¼Œå µå¡æœ€çŸ­è·¯ä¸Šçš„æ¯ä¸€æ¡è¾¹â€¦æšä¸¾&amp;å›æº¯å³å¯å¾—åˆ°æ‰€æœ‰çš„ç»“æœï¼Œå–å‡ºæœ€é•¿çš„æœ€çŸ­è·¯ä½œä¸ºç­”æ¡ˆå³å¯ã€‚</p><p>æ—¶é—´å¤æ‚åº¦$O(T<em>n^2</em>L^k)$ å…¶ä¸­$L$æ˜¯æœ€çŸ­è·¯å¾„å¯èƒ½çš„é•¿åº¦ã€‚</p><p><del>è™½ç„¶æ²¡æœ‰æµ‹è¯•ï¼Œä½†æ˜¯Lå¤§æ¦‚æœ€å¤šå¤§æ¦‚ä¹Ÿå°±6ã€7çš„çº§åˆ«</del></p><p><del>ç„¶è€ŒwmxçœŸç®—æ³•äº†ç»“æœæ²¡æœ‰åˆå§‹åŒ–GG</del> </p><p><del>IGVA orz</del></p><h2 id="1008-è®¡ç®—å‡ ä½•ä¸å¹³é¢æ—‹è½¬"><a href="#1008-è®¡ç®—å‡ ä½•ä¸å¹³é¢æ—‹è½¬" class="headerlink" title="1008 è®¡ç®—å‡ ä½•ä¸å¹³é¢æ—‹è½¬"></a>1008 è®¡ç®—å‡ ä½•ä¸å¹³é¢æ—‹è½¬</h2><p>è½¬åŒ–æ€è·¯ï¼Œä¸è€ƒè™‘å°çƒåœ¨è¿™ä¸ªä¸‰è§’å½¢ä¸­å¦‚ä½•å¼¹å°„ï¼Œè€Œæ˜¯ç”¨ä¸‰è§’å½¢å¯†é“ºæ•´ä¸ªå¹³é¢ï¼Œé‚£ä¹ˆå°çƒåœ¨ä¸‰è§’å½¢çš„å¼¹å°„è·¯å¾„å°±å¯ä»¥é€šè¿‡å¯¹ç§°æ“ä½œå˜æˆä¸€æ¡ç›´çº¿ï¼Œé‚£ä¹ˆç°åœ¨çš„é—®é¢˜å°±æ˜¯åœ¨ä¸‰è§’å½¢å¹³é¢ä¸­æ±‚ä¸€æ¡çº¿ç¢°åˆ°ç¬¬kä¸ªäº¤ç‚¹æ—¶çš„æ—¶é—´ã€‚</p><p>äºŒåˆ†æ—¶é—´ï¼Œæ£€æŸ¥å½“å‰æ—¶é—´æ—¶åªéœ€è¦æ£€æŸ¥å½“å‰é•¿åº¦çš„çº¿æ®µä¸ä¸‰æ—å¹³è¡Œçº¿(<code>0, pi / 3, pi * 2 / 3</code>)ä¹‹é—´å„è‡ªäº¤äº†å¤šå°‘ä¸ªç‚¹ã€‚</p><p>æ£€æŸ¥<code>0</code>æ—¶åªéœ€è¦çœ‹yè½´æ–¹å‘çš„é€Ÿåº¦ï¼Œè¯¥æ–¹å‘ä¸Šçš„é•¿åº¦hèƒ½è·¨è¶Šå¤šå°‘ä¸ªå¹³è¡Œçº¿ï¼Œæ³¨æ„åˆ¤æ–­ä¸€ä¸‹æœ€å¼€å§‹çš„åŠæˆªçš„å½±å“ã€‚</p><p>æ¥ä¸‹æ¥è¦åˆ¤æ–­<code>pi / 3, pi * 2 / 3</code>çš„å¹³è¡Œçº¿æ—çš„ç›¸äº¤æƒ…å†µæ—¶ä¸éœ€è¦ä»å°çƒåˆå§‹ä½ç½®æ–œç€æ‰¾æŠ•å½±åçš„é•¿åº¦ï¼Œå¯ä»¥ç›¸å¯¹åœ°å°†åˆå§‹ä½ç½®å’Œé€Ÿåº¦æ—‹è½¬ä¸€ç•ªï¼Œè¿™æ ·å°±å¯ä»¥åŒ–å½’åˆ°å¯¹<code>0</code>çš„æƒ…å†µï¼Œè€Œå¯¹<code>0</code>çš„æƒ…å†µå¾ˆå®¹æ˜“è€ƒè™‘ï¼Œ$v_y*t$å°±æ˜¯å¹³è¡Œçº¿æ–¹å‘çš„æŠ•å½±ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> pi = <span class="built_in">acos</span>(<span class="number">-1</span>);</span><br><span class="line"><span class="keyword">double</span> l, x, y, vx, vy; <span class="keyword">int</span> k;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-8</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å°†(x, y)é€†æ—¶é’ˆæ—‹è½¬aåº¦</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">double</span> &amp;x, <span class="keyword">double</span> &amp;y, <span class="keyword">double</span> cx, <span class="keyword">double</span> cy, <span class="keyword">double</span> a)</span></span>&#123;</span><br><span class="line">    x -= cx; y -= cy;</span><br><span class="line">    <span class="keyword">double</span> cosa = <span class="built_in">cos</span>(a), sina = <span class="built_in">sin</span>(a);</span><br><span class="line">    <span class="keyword">double</span> xx = x * cosa + y * -sina;</span><br><span class="line">    <span class="keyword">double</span> yy = x * sina + y * cosa;</span><br><span class="line">    x = xx + cx; y = yy + cy;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fun</span><span class="params">(<span class="keyword">double</span> &amp;x, <span class="keyword">double</span> &amp;y, <span class="keyword">double</span> &amp;vx, <span class="keyword">double</span> &amp;vy)</span></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> cx = <span class="number">0</span>, cy = l / <span class="built_in">sqrt</span>(<span class="number">3</span>) / <span class="number">2</span>;</span><br><span class="line">    <span class="built_in">rotate</span>(x, y, cx, cy, -pi * <span class="number">2</span> / <span class="number">3</span>);</span><br><span class="line">    <span class="built_in">rotate</span>(vx, vy, <span class="number">0</span>, <span class="number">0</span>, -pi * <span class="number">2</span> / <span class="number">3</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">double</span> t, <span class="keyword">double</span> h = <span class="number">0</span>)</span></span>&#123;</span><br><span class="line">    ll cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">double</span> L = l / <span class="number">2</span> * <span class="built_in">sqrt</span>(<span class="number">3</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++)&#123;</span><br><span class="line">        h = <span class="built_in">abs</span>(vy) * t;</span><br><span class="line">        <span class="keyword">if</span>(vy &lt; <span class="number">0</span>) cnt += h &lt; y? <span class="number">0</span>: <span class="number">1</span> + (ll)((h - y) / L);</span><br><span class="line">        <span class="keyword">else</span> cnt += h &lt; L - y? <span class="number">0</span>: <span class="number">1</span> + (ll)((h - (L - y)) / L);</span><br><span class="line">        <span class="built_in">fun</span>(x, y, vx, vy);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cnt &lt; k;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="keyword">int</span> t; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;t); <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lf %lf %lf %lf %lf %d&quot;</span>, &amp;l, &amp;x, &amp;y, &amp;vx, &amp;vy, &amp;k);</span><br><span class="line">        <span class="keyword">double</span> left = <span class="number">0</span>, right = <span class="number">1e10</span>, middle;</span><br><span class="line">        <span class="keyword">while</span>(left + eps &lt; right)&#123;</span><br><span class="line">            middle = (left + right) / <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">check</span>(middle)) left = middle;</span><br><span class="line">            <span class="keyword">else</span> right = middle;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%.10f\n&quot;</span>, left);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¡ç®—å‡ ä½• </tag>
            
            <tag> å›¾è®º </tag>
            
            <tag> å¹¶æŸ¥é›† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020-ç‰›å®¢å¤šæ ¡-5</title>
      <link href="/2020/07/27/2020-%E7%89%9B%E5%AE%A2%E5%A4%9A%E6%A0%A1-5/"/>
      <url>/2020/07/27/2020-%E7%89%9B%E5%AE%A2%E5%A4%9A%E6%A0%A1-5/</url>
      
        <content type="html"><![CDATA[<p>[toc]</p><p>å‘</p><span id="more"></span><h2 id="I-æ•°å­¦æ„é€ é¢˜"><a href="#I-æ•°å­¦æ„é€ é¢˜" class="headerlink" title="I æ•°å­¦æ„é€ é¢˜"></a>I æ•°å­¦æ„é€ é¢˜</h2><p>æƒ³è¿™ç±»é¢˜çš„æ—¶å€™ä¸èƒ½å¤ªè¿‡äºä»æœ‰é™çš„è§’åº¦å»è€ƒè™‘æ— ç©·çš„è§’åº¦ï¼Œå¦‚æœç”¨æœ‰é™çš„é¢ç§¯æ‹“å±•åˆ°æ— é™çš„é¢ç§¯ï¼Œé‚£ä¹ˆæœ€å¤šå¤§æ¦‚ä¹Ÿå°±1/2, 5/9çš„æƒ…å†µï¼Œè¿™ä¸æ˜¯æœ€ä¼˜çš„ã€‚åº”è¯¥ç”¨æ— é™çš„è§‚ç‚¹å»å°è¯•æ„é€ ï¼Œè€ƒè™‘ä¸€ä¸ªé‡‘å—æœ€å¤šå¯ä»¥è´¡çŒ®å‡º4ä¸ªä¿¡æ ‡ï¼Œä¸€ä¸ªç‚¼ä¸¹ç‚‰æœ€å¤šä¹Ÿå¯ä»¥è´¡çŒ®4ä¸ªä¿¡æ ‡ï¼Œå¹¶ä¸”è®¤ä¸ºè¿™ä¸€ä¸ªé‡‘å—å’Œä¸€ä¸ªç‚¼ä¸¹ç‚‰éƒ½èƒ½åœ¨å¹³å‡çš„æ„ä¹‰ä¸‹æ»¡è¶³4ä¸ªä¿¡æ ‡çš„æ”¾ç½®æ¡ä»¶ï¼Œé‚£ä¹ˆæœ€å¥½çš„æƒ…å†µå°±æ˜¯4/6 = 2/3ã€‚</p><p>ä¸‹é¢ç»™å‡ºä¸€ç§æ„é€ æ–¹å¼ï¼Œæ–œç€æ”¾ä¸¤ä¸²1ï¼Œ2ã€3äº¤æ›¿å¡«å……åœ¨å‡¹æ§½é‡Œå³å¯ã€‚</p><h2 id="E-ç½®æ¢ä¸å¤§æ•°LCM"><a href="#E-ç½®æ¢ä¸å¤§æ•°LCM" class="headerlink" title="E ç½®æ¢ä¸å¤§æ•°LCM"></a>E ç½®æ¢ä¸å¤§æ•°LCM</h2><p>æ±‚å‡ºæ¯ä¸ªç¯é•¿åº¦çš„LCMå³å¯ï¼Œå¾—ç”¨é«˜ç²¾åº¦ï¼Œæ‰‹å†™å¤§æ•°/JAVA</p><p>å› ä¸ºè¦æ‰¾æ‰€æœ‰çš„åºåˆ—ï¼Œå¯ä»¥é€šè¿‡è‹¥å¹²æ¬¡çš„ç½®æ¢æˆä¸ºæœ‰åºåºåˆ—ï¼Œé‚£ä¹ˆå°±ç­‰ä»·äºå°†æœ‰åºåºåˆ—<code>[1, 2, ...,n]</code>é€šè¿‡åå‘ç½®æ¢å¯ä»¥å¾—åˆ°çš„ä¸åŒåºåˆ—çš„ä¸ªæ•°ï¼Œè½¬åŒ–å®Œåæ˜¾ç„¶å°±æ˜¯æ±‚æ‰€æœ‰ç¯é•¿åº¦çš„LCMäº†ã€‚</p><h2 id="D-LIS"><a href="#D-LIS" class="headerlink" title="D LIS"></a>D LIS</h2><p>ä»”ç»†è§‚å¯Ÿé¢˜ç›®ç»™çš„ä¸¤ç§æ“ä½œåå‘ç°å°±æ˜¯å°†ä¸€ä¸ªæ•°ç§»åŠ¨åˆ°å¦ä¸€ä¸ªä½ç½®ä¼šèŠ±è´¹ä¸€æ¬¡ä»£ä»·ï¼Œè¦ä½¿å¾—ç§»åŠ¨æ¬¡æ•°æœ€å°‘ä½¿å¾—æˆä¸ºä¸€ä¸ªæœ‰åºæ•°åˆ—ï¼Œé‚£ä¹ˆåªè¦æ‰¾æ‰€æœ‰èµ·ç‚¹å¼€å§‹LISæœ€é•¿æ˜¯å¤šå°‘å³å¯ã€‚å¤æ‚åº¦$O(n^2logn)$</p><h2 id="B-å¼‚æˆ–MST"><a href="#B-å¼‚æˆ–MST" class="headerlink" title="B å¼‚æˆ–MST"></a>B å¼‚æˆ–MST</h2><p>å®¹æ˜“å‘ç°ï¼Œä¸ç®¡ä¹‹å‰æ˜¯å¦æœ‰è¿›è¡Œè¿‡åˆ è¾¹åŠ è¾¹æ“ä½œï¼Œè¿æ¥ä¸¤ä¸ªç‚¹çš„è¾¹çš„æƒå€¼ä¸å˜ã€‚</p><p>é‚£ä¹ˆdfsä¸€éåŸå›¾ï¼Œç”¨æ ¹èŠ‚ç‚¹åˆ°å½“å‰èŠ‚ç‚¹è·¯å¾„ä¸Šæ‰€æœ‰è¾¹æƒçš„å¼‚æˆ–å’Œä½œä¸ºç‚¹æƒï¼Œè·‘å®Œå…¨å›¾çš„å¼‚æˆ–MSTå³å¯ã€‚</p><p>å¼‚æˆ–MSTå·²ç»æ›´æ–°åˆ°æ¨¡ç‰ˆtemplateä¸­ï¼Œé€Ÿåº¦é£å¿«ï¼Œå¸¸æ•°è¾ƒå°$O(n<em>log</em>log)$</p><p>æ€»ä½“ç®—æ³•æ€æƒ³æ˜¯boruvkaç®—æ³•ï¼Œåˆ©ç”¨åˆ‡åˆ†å®šç†è¿›è¡Œå¤šè·¯å¢å¹¿ï¼Œè¿™æ ·ä¿è¯æœ€å¤šåªè¦å¢å¹¿lognæ¬¡å³å¯åˆå¹¶åˆ°ä¸€ä¸ªè”é€šå—ã€‚è€Œåœ¨å¼‚æˆ–å›¾ä¸­æ‰¾å¢å¹¿åˆ™å¯ä»¥Onæšä¸¾æŸä¸€ä¸ªè”é€šå—ä¸­æ‰€æœ‰èŠ‚ç‚¹ï¼Œåˆ©ç”¨01trieåœ¨å…¶ä½™èŠ‚ç‚¹ä¸­Ologçš„æ‰¾æœ€å°çš„è¾¹æƒè¿›è¡Œç›¸è¿ã€‚</p><p>è™½ç„¶å¯ä»¥æœ´ç´ åœ°åœ¨trieä¸­åˆ å»å½“å‰è”é€šå—ä¸­æ‰€æœ‰ç‚¹ã€æŸ¥è¯¢æœ€çŸ­è¾¹ã€åŠ å›ä¹‹å‰è”é€šå—ä¸­æ‰€æœ‰ç‚¹ï¼ˆå¸¸æ•°å·¨å¤§ï¼‰æ¥å¤„ç†ï¼Œä½†æ˜¯åœ¨ç‰›å®¢ä¼šTLEæ‰ï¼ŒçœŸçš„éå¸¸æ…¢ã€‚ã€‚</p><p>ä¸€ç§å¾ˆå¿«çš„åŠæ³•æ˜¯åœ¨01Trieä¸Šåšæš´åŠ›æœç´¢ã€‚å¯ä»¥æ–™æƒ³ï¼Œå› ä¸ºè¦ä½¿å¾—å¼‚æˆ–åè¾¹æƒæœ€å°ï¼Œæ‰€ä»¥åœ¨01trieä¸Šä¸€å®šæ˜¯å­æ ‘çš„å­©å­ä¹‹é—´ä¼šé…å¯¹åˆ°æœ€ä¼˜çš„è¿è¾¹æƒ…å†µã€‚å› è€Œé€’å½’å¤„ç†ï¼Œå½“å¤„ç†å®ŒæŸä¸ªèŠ‚ç‚¹çš„å·¦å­æ ‘å’Œå³å­æ ‘åï¼Œæš´åŠ›æšä¸¾ä¸€è¾¹çš„å­æ ‘ï¼Œåœ¨å¦ä¸€ç«¯ç”¨01trieçš„æ€§è´¨è´ªå¿ƒåœ°æ‰¾æœ€çŸ­çš„è¾¹ï¼Œä»è€Œå®Œæˆå·¦å³å­æ ‘çš„åˆå¹¶ã€‚å¯ä»¥åŠ¨æ€ç»´æŠ¤vectorï¼Œä¹Ÿå¯ä»¥æ¯”è¾ƒæ¼‚äº®åœ°ï¼ˆè€Œä¸”é€Ÿåº¦å¿«ä¸€å€orzï¼‰åˆ©ç”¨å¾ªç¯æ¥åˆ’åˆ†å·¦å³å­æ ‘ï¼Œå…·ä½“ä»£ç å‚è§templateã€‚</p><p><del>è¿™é“é¢˜è™½ç„¶æœ‰ä¸ªå¼‚æˆ–MSTçš„çŸ¥è¯†ç‚¹ï¼Œä½†æ˜¯èƒ½æƒ³åˆ°æœ€å¼€å§‹çš„ç»“è®ºå…¶å®ä¹Ÿä¸å®¹æ˜“qaqã€‚</del></p><h2 id="C-ç”Ÿæˆå‡½æ•°-amp-æ„é€ "><a href="#C-ç”Ÿæˆå‡½æ•°-amp-æ„é€ " class="headerlink" title="C ç”Ÿæˆå‡½æ•°&amp;æ„é€ "></a>C ç”Ÿæˆå‡½æ•°&amp;æ„é€ </h2><p>æ ¹æ®ç”Ÿæˆå‡½æ•°ç†è®ºï¼Œå¯¹äºå‡½æ•°$f(x, y) = (x^1 + x^2 + â€¦)^k (y^1+y^2+â€¦)^k$ï¼Œå±•å¼€å¼ä¸­å•é¡¹å¼$x^ny^m$çš„ç³»æ•°å°±æ˜¯æ»¡è¶³$\sum a_i = n, \sum b_i=m$çš„æ‰€æœ‰å¯èƒ½çš„åºåˆ—ä¸ªæ•°ã€‚æˆ‘ä»¬å°†åºåˆ—æ‹†åˆ†æˆkç»„$(x^1+x^2â€¦)(y^1+y^2+â€¦)$æ¥çœ‹ï¼Œå‡è®¾è¯¥åºåˆ—å¯¹ç­”æ¡ˆè´¡çŒ®å‡ºäº†å•é¡¹å¼$x^iy^j$ï¼Œé‚£ä¹ˆæ­¤æ—¶å…¶ç³»æ•°è´¡çŒ®æ˜¾ç„¶åªæœ‰1ï¼Œé¢˜ç›®è¦æ±‚æ¯ä¸€å¯¹$a_i, b_i$éƒ½è¦è´¡çŒ®å‡º$min(a_i, b_i)$æ¬¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬è€ƒè™‘æ„é€ å‡ºä¸€ç§åŠæ³•ï¼Œå¯ä»¥è®©æ¯ä¸€ç»„$(x^1+x^2â€¦)(y^1+y^2+â€¦)$éƒ½èƒ½è´¡çŒ®å‡º$min(i, j)$æ¬¡$x^iy^j$ä¸ªå•é¡¹å¼ã€‚å¯ä»¥é‡‡å–å¦‚ä¸‹ç²¾å¦™çš„åŠæ³•ï¼šå°†å…¶ä¿®æ”¹ä¸º$(x^1+x^2â€¦)(y^1+y^2+â€¦)(1+xy+x^2y^2+â€¦)$ï¼Œè¿™æ ·åœ¨åŸå…ˆåºåˆ—ä¸­çš„$x^iy^j, x^{i-1}y^{j-1},x^{i-2}y^{j-2},â€¦$éƒ½ä¼šé€šè¿‡$(1+xy+x^2y^2+â€¦)$ä¸­çš„æŸä¸€é¡¹æ˜ å°„åˆ°$x^iy^j$,è€Œåºåˆ—$\{x^iy^j,x^{i-1}y^{k-1}, â€¦x^0y^{j-i}\}$çš„ä¸ªæ•°å°±æ˜¯$min(i, j)$ï¼Œè¿™æ ·ï¼Œè¿™$min(i, j)$ä¸ªå•é¡¹å¼éƒ½ä¼šè´¡çŒ®å‡º1ï¼Œæ€»å…±è´¡çŒ®å°±æ˜¯$min(i,j)$ã€‚</p><p>å°†æ‰€æœ‰çš„é¡¹å åŠ èµ·æ¥å³å¯å¾—åˆ°æœ€ç»ˆçš„ç»“æœ.ã€‚</p><p>æœ€ç»ˆè¦æ±‚çš„ç§¯å¼$\prod min(a_i, b_i) $çš„å€¼å°±æ˜¯$(x^1 + x^2 + â€¦)^k (y^1+y^2+â€¦)^k(1+xy+x^2y^2+â€¦)^k$ä¸­$x^ny^m$çš„ç³»æ•°ã€‚</p><p>æ ¹æ®ç»„åˆå…¬å¼ï¼Œæ˜“çŸ¥å…¶ç»“æœä¸º$\sum_{i=0}^{min(n-k, m-k)}(^{i+k-1}_{k-1})(^{n-i-1}_{k-1})(^{m-i-1}_{k-1})$</p><p>é¢„å¤„ç†ä¸€ä¸‹$C(n,k-1)$å³å¯ï¼Œå¤æ‚åº¦$O(Tn)$</p>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ„é€  </tag>
            
            <tag> LCM </tag>
            
            <tag> LIS </tag>
            
            <tag> Boruvka </tag>
            
            <tag> å¼‚æˆ–MST </tag>
            
            <tag> ç”Ÿæˆå‡½æ•° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020-ç‰›å®¢å¤šæ ¡-6</title>
      <link href="/2020/07/27/2020-%E7%89%9B%E5%AE%A2%E5%A4%9A%E6%A0%A1-6/"/>
      <url>/2020/07/27/2020-%E7%89%9B%E5%AE%A2%E5%A4%9A%E6%A0%A1-6/</url>
      
        <content type="html"><![CDATA[<p>[toc]</p><p>æœ‰å‘å¾…è¡¥ å…·ä½“æ•°å­¦ çº¦ç‘Ÿå¤«çš„Okåšæ³•</p><span id="more"></span><h2 id="B-çº¿æ€§æ— å…³çš„nç»´01å‘é‡ä¸ªæ•°"><a href="#B-çº¿æ€§æ— å…³çš„nç»´01å‘é‡ä¸ªæ•°" class="headerlink" title="B çº¿æ€§æ— å…³çš„nç»´01å‘é‡ä¸ªæ•°"></a>B çº¿æ€§æ— å…³çš„nç»´01å‘é‡ä¸ªæ•°</h2><p>è€ƒè™‘æ¯æ¬¡åŠ å…¥å…ƒç´ æ—¶å¯å–çš„å…ƒç´ ä¸ªæ•°ã€‚</p><p>å‡è®¾å½“å‰å·²ç»å–äº†iä¸ªçº¿æ€§æ— å…³å‘é‡ï¼Œåˆ™å®ƒä»¬å¯ä»¥å¼ å‡ºä¸€å…±$2^i$ä¸ªå‘é‡ï¼Œæ‰€ä»¥ç¬¬i + 1ä¸ªå‘é‡åªæœ‰$2^n - 2 ^ i$ç§å¯å–åŠæ³•ã€‚</p><p>å› è€Œ$f(n) = \prod_{i=0}^{n - 1}(2^n-2^i)/2^n$</p><p>æ¨å¯¼å¯å¾—é€’æ¨å…³ç³»:</p><p>$f(n) = (1 - 1/2^n)*f(n - 1)$</p><p>çº¿æ€§å¤„ç†å‡ºæ¥O1æŸ¥è¯¢å³å¯ã€‚</p><h2 id="J-çº¦ç‘Ÿå¤«å˜æ¢ä¸ç½®æ¢"><a href="#J-çº¦ç‘Ÿå¤«å˜æ¢ä¸ç½®æ¢" class="headerlink" title="J çº¦ç‘Ÿå¤«å˜æ¢ä¸ç½®æ¢"></a>J çº¦ç‘Ÿå¤«å˜æ¢ä¸ç½®æ¢</h2><p>è€ƒè™‘ä¸€ä¸ª<code>k-çº¦ç‘Ÿå¤«å˜æ¢</code>ï¼ŒæŒ‡çš„æ˜¯å°†åºåˆ—<code>1, 2, ..., n</code>å˜æ¢åˆ°<code>p1, p2, ..., pn</code>ï¼Œå…¶ä¸­<code>pi</code>è¡¨ç¤ºåœ¨çº¦ç‘Ÿå¤«è¿‡ç¨‹ä¸­ç¬¬iä¸ªå‡ºå±€çš„äººçš„æ ‡å·ã€‚</p><p>é‚£ä¹ˆåªè¦å¤„ç†å‡ºk-çº¦ç‘Ÿå¤«å˜æ¢çš„ç½®æ¢æ–¹æ¡ˆï¼Œå°±å¯ä»¥Onåœ°å¾—çŸ¥è¿›è¡Œ1e9æ¬¡k-çº¦ç‘Ÿå¤«å˜æ¢çš„ç»“æœã€‚</p><p><del>æ‰€ä»¥ä¸ºä»€ä¹ˆä¸€ç›´è®¤ä¸ºç½®æ¢çš„å¹‚æ¬¡ä¸€å®šè¦å€å¢æ¥nlognçš„åšå‡ºæ¥qaq</del></p><p>å› ä¸ºnm &lt;= 1e6,æ‰€ä»¥æ€»å…±$O(nmlogn)$å³å¯ã€‚</p><p>ä¹‹å‰ä¸ä¼šåš<a href="http://acm.xidian.edu.cn/problem.php?id=1009">xdoj1009</a>ï¼Œè¿™æ¬¡åœºä¸Šè¿˜æ˜¯ä¸ä¼šï¼Œä¸ç„¶è¿™é“é¢˜å…¶å®å¯ä»¥é£å¿«çš„è¿‡æ‰ã€‚</p><p>wmxç”¨äº†splayå¸¦å¤§å¸¸æ•°çš„å¤„ç†å‡ºäº†ä¸€æ¬¡k-çº¦ç‘Ÿå¤«å˜æ¢çš„ç»“æœï¼Œç„¶åTLEäº†ç‰›å®¢ã€‚</p><p>äº‹å®ä¸Šå¯ä»¥ç”¨çº¿æ®µæ ‘ç›´æ¥æ›´å°å¸¸æ•°çš„æŸ¥è¯¢ï¼š</p><p>çº¿æ®µæ ‘ç»´æŠ¤æ¯ä¸ªå…ƒç´ å­˜åœ¨çš„æƒ…å†µï¼Œå­˜åœ¨åˆ™èŠ‚ç‚¹å€¼ä¸º1ï¼Œä¸ç„¶åˆ™å€¼ä¸º0ï¼›æ”¯æŒå•ç‚¹ä¿®æ”¹å’ŒæŸ¥è¯¢å½“å‰ä»å­˜åœ¨äºçº¿æ®µæ ‘ä¸­çš„ç¬¬kä¸ªå…ƒç´ ã€‚</p><p>å¦‚æœå½“å‰æœ‰nä¸ªå…ƒç´ ï¼Œéœ€è¦æŸ¥è¯¢ä»å‰å¾€åç¬¬cntä¸ªï¼Œç›´æ¥ç”¨çº¿æ®µæ ‘å°±å¯ä»¥$O(logn)$æŸ¥è¯¢å‡ºè°æ˜¯ä¸‹ä¸€ä¸ªè¢«æ·˜æ±°å‡ºå±€çš„ï¼›æ¥ä¸‹æ¥è¦æ›´æ–°$cnt$çš„å€¼ï¼Œæ·˜æ±°å®Œä¸€äººååœ¨æ–°çš„$n -1$é•¿åº¦çš„åºåˆ—ä¸­è¢«æ·˜æ±°çš„äººæ˜¯è¯¥æ–°åºåˆ—çš„ç¬¬å‡ ä¸ªï¼Œç¨å¾®æ¨å¯¼ç ”ç©¶ä¸€ä¸‹å°±å¯ä»¥çŸ¥é“$cntâ€™ = (cnt + k - 2)\% (n - i) + 1$ï¼Œä»1å¼€å§‹ç¼–å·ã€‚åå¤è¿›è¡Œä¸Šè¿°æ“ä½œå³å¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ls (p &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rs ((p &lt;&lt; 1) | 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mid ((l + r) &gt;&gt; 1)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> itn maxn = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">20</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> st[maxn &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">up</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;st[p] = st[ls] + st[rs];&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k, <span class="keyword">int</span> op)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l == r &amp;&amp; l == k)&#123;</span><br><span class="line">        st[p] += op;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(k &lt;= mid) <span class="built_in">update</span>(ls, l, mid, k, op);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">update</span>(rs, mid + <span class="number">1</span>, r, k, op);</span><br><span class="line">    <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŸ¥è¯¢ç¬¬kä¸ªæ•°</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l == r)&#123; <span class="keyword">return</span> l;&#125;</span><br><span class="line">    <span class="keyword">if</span>(st[ls] &lt; k) <span class="keyword">return</span> <span class="built_in">query</span>(rs, mid + <span class="number">1</span>, r, k - st[ls]);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">query</span>(ls, l, mid, k);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> vis[maxn];</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; vec;</span><br><span class="line"><span class="keyword">int</span> p[maxn], nxt[maxn][N];</span><br><span class="line"><span class="keyword">int</span> a[maxn], temp[maxn], c[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(st, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(st[<span class="number">0</span>]) * <span class="number">4</span> * n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        c[i] = i;</span><br><span class="line">        <span class="built_in">update</span>(<span class="number">1</span>, <span class="number">1</span>, n, i, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> cnt = k;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        p[i] = <span class="built_in">query</span>(<span class="number">1</span>, <span class="number">1</span>, n, cnt);</span><br><span class="line">        <span class="built_in">update</span>(<span class="number">1</span>, <span class="number">1</span>, n, p[i], <span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">if</span>(i != n) cnt = (cnt + k - <span class="number">2</span>) % (n - i) + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) nxt[i][<span class="number">0</span>] = p[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i++) <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++)</span><br><span class="line">        nxt[j][i] = nxt[nxt[j][i - <span class="number">1</span>]][i - <span class="number">1</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) vis[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="keyword">if</span>(!vis[i])&#123;</span><br><span class="line">        vec.<span class="built_in">clear</span>(); vec.<span class="built_in">push_back</span>(i);</span><br><span class="line">        <span class="keyword">int</span> now = i;</span><br><span class="line">        <span class="keyword">while</span>(p[now] != i)&#123;</span><br><span class="line">            now = p[now]; vis[now] = <span class="number">1</span>;</span><br><span class="line">            vec.<span class="built_in">push_back</span>(now);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> len = (<span class="keyword">int</span>)vec.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">int</span> step = x % len;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> x: vec)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = N - <span class="number">1</span>; j &gt;= <span class="number">0</span>; j--) <span class="keyword">if</span>(step &amp; <span class="number">1</span> &lt;&lt; j)&#123;</span><br><span class="line">                c[x] = nxt[c[x]][j];</span><br><span class="line">            &#125;</span><br><span class="line">            temp[x] = a[c[x]];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) a[i] = temp[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) a[i] = i;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> _ = <span class="number">1</span>; _ &lt;= m; _++)&#123;</span><br><span class="line">        <span class="keyword">int</span> k, x; <span class="built_in">scnaf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;k, &amp;x);</span><br><span class="line">        <span class="built_in">update</span>(k, x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, a[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="J-gt-XDOJ-1018"><a href="#J-gt-XDOJ-1018" class="headerlink" title="J-&gt;XDOJ 1018"></a>J-&gt;XDOJ 1018</h3><p>ç•™å‘å¾…è¡¥ã€Š å…·ä½“æ•°å­¦ã€‹</p>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çº¿æ€§ç©ºé—´ </tag>
            
            <tag> çº¦ç‘Ÿå¤«ç¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020-hduå¤šæ ¡-2</title>
      <link href="/2020/07/23/2020-hdu%E5%A4%9A%E6%A0%A1-2/"/>
      <url>/2020/07/23/2020-hdu%E5%A4%9A%E6%A0%A1-2/</url>
      
        <content type="html"><![CDATA[<p>[toc]</p><span id="more"></span><h1 id="6763-1001-å¹¶æŸ¥é›†"><a href="#6763-1001-å¹¶æŸ¥é›†" class="headerlink" title="6763  1001 å¹¶æŸ¥é›†"></a>6763  1001 å¹¶æŸ¥é›†</h1><p>é¢˜ç›®å‡ºé”…äº† è™½ç„¶å¼€å±€ä¸€å †äººAçš„é£å¿«ï¼Œä½†æ˜¯åº”è¯¥éƒ½æ˜¯å‡ç®—æ³•ï¼Ÿ<del>ä¸»è¦æ˜¯å‡ºé¢˜äººç»™çš„é¢˜è§£æ˜¯å‡çš„</del></p><p>å¦‚æœä»æ¯æ¬¡éƒ½å°½å¯èƒ½åˆ é™¤æå¤§è”é€šå—çš„ç­–ç•¥æ¥è€ƒè™‘ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨å¹¶æŸ¥é›†ç»´æŠ¤ä¿¡æ¯ã€‚æ˜¾ç„¶åœ¨ä¸€ä¸ªæå¤§è”é€šå—ä¸­å¯ä»¥å°†æ¯ä¸ªèŠ‚ç‚¹åˆ å»æ‰€æœ‰æƒå€¼ä¸­çš„æœ€å°å€¼ï¼Œä¹‹åè¯¥ç‚¹æ–­è£‚ï¼Œå°†åŸè”é€šå—åˆ†æˆè‹¥å¹²ä¸ªå°è”é€šå—ï¼Œåå¤è¿›è¡Œä¸Šè¿°æ“ä½œå³å¯ã€‚æˆ‘ä»¬ç”¨å¹¶æŸ¥é›†åå‘ç»´æŠ¤è¿™ä¸ªè¿‡ç¨‹ï¼šå°†æ‰€æœ‰èŠ‚ç‚¹æŒ‰ç…§æƒå€¼ä»å¤§åˆ°å°è¿›è¡Œéå†ï¼Œå¦‚æœå½“å‰ç‚¹$u$è¿æœ‰è¾¹$<u,v>$å¹¶ä¸”æœ‰$w[v] &gt; w[u]$ï¼Œé‚£ä¹ˆå°±åœ¨å¹¶æŸ¥é›†ä¸­è¿$<root[v]->u&gt;$ ã€‚è¿™æ ·ï¼Œ æˆ‘ä»¬æœ€ç»ˆå°±ä¼šå¾—åˆ°ä¸€é¢—æœ‰æ ¹æ ‘ï¼Œå…¶ä¸ŠèŠ‚ç‚¹çš„çˆ¶å­å…³ç³»ä¹Ÿç»™å‡ºäº†åˆ å»æƒå€¼çš„æ–¹æ¡ˆã€‚æœ€ç»ˆåªéœ€è¦ç”¨<code>w[x] - w[par[x]]â€‹</code>å»æ›´æ–°ç­”æ¡ˆå³å¯ã€‚</p><p>å› ä¸ºä½¿ç”¨è·¯å¾„å‹ç¼©çš„å¹¶æŸ¥é›†ï¼Œæ‰€ä»¥è¦é¢å¤–å­˜ä¸€ä¸ªæ•°ç»„ï¼Œè¡¨ç¤ºçœŸæ­£çš„æ‹“æ‰‘ç»“æ„ä¸Šçš„çˆ¶èŠ‚ç‚¹ï¼Œç”¨äºæœ€åæ›´æ–°ç­”æ¡ˆã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">star</span>&#123;</span><span class="keyword">int</span> to, next;&#125;;</span><br><span class="line"><span class="keyword">int</span> n, m, head[maxn], top = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> w[maxn];</span><br><span class="line">star edge[maxn &lt;&lt; <span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> w[a] &gt; w[b];&#125;</span><br><span class="line"><span class="keyword">int</span> id[maxn], vis[maxn];;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> par[maxn], f[maxn];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;<span class="keyword">return</span> x == par[x]? x: par[x] = <span class="built_in">find</span>(par[x]);&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="keyword">int</span> t; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;t); <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        <span class="built_in">clr</span>(head, <span class="number">-1</span>); top = <span class="number">0</span>; <span class="built_in">clr</span>(vis, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, w + i);</span><br><span class="line">            id[i] = i; par[i] = i; f[i] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> u, v; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;u, &amp;v); <span class="built_in">add</span>(u, v); <span class="built_in">add</span>(v, u);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">sort</span>(id + <span class="number">1</span>, id + n + <span class="number">1</span>, cmp);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">            vis[id[i]] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = head[id[i]]; ~j; j = edge[j].next)&#123;</span><br><span class="line">                <span class="keyword">int</span> to = edge[j].to; <span class="keyword">if</span>(vis[to])&#123;</span><br><span class="line">                    <span class="keyword">int</span> r = <span class="built_in">find</span>(to);</span><br><span class="line">                    <span class="keyword">if</span>(r != id[i]) par[r] = f[r] = id[i];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ll ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) ans += w[i] - w[f[i]];</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="1012"><a href="#1012" class="headerlink" title="1012"></a>1012</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf = <span class="number">1e9</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">char</span> s[maxn], t[<span class="number">30</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> nxt[maxn][<span class="number">26</span>], temp[<span class="number">26</span>];</span><br><span class="line"><span class="keyword">int</span> dp[<span class="number">30</span>][<span class="number">30</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="keyword">int</span> __; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;__); <span class="keyword">while</span>(__--)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s %s&quot;</span>, s + <span class="number">1</span>, t + <span class="number">1</span>); n = (<span class="keyword">int</span>)<span class="built_in">strlen</span>(s + <span class="number">1</span>); m = (<span class="keyword">int</span>)<span class="built_in">strlen</span>(t + <span class="number">1</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++) temp[i] = inf;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = n; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">26</span>; j++) nxt[i][j] = temp[j];</span><br><span class="line">            <span class="keyword">if</span>(i) temp[s[i] - <span class="string">&#x27;a&#x27;</span>] = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> q; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;q); <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; q; i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> l, r; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;l, &amp;r);</span><br><span class="line">            <span class="comment">//dp[i][j]è¡¨ç¤ºå¤„ç†tä¸²çš„ç¬¬iä½åï¼Œå·²ç»æœ‰lcsé•¿ä¸ºjæ—¶ï¼Œsä¸²ä¸­æœ€çŸ­çš„å‰ç¼€ä½ç½®</span></span><br><span class="line">            dp[<span class="number">1</span>][<span class="number">0</span>] = l - <span class="number">1</span>; dp[<span class="number">1</span>][<span class="number">1</span>] = s[l] == t[<span class="number">1</span>]? l: nxt[l][t[<span class="number">1</span>] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= m; i++) dp[<span class="number">1</span>][i] = inf;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= m; i++)&#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= i; j++)&#123;</span><br><span class="line">                    dp[i][<span class="number">0</span>] = dp[i - <span class="number">1</span>][<span class="number">0</span>]; dp[i][j] = dp[i - <span class="number">1</span>][j];</span><br><span class="line">                    <span class="keyword">if</span>(dp[i - <span class="number">1</span>][j - <span class="number">1</span>] &lt;= r &amp;&amp; nxt[dp[i - <span class="number">1</span>][j - <span class="number">1</span>]][t[i] - <span class="string">&#x27;a&#x27;</span>] &lt;= r)</span><br><span class="line">                        dp[i][j] = <span class="built_in">min</span>(dp[i][j], nxt[dp[i - <span class="number">1</span>][j - <span class="number">1</span>]][t[i] - <span class="string">&#x27;a&#x27;</span>]);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt;= m; j++) dp[i][j] = inf;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">int</span> lcs = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) <span class="keyword">if</span>(dp[m][i] &lt;= r) lcs = i;</span><br><span class="line"></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, r - l + <span class="number">1</span> + m - <span class="number">2</span> * lcs);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line">    </span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unordered_set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;random&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;chrono&gt;</span></span></span><br><span class="line">   </span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cassert&gt;</span></span></span><br><span class="line">    </span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> itn int</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fro for</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> scnaf scanf</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sacnf scanf</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Fastin freopen(<span class="meta-string">&quot;in.txt&quot;</span>, <span class="meta-string">&quot;r&quot;</span>, stdin)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Fastout freopen(<span class="meta-string">&quot;out.txt&quot;</span>, <span class="meta-string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> manx maxn</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lowbit(x) ((x) &amp; (-x))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ceil(n, p) (((n) +(p) - 1) / (p))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DBG(x) (void)(cout &lt;&lt; <span class="meta-string">&quot;L&quot;</span> &lt;&lt; __LINE__ &lt;&lt; <span class="meta-string">&quot;: &quot;</span> &lt;&lt; #x &lt;&lt; <span class="meta-string">&quot; = &quot;</span> &lt;&lt;( x) &lt;&lt; <span class="meta-string">&#x27;\n&#x27;</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> clr(a, x) memset((a), x, sizeof (a))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> min(a, b) ((a) &lt; (b)? (a): (b))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> max(a, b) ((a) &gt; (b)? (a): (b))</span></span><br><span class="line">   </span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">   <span class="keyword">int</span> ng=<span class="number">0</span>,x=<span class="number">0</span>;</span><br><span class="line">   <span class="keyword">char</span> ch=<span class="built_in">getchar</span>();</span><br><span class="line">   <span class="keyword">for</span>(;ch&lt;<span class="string">&#x27;0&#x27;</span> || ch&gt;<span class="string">&#x27;9&#x27;</span>;ch=<span class="built_in">getchar</span>()) ng|=ch==<span class="string">&#x27;-&#x27;</span>;</span><br><span class="line">   <span class="keyword">for</span>(;ch&gt;=<span class="string">&#x27;0&#x27;</span> &amp;&amp; ch&lt;=<span class="string">&#x27;9&#x27;</span>;ch=<span class="built_in">getchar</span>()) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+ch-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">   <span class="keyword">return</span> ng?-x:x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*------------------------------------------------------------------------------------*/</span></span><br><span class="line"><span class="function">ll <span class="title">gcd</span><span class="params">(ll x, ll y)</span></span>&#123;<span class="keyword">return</span> !x? y: <span class="built_in">gcd</span>(y % x, x);&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exgcd</span><span class="params">(ll a, ll b, ll &amp;x, ll &amp;y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!b)&#123;x = <span class="number">1</span>; y = <span class="number">0</span>;<span class="keyword">return</span>;&#125;</span><br><span class="line">    <span class="built_in">exgcd</span>(b, a % b, y, x); y -= a / b * x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">qp</span><span class="params">(ll a, ll p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(p &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    ll ans = <span class="number">1</span>; <span class="keyword">while</span>(p)&#123;<span class="keyword">if</span>(p &amp; <span class="number">1</span>) ans = ans * a ; a = a * a; p &gt;&gt;= <span class="number">1</span>;&#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">qp</span><span class="params">(ll a, ll p, ll M)</span></span>&#123;</span><br><span class="line">    ll ans = <span class="number">1</span>; <span class="keyword">while</span>(p)&#123; <span class="keyword">if</span>(p &amp; <span class="number">1</span>) ans = ans * a % M; a = a * a % M; p &gt;&gt;= <span class="number">1</span>;&#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*------------------------------------------------------------------------------------*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> manx = <span class="number">2e4</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">star</span>&#123;</span><span class="keyword">int</span> to, next, a, b;&#125;;</span><br><span class="line"><span class="keyword">int</span> n, k;</span><br><span class="line"><span class="keyword">int</span> head[maxn], top = <span class="number">0</span>;</span><br><span class="line">star edge[maxn &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    edge[top].a = a; edge[top].b = b;</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ£€éªŒæ ‘ç›´å¾„&lt;=x çš„å¯èƒ½æ€§</span></span><br><span class="line">ll dp[maxn][<span class="number">25</span>], middle, h[<span class="number">25</span>], size[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> par)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> pre = <span class="number">0</span>; dp[now][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> id = head[now]; ~id; id = edge[id].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[id].to; <span class="keyword">if</span>(to == par) <span class="keyword">continue</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">dfs</span>(to, now);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= k &amp;&amp; i &lt;= pre + size[to]; i++) h[i] = middle + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= pre; i++) <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; size[to] &amp;&amp; j + i &lt;= k; j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(dp[now][i] + dp[to][j] + edge[id].a &lt;= middle)</span><br><span class="line">                h[i + j + <span class="number">1</span>] = <span class="built_in">min</span>(h[i + j + <span class="number">1</span>], <span class="built_in">max</span>(dp[now][i], dp[to][j] + edge[id].a));</span><br><span class="line">            <span class="keyword">if</span>(dp[now][i] + dp[to][j] + edge[id].b &lt;= middle)</span><br><span class="line">                h[i + j] = <span class="built_in">min</span>(h[i + j], <span class="built_in">max</span>(dp[now][i], dp[to][j] + edge[id].b));</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= pre + size[to]; i++) dp[now][i] = h[i];</span><br><span class="line">        pre += size[to];</span><br><span class="line">    &#125;</span><br><span class="line">    size[now] = pre + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="keyword">int</span> _; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;_); <span class="keyword">while</span>(_--)&#123;</span><br><span class="line">        top = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;k); <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span> * n; i++) head[i] = <span class="number">-1</span>;</span><br><span class="line">        ll M =<span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> u, v, a, b;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d %d&quot;</span>, &amp;u, &amp;v, &amp;a, &amp;b);</span><br><span class="line">            <span class="built_in">add</span>(u, v, a, b);</span><br><span class="line">            <span class="built_in">add</span>(v, u, a, b);</span><br><span class="line">            M += <span class="built_in">max</span>(a, b);</span><br><span class="line">        &#125;</span><br><span class="line">        ll left = <span class="number">1</span>, right = M;</span><br><span class="line">        <span class="keyword">while</span>(left &lt; right)&#123;</span><br><span class="line">            middle = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">            <span class="keyword">if</span>(dp[<span class="number">1</span>][k] &lt;= middle) right = middle;</span><br><span class="line">            <span class="keyword">else</span> left = middle + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, left);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>2020-hduå¤šæ ¡-1</title>
      <link href="/2020/07/22/2020-hdu%E5%A4%9A%E6%A0%A1-1/"/>
      <url>/2020/07/22/2020-hdu%E5%A4%9A%E6%A0%A1-1/</url>
      
        <content type="html"><![CDATA[<h3 id="1006"><a href="#1006" class="headerlink" title="1006"></a>1006</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> itn maxn = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m, w[maxn];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">star</span>&#123;</span><span class="keyword">int</span> to, next;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> head[maxn], top = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> du[maxn], K;</span><br><span class="line">star edge[maxn &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">unordered_map&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; mp[maxn];</span><br><span class="line">unordered_map&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; conv;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> c[<span class="number">700</span>][maxn], bitcnt = <span class="number">0</span>, zero[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> i, <span class="keyword">int</span> x, <span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(i &lt;= n)&#123; c[id][i] += x; i += <span class="built_in">lowbit</span>(i);&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(i)&#123;ans += c[id][i]; i -= <span class="built_in">lowbit</span>(i);&#125; <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bitupdate</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> key, <span class="keyword">int</span> op)</span></span>&#123;</span><br><span class="line">    <span class="built_in">assert</span>(conv.<span class="built_in">count</span>(u) == <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> id = conv[u]; <span class="built_in">add</span>(id, key, op, du[u]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å°†uèŠ‚ç‚¹çš„é‚»æ¥æƒå€¼keyçš„æ•°é‡ += op</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> key, <span class="keyword">int</span> op)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(key &gt; du[u]) <span class="keyword">return</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//ç‰¹åˆ¤æ–­0</span></span><br><span class="line">    <span class="keyword">if</span>(key == <span class="number">0</span>)&#123;</span><br><span class="line">        zero[u] += op; <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    mp[u][key] += op;</span><br><span class="line">    <span class="comment">// 1 - &gt;0</span></span><br><span class="line">    <span class="keyword">if</span>(mp[u][key] == <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="built_in">bitupdate</span>(u, key, <span class="number">-1</span>);</span><br><span class="line">        mp[u].<span class="built_in">erase</span>(key);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//0 -&gt; 1</span></span><br><span class="line">    <span class="keyword">if</span>(mp[u][key] == <span class="number">1</span> &amp;&amp; op == <span class="number">1</span>) <span class="built_in">bitupdate</span>(u, key, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ£€æŸ¥uèŠ‚ç‚¹çš„é‚»ç‚¹ä¸­ æƒå€¼xåŠå…¶ä¹‹å‰æ˜¯å¦å¡«æ»¡</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x == <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(zero[u] == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="built_in">query</span>(conv[u], x);</span><br><span class="line">    <span class="keyword">return</span> x == cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> temp[maxn];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mex</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(du[u] &lt; K)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= du[u]; i++) temp[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = head[u]; ~i; i = edge[i].next)&#123;</span><br><span class="line">            <span class="keyword">if</span>(w[edge[i].to] &gt; du[u]) <span class="keyword">continue</span>;</span><br><span class="line">            temp[w[edge[i].to]] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= du[u]; i++) <span class="keyword">if</span>(!temp[i]) <span class="keyword">return</span> i;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(zero[u] == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">int</span> left = <span class="number">0</span>, right = du[u], middle;</span><br><span class="line">        <span class="keyword">while</span>(left &lt; right)&#123;</span><br><span class="line">            middle = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">check</span>(u, middle)) left = middle + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> right = middle;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> left;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">unordered_set&lt;<span class="keyword">int</span>&gt; vec[maxn];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NODE</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> x, y;</span><br><span class="line">    <span class="built_in">NODE</span>(<span class="keyword">int</span> _x, <span class="keyword">int</span> _y)&#123;</span><br><span class="line">        x = <span class="built_in">min</span>(_x, _y);</span><br><span class="line">        y = <span class="built_in">max</span>(_x, _y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> NODE &amp;b)<span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(x != b.x) <span class="keyword">return</span> x &lt; b.x;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> y &lt; b.y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">set&lt;NODE&gt; EDGE;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="keyword">int</span> t; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;t); <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        <span class="built_in">clr</span>(head, <span class="number">-1</span>); top = <span class="number">0</span>; <span class="built_in">clr</span>(du, <span class="number">0</span>); <span class="built_in">clr</span>(zero, <span class="number">0</span>); bitcnt = <span class="number">0</span>;</span><br><span class="line">        </span><br><span class="line">        n = <span class="built_in">read</span>(); m = <span class="built_in">read</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) mp[i].<span class="built_in">clear</span>(); conv.<span class="built_in">clear</span>();</span><br><span class="line">        </span><br><span class="line">        K = <span class="built_in">sqrt</span>(m);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">            w[i] = <span class="built_in">read</span>(); vec[i].<span class="built_in">clear</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        EDGE.<span class="built_in">clear</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> u, v; u = <span class="built_in">read</span>(); v = <span class="built_in">read</span>();</span><br><span class="line">            EDGE.<span class="built_in">insert</span>(<span class="built_in">NODE</span>(u, v));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> edge: EDGE)&#123;</span><br><span class="line">            <span class="keyword">if</span>(edge.x != edge.y)&#123;</span><br><span class="line">                <span class="built_in">add</span>(edge.x, edge.y); <span class="built_in">add</span>(edge.y, edge.x);</span><br><span class="line">                du[edge.x]++; du[edge.y]++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="built_in">add</span>(edge.x, edge.y);</span><br><span class="line">                du[edge.x]++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//åªæœ‰O(sqrt(m))ä¸ªç‚¹çš„åº¦&gt;= K = sqrt(m)</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="keyword">if</span>(du[i] &gt;= K)&#123;</span><br><span class="line">            <span class="built_in">memset</span>(c[bitcnt], <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span> (c[bitcnt]));</span><br><span class="line">            conv[i] = bitcnt++;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = head[i]; ~j; j = edge[j].next)&#123;</span><br><span class="line">                <span class="keyword">int</span> to = edge[j].to; vec[to].<span class="built_in">insert</span>(i);</span><br><span class="line">                <span class="built_in">update</span>(i, w[to], <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">int</span> q; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;q); <span class="keyword">while</span>(q--)&#123;</span><br><span class="line">            itn op, x, y; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;op);</span><br><span class="line">            <span class="keyword">if</span>(op == <span class="number">1</span>)&#123;</span><br><span class="line">                x = <span class="built_in">read</span>(); y = <span class="built_in">read</span>();</span><br><span class="line">                <span class="comment">//w[x] := y;</span></span><br><span class="line">                <span class="comment">//væ˜¯æ‰€æœ‰çš„ç›¸é‚»å¤§åº¦ç‚¹</span></span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">auto</span> v: vec[x])&#123;</span><br><span class="line">                    <span class="built_in">update</span>(v, w[x], <span class="number">-1</span>);</span><br><span class="line">                    <span class="built_in">update</span>(v, y, <span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                w[x] = y;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                x = <span class="built_in">read</span>();</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">mex</span>(x));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åˆ†å— </tag>
            
            <tag> æ ‘çŠ¶æ•°ç»„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘ç»œæµ</title>
      <link href="/2020/07/14/%E7%BD%91%E7%BB%9C%E6%B5%81/"/>
      <url>/2020/07/14/%E7%BD%91%E7%BB%9C%E6%B5%81/</url>
      
        <content type="html"><![CDATA[<p>ä¸¤ä¸ªå®šç†çš„è¯æ˜</p><p><a href="https://www.cnblogs.com/cniwoq/p/9245813.html">https://www.cnblogs.com/cniwoq/p/9245813.html</a></p><p>spfaçš„ä¸€äº›è¯´æ˜</p><p><a href="https://blog.csdn.net/xiazdong/article/details/8193680">https://blog.csdn.net/xiazdong/article/details/8193680</a></p><p>dinic</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> itn maxn = <span class="number">1200</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxe = <span class="number">120000</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> ll inf = <span class="number">1ll</span> &lt;&lt; <span class="number">60</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">star</span>&#123;</span><span class="keyword">int</span> to, next, w;&#125;;</span><br><span class="line"><span class="keyword">int</span> head[maxn], top = <span class="number">0</span>;</span><br><span class="line">star edge[maxe &lt;&lt; <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    edge[top].w = w;</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> d[maxn], cur[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t, ll flow)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(flow == <span class="number">0</span> || s == t) <span class="keyword">return</span> flow;</span><br><span class="line">    </span><br><span class="line">    ll res = <span class="number">0</span>, f;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = cur[s]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        cur[s] = i;</span><br><span class="line">        <span class="keyword">if</span>(d[edge[i].to] == d[s] + <span class="number">1</span>)&#123;</span><br><span class="line">            f = <span class="built_in">dfs</span>(edge[i].to, t, <span class="built_in">min</span>(flow, (ll)edge[i].w));</span><br><span class="line">            edge[i].w -= f; edge[i ^ <span class="number">1</span>].w += f; res += f; flow -= f;</span><br><span class="line">            <span class="keyword">if</span>(flow == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">queue&lt;<span class="keyword">int</span>&gt; q, q0;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">bfs</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t)</span></span>&#123;</span><br><span class="line">    <span class="built_in">clr</span>(d, <span class="number">0</span>);</span><br><span class="line">    q = q0; q.<span class="built_in">push</span>(s);</span><br><span class="line">    cur[s] = head[s]; d[s] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())&#123;</span><br><span class="line">        <span class="keyword">int</span> now = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = head[now]; ~i; i = edge[i].next) <span class="keyword">if</span>(!d[edge[i].to] &amp;&amp; edge[i].w &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            cur[edge[i].to] = head[edge[i].to]; d[edge[i].to] = d[now] + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(edge[i].to == t) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            q.<span class="built_in">push</span>(edge[i].to);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">dinic</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t)</span></span>&#123;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">bfs</span>(s, t)) ans += <span class="built_in">dfs</span>(s, t, inf);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="built_in">clr</span>(head, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">int</span> n, m, s, t; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d %d&quot;</span>, &amp;n, &amp;m, &amp;s, &amp;t);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>, u, v, w; i &lt; m; i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;u, &amp;v, &amp;w);</span><br><span class="line">        <span class="built_in">add</span>(u, v, w); <span class="built_in">add</span>(v, u, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">dinic</span>(s, t));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>isap</p><p><a href="https://www.cnblogs.com/owenyu/p/6852664.html">https://www.cnblogs.com/owenyu/p/6852664.html</a></p><p>è¿™ä¸ªåšä¸»å¥½åƒæœ‰ä¸€ç¯‡å¸¦èŠ±æ ‘çš„è®²è§£ï¼Œä¹‹åçœ‹ä¸€ä¸‹</p><p>è¾ƒå…¨é¢çš„ç½‘ç»œæµ</p><p><a href="https://blog.csdn.net/A_Comme_Amour/article/details/79356220">https://blog.csdn.net/A_Comme_Amour/article/details/79356220</a></p><p>MCMF</p><p><a href="https://blog.csdn.net/lym940928/article/details/90209172">https://blog.csdn.net/lym940928/article/details/90209172</a></p><p>isap</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> itn maxn = <span class="number">1200</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxe = <span class="number">120000</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> ll inf = <span class="number">1ll</span> &lt;&lt; <span class="number">60</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">star</span>&#123;</span><span class="keyword">int</span> to, next, w;&#125;;</span><br><span class="line"><span class="keyword">int</span> n, m, s, t;</span><br><span class="line"><span class="keyword">int</span> head[maxn], top = <span class="number">0</span>;</span><br><span class="line">star edge[maxe &lt;&lt; <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    edge[top].w = w;</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> d[maxn], cur[maxn], gap[maxn];</span><br><span class="line"></span><br><span class="line">queue&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bfs</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t)</span></span>&#123;</span><br><span class="line">    q.<span class="built_in">push</span>(t); gap[d[t] = <span class="number">1</span>]++; cur[t] = head[t];</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())&#123;</span><br><span class="line">        <span class="keyword">int</span> now = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = head[now]; ~i; i = edge[i].next) <span class="keyword">if</span>(!d[edge[i].to])&#123;</span><br><span class="line">            gap[d[edge[i].to] = d[now] + <span class="number">1</span>]++;</span><br><span class="line">            cur[edge[i].to] = head[edge[i].to];</span><br><span class="line">            q.<span class="built_in">push</span>(edge[i].to);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> s, <span class="keyword">int</span> t, ll flow)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x == t) <span class="keyword">return</span> flow;</span><br><span class="line">    </span><br><span class="line">    ll res = <span class="number">0</span>, f;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = cur[x]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        cur[x] = i;</span><br><span class="line">        <span class="keyword">if</span>(d[x] == d[edge[i].to] + <span class="number">1</span>)&#123;</span><br><span class="line">            f = <span class="built_in">dfs</span>(edge[i].to, s, t, <span class="built_in">min</span>(flow, (ll)edge[i].w));</span><br><span class="line">            edge[i].w -= f; edge[i ^ <span class="number">1</span>].w += f; flow -= f; res += f;</span><br><span class="line">            <span class="keyword">if</span>(flow == <span class="number">0</span>) <span class="keyword">return</span> res;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!(gap[d[x]]--)) d[s] = n + <span class="number">1</span>;</span><br><span class="line">    gap[++d[x]]++; cur[x] = head[x];</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">isap</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t)</span></span>&#123;</span><br><span class="line">    <span class="built_in">bfs</span>(s, t);</span><br><span class="line">    ll ans = <span class="built_in">dfs</span>(s, s, t, inf);</span><br><span class="line">    <span class="keyword">while</span>(d[s] &lt;= n) ans += <span class="built_in">dfs</span>(s, s, t, inf);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="built_in">clr</span>(head, <span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d %d&quot;</span>, &amp;n, &amp;m, &amp;s, &amp;t);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>, u, v, w; i &lt; m; i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;u, &amp;v, &amp;w);</span><br><span class="line">        <span class="built_in">add</span>(u, v, w); <span class="built_in">add</span>(v, u, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">isap</span>(s, t));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>dinicçš„ä¼˜åŒ–</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="comment">//loj.ac/submission/321069</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç½‘ç»œæµ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020-ç‰›å®¢å¤šæ ¡-1</title>
      <link href="/2020/07/12/2020-%E7%89%9B%E5%AE%A2%E5%A4%9A%E6%A0%A1-1/"/>
      <url>/2020/07/12/2020-%E7%89%9B%E5%AE%A2%E5%A4%9A%E6%A0%A1-1/</url>
      
        <content type="html"><![CDATA[<p>[toc]</p><span id="more"></span><hr><h3 id="F-Periodicity-Lemma"><a href="#F-Periodicity-Lemma" class="headerlink" title="F Periodicity Lemma"></a>F Periodicity Lemma</h3><p>å‰å§çŸ¥ä¹ä¸“æ  <a href="https://zhuanlan.zhihu.com/which-way-did-the-bicycle-go">https://zhuanlan.zhihu.com/which-way-did-the-bicycle-go</a></p><p>å¦ä¸€ç¯‡è¯æ˜ <a href="https://zhuanlan.zhihu.com/p/89385360">https://zhuanlan.zhihu.com/p/89385360</a></p><p>åŸæ–‡ <a href="http://www.karlin.mff.cuni.cz/~holub/soubory/FineWilf.pdf">http://www.karlin.mff.cuni.cz/~holub/soubory/FineWilf.pdf</a></p><p>å®šç†å¦‚ä¸‹ï¼š</p><p>é•¿ä¸ºnçš„å­—ç¬¦ä¸²Sæœ‰å¾ªç¯èŠ‚pã€qï¼Œä¸”æ»¡è¶³p + q - gcd(p, q) &lt;= nï¼Œé‚£ä¹ˆæœ‰gcd(p, q)ä¹Ÿæ˜¯Sçš„å¾ªç¯èŠ‚ã€‚</p><p>å·²çŸ¥ä¸Šè¿°ç»“è®ºåï¼Œé‚£ä¹ˆä¸ºäº†æ¯”è¾ƒ$s^âˆ$ä¸$t^âˆ$çš„å­—å…¸åºå°±å¯ä»¥åªæ¯”è¾ƒ$|s| + |t| - gcd(|s|, |t|)$æ¬¡ã€‚</p><p><del>çœŸæ˜¯é«˜çº§çš„ç»“è®ºï¼Œè¯æ˜åŠå…¶æ•°å­¦æ€æƒ³ç•™å‘å¾…è¡¥</del></p><p>J</p><p>ä¼½é©¬å‡½æ•°</p><p>Wallisâ€™ integrals</p><p>I</p><p>ä¸€èˆ¬å›¾æœ€å¤§åŒ¹é…ï¼Ÿ</p>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>2016-icpc-beijing</title>
      <link href="/2020/07/07/2016-icpc-beijing/"/>
      <url>/2020/07/07/2016-icpc-beijing/</url>
      
        <content type="html"><![CDATA[<p>[toc]</p><span id="more"></span><hr><p><strong>H</strong></p><p>äºŒåˆ†ç­”æ¡ˆç„¶åè·‘<strong>åœ†çš„kæ¬¡äº¤</strong>å³å¯ã€‚</p><p>å› ä¸ºå­¦ä¹ å®Œkæ¬¡äº¤åç²¾ç–²åŠ›ç«­å°±ä¸å†™å®Œæ•´è¿™é“é¢˜äº†ã€‚</p><p>è´´ä¸€ä¸‹ç”¨è‡ªå·±çš„ç é£å†™çš„æ¿å­ã€‚å·²æ›´æ–°å…¥æ¨¡ç‰ˆä¸­ã€‚</p><p>ç»™å‡ºnä¸ªåœ†çš„å¹³é¢åæ ‡å’ŒåŠå¾„ï¼Œèƒ½å¤Ÿè·å¾—æ‰€æœ‰åœ†kæ¬¡äº¤çš„é¢ç§¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> manx = <span class="number">1e2</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-8</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> pi = <span class="built_in">acos</span>(<span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">sgn</span><span class="params">(<span class="keyword">double</span> x)</span></span>&#123;<span class="keyword">return</span> x &lt; -eps? <span class="number">-1</span>: x &gt; eps? <span class="number">1</span>: <span class="number">0</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">sqr</span><span class="params">(<span class="keyword">double</span> x)</span></span>&#123;<span class="keyword">return</span> x * x;&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">CIRCLE</span>&#123;</span></span><br><span class="line">    <span class="keyword">double</span> x, y, r, angle;</span><br><span class="line">    <span class="keyword">int</span> d;</span><br><span class="line">    <span class="built_in">CIRCLE</span>()&#123;d = <span class="number">1</span>; angle = <span class="number">0</span>;&#125;</span><br><span class="line">    <span class="built_in">CIRCLE</span>(<span class="keyword">double</span> _x, <span class="keyword">double</span> _y, <span class="keyword">double</span> _angle = <span class="number">0</span>, <span class="keyword">int</span> _d = <span class="number">0</span>)&#123;</span><br><span class="line">        x = _x; y = _y; angle = _angle; d = _d; r = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> CIRCLE &amp;b)<span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">sgn</span>(r - b.r) == <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">dis</span><span class="params">(CIRCLE a, CIRCLE b)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">sqrt</span>(<span class="built_in">sqr</span>(a.x - b.x) + <span class="built_in">sqr</span>(a.y - b.y));&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">cross</span><span class="params">(CIRCLE a, CIRCLE b, CIRCLE c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (b.x - a.x) * (c.y - a.y) - (b.y - a.y) * (c.x - a.x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æœ‰ä¸¤ä¸ªäº¤ç‚¹è¿”å›trueï¼Œä»¥åŠä¸¤ä¸ªäº¤ç‚¹çš„åæ ‡å’Œæ–¹ä½è§’ï¼Œp1æŒ‰ç…§é¡ºæ—¶é’ˆï¼Œp2æŒ‰ç…§é€†æ—¶é’ˆ</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cir_inter_cir</span><span class="params">(CIRCLE a, CIRCLE b, CIRCLE &amp;p1, CIRCLE &amp;p2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> d = <span class="built_in">dis</span>(a, b);</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">sgn</span>(d - a.r - b.r) &gt;= <span class="number">0</span> || <span class="built_in">sgn</span>(<span class="built_in">abs</span>(b.r - a.r) - d) &gt;= <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">double</span> cosa = (<span class="built_in">sqr</span>(a.r) + <span class="built_in">sqr</span>(d) - <span class="built_in">sqr</span>(b.r)) / (<span class="number">2</span> * a.r * d);</span><br><span class="line">    <span class="keyword">double</span> sina = <span class="built_in">sqrt</span>(<span class="built_in">max</span>(<span class="number">0.</span>, <span class="number">1.</span> - <span class="built_in">sqr</span>(cosa)));</span><br><span class="line">    <span class="comment">//æ—‹è½¬çŸ©é˜µ [cosa, -sina; sina, cosa]</span></span><br><span class="line">    p1 = p2 = a;</span><br><span class="line">    p1.x += a.r / d * ((b.x - a.x) * cosa + (b.y - a.y) * -sina);</span><br><span class="line">    p1.y += a.r / d * ((b.x - a.x) * sina + (b.y - a.y) * cosa);</span><br><span class="line">    p2.x += a.r / d * ((b.x - a.x) * cosa + (b.y - a.y) * sina);</span><br><span class="line">    p2.y += a.r / d * ((b.x - a.x) * -sina + (b.y - a.y) * cosa);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">const</span> CIRCLE &amp;a, <span class="keyword">const</span> CIRCLE &amp;b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">sgn</span>(a.angle - b.angle)) <span class="keyword">return</span> <span class="built_in">sgn</span>(a.angle - b.angle) == <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> a.d &gt; b.d;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">cal</span><span class="params">(CIRCLE a, CIRCLE p1, CIRCLE p2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> ans = <span class="built_in">sqr</span>(a.r) * (p2.angle - p1.angle) - <span class="built_in">cross</span>(a, p1, p2) + <span class="built_in">cross</span>(<span class="built_in">CIRCLE</span>(<span class="number">0</span>, <span class="number">0</span>), p1, p2);</span><br><span class="line">    <span class="keyword">return</span> ans / <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">CIRCLE dot[maxn &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">double</span> area[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cirunion</span><span class="params">(CIRCLE cir[], <span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="built_in">sort</span>(cir, cir + n);</span><br><span class="line">    <span class="comment">//è®°å½•æ¯ä¸ªåœ†è¢«å®Œå…¨è¦†ç›–çš„æ¬¡æ•°ï¼Œåˆå§‹å€¼æ˜¾ç„¶ä¸º1</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="keyword">for</span>(<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; n; j++)</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">sgn</span>(<span class="built_in">dis</span>(cir[i], cir[j]) + cir[i].r - cir[j].r) &lt;= <span class="number">0</span>) cir[i].d++;</span><br><span class="line">    CIRCLE p1, p2;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">        <span class="comment">//é’ˆå¯¹æ¯ä¸€ä¸ªåœ†è€ƒè™‘å®ƒä¸æ‰€æœ‰å…¶ä»–åœ†çš„äº¤</span></span><br><span class="line">        <span class="keyword">int</span> cnt = <span class="number">0</span>, top = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(i == j) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span>(!<span class="built_in">cir_inter_cir</span>(cir[i], cir[j], p1, p2)) <span class="keyword">continue</span>;</span><br><span class="line">            p1.angle = <span class="built_in">atan2</span>(p1.y - cir[i].y, p1.x - cir[i].x);</span><br><span class="line">            p2.angle = <span class="built_in">atan2</span>(p2.y - cir[i].y, p2.x - cir[i].x);</span><br><span class="line">            p1.d = <span class="number">-1</span>; p2.d = <span class="number">1</span>;</span><br><span class="line">            dot[top++] = p1; dot[top++] = p2;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">sgn</span>(p2.angle - p1.angle) == <span class="number">1</span>) cnt++;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//åŠ å…¥èµ·ç‚¹ç»ˆç‚¹ä½ç½®</span></span><br><span class="line">        dot[top++] = <span class="built_in">CIRCLE</span>(cir[i].x - cir[i].r, cir[i].y, -pi, <span class="number">-2</span>);</span><br><span class="line">        dot[top++] = <span class="built_in">CIRCLE</span>(cir[i].x - cir[i].r, cir[i].y, pi, <span class="number">2</span>);</span><br><span class="line">        <span class="built_in">sort</span>(dot, dot + top, cmp);</span><br><span class="line">        <span class="keyword">int</span> now = cir[i].d + cnt;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; top; j++)&#123;</span><br><span class="line">            area[now] += <span class="built_in">cal</span>(cir[i], dot[j - <span class="number">1</span>], dot[j]);</span><br><span class="line">            now += dot[j].d;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">CIRCLE cir[maxn];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="keyword">int</span> t; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;t); <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        <span class="built_in">clr</span>(area, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">int</span> n; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%lf %lf %lf&quot;</span>, &amp;cir[i].x, &amp;cir[i].y, &amp;cir[i].r);</span><br><span class="line">        <span class="built_in">cirunion</span>(cir, n);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">printf</span>(<span class="string">&quot;%.5f\n&quot;</span>, area[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><del>å› ä¸ºç½‘ä¸ŠåŸºæœ¬æ²¡æœ‰è®²è§£åªæœ‰ä»£ç ..oi-wikiç”šè‡³å¥½åƒéƒ½æ²¡æœ‰æ”¶å½•è¿™ä¸ªç®—æ³•ï¼Œæ‰€ä»¥æˆ‘å­¦äº†å¥½ä¹…æ‰â€¦</del></p><p>ä¸‹é¢æ˜¯ç®€å•çš„ä¸ªäººç†è§£</p><p>åœ¨ä¸»ç®—æ³•<code>cirunion</code>ä¸­ï¼Œå…ˆå°†åœ†æŒ‰ç…§åŠå¾„ä»å°åˆ°å¤§æ’åºï¼Œæ¥ä¸‹æ¥é¡ºåºéå†è¿™äº›åœ†ï¼Œ$O(n^2)$åœ°æ‰¾å‡ºæ¯ä¸ªåœ†è¢«å¦å¤–çš„åœ†å®Œå…¨åŒ…å«çš„æ¬¡æ•°ï¼Œä¸ºåé¢çš„è®¡ç®—ä½œå‡†å¤‡ã€‚ç„¶åæšä¸¾æ¯ä¸€ä¸ªåœ†ï¼Œè€ƒè™‘è¿™ä¸ªåœ†å‚ä¸çš„é‡å é¢ç§¯çš„æ±‚è§£ï¼šéå†å…¶ä»–æ‰€æœ‰åœ†ï¼Œè®°å½•æ‰€æœ‰çš„äº¤ç‚¹ï¼ŒåŒæ—¶è®¡ç®—å‡ºè¿™äº›äº¤ç‚¹å¯¹äºåœ†å¿ƒçš„è§’åº¦(angle)ï¼Œç»™æ¯ä¸€ä¸ªäº¤ç‚¹ä¸€ä¸ªæ ‡è®°(d)ç”¨æ¥ä¹‹åå¤„ç†é‡å çš„æ¬¡æ•°ã€‚æœ€åå¯¹è¿™äº›äº¤ç‚¹æ’åºï¼ŒæŒ‰ç…§é€†æ—¶é’ˆé¡ºåºéå†äº¤ç‚¹ï¼Œæ›´æ–°areaã€‚</p><p>æ€»ä½“æ€è·¯å¦‚ä¸Šï¼Œä½†æ˜¯å…·ä½“ç»†èŠ‚æˆ‘æ‰£äº†å¾ˆä¹…ã€‚</p><ul><li>åœ¨è®¡ç®—äº¤ç‚¹çš„æ—¶å€™ï¼Œé€šè¿‡ä½™å¼¦å®šç†è·å¾—è§’åº¦ï¼Œç„¶åæ ¹æ®æ—‹è½¬çš„çŸ©é˜µå˜æ¢å¾—åˆ°ä¸¤ä¸ªæ–¹å‘ï¼ˆé€†æ—¶é’ˆå’Œé¡ºæ—¶é’ˆï¼‰çš„äº¤ç‚¹ã€‚</li><li>atançš„å€¼åŸŸåªæœ‰<code>(-pi/2, pi/2)</code>ï¼Œæ‰€ä»¥é‡‡ç”¨äº†<code>atan2(int y, int x)</code>ï¼Œè®°å½•å¤æ•°çš„å¹…è§’ï¼ŒèŒƒå›´ä¸º<code>(-pi, pi]</code>ã€‚</li><li>æˆ‘ä»¬æŒ‰ç…§å¹…è§’angleæ’åºï¼Œé‚£ä¹ˆéå†çš„æ—¶å€™å°±æ˜¯è¿›è¡Œé€†æ—¶é’ˆçš„éå†ï¼Œä»è€Œå¦‚æœé‡åˆ°äº†é€šè¿‡é€†æ—¶é’ˆæ“ä½œå¾—åˆ°çš„äº¤ç‚¹åº”è¯¥ç½®dä¸º1ï¼Œè¡¨ç¤ºæ­¤åçš„è¿™æ®µåŒºåŸŸå¤šä¸€ä¸ªåœ†é‡å ï¼Œè€Œé‡åˆ°äº†é¡ºæ—¶é’ˆæ“ä½œå¾—åˆ°çš„äº¤ç‚¹åº”è¯¥ç½®dä¸º-1ï¼Œè¡¨ç¤ºæ­¤åè¿™ä¸ªå¼§å°±ä¸å†ç›¸äº¤äº†ï¼Œé‡å çš„åœ†å°‘ä¸€ä¸ªã€‚</li><li>åœ¨æœ€åçš„æ›´æ–°çš„æ—¶å€™ï¼Œç»´æŠ¤å½“å‰é‡å çš„åœ†çš„ä¸ªæ•°ã€‚æˆ‘ä»¬ä»-piçš„ä½ç½®å¼€å§‹é€†æ—¶é’ˆè½¬ï¼Œå› ä¸ºä¸çŸ¥é“æœ€å¼€å§‹æœ‰å¤šå°‘ä¸ªå¼§å·²ç»ç»è¿‡äº†-piè¿™ä¸ªä½ç½®ï¼Œæ‰€ä»¥ä¹‹å‰åœ¨æ›´æ–°çš„æ—¶å€™è¦è®°å½•cntå€¼ã€‚è€Œcntå€¼æ˜¯è¿™æ ·äº§ç”Ÿçš„ï¼šå› ä¸ºåœ¨ä¸Šè¿°ç®—æ³•ä¸­p1æ˜¯é¡ºæ—¶é’ˆæ„é€ å‡ºçš„äº¤ç‚¹ï¼Œp2æ˜¯é€†æ—¶é’ˆæ„é€ å‡ºçš„äº¤ç‚¹ï¼Œæ‰€ä»¥å¦‚æœä¸å­˜åœ¨<code>(-pi, pi]</code>çš„é™åˆ¶p1çš„è§’åº¦æ€»æ˜¯å¤§äºp2çš„ï¼Œä½†æ˜¯å› ä¸ºæœ‰äº†è¿™ä¸ªé™åˆ¶ï¼Œæ‰€ä»¥å¦‚æœè¿™ä¸¤ä¸ªè§’åº¦è·¨è¶Šäº†-piï¼Œå°±ä¼šå‡ºç°p2çš„è§’åº¦å¤§äºp1ï¼Œå› è€Œå°±å¯ä»¥æ ¹æ®p2çš„è§’åº¦æ˜¯å¦å¤§äºp1æ¥åˆ¤æ–­è¿™ä¸€æ¡å¼§æ˜¯å¦è·¨è¶Šäº†-piã€‚ä½†æ˜¯cntå€¼åªèƒ½è¡¨ç¤ºè·¨è¶Šäº†-piçš„å¼§ä¸ªæ•°ï¼Œå®é™…åœ¨-piå¤„ä¸ä¸€å®šæœ‰ä¸€ä¸ªäº¤ç‚¹ï¼Œè¨€ä¸‹ä¹‹æ„å°±æ˜¯èµ·ç‚¹ä¸ä¸€å®šä»-piå¼€å§‹ï¼Œé‚£ä¹ˆcntå€¼éš¾é“æ ¹æ®ç¬¬ä¸€ä¸ªç‚¹çš„è§’åº¦åŠ¨æ€å˜åŒ–ï¼Ÿå®é™…ä¸Šå¹¶ä¸éœ€è¦ï¼Œæˆ‘ä»¬æ·»åŠ ä¸¤ä¸ªå†—ä½™äº¤ç‚¹ï¼Œåæ ‡å‡ä¸º<code>(x - r, y)</code>ï¼ŒåŠå¾„æ— å…³ç´§è¦ï¼Œè§’åº¦åˆ†åˆ«ä¸º-pi, pi, då€¼åˆ†åˆ«ä¸º2, -2ã€‚è¿™æ ·å°±å¯ä»¥ä¿è¯åœ¨cmpæ¯”è¾ƒç¬¦ä¸‹è¿™ä¸¤ä¸ªç‚¹ä¸€å®šæ˜¯è¿™ä¸ªåºåˆ—çš„ç¬¬ä¸€ä¸ªæ•°å’Œæœ€åä¸€ä¸ªæ•°ã€‚é‚£ä¹ˆä»è¿™ä¸ª-piç‚¹å¼€å§‹çš„è¯ï¼Œå°±å¯ä»¥é€šè¿‡cntè½»è€Œæ˜“ä¸¾çš„å¾—çŸ¥ç›¸äº¤çš„é‚£äº›å¼§çš„ä¸ªæ•°ï¼Œå†åŠ ä¸Šå®Œå…¨è¦†ç›–å½“å‰åœ†çš„ä¸ªæ•°ï¼Œå°±å¾—åˆ°äº†åˆå€¼ã€‚ä¹‹åé‡åˆ°ä¸€ä¸ªäº¤ç‚¹å°±æ ¹æ®å®ƒçš„æ ‡è®°æ›´æ–°å½“å‰é‡å çš„ä¸ªæ•°å³å¯ã€‚</li><li>æœ€åä¸€ç‚¹æ˜¯ï¼Œå¦‚ä½•æ ¹æ®éå†ç›¸é‚»çš„ç‚¹å¯¹æ¥è·å¾—é‡å é¢ç§¯ã€‚è¿™ä¸€ä¸ªé—®é¢˜æˆ‘æƒ³äº†éå¸¸ä¹…ï¼Œå› ä¸ºä¹‹å‰æ²¡æœ‰è®¡ç®—å‡ ä½•çš„åŸºç¡€ï¼Œæ‰€ä»¥ç™¾æ€ä¸å¾—å…¶è§£ã€‚è§‚å¯Ÿcalå‡½æ•°ï¼Œå‰ä¸¤é¡¹<code>sqr(a.r) * (p2.angle - p1.angle) - cross(a, p1, p2)</code>å¾—åˆ°äº†å¼“å½¢é¢ç§¯ï¼ˆé’è§’æ—¶å› ä¸ºcrossæ˜¯æœ‰å‘é¢ç§¯æ‰€ä»¥æœ€ç»ˆç»“æœä¹Ÿæ˜¯å¼“å½¢ï¼‰ï¼Œä½†æ˜¯ç¬¬ä¸‰é¡¹â€¦åæ¥å¿½ç„¶æ„è¯†åˆ°ï¼Œå¤šè¾¹å½¢çš„é¢ç§¯å¥½åƒå°±æ˜¯é€šè¿‡ä¸æ–­åœ°å¯¹ä¸€ä¸ªå›ºå®šç‚¹æ±‚æœ‰å‘é¢ç§¯æœ€ç»ˆæ±‚å’Œå³å¯ï¼Œé‚£ä¹ˆè¿™è¾¹ä¹Ÿå°±å—åˆ°äº†å¯å‘ï¼šå¦‚æœæŸä¸ªåŒºåŸŸæœ‰è‹¥å¹²çš„åœ†é‡å å¾—åˆ°ï¼Œé‚£ä¹ˆå¯ä»¥é¢„æƒ³å°†é‚£äº›ç›¸é‚»çš„äº¤ç‚¹ç›¸è¿ï¼Œé™¤å»æ‰€æœ‰çš„å¼“å½¢ï¼Œå‰©ä¸‹çš„å°±æ˜¯ä¸€ä¸ªå¤šè¾¹å½¢çš„é¢ç§¯ï¼Œè€Œè¿™ä¸ªé¢ç§¯å°±å¯ä»¥é€šè¿‡å¯¹ä¸€ä¸ªå®šç‚¹æ±‚æœ‰å‘é¢ç§¯å¾—åˆ°ã€‚ä½†æ˜¯è¿™é‡Œå¹¶ä¸æ˜¯ä¸€æ¬¡æ€§æ±‚å‡ºæ¥æ‰€æœ‰çš„é‚»è¾¹å¯¹åº”çš„æœ‰å‘é¢ç§¯ï¼Œå› ä¸ºè¯¥ç®—æ³•éå†æ‰€æœ‰çš„åœ†ï¼Œå¹¶ä¸”ä¸Šè¿°çš„æ¯ä¸€ä¸ªé‚»è¾¹ä¸Šçš„ä¸¤ä¸ªç‚¹ä¸€å®šå±äº?</li></ul>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¡ç®—å‡ ä½• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2016-icpc-qingdao</title>
      <link href="/2020/06/30/2016-icpc-qingdao/"/>
      <url>/2020/06/30/2016-icpc-qingdao/</url>
      
        <content type="html"><![CDATA[<p>[toc]</p><p>å‚è€ƒè¯´æ˜ï¼š</p><p><a href="https://github.com/ftiasch/icpc-camp-wiki/commit/83642c220274db20ae5f86caa958029b2cbb2f9c">added saltyfish/2016 ACM/ICPC Asia Regional Qingdao Onsite.page</a></p><p><a href="https://github.com/ftiasch/icpc-camp-wiki/blob/364abdcbedef99104107d01e64152fa0e492bade/post/Post%20640.page">Fibnacci</a></p><hr><h2 id="D-æ¦‚ç‡"><a href="#D-æ¦‚ç‡" class="headerlink" title="D æ¦‚ç‡"></a>D æ¦‚ç‡</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">qp</span><span class="params">(<span class="keyword">double</span> a, <span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(p)&#123;</span><br><span class="line">        <span class="keyword">if</span>(p &amp; <span class="number">1</span>) ans *= a;</span><br><span class="line">        a *= a; p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">int</span> num[<span class="number">20</span>];</span><br><span class="line"><span class="keyword">double</span> p[<span class="number">20</span>], ans[<span class="number">20</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//é™¤äº†xç¡¬å¸å…¶ä½™ç¡¬å¸æ´»ä¸åˆ°ç¬¬kè½®çš„æ¦‚ç‡</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">sove</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(i == x) <span class="keyword">continue</span>;</span><br><span class="line">        ans *= <span class="built_in">qp</span>((<span class="number">1</span> - <span class="built_in">qp</span>(p[i], k)), num[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="keyword">int</span> t; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;t); <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">        <span class="built_in">fro</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d %lf&quot;</span>, num + i, p + i);</span><br><span class="line">            ans[i] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(n == <span class="number">1</span>) <span class="built_in">printf</span>(<span class="string">&quot;1.000000\n&quot;</span>);</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">//å®éªŒ100è½®</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">100</span>; i++) <span class="keyword">for</span>(<span class="keyword">int</span> x = <span class="number">0</span>; x &lt; n; x++)&#123;</span><br><span class="line">                ans[x] += (<span class="built_in">sove</span>(x, i) - <span class="built_in">sove</span>(x, i - <span class="number">1</span>)) * (<span class="number">1</span> - <span class="built_in">qp</span>((<span class="number">1</span> - <span class="built_in">qp</span>(p[x], i)), num[x]));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%.6f&quot;</span>, ans[i]);</span><br><span class="line">                <span class="keyword">if</span>(i != n - <span class="number">1</span>) <span class="built_in">printf</span>(<span class="string">&quot; &quot;</span>);</span><br><span class="line">                <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è€ƒè™‘æ‰€æœ‰ä¸‰å…ƒç»„ï¼Œå›¾æ˜¯è‹¥å¹²ä¸ªå›¢ä¹‹å¹¶çš„å……è¦æ¡ä»¶æ˜¯ä¸å­˜åœ¨æŸä¸ªä¸‰å…ƒç»„ä¸­æœ‰ä¸¤æ¡è¾¹ï¼ˆå®é™…ä¸Šå°±æ˜¯è¦æ»¡è¶³ä¼ é€’æ€§ï¼‰ï¼Œäºæ˜¯ä»»å–ä¸€ä¸ªæœ‰ä¸¤æ¡è¾¹çš„ä¸‰å…ƒç»„ï¼Œæšä¸¾åŠ ä¸Šå‰©ä¸‹çš„è¾¹æˆ–è€…åˆ é™¤ç°æœ‰ä¸¤æ¡è¾¹ä¹‹ä¸€ï¼Œä¿®æ”¹ä¸€æ¡è¾¹ä¹‹åä¼šæœ‰$O(n)$ä¸ªä¸‰å…ƒç»„å—å½±å“ï¼Œæš´åŠ›ä¿®æ”¹è¿™äº›ä¸‰å…ƒç»„ï¼ŒåŒæ—¶ç”¨ä¸€ä¸ªé˜Ÿåˆ—+æ—¶é—´æˆ³ç»´æŠ¤å½“å‰æœ‰ä¸¤æ¡è¾¹çš„ä¸‰å…ƒç»„ï¼Œæœ$10$æ­¥å³å¯ï¼Œå¤æ‚åº¦æ˜¯$O(n^3+n3^{10})$</p>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¦‚ç‡ </tag>
            
            <tag> å›¾è®º </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2017-ICPC-jakarta</title>
      <link href="/2020/06/27/2017-ICPC-jakarta/"/>
      <url>/2020/06/27/2017-ICPC-jakarta/</url>
      
        <content type="html"><![CDATA[<p>[toc]</p><span id="more"></span><hr><h2 id="B-åŠ¨æ€ç»´æŠ¤ä¸¤ä¸ªåºåˆ—ä¹‹é—´çš„æœ€å°å·®å€¼"><a href="#B-åŠ¨æ€ç»´æŠ¤ä¸¤ä¸ªåºåˆ—ä¹‹é—´çš„æœ€å°å·®å€¼" class="headerlink" title="B åŠ¨æ€ç»´æŠ¤ä¸¤ä¸ªåºåˆ—ä¹‹é—´çš„æœ€å°å·®å€¼"></a>B åŠ¨æ€ç»´æŠ¤ä¸¤ä¸ªåºåˆ—ä¹‹é—´çš„æœ€å°å·®å€¼</h2><p>å°è¯•å°†å›¾äºŒåˆ†æŸ“è‰²ã€‚å¦‚æœä¸èƒ½äºŒåˆ†æŸ“è‰²ï¼Œé‚£ä¹ˆä¸¤äººæ— è®ºåˆå§‹å¤„äºä»€ä¹ˆä½ç½®ä¸€å®šéƒ½æœ‰æŸç§ç­–ç•¥èµ°åˆ°åŒä¸€ä¸ªèŠ‚ç‚¹ï¼›å¦‚æœèƒ½å¤ŸäºŒåˆ†æŸ“è‰²ï¼Œé¢˜ç›®åˆ™ç­‰ä»·è½¬åŒ–æ±‚$min\{|u - v|\}, uâˆˆA, vâˆˆB$ï¼Œå¹¶ä¸”æ”¯æŒåœ¨çº¿ä¿®æ”¹ï¼Œè¿™ç§æƒ…å†µæ˜¯æˆ‘ä»¬è¦ç€é‡å¤„ç†çš„é—®é¢˜ã€‚</p><p>ä¸ºæ­¤ï¼Œåˆ©ç”¨multisetä½œä¸ºä¸€ä¸ª<strong>æœ‰åºå®¹å™¨</strong>æ¥å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚</p><p>åˆå§‹æ—¶å°†æ‰€æœ‰çš„<code>&lt;èŠ‚ç‚¹æƒå€¼ï¼ŒèŠ‚ç‚¹ç±»å‹&gt;</code>å­˜å…¥setï¼ŒæŒ‰ç…§èŠ‚ç‚¹æƒå€¼ä»å°åˆ°å¤§æ’åºã€‚æ˜¾ç„¶æœ€ä¼˜çš„ç­”æ¡ˆåªå¯èƒ½å‡ºç°åœ¨è¿™ä¸ªsetä¸­ç›¸é‚»çš„ä¸¤ä¸ªä¸åŒç±»å‹èŠ‚ç‚¹ä¹‹é—´ï¼Œå› è€Œå†å¼€è®¾å¦ä¸€ä¸ªmultisetè®°å½•ansï¼Œansçº¯ç²¹ä½œä¸ºä¸€ä¸ªå¤šé‡é›†åˆä½¿ç”¨ã€‚</p><p>æœ‰äº†å¦‚ä¸Šçš„å‡†å¤‡å·¥ä½œï¼Œæ¯æ¬¡æŸ¥è¯¢åªéœ€è¦æ‰¾å‡ºansç¬¬ä¸€ä¸ªå…ƒç´ å³å¯ï¼›è€Œä¿®æ”¹åˆ™å¤æ‚ä¸€äº›ï¼šlogåœ°æ‰¾åˆ°å°†è¦è¢«ä¿®æ”¹çš„å…ƒç´ åœ¨setä¸­çš„è¿­ä»£å™¨ä½ç½®ï¼Œæ£€æŸ¥å…¶æ˜¯å¦å·²ç»å’Œå·¦å³ä¸¤ä¸ªèŠ‚ç‚¹é…å¯¹å¹¶åœ¨ansä¸­è´¡çŒ®è¿‡äº†ç­”æ¡ˆï¼Œå¦‚æœè´¡çŒ®è¿‡åˆ™åº”è¯¥åœ¨ansä¸­åˆ å»ä¸€ä¸ªè¯¥ç­”æ¡ˆï¼Œå†æ£€æŸ¥æ˜¯å¦è¯¥ä½ç½®è¢«ç§»é™¤åå·¦å³ä¸¤ä¸ªèŠ‚ç‚¹äº’ç›¸é…å¯¹äº§ç”Ÿç­”æ¡ˆï¼Œå¦‚æœæœ‰å¯èƒ½åˆ™åº”è¯¥æ®æ­¤æ›´æ–°ansï¼›å¤„ç†å®Œä¹‹å‰çš„å½±å“åå°±å¯ä»¥åœ¨setä¸­åˆ é™¤è¯¥å€¼ï¼Œæ’å…¥æ–°å€¼ï¼›æ¥ä¸‹æ¥è€ƒè™‘æ’å…¥æ–°å€¼å¯¹setçš„å½±å“ï¼Œå¦‚æœæ’å…¥çš„å€¼å°†ä¹‹å‰ä¸¤ä¸ªé…å¯¹çš„èŠ‚ç‚¹éš”å¼€äº†ï¼Œåˆ™åº”è¯¥å°†ansä¸­å¯¹åº”çš„ç­”æ¡ˆåˆ å»ï¼Œå¦‚æœæ’å…¥çš„å€¼å’Œå·¦å³ä¸¤ä¸ªèŠ‚ç‚¹æœ‰é…å¯¹ï¼Œä¹Ÿåº”è¯¥ç›¸åº”åœ°æ›´æ–°ç­”æ¡ˆã€‚</p><p>æ€»è€Œè¨€ä¹‹ï¼Œå¯¹äºä¿®æ”¹çš„æ“ä½œå¿…é¡»è¦ä¿è¯ansé›†åˆä¸­æ˜¯ä¸€ä¸€å¯¹åº”åœ°å­˜setä¸­<strong>ä½ç½®ç›¸é‚»ä¸”ç±»å‹ä¸åŒçš„èŠ‚ç‚¹çš„å·®å€¼</strong> ã€‚</p><p>å› ä¸ºæ˜¯logå¤æ‚åº¦ï¼Œæ‰€ä»¥å¯ä»¥é£å¿«åœ°é€šè¿‡è¿™é“é¢˜ã€‚</p><p>ç„¶è€Œæœ€å¼€å§‹æ²¡æœ‰ä¿è¯ansé›†åˆæ»¡è¶³ä¸Šè¿°æ€§è´¨ï¼Œåœ¨æ’å…¥æ–°å€¼çš„æ—¶å€™è®¤ä¸ºæ—§å€¼ä¸ä¼šå½±å“åˆ°æœ€ä¼˜è§£ï¼Œå°±è´ªå›¾æ–¹ä¾¿æ²¡æœ‰åˆ é™¤è¢«éš”æ–­çš„å€¼ï¼›äº‹å®ä¸Šï¼Œè¿™æ ·å­å°±æ— æ³•ä½¿å¾—åˆ å»æ—§å€¼æ—¶ä¿è¯æ‰€æœ‰ä¸è¯¥å€¼é…å¯¹çš„ç­”æ¡ˆå…¨éƒ¨åœ¨ansä¸­è¢«åˆ é™¤ï¼Œä¼šæ®‹ç•™ä¸€äº›æ›´å°çš„ä½†æœ¬ä¸åº”è¯¥å­˜åœ¨çš„å€¼ã€‚</p><p>å¦ä¸€ä¸ªå‘ç‚¹æ˜¯ï¼Œmultisetçš„eraseæ”¯æŒè¿­ä»£å™¨åˆ é™¤å’ŒæŒ‰é”®å€¼åˆ é™¤ï¼›ä½¿ç”¨è¿­ä»£å™¨åˆ é™¤åªä¼šåˆ é™¤æŒ‡å‘çš„è¿™ä¸€é¡¹ï¼Œ<strong>è€ŒæŒ‰é”®å€¼åˆ é™¤ä¼šæŠŠæ‰€æœ‰ç­‰äºè¯¥å€¼çš„å…ƒç´ å…¨éƒ¨åˆ é™¤ï¼</strong><del>qaq</del></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> itn maxn = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> &#123;</span><span class="keyword">int</span> to, next;&#125;edge[maxn &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">int</span> head[maxn], top = <span class="number">0</span>, w[maxn];;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//-1è¡¨ç¤ºæœªæŸ“è‰²ã€‚</span></span><br><span class="line"><span class="keyword">int</span> c[maxn];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> op)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(c[now] != <span class="number">-1</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(c[now] != op) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    c[now] = op;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[now]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="built_in">check</span>(edge[i].to, !op)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NODE</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> key, type;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> NODE &amp;b)<span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(key != b.key) <span class="keyword">return</span> key &lt; b.key;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> type &lt; b.type;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">multiset&lt;NODE&gt; s;</span><br><span class="line">multiset&lt;<span class="keyword">int</span>&gt; ans;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> å¦‚æœè¦ä¿®æ”¹ä¸€ä¸ªæ•°ï¼Œåœ¨sä¸­æ‰¾åˆ°å®ƒçš„è¿­ä»£å™¨ï¼Œå°†å®ƒå¯èƒ½çš„å·²ç»äº§ç”Ÿçš„å·®å€¼(ä¸€å·¦ä¸€å³)ä»ansä¸­åˆ å»</span></span><br><span class="line"><span class="comment"> åˆ å»è¿™ä¸ªæ•°ï¼Œæ’å…¥æ–°æ•°ã€‚</span></span><br><span class="line"><span class="comment"> ä¸éœ€è¦è€ƒè™‘æ–°æ•°å¯¹åŸæœ‰ç»“æ„çš„å½±å“ï¼Œç›´æ¥ç”¨æ–°æ•°å·¦å³ä¸¤ç«¯çš„ä¿¡æ¯æ›´æ–°ans</span></span><br><span class="line"><span class="comment"> UPD: è¿™æ˜¯é”™çš„ï¼å¿…é¡»è¦è€ƒè™‘ï¼</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> å¦‚æœè¦æŸ¥è¯¢ï¼Œçœ‹ç±»å‹ã€flagç­‰ç›¸å…³ä¿¡æ¯ç›´æ¥æŸ¥è¯¢å°±è¡Œäº†...</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="built_in">clr</span>(c, <span class="number">-1</span>); <span class="built_in">clr</span>(head, <span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, w + i);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>, u, v; i &lt; m; i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">        <span class="built_in">add</span>(u, v); <span class="built_in">add</span>(v, u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> flag = <span class="built_in">check</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    multiset&lt;NODE&gt;::iterator p, q;</span><br><span class="line">    <span class="keyword">if</span>(flag)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) s.<span class="built_in">insert</span>(&#123;w[i], c[i]&#125;);</span><br><span class="line">        p = s.<span class="built_in">begin</span>(); q = s.<span class="built_in">begin</span>(); q++;</span><br><span class="line">        <span class="keyword">for</span>(; q != s.<span class="built_in">end</span>(); p++, q++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(p-&gt;type != q-&gt;type)&#123;</span><br><span class="line">                ans.<span class="built_in">insert</span>(<span class="built_in">abs</span>(p-&gt;key - q-&gt;key));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> query; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;query); <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; query; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> op, x, y; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;op, &amp;x, &amp;y);</span><br><span class="line">        <span class="keyword">if</span>(!flag)&#123;</span><br><span class="line">            <span class="keyword">if</span>(op) <span class="built_in">puts</span>(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="comment">//w[x] := y;</span></span><br><span class="line">            p = s.<span class="built_in">find</span>(&#123;w[x], c[x]&#125;);</span><br><span class="line">            NODE t1, t2; t1.type = t2.type = <span class="number">-1</span>;</span><br><span class="line">            q = p; q--; <span class="keyword">if</span>(p != s.<span class="built_in">begin</span>())&#123;</span><br><span class="line">                t1 = *q;</span><br><span class="line">                <span class="keyword">if</span>(t1.type != c[x]) ans.<span class="built_in">erase</span>(ans.<span class="built_in">find</span>(<span class="built_in">abs</span>(w[x] - t1.key)));</span><br><span class="line">            &#125;</span><br><span class="line">            q = p; q++; <span class="keyword">if</span>(q != s.<span class="built_in">end</span>())&#123;</span><br><span class="line">                t2 = *q;</span><br><span class="line">                <span class="keyword">if</span>(t2.type != c[x]) ans.<span class="built_in">erase</span>(ans.<span class="built_in">find</span>(<span class="built_in">abs</span>(w[x] - t2.key)));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(t1.type != <span class="number">-1</span> &amp;&amp; t2.type != <span class="number">-1</span> &amp;&amp; t1.type != t2.type) ans.<span class="built_in">insert</span>(<span class="built_in">abs</span>(t1.key - t2.key));</span><br><span class="line">            </span><br><span class="line">            s.<span class="built_in">erase</span>(p); w[x] = y; s.<span class="built_in">insert</span>(&#123;y, c[x]&#125;);</span><br><span class="line">            t1.type = t2.type = <span class="number">-1</span>; p = s.<span class="built_in">find</span>(&#123;w[x], c[x]&#125;);</span><br><span class="line">            q = p; q--; <span class="keyword">if</span>(p != s.<span class="built_in">begin</span>())&#123;</span><br><span class="line">                t1 = *q;</span><br><span class="line">                <span class="keyword">if</span>(t1.type != c[x]) ans.<span class="built_in">insert</span>(<span class="built_in">abs</span>(w[x] - t1.key));</span><br><span class="line">            &#125;</span><br><span class="line">            q = p; q++; <span class="keyword">if</span>(q != s.<span class="built_in">end</span>())&#123;</span><br><span class="line">                t2 = *q;</span><br><span class="line">                <span class="keyword">if</span>(t2.type != c[x]) ans.<span class="built_in">insert</span>(<span class="built_in">abs</span>(w[x] - t2.key));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(t1.type != <span class="number">-1</span> &amp;&amp; t2.type != <span class="number">-1</span> &amp;&amp; t1.type != t2.type) ans.<span class="built_in">erase</span>(ans.<span class="built_in">find</span>(<span class="built_in">abs</span>(t1.key - t2.key)));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(c[x] == c[y]) <span class="built_in">puts</span>(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, *ans.<span class="built_in">begin</span>());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="C-è´ªå¿ƒæ„é€ "><a href="#C-è´ªå¿ƒæ„é€ " class="headerlink" title="C è´ªå¿ƒæ„é€ "></a>C è´ªå¿ƒæ„é€ </h2><p>å¦‚æœæ²¡æœ‰ç­‰äºå·ï¼Œæœ€åçš„æ„é€ ä¸€ä¸‹ï¼Œæœ€ååˆ¤æ–­ä¸€ä¸‹æ˜¯å¦ç¡®å®ä¸å­˜åœ¨ç­‰äºçš„æƒ…å†µã€‚</p><p>å¦‚æœæœ‰ç­‰äºå·ï¼Œè€ƒè™‘ä»æœ€åçš„ä¸ºåŸºå‡†å¼€å§‹æ„é€ ï¼š</p><p>å› ä¸ºæ¯æ¬¡ä»ä¸¤ç«¯å¼€å§‹è¯¢é—®ä¼šä½¿å¾—å¯èƒ½çš„ç­”æ¡ˆä¸ªæ•°-1ï¼Œå› è€Œå¦‚æœå…¨éƒ¨æœ€åè¯¢é—®ï¼Œå¯èƒ½çš„ç­”æ¡ˆä¸ªæ•°å°±æ˜¯<code>n - [è¯¢é—®æ¬¡æ•°]</code> ã€‚</p><p>è€ƒè™‘æ¯ä¸€æ¬¡äºŒåˆ†éƒ½å°½å¯èƒ½å¤šæ’é™¤ä¸€äº›å¯èƒ½ç­”æ¡ˆï¼Œä½¿å¾—å‰©ä½™çš„å¯èƒ½ç­”æ¡ˆå°½å¿«ä¸º1ã€‚é‚£ä¹ˆæ˜¾è€Œæ˜“è§ï¼Œæ¯æ¬¡æ ¹æ®ä¸ç­‰å·æ–¹å‘ç¡®å®šåŒºé—´æ”¶ç¼©æ–¹å‘ï¼Œè¿›è€Œç¡®å®šæœ€è¿œæ”¶ç¼©çš„ä½ç½®ã€‚å¦‚æœæ”¶ç¼©åˆ°æœ€è¿œä½ç½®ä»ç„¶æœ‰ä¸æ­¢ä¸€ä¸ªå¯èƒ½ç­”æ¡ˆé‚£ä¹ˆå°±æœ€ä¼˜çš„é€‰æ‹©è¿™é‡Œï¼Œä¸ç„¶çš„è¯å°±å¯ä»¥é€‰æ‹©æ°å¥½ä¸º1ä¸ªç­”æ¡ˆçš„ä½ç½®è¿›è¡Œæ”¶ç¼©ã€‚å½“å‰©ä½™ç­”æ¡ˆä»…ä¸º1æ—¶ï¼Œæ¯æ¬¡å°±ä¸éœ€è¦å¤šæ’é™¤ç­”æ¡ˆäº†ï¼Œæœ€åçš„è¿›è¡Œæ’é™¤ç­”æ¡ˆå³å¯ã€‚</p><p>å› ä¸ºè¯»é¢˜æœ‰è¯¯æ²¡æœ‰æ³¨æ„åˆ°å¥‡æ•°é•¿åº¦çš„ä¸­ç‚¹ä¿è¯è¿”å›â€™&lt;â€™<del>ä»¥åŠvjä¸Šè¿™é“é¢˜çš„è¯„æµ‹æœºç‚¸äº†</del>æ‰€ä»¥åƒäº†1000å‘WA</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">5e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">char</span> s[maxn];</span><br><span class="line"></span><br><span class="line">ll n, k;</span><br><span class="line">vector&lt;ll&gt; vec;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">&quot;%lld %lld&quot;</span>, &amp;n, &amp;k))&#123;</span><br><span class="line">        vec.<span class="built_in">clear</span>();</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s); <span class="keyword">int</span> top = (<span class="keyword">int</span>)<span class="built_in">strlen</span>(s);</span><br><span class="line">        <span class="keyword">if</span>(top == k &amp;&amp; s[top - <span class="number">1</span>] != <span class="string">&#x27;=&#x27;</span>)&#123;</span><br><span class="line">            ll left = <span class="number">1</span>, right = n;</span><br><span class="line">            itn fail = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; top; i++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(s[i] == <span class="string">&#x27;&lt;&#x27;</span>)&#123;</span><br><span class="line">                    vec.<span class="built_in">push_back</span>(right); right--;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span>&#123;</span><br><span class="line">                    vec.<span class="built_in">push_back</span>(left); left++;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(left &gt; right)&#123;</span><br><span class="line">                    fail = <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(fail) <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">auto</span> x: vec) <span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>, x); <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">//çŒœåˆ°äº†</span></span><br><span class="line">            ll r = n - top;</span><br><span class="line">            <span class="keyword">if</span>(r &lt; <span class="number">0</span>) <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                ll left = <span class="number">1</span>, right = n;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; top - <span class="number">1</span>; i++)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(s[i] == <span class="string">&#x27;&gt;&#x27;</span>)&#123;</span><br><span class="line">                        ll M = (right + left - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">                        <span class="keyword">if</span>(M - left &gt;= r)&#123;</span><br><span class="line">                            vec.<span class="built_in">push_back</span>(left + r);</span><br><span class="line">                            left = left + r + <span class="number">1</span>;</span><br><span class="line">                            r = <span class="number">0</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span>&#123;</span><br><span class="line">                            vec.<span class="built_in">push_back</span>(M);</span><br><span class="line">                            r -= M - left;</span><br><span class="line">                            left = M + <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span>&#123;</span><br><span class="line">                        ll m = (left + right + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">                        <span class="keyword">if</span>(right - m &gt;= r)&#123;</span><br><span class="line">                            vec.<span class="built_in">push_back</span>(right - r);</span><br><span class="line">                            right = right - r - <span class="number">1</span>;</span><br><span class="line">                            r = <span class="number">0</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span>&#123;</span><br><span class="line">                            vec.<span class="built_in">push_back</span>(m);</span><br><span class="line">                            r -= right - m;</span><br><span class="line">                            right = m - <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(left != right) <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line">                <span class="keyword">else</span>&#123;</span><br><span class="line">                    vec.<span class="built_in">push_back</span>(left);</span><br><span class="line">                    <span class="keyword">for</span>(<span class="keyword">auto</span> x: vec) <span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>, x); <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="D"><a href="#D" class="headerlink" title="D"></a>D</h2><p>ä¹Ÿæ˜¯è¯»é¢˜æœ‰è¯¯ï¼Œä»ç­¾åˆ°é¢˜åˆ°aké¢˜</p><p>æ²¡æœ‰æ³¨æ„åˆ°ç»™å‡ºçš„æ¯ä¸€æ¡è¾¹éƒ½æ˜¯æœ‰å‘è¾¹ï¼Œæ‰€ä»¥æœ€å¼€å§‹ä¸çŸ¥é“ç”¨å“ªä¸€ç«¯å»ç²˜ï¼Œå°±ggäº†</p><p>çŸ¥é“äº†çš„è¯éšä¾¿è®°å½•ä¸€ä¸‹å‰©ä½™å¯ç”¨çš„åº¦æ•°å³å¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> itn maxn = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line">unordered_map&lt;ll, <span class="keyword">int</span>&gt; tong;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NODE</span>&#123;</span></span><br><span class="line">    ll u, v, w;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> NODE &amp;b)<span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> w &lt; b.w;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;node[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="keyword">int</span> n, m; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%lld %lld %lld&quot;</span>, &amp;node[i].u, &amp;node[i].v, &amp;node[i].w);</span><br><span class="line">    <span class="built_in">sort</span>(node, node + n);</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">fro</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(tong.<span class="built_in">count</span>(node[i].u) == <span class="number">0</span> || tong[node[i].u] == <span class="number">0</span>)&#123;</span><br><span class="line">            ans++;</span><br><span class="line">            tong[node[i].u] = m - <span class="number">1</span>;</span><br><span class="line">            tong[node[i].v] += m;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            tong[node[i].u]--;</span><br><span class="line">            tong[node[i].v] += m;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="F-æœŸæœ›dp"><a href="#F-æœŸæœ›dp" class="headerlink" title="F æœŸæœ›dp"></a>F æœŸæœ›dp</h2><p><del>ç¡®å®æ˜¯ä¸ªæ²¡æœ‰å†™è¿‡çš„æ–¹æ³•qaq</del></p><p>å…·ä½“æœ‰å“ªå‡ ä¸ªæ•°å‡ºç°è¿‡æˆ‘ä»¬ä¸ç”¨å…³å¿ƒï¼Œæˆ‘ä»¬åªéœ€è¦è®°å½•çŠ¶æ€(x, y, z)åˆ†åˆ«è¡¨ç¤ºå‡ºç°0æ¬¡ã€1æ¬¡ã€ä¸å°‘äº2æ¬¡çš„æ•°çš„æ€»ä¸ªæ•°å³å¯ã€‚</p><p>è®¾<code>dp[x][y][z]</code>è¡¨ç¤ºä»å½“å‰çŠ¶æ€å¼€å§‹åˆ°åœæœºæ‰€éœ€è¦çš„æ¬¡æ•°çš„æœŸæœ›ã€‚</p><p>å®¹æ˜“æœ‰é€’æ¨å…³ç³»</p><p>$dp[x][y][z] = 1 + \frac xn dp[x-1][y+1][z] + \frac yndp[x][y-1][z+1] + \frac zndp[x][y][z]$</p><p>æœ€å¼€å§‹çœ‹åˆ°è¿™ä¸ªå¼å­æ„Ÿåˆ°éå¸¸ç¥å¥‡</p><p>ä»”ç»†æƒ³äº†ä¸€ä¸‹æ„Ÿè§‰ç¡®å®å¾ˆç¬¦åˆæœŸæœ›çš„è¡¨è¾¾</p><p>å½“å‰çŠ¶æ€æ“ä½œ1æ¬¡åˆ†åˆ«æœ‰$\frac xn \frac yn \frac zn$çš„å‡ ç‡è½¬ç§»åˆ°ä¸Šè¿°ä¸‰ç§çŠ¶æ€ï¼Œå› è€ŒåŠ æƒ(å³è½¬ç§»çš„æ¦‚ç‡)æ±‚å’Œå†åŠ 1åå°±å¾—åˆ°å½“å‰çš„æ“ä½œæœŸæœ›ã€‚</p><p><del>è™½ç„¶å…·ä½“æ‰€ä»¥ç„¶è¯´ä¸çœŸåˆ‡ï¼Œä½†æ˜¯æ„Ÿè§‰ä¸Šè¿˜æ˜¯å¾ˆç²¾å¦™çš„</del></p><p><del>ç•™ä¸ªæœŸæœ›dpçš„å‘å¾…è¡¥</del></p><p>ä¹‹ååšä¸¤ä¸ªä¼˜åŒ–ï¼š</p><ul><li>ç”±$x + y + z = n$ ä»3ç»´ä¼˜åŒ–åˆ°2ä½</li><li>åŒ–ç®€åå‘ç°æœŸæœ›ä¹‹é—´çš„è½¬ç§»å…³ç³»ä¸$n$æˆæ­£æ¯”ï¼Œå¯ç¤ºæˆ‘ä»¬æ±‚è§£$\frac {dp}n$ çš„çŠ¶æ€ï¼Œå°†å¤æ‚åº¦ä»$O(nT)$é™ä½åˆ°$O(n)$</li></ul><p>åŒ–ç®€åå¾—åˆ°L10-12è¡Œæ‰€ç¤ºçš„å…¬å¼ï¼Œå› ä¸ºhexo-nextå¥½åƒä¸å¤ªæ”¯æŒ\fracå’Œå…¶ä»–ä¸€äº›å…¬å¼çš„ç»„åˆåµŒå¥—ï¼Œæ‰€ä»¥å°±ä¸æ”¾ä¹±ç ä¸Šæ¥äº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> itn maxn = <span class="number">3e3</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> dp[maxn][maxn];</span><br><span class="line"><span class="keyword">int</span> tong[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; maxn; j++) dp[<span class="number">0</span>][j] = dp[<span class="number">0</span>][j - <span class="number">1</span>] + <span class="number">1.0</span> / j;</span><br><span class="line">    <span class="built_in">fro</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; maxn; i++) <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; i + j &lt; maxn; j++)&#123;</span><br><span class="line">        dp[i][j] = <span class="number">1</span> + i * dp[i - <span class="number">1</span>][j + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">if</span>(j &gt;= <span class="number">1</span>) dp[i][j] += j * dp[i][j - <span class="number">1</span>];</span><br><span class="line">        dp[i][j] = dp[i][j] * <span class="number">1.0</span> / (i + j);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> t; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;t); <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        <span class="built_in">clr</span>(tong, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">int</span> n, k; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;k);</span><br><span class="line">        <span class="keyword">int</span> cnt0 = <span class="number">0</span>, cnt1 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>, x; i &lt; k; i++)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x); tong[x]++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(tong[i] == <span class="number">0</span>) cnt0++;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(tong[i] == <span class="number">1</span>) cnt1++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%.15f\n&quot;</span>, n * dp[cnt0][cnt1]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="L-çŠ¶æ€å‹ç¼©-amp-å®¹æ–¥"><a href="#L-çŠ¶æ€å‹ç¼©-amp-å®¹æ–¥" class="headerlink" title="L çŠ¶æ€å‹ç¼© &amp; å®¹æ–¥"></a>L çŠ¶æ€å‹ç¼© &amp; å®¹æ–¥</h2><p>é¢˜ç›®è¦æ±‚æ¯è¡Œéƒ½æœ‰è‡³å°‘ä¸€ä¸ªç¨»è‰äººï¼Œç›¸é‚»ä¸¤åˆ—è‡³å°‘æœ‰ä¸€ä¸ªç¨»è‰äººã€‚</p><p>æ€æƒ³ä¸æ ¡èµ›ç±»ä¼¼ï¼Œå…ˆä¼˜å…ˆè€ƒè™‘ä¸€ä¸ªï¼Œä¹‹ååˆ©ç”¨æœ´ç´ çš„å®¹æ–¥æ»¡è¶³å¦ä¸€ä¸ªã€‚</p><p>æšä¸¾è¡Œçš„å­é›†ï¼Œæ±‚è§£è¿™äº›è¡Œåªè€ƒè™‘åˆ—æ–¹å‘ä¸Šçš„çº¦æŸå…³ç³»çš„æ’åˆ—ä¸ªæ•°ã€‚å¯ä»¥ç”¨dpè¿›è¡Œ$O(m)$çš„æ±‚è§£:</p><p>$dp[i][0] = dp[i - 1][1]$</p><p>$dp[i][1] = (dp[i - 1][0] + dp[i -1][1]) * (2^{cnt_i} - 1),$</p><p>å…¶ä¸­$cnt_i$è¡¨ç¤ºç¬¬$i$åˆ—æ‹¥æœ‰ç©ºåœ°çš„ä¸ªæ•°ã€‚</p><p>è¿™é‡Œæ³¨æ„æ€»åˆ—æ•°ä¸º1çš„æ—¶å€™æœ‰<code>dp[0][0] = 0</code>ï¼Œå…¶ä½™æƒ…å†µä¸‹éƒ½æœ‰<code>dp[0][0] = 1</code>ï¼Œéœ€è¦ç‰¹åˆ¤ä¸€ä¸‹ã€‚</p><p>å› ä¸ºä»…æ»¡è¶³äº†åˆ—ä¸Šçš„çº¦æŸï¼Œæ‰€ä»¥æ±‚å¾—çš„dpå€¼æ»¡è¶³è¡Œä¸Šè¦æ±‚çš„è¡Œä¸ªæ•°è‡³å¤šä¸ºrï¼Œræ˜¯å½“å‰æšä¸¾çš„è¡Œçš„å­é›†çš„å¤§å°ã€‚</p><p>ä¸ºäº†è¦æ±‚æ°æœ‰nè¡Œï¼Œå¯ä»¥ä»&lt;=nè¡Œå‡å»æ‰€æœ‰&lt;=n-1è¡Œçš„æƒ…å†µï¼Œè¿™æ ·ä»…ä¿è¯æ‰€æœ‰æ°ä¸ºn-1çš„æƒ…å†µéƒ½è¢«ä¸é‡ä¸æ¼å¾—å‡å»ï¼Œä½†æ˜¯&lt;=n-2çš„æƒ…å†µä¼šè¢«é‡å¤å‰ªå»ï¼Œå› è€Œè¦åŠ ä¸Šæ‰€æœ‰çš„&lt;=n-2çš„æƒ…å†µâ€¦ä¹‹åä¸€åŠ ä¸€å‡ä»¥æ­¤ç±»æ¨</p><p>ä¸è¿‡è¿™æ ·è¯´æ˜æ˜¯ä¸ä¸¥è°¨çš„ï¼Œåº”è¯¥ç”¨å®¹æ–¥åŸç†è¯´æ˜ã€‚</p><p><del>ä¹‹å‰å°±æ²¡æœ‰è¡¥å®ŒçŸ¥è¯†ç‚¹ï¼Œç°åœ¨è¿˜æ˜¯ï¼Œæ‰€ä»¥å°±å…ˆç»§ç»­ğŸ¦ç€äº†ã€‚</del></p><p>æ—¶é—´å¤æ‚åº¦å¿…é¡»å‹ç¼©åœ¨$O(2^r*C)$ï¼Œå†å¤šä¸ª$r$å°±çˆ†äº†ï¼Œå¿…é¡»è¦å¦¥å–„çš„é¢„å¤„ç†æ‰è¡Œã€‚</p><p>å¦å¤–ç©ºé—´ä¹Ÿæœ‰ç‚¹ç´§(ï¼Ÿ)è¯„æµ‹æœºè¯´å¯ä»¥512MBï¼Œæœ¬åœ°è·‘ä¸‹æ¥300MBè¿˜æ˜¯å†…å­˜æº¢å‡ºã€‚ä¸è¿‡åæ¥æ„è¯†åˆ°æ²¡æœ‰å¿…è¦å­˜å‚¨æ¯æ¬¡çš„dpå€¼æœ€åå†éå†ï¼Œç›´æ¥åœ¨å¤„ç†å®Œå½“å‰çŠ¶æ€åå®æ—¶å°†ç»“æœæ·»åŠ åˆ°ç­”æ¡ˆä¸­å°±è¡Œäº†ã€‚è¿™æ ·å°±å¯ä»¥ACäº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">15</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxm = <span class="number">1e3</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> pow2[maxn];</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">char</span> mp[maxn][maxm];</span><br><span class="line"><span class="keyword">int</span> cnt[<span class="number">1</span> &lt;&lt; maxn][maxm], vis[<span class="number">1</span> &lt;&lt; maxn];</span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; nxt[<span class="number">1</span> &lt;&lt; maxn];</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; order[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">count_1</span><span class="params">(<span class="keyword">int</span> sts)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="keyword">if</span>(sts &amp; <span class="number">1</span> &lt;&lt; i) cnt++;</span><br><span class="line">    <span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ini</span><span class="params">(<span class="keyword">int</span> sts)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(vis[sts]) <span class="keyword">return</span>; vis[sts] = <span class="number">1</span>;</span><br><span class="line">    order[<span class="built_in">count_1</span>(sts)].<span class="built_in">push_back</span>(sts);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="keyword">if</span>((sts &amp; <span class="number">1</span> &lt;&lt; i) == <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(nxt[sts].first == <span class="number">-1</span>)&#123;</span><br><span class="line">            nxt[sts].first = sts | <span class="number">1</span> &lt;&lt; i;</span><br><span class="line">            nxt[sts].second = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">ini</span>(sts | <span class="number">1</span> &lt;&lt; i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ll a[maxm][<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sove</span><span class="params">(<span class="keyword">int</span> sts)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> *b = cnt[sts];</span><br><span class="line">    a[<span class="number">0</span>][<span class="number">0</span>] = m == <span class="number">1</span>? <span class="number">0</span>: <span class="number">1</span>;</span><br><span class="line">    a[<span class="number">0</span>][<span class="number">1</span>] = pow2[b[<span class="number">0</span>]] - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; m; i++)&#123;</span><br><span class="line">        a[i][<span class="number">0</span>] = a[i - <span class="number">1</span>][<span class="number">1</span>];</span><br><span class="line">        a[i][<span class="number">1</span>] = (a[i - <span class="number">1</span>][<span class="number">0</span>] + a[i - <span class="number">1</span>][<span class="number">1</span>]) % M * <span class="number">1ll</span> * (pow2[b[i]] - <span class="number">1</span>) % M;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">sgn</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> x &amp; <span class="number">1</span>? <span class="number">-1</span>: <span class="number">1</span>;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    pow2[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">fro</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; maxn; i++) pow2[i] = <span class="number">2</span> * pow2[i - <span class="number">1</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="built_in">clr</span>(nxt, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, mp[i]);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">ini</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">int</span> sts = (<span class="number">1</span> &lt;&lt; n) - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> c = <span class="number">0</span>; c &lt; m; c++) <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) cnt[sts][c] += mp[i][c] == <span class="string">&#x27;.&#x27;</span>;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = n; i &gt;= <span class="number">1</span>; i--) <span class="keyword">for</span>(<span class="keyword">auto</span> x: order[i])&#123;</span><br><span class="line">        <span class="keyword">if</span>(i != n) <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) cnt[x][i] = cnt[nxt[x].first][i] - (mp[nxt[x].second][i] == <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        <span class="built_in">sove</span>(x);</span><br><span class="line">        <span class="keyword">int</span> cnt = <span class="built_in">count_1</span>(x);</span><br><span class="line">        ans += <span class="built_in">sgn</span>(n - cnt) * (a[m - <span class="number">1</span>][<span class="number">0</span>] + a[m - <span class="number">1</span>][<span class="number">1</span>]);</span><br><span class="line">        ans = (ans % M + M) % M;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> multiset </tag>
            
            <tag> æœŸæœ›dp </tag>
            
            <tag> çŠ¶æ€å‹ç¼© </tag>
            
            <tag> å®¹æ–¥åŸç† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CF-1373E</title>
      <link href="/2020/06/27/CF-1373E/"/>
      <url>/2020/06/27/CF-1373E/</url>
      
        <content type="html"><![CDATA[<p>å…¶å®æ˜¯ä¸€é“æ¯”è¾ƒç®€å•çš„æš´åŠ›æ„é€ é¢˜ï¼ˆï¼Ÿï¼‰</p><p>ä½†æ˜¯å› ä¸ºæ²¡æœ‰å¾€è¿™æ–¹é¢å»è€ƒè™‘æ‰€ä»¥å°±â€¦</p><p><del>æ­£å¦‚ä¹‹å‰çœ‹åˆ°è¿‡ ç¬¬ä¸€ä¸ªé€ åŸå­å¼¹çš„å›½å®¶æ‰æ˜¯çœŸæ­£å‰å®³çš„ å› ä¸ºè¿™æ˜¯å¼€è¾Ÿä¸€æ¡ä»0åˆ°1çš„é“è·¯ åé¢çš„æ•ˆä»¿è€…å·²çŸ¥ç»“æœå¯è¡Œå†å»æ•ˆä»¿å°±å®¹æ˜“å¾ˆå¤š</del></p><span id="more"></span><hr><p>è¿™é“é¢˜ä¸­æœ€éº»çƒ¦çš„åœ°æ–¹åœ¨äºå¦‚æœäº§ç”Ÿè¿›ä½ä¼šå¦‚ä½•å½±å“ç»“æœã€‚</p><p>å¦‚æœä¸€ä¸ªæ•°æœ«å°¾æœ‰è¿ç»­kä¸ª9ï¼Œé‚£ä¹ˆå¯¹å…¶åŠ 1åå…¶æ•°ç ä¹‹å’Œä¼šå˜åŒ–<code>+1 - 9k</code>ã€‚</p><p>å¾—çŸ¥è¿™ä¸ªè§„å¾‹åå°±å¯ä»¥å°†$f(x) + f(x + 1) + â€¦+f(x + k)$å†™æˆ</p><p>$(k + 1) <em> f(x) + \frac{k </em> (k + 1)}{2} - 9 <em> cnt </em> k$</p><p>å…¶ä¸­ï¼Œ$cnt$è¡¨ç¤º$f(x)â€¦f(x +k)$å…¶ä¸­ä¼šäº§ç”Ÿè¿›ä½çš„æ•°å­—çš„ä¸ªæ•°ï¼Œ$k$è¡¨ç¤ºè¿›ä½åä¼šå—åˆ°å½±å“çš„9çš„ä¸ªæ•°ã€‚</p><p>å½“æˆ‘ä»¬æšä¸¾nã€kæ—¶ï¼Œå¯ä»¥å†æšä¸¾<strong>cnt</strong>ï¼ˆå› ä¸ºkå·²ç»ç»™å®šï¼Œæ‰€ä»¥åªæœ‰æœ«å°¾æ•°å­—digå½±å“cntçš„å€¼ï¼Œå› è€Œæšä¸¾cntå³æšä¸¾digï¼‰ä»¥åŠ<strong>k</strong>ï¼Œæ¯æ¬¡çœ‹æ˜¯å¦å­˜åœ¨ä¸€ä¸ª$f(x)$æ»¡è¶³ç­‰å¼æ¡ä»¶ã€‚å¦‚æœæ»¡è¶³æ•´é™¤æ¡ä»¶ï¼Œå°±åˆ©ç”¨å‚æ•°$cnt(dig)ã€kã€f(x)$è¿›è¡Œæ„é€ å¹¶æ›´æ–°ç­”æ¡ˆã€‚</p><p>æ¯æ¬¡æ„é€ å…ˆç”¨$digã€k$å¡«å……ä½ä½ï¼Œç„¶åæ ¹æ®å‰©ä½™çš„æ•°ç å’Œæ„é€ é«˜ä½ã€‚æ˜¾ç„¶ä¼˜å…ˆå¡«å¤Ÿ9ï¼Œè®©æ€»ä½æ•°å°½å¯èƒ½æœ€å°ï¼›å½“å‰©ä½™æ•°ç ä¸è¶…è¿‡9æ—¶ï¼Œç›´æ¥å¡«å…¥è¯¥æ•°ç å³å¯ã€‚æœ‰ä¸€ä¸ªè¦æ³¨æ„çš„åœ°æ–¹ï¼Œå› ä¸ºæšä¸¾çš„$k$æ˜¯æœ«å°¾è¿ç»­9çš„ä¸ªæ•°ï¼Œæ‰€ä»¥å½“å¡«å……å®Œ$dig$å’Œ$k$ä¸ª9åï¼Œä¸‹ä¸€ä½ä¸èƒ½ç»§ç»­å¡«9ï¼Œè€Œåº”è¯¥ç”¨8å»å¡«å……ä½œä¸ºåˆ†å‰²ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">200</span>;</span><br><span class="line"><span class="keyword">const</span> ll inf = <span class="number">1ll</span> &lt;&lt; <span class="number">62</span>;</span><br><span class="line">ll ans[maxn][<span class="number">15</span>];</span><br><span class="line"></span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; vec;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">make</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> k, <span class="keyword">int</span> last, <span class="keyword">int</span> num, <span class="keyword">int</span> sum)</span></span>&#123;</span><br><span class="line">    sum -= last; sum -= <span class="number">9</span> * num;</span><br><span class="line">    vec.<span class="built_in">clear</span>(); vec.<span class="built_in">push_back</span>(last);</span><br><span class="line">    <span class="keyword">while</span>(num--) vec.<span class="built_in">push_back</span>(<span class="number">9</span>);</span><br><span class="line">    <span class="keyword">if</span>(sum &lt; <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(sum &gt;= <span class="number">8</span>)&#123;</span><br><span class="line">        <span class="comment">//ä½œä¸ºåˆ†å‰²ç¬¦</span></span><br><span class="line">        vec.<span class="built_in">push_back</span>(<span class="number">8</span>);</span><br><span class="line">        sum -= <span class="number">8</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(sum &gt; <span class="number">9</span>)&#123;</span><br><span class="line">        vec.<span class="built_in">push_back</span>(<span class="number">9</span>); sum -= <span class="number">9</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(sum) vec.<span class="built_in">push_back</span>(sum);</span><br><span class="line">    </span><br><span class="line">    ll res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> top = (<span class="keyword">int</span>)vec.<span class="built_in">size</span>(); <span class="keyword">if</span>(top &gt; <span class="number">60</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = top - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">        res *= <span class="number">10</span>;</span><br><span class="line">        res += vec[i];</span><br><span class="line">    &#125;</span><br><span class="line">    ans[n][k] = <span class="built_in">min</span>(ans[n][k], res);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sove</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> len = <span class="number">20</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> n = <span class="number">1</span>; n &lt;= <span class="number">150</span>; n++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt;= <span class="number">9</span>; k++)&#123;</span><br><span class="line">            <span class="comment">//f[x] * (k + 1) + (1 + ... + k) - 9 * æ•°çš„ä¸ªæ•° * æ¯ä¸ªæ•°ä¸­æœ«å°¾è¿ç»­9çš„ä¸ªæ•° = nã€‚</span></span><br><span class="line">            <span class="comment">//å…¶ä¸­kæ˜¯ç»™å®šçš„ï¼Œæ•°çš„ä¸ªæ•°é€šè¿‡è°ƒèŠ‚æœ€åä¸€ä½æ¥æ§åˆ¶ï¼Œ9çš„ä¸ªæ•°ç›´æ¥æšä¸¾.</span></span><br><span class="line">            <span class="keyword">int</span> now = n - (k + <span class="number">1</span>) * k / <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> dig = <span class="number">0</span>; dig &lt;= <span class="number">9</span>; dig++)&#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> num = <span class="number">0</span>; num &lt; len; num++)&#123;</span><br><span class="line">                    <span class="keyword">int</span> cnt = <span class="built_in">max</span>(<span class="number">0</span>, dig + k - <span class="number">10</span> + <span class="number">1</span>);</span><br><span class="line">                    <span class="keyword">if</span>((now + <span class="number">9</span> * (num + <span class="number">1</span>) * cnt) % (k + <span class="number">1</span>) == <span class="number">0</span>)&#123;</span><br><span class="line">                        <span class="built_in">make</span>(n, k, dig, num, ((now + <span class="number">9</span> * (num + <span class="number">1</span>) * cnt) / (k + <span class="number">1</span>)));</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; maxn; i++) <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">15</span>; j++) ans[i][j] = inf;</span><br><span class="line">    <span class="built_in">sove</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="keyword">int</span> t; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;t); <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        <span class="keyword">int</span> n, k; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;k);</span><br><span class="line">        <span class="keyword">if</span>(ans[n][k] - inf) <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans[n][k]);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ„é€  </tag>
            
            <tag> æ•°ç  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CF-#651-div2</title>
      <link href="/2020/06/21/CF-651-div2/"/>
      <url>/2020/06/21/CF-651-div2/</url>
      
        <content type="html"><![CDATA[<p>å€¼å¾—æ³¨æ„çš„é¢˜ï¼š<strong>F</strong> æ ‘ä¸ŠäºŒåˆ† &amp; äº¤äº’</p><span id="more"></span><hr><p><strong>A</strong></p><p>æ˜¾ç„¶æ˜¯$floor(n/2)$</p><p><strong>B</strong></p><p>ä¸ºä»€ä¹ˆä¸€å®šå­˜åœ¨å‘¢ï¼Ÿåˆ†å¥‡å¶é¡¹åå°±å®¹æ˜“è¯´æ˜äº†ã€‚</p><p><strong>C</strong></p><p>æœ€å¼€å§‹è¯»é”™é¢˜äº†ï¼Œä»¥ä¸ºå¿…é¡»è¦å¥‡ç´ å› å­â€¦ä¸éœ€è¦çš„è¯åªéœ€è¦åˆ†ç±»è€ƒè™‘ä¸€ä¸‹å¥‡æ•°å› å­çš„ä¸ªæ•°å’Œ2çš„ä¸ªæ•°å³å¯ã€‚</p><p><strong>B</strong></p><p>ä¸ºä»€ä¹ˆä¸€å®šå­˜åœ¨å‘¢ï¼Ÿåˆ†å¥‡å¶é¡¹åå°±å®¹æ˜“è¯´æ˜äº†ã€‚</p><p><strong>C</strong></p><p>æœ€å¼€å§‹è¯»é”™é¢˜äº†ï¼Œä»¥ä¸ºå¿…é¡»è¦å¥‡ç´ å› å­â€¦ä¸éœ€è¦çš„è¯åªéœ€è¦åˆ†ç±»è€ƒè™‘ä¸€ä¸‹å¥‡æ•°å› å­çš„ä¸ªæ•°å’Œ2çš„ä¸ªæ•°å³å¯ã€‚</p><p><strong>D</strong></p><p>äºŒåˆ†ç­”æ¡ˆã€‚</p><p><strong>E</strong></p><p>åœ¨ä¸€ä¸ªåºåˆ—ä¸­æå–å‡ºå½¢å¦‚<code>xyxy..xy</code>çš„å­åºåˆ—ï¼Œè¦æ±‚è¿™äº›åºåˆ—ä¸ªæ•°æœ€å°ï¼ˆå³æ¯ä¸€ä¸ªé•¿åº¦å°½å¯èƒ½å¤§ï¼‰ã€‚</p><p>æœ€å¼€å§‹åªæƒ³åˆ°å¾ªç¯â€¦æ¨¡æ‹Ÿâ€¦ç„¶è€Œæ—¶é—´å¤æ‚åº¦ä¸Šåº”è¯¥æ˜¯è¿‡ä¸å»</p><p>åæ¥æ„è¯†åˆ°è¿™nmä¸å°±æ˜¯ä¸ªå‚»é€¼é¢˜ï¼Œç›´æ¥ç»´æŠ¤å½“å‰ä»¥0ã€1ç»“å°¾çš„ä¸²çš„ä¸ªæ•°ã€‚é¡ºåºæ‰«ä¸€éä¸Šè¿°åºåˆ—ï¼Œé‡åˆ°(æ¯”å¦‚)0å°±çœ‹æ˜¯å¦è‡³å°‘æœ‰ä¸€ä¸ª1ç»“å°¾çš„ä¸²ï¼Œæœ‰çš„è¯å°±å°†è¿™ä¸ªä¸²å˜æˆ0ç»“å°¾ï¼Œæ›´æ–°ä¸¤ç§ä¸²çš„ä¸ªæ•°ï¼›ä¸ç„¶çš„è¯ans++æ–°å»ºä¸€ä¸ªä¸²ã€‚</p><p><strong>F</strong></p><p>åŸæ¥èŒ´é¦™è±†çš„èŒ´çœŸçš„æœ‰å››ç§å†™æ³•â€¦qaq</p><p>åœºä¸Šæ‰“çš„æ—¶å€™å…¶å®æ²¡è®¤ä¸ºè‡ªå·±å¯ä»¥åšå‡ºæ¥ï¼Œæœ€åè¿˜å‰©çš„åŠä¸ªå°æ—¶å¿½ç„¶æ„è¯†åˆ°å¥½åƒF1æ˜¯å¯ä»¥éšæ„äºŒåˆ†åšå‡ºæ¥çš„ï¼Œä½†æ˜¯å½“æ—¶å·²ç»ä¸å¤ªå†™å¾—åŠ¨äº†ï¼Œå‹‰å‹‰å¼ºå¼ºäº¤äº†ä¸ªä¸‘é™‹çš„ä»£ç T1(å¿˜è®°fflushäº†)ã€‚</p><p>ä»Šå¤©çœ‹æ­£è§£å‘ç°ä¹‹å‰çš„ç®—æ³•è¿˜æ˜¯å¤ªè¿‡äºç¹çã€‚å¯ä»¥å…ˆæ‰¾å‡ºè·¯å¾„ä¸ŠæŸä¸€ä¸ªç‚¹ä½œä¸ºæ ¹ï¼Œç„¶åäºŒåˆ†æ·±åº¦æ‰¾æŸä¸€ä¸ªç­”æ¡ˆç‚¹ï¼Œå› ä¸ºæœ€æ·±å¯èƒ½åˆ°è¾¾1e3ï¼Œæ‰€ä»¥è‡³å¤šä¼šèŠ±è´¹10æ¬¡äºŒåˆ†æŸ¥è¯¢ï¼Œå¾—åˆ°äº†æŸä¸ªç­”æ¡ˆç‚¹åæŸ¥è¯¢è·ç¦»å®ƒä¸º$l$ï¼ˆ$l$æ˜¯æœ€çŸ­è·¯å¾„çš„é•¿åº¦ï¼‰çš„æ‰€æœ‰ç‚¹å°±å¯ä»¥è·å¾—å¦ä¸€ä¸ªç­”æ¡ˆç‚¹ã€‚è¿™æ ·çš„ç®—æ³•æ€»å…±èŠ±è´¹<code>1 + 10 + 1</code>æ¬¡æŸ¥è¯¢ï¼Œè¿˜å¾—ç²¾ç®€æ‰ä¸€æ¬¡æ‰èƒ½ç¬¦åˆé¢˜ç›®è¦æ±‚ã€‚æ³¨æ„åˆ°æ— è®ºå¾—åˆ°ä¸¤ä¸ªç‚¹ä¸­çš„å“ªä¸€ä¸ªéƒ½å¯ä»¥å†èŠ±è´¹ä¸€æ¬¡æŸ¥è¯¢æ‰¾åˆ°å¦ä¸€ä¸ªç‚¹ï¼Œè€Œåœ¨è¿™æ£µæ ‘ä¸Šä¸€å®šè¿™ä¸¤ä¸ªç‚¹ä¸€å®šä¸€é«˜ä¸€ä½ï¼Œæ•…æˆ‘ä»¬å¯ä»¥å°†äºŒåˆ†çš„èŒƒå›´ç¼©å°ä¸€å€ï¼Œè¿™æ ·å°±å¯ä»¥çœä¸‹ä¸€æ¬¡ä»è€Œæ»¡è¶³è¦æ±‚ã€‚</p><p>äº‹å®ä¸Šä¸Šè¿°åˆ†ææ­£ç¡®æ— è¯¯ï¼Œæˆ‘å†™æŒ‚äº†é è¿‘10å‘çš„åŸå› è¿˜æ˜¯åœ¨äºèŒ´é¦™è±†å†™çš„ä¸å¤Ÿå¤šã€‚</p><p>åœ¨è¿™é“é¢˜ä¸­å¦‚æœæŸä¸ªæ·±åº¦å¯ä»¥é‚£ä¹ˆåº”è¯¥å°†leftæé«˜åˆ°middleï¼Œå¦‚æœä¸å¯ä»¥åˆ™å°†righté™ä½åˆ°middle - 1ï¼›</p><p>æˆ‘å¹³å¸¸å–œæ¬¢çš„äºŒåˆ†æ–¹å¼å¦‚ä¸‹: </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(left &lt; right)&#123;</span><br><span class="line">middle = (left + right + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">   <span class="keyword">if</span>(<span class="built_in">check</span>(middle, ans1)) left = middle;</span><br><span class="line">  <span class="keyword">else</span> right = middle - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™ç§å†™æ³•çš„ä¼šå¤šèŠ±è´¹è‹¥å¹²æ¬¡çš„æŸ¥è¯¢ã€‚</p><p>å¦‚æœæŸ¥è¯¢åŒºé—´<code>[1, 2]</code>ï¼Œæ­¤æ—¶<code>middle=2</code>ï¼›å¦‚æœ<code>middle</code>æˆç«‹ï¼Œé‚£ä¹ˆçš†å¤§æ¬¢å–œï¼Œmiddleæ‰€åœ¨çš„çŠ¶æ€ä¸­ç­”æ¡ˆç‚¹å¾—åˆ°æ›´æ–°ï¼›ä¸ç„¶ï¼Œ<code>right</code>ä¸‹é™åˆ°1ï¼Œå°½ç®¡ç­”æ¡ˆå·²ç»å¤¹é€¼è·å¾—ï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶ä¸çŸ¥é“åœ¨è¿™ä¸ªæ·±åº¦ä¸‹å“ªä¸€ä¸ªç‚¹æ˜¯æˆ‘ä»¬è¦çš„ç­”æ¡ˆç‚¹ï¼Œå› è€Œè¿˜éœ€è¦èŠ±è´¹ä¸€æ¬¡æŸ¥è¯¢æ‰¾åˆ°ç­”æ¡ˆç‚¹ã€‚ </p><p>å¦‚æœæŸ¥è¯¢åŒºé—´<code>[1, 3]</code>ï¼Œæ­¤æ—¶<code>middle=2</code>ï¼›å¦‚æœmiddleæˆç«‹ï¼Œç»“åˆä¸Šè¿°<code>[1, 2]</code>çš„æƒ…å†µï¼Œè‡³å¤šè¦èŠ±è´¹3æ¬¡æŸ¥è¯¢ã€‚è¿™å¤ªä¸å¦™äº†ï¼</p><p>æ­£ç¡®çš„äºŒåˆ†æ–¹å¼åº”è¯¥å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(left &lt;= right)&#123;</span><br><span class="line">  middle = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">check</span>(middle, ans1)) left = middle + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">else</span> right = middle - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç±»ä¼¼çš„è®¨è®ºä¸€ä¸‹åŒºé—´<code>[1, 2]</code>, <code>[1, 3]</code>çš„æƒ…å†µä¼šå‘ç°ï¼Œæœ€åä¹Ÿåªéœ€è¦æŸ¥è¯¢2æ¬¡å°±å¯ä»¥è·å¾—ç»“æœï¼Œæ›´å¤§çš„æƒ…å†µä¹Ÿå¯ä»¥æ®æ­¤åˆ†æå‡ºæ¥ã€‚</p><p>ç©¶å…¶åŸç†ï¼Œæˆ‘è®¤ä¸ºæ˜¯è¿™é“é¢˜ä¸­è¦æ±‚çš„æ˜¯æœ€å¤§çš„æ»¡è¶³æ¡ä»¶çš„ä½ç½®(1 1 1 .. 1 <strong>1</strong> 0 0 0.. 00)ï¼Œå¹¶ä¸”æˆ‘ä»¬éœ€è¦åœ¨checkçš„åŒæ—¶æ±‚å‡ºå…³äºå½“å‰ä½ç½®çš„æŸäº›ç›¸å…³å‚é‡ï¼Œæ‰€ä»¥å°±ä¸èƒ½é‡‡ç”¨ç¬¬ä¸€ç§æ–¹æ³•çš„å‘ä¸Šå–æ•´ã€å¤¹é€¼å¾—åˆ°ç»“æœçš„æ‰‹æ®µï¼Œè¿™ä¼šä½¿å¾—æŸäº›1ä½ç½®çš„<strong>ç­”æ¡ˆ</strong>æ˜¯ä»0å¤¹é€¼å¾—æ¥ï¼Œå…¶<strong>å‚é‡</strong>å´éœ€è¦èŠ±è´¹é¢å¤–çš„ä»£ä»·å»æ±‚è§£ã€‚è€Œé‡‡ç”¨ç¬¬äºŒç§æ–¹æ³•åˆ™æ˜¯ä¸æ–­çš„ä»å¯è¡ŒçŠ¶æ€å¾€åè¿›è¡Œå‹ç¼©ï¼Œæ¯æ¬¡çš„<code>`middle</code>å€¼éƒ½æ˜¯ä»1çŠ¶æ€å¼€å§‹è€ƒè™‘ï¼ŒåŒæ—¶ä¹Ÿè¿›è¡Œç›¸å…³å‚é‡çš„æ±‚è§£ï¼Œè¿™æ ·æœ€ç»ˆå°±ä¸éœ€è¦èŠ±è´¹é¢å¤–çš„ä»£ä»·å¾—åˆ°æƒ³è¦çš„ç»“æœã€‚</p><p><code>ACä»£ç </code></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e3</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">star</span>&#123;</span><span class="keyword">int</span> to, next;&#125;;</span><br><span class="line"></span><br><span class="line">star edge[maxn &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> n, head[maxn], top = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; ask;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> &amp;d)</span></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;? %d &quot;</span>, (<span class="keyword">int</span>)ask.<span class="built_in">size</span>());</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> x: ask) <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, x); <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="built_in">fflush</span>(stdout);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;x, &amp;d);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> l, ans1, ans2;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ok</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;! %d %d\n&quot;</span>, ans1, ans2);</span><br><span class="line">    <span class="built_in">fflush</span>(stdout);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">judge</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> temp[<span class="number">30</span>]; <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, temp);</span><br><span class="line">    <span class="keyword">if</span>(temp[<span class="number">0</span>] == <span class="string">&#x27;C&#x27;</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> vis[maxn];</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; vec[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> dep)</span></span>&#123;</span><br><span class="line">    vec[dep].<span class="built_in">push_back</span>(now); vis[now] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[now]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!vis[edge[i].to]) <span class="built_in">dfs</span>(edge[i].to, dep + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> dep, <span class="keyword">int</span> &amp;x)</span></span>&#123;</span><br><span class="line">    ask.<span class="built_in">clear</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> x: vec[dep]) ask.<span class="built_in">push_back</span>(x);</span><br><span class="line">    <span class="keyword">int</span> temp, d; <span class="built_in">query</span>(temp, d);</span><br><span class="line">    <span class="keyword">if</span>(d == l) x = temp;</span><br><span class="line">    <span class="keyword">return</span> d == l;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfss</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> dep)</span></span>&#123;</span><br><span class="line">    vis[now] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(dep == l)&#123;</span><br><span class="line">        ask.<span class="built_in">push_back</span>(now);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[now]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!vis[edge[i].to]) <span class="built_in">dfss</span>(edge[i].to, dep + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="keyword">int</span> t; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;t); <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        <span class="built_in">clr</span>(head, <span class="number">-1</span>); top = <span class="number">0</span>; <span class="built_in">clr</span>(vis, <span class="number">0</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n); <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) vec[i].<span class="built_in">clear</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> u, v; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">            <span class="built_in">add</span>(u, v); <span class="built_in">add</span>(v, u);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        ask.<span class="built_in">clear</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) ask.<span class="built_in">push_back</span>(i);</span><br><span class="line">        <span class="keyword">int</span> rot; <span class="built_in">query</span>(rot, l);</span><br><span class="line">        <span class="built_in">dfs</span>(rot, <span class="number">0</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//æ‰¾æœ€è¿œçš„é‚£ä¸ªç‚¹ã€‚</span></span><br><span class="line">        <span class="keyword">int</span> left = <span class="built_in">ceil</span>(l, <span class="number">2</span>), right = <span class="number">-1</span>, middle;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="keyword">if</span>(!vec[i].<span class="built_in">empty</span>()) right = i; right = <span class="built_in">min</span>(right, l);</span><br><span class="line">        <span class="keyword">while</span>(left &lt;= right)&#123;</span><br><span class="line">            middle = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">check</span>(middle, ans1)) left = middle + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> right = middle - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        if(ans1 == -1) check(left, ans1);</span></span><br><span class="line">        ask.<span class="built_in">clear</span>(); <span class="built_in">clr</span>(vis, <span class="number">0</span>); <span class="built_in">dfss</span>(ans1, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">query</span>(ans2, l);</span><br><span class="line">        <span class="built_in">ok</span>(); <span class="built_in">judge</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p><del>qaqæˆ‘å±…ç„¶ğŸŠäº†â€¦çœŸçš„æ²¡æœ‰æƒ³åˆ°ğŸŠäº†â€¦</del></p><p>è¿‡å¹´çš„magicå°ç›®æ ‡ç®—æ˜¯å¿½ç„¶å®ç°äº†ï¼Œæ¥ä¸‹æ¥è¿˜æ˜¯è¦å¥½å¥½è®­ç»ƒåŠªåŠ›ä¿æŒåœ¨æ©™åqaq</p>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ ‘ä¸ŠäºŒåˆ† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>0619-weekly-test-B</title>
      <link href="/2020/06/19/0619-weekly-test-B/"/>
      <url>/2020/06/19/0619-weekly-test-B/</url>
      
        <content type="html"><![CDATA[<p>é¢˜ç›®è¦æ±‚æˆ‘ä»¬å†™ä¸€ä¸ªæŒ‡å®šè¯­æ³•çš„ç¨‹åºï¼Œè¦æ±‚è¿™ä¸ªç¨‹åºèƒ½å¤Ÿè¾“å‡ºæŒ‡å®šfibnacciæ•°åˆ—ä¸­çš„æŸä¸€é¡¹ï¼Œè¯¢é—®è‡³å¤šä¸è¶…è¿‡30é¡¹ã€‚</p><!--- more ---><p>è¿™é“é¢˜ç›®è¿˜æ˜¯è›®æ–°é¢–çš„ï¼Œè™½ç„¶ä¸ç®—å¾ˆéš¾ï¼Œä½†æ˜¯å› ä¸ºå‘åˆ°æˆ‘äº†â€¦æ‰€ä»¥è¿˜æ˜¯å†™ç¯‡ç®€çŸ­çš„åšå®¢è®°å½•ä¸€ç•ªã€‚</p><p>è¿™é“é¢˜ç›®å¯è¡Œçš„ç¨‹åºå¾ˆå¤š<del>ä»¥è‡³äºWAäº†ä¹‹åä¸çŸ¥é“æ€ä¹ˆæ”¹</del>ï¼Œæˆ‘çš„ç®—æ³•æ˜¯åˆå§‹åŒ–<code>[n, 0, 1]</code>ä¹‹åå¾ªç¯åˆ¤æ–­å½“å‰næ˜¯å¦ä¸º1ï¼Œä¸æ˜¯çš„è¯å°†<code>[n, y, x]</code>å˜æˆ<code>[n - 1, x, x + y]</code>ï¼Œç„¶åå†æ¬¡jumpåˆ°åˆ¤æ–­è¯­å¥å¤„ã€‚ä¸»è¦åˆ†æˆä¸‰ä¸ªæ¨¡å—ï¼šåˆ¤æ–­æ˜¯å¦ä¸º1ï¼Œå¯¹nå‡ä¸€ï¼Œå˜æ¢<code>[y, x]</code>æˆä¸º<code>[x, x + y]</code>ã€‚ç»“åˆæ“ä½œéšæ„æ„é€ ä¸€ç•ªå³å¯ã€‚</p><p>å‘ç‚¹åœ¨äºï¼Œé¢˜ç›®è´¹äº†å¾ˆå¤§çš„åŠ²è¯´äº†çº¦æŸæ¡ä»¶ï¼Œçº¦æŸäº†ç¨‹åºæ‰§è¡Œçš„æœ€å¤§æ¬¡æ•°1e3..å¦‚æœæˆ‘ä»¬å¾ªç¯çš„æ¬¡æ•°è¶…è¿‡33æ¬¡çš„è¯ï¼Œå°±æ— æ³•åœ¨1000è¡Œä»¥å†…è·‘å®Œé¡¹æ•°æœ€å¤§30çš„æƒ…å†µï¼Œä¹Ÿæ˜¯è¿™é‡Œå¯¼è‡´æˆ‘WAåˆ°è‡ªé—­QAQâ€¦ä¼˜åŒ–ç®—æ³•ä¹‹åå³å¯æˆåŠŸACã€‚</p><p>ä»¥åè¯»é¢˜ç›®ä¸€å®šè¦ä»”ç»†å…³æ³¨æ¡ä»¶ï¼Œä¸ç„¶æ€»æ˜¯æ­»åœ¨å¥‡å¥‡æ€ªæ€ªçš„åœ°æ–¹â€¦</p><p><del>å½“æ—¶ä»¥ä¸ºè‡ªå·±ç¨‹åºé”™äº†è¿˜å†™äº†ä¸ªè§£é‡Šå™¨å´å‘ç°ç»“æœç¬¦åˆçš„å¾ˆå¥½qaq</del></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fun</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; x; i++) <span class="built_in">printf</span>(<span class="string">&quot;c&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf = <span class="number">50</span>;</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; vec = &#123;</span><br><span class="line">    <span class="number">4</span>, <span class="number">7</span>, <span class="number">8</span>,</span><br><span class="line">    <span class="number">8</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">3</span>, inf, <span class="number">6</span>,</span><br><span class="line">    <span class="number">7</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">6</span>,</span><br><span class="line">    <span class="number">7</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">1</span>,</span><br><span class="line">    <span class="number">8</span>, <span class="number">11</span>, <span class="number">6</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="keyword">int</span> size = (<span class="keyword">int</span>)vec.<span class="built_in">size</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++)&#123;</span><br><span class="line">        <span class="built_in">fun</span>(vec[i]);</span><br><span class="line">        <span class="keyword">if</span>(i != size - <span class="number">1</span>) <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¨¡æ‹Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯¹æ‹ç¨‹åº</title>
      <link href="/2020/06/18/%E5%AF%B9%E6%8B%8D%E7%A8%8B%E5%BA%8F/"/>
      <url>/2020/06/18/%E5%AF%B9%E6%8B%8D%E7%A8%8B%E5%BA%8F/</url>
      
        <content type="html"><![CDATA[<p>å› ä¸ºä»Šå¤©æ‰“æ¯”èµ›é˜Ÿå‹å¯¹æ‹å‡ºäº†ä¸€ä¸ªé”™è¯¯ç»“æœï¼Œæ‰€ä»¥æˆ‘ä¹Ÿè¶æœºè‡ªå·±å†™äº†ä¸€ç•ªè¿™ä¸ªä¸€ç›´æ²¡æœ‰å®ç°çš„æŠ€æœ¯ï¼Œç”¨èµ·æ¥è¿˜æ˜¯å¾ˆèˆ’çˆ½çš„ã€‚</p><span id="more"></span><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[])</span> </span>&#123;</span><br><span class="line">    <span class="built_in">system</span>(<span class="string">&quot;g++ ~/Desktop/data/data/main.cpp -std=c++11 -o data.out&quot;</span>);</span><br><span class="line">    <span class="built_in">system</span>(<span class="string">&quot;g++ ~/Desktop/T/T/main.cpp -std=c++11 -o T.out&quot;</span>);</span><br><span class="line">    <span class="built_in">system</span>(<span class="string">&quot;g++ ~/Desktop/ttt/ttt/main.cpp -std=c++11 -o ttt.out&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> times = <span class="number">-1</span>;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;times);</span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(times != <span class="number">0</span>)&#123;</span><br><span class="line">        times--;</span><br><span class="line">        <span class="built_in">system</span>(<span class="string">&quot;./data.out &gt;~/Desktop/in.txt&quot;</span>);</span><br><span class="line">        <span class="built_in">system</span>(<span class="string">&quot;./T.out &lt; ~/Desktop/in.txt &gt; ~/Desktop/out.txt&quot;</span>);</span><br><span class="line">        <span class="built_in">system</span>(<span class="string">&quot;./ttt.out &lt; ~/Desktop/in.txt &gt; ~/Desktop/ans.txt&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">system</span>(<span class="string">&quot;diff ~/Desktop/out.txt ~/Desktop/ans.txt&quot;</span>))&#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;Differences occur!&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;No.%d&#x27;s OK.\n&quot;</span>, cnt++);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æŠ€æœ¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¯¹æ‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>template</title>
      <link href="/2020/06/17/template/"/>
      <url>/2020/06/17/template/</url>
      
        <content type="html"><![CDATA[<p>[toc]</p><span id="more"></span><div STYLE="page-break-after: always;"></div><div STYLE="page-break-after: always;"></div><h2 id="1-å­—ç¬¦ä¸²"><a href="#1-å­—ç¬¦ä¸²" class="headerlink" title="1 å­—ç¬¦ä¸²"></a>1 å­—ç¬¦ä¸²</h2><h3 id="trieæ ‘"><a href="#trieæ ‘" class="headerlink" title="trieæ ‘"></a>trieæ ‘</h3><p>å®ç°ä¸€ï¼šæ•°ç»„å®ç°çš„æŒ‰é”®æŸ¥æ‰¾</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxsize = <span class="number">26</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">TRIE</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> ch[maxn][maxsize];</span><br><span class="line">    <span class="keyword">int</span> flag[maxn];</span><br><span class="line">    <span class="keyword">int</span> top = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æŒ‰ç…§å®é™…æ¡ä»¶è¿›è¡Œä¿®æ”¹</span></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getid</span><span class="params">(<span class="keyword">char</span> c)</span></span>&#123;<span class="keyword">return</span> c - <span class="string">&#x27;a&#x27;</span>;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ’å…¥é•¿åº¦ä¸ºnçš„å­—ç¬¦ä¸²s[0,..n - 1]</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">char</span> s[maxn], <span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> u = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> id = <span class="built_in">getid</span>(s[i]);</span><br><span class="line">            <span class="keyword">if</span>(!ch[u][id]) ch[u][id] = top++;</span><br><span class="line">            u = ch[u][id];</span><br><span class="line">        &#125;</span><br><span class="line">        flag[u] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">query</span><span class="params">(<span class="keyword">char</span> s[maxn], <span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> u = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> id = <span class="built_in">getid</span>(s[i]);</span><br><span class="line">            <span class="keyword">if</span>(!ch[u][id]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            u = ch[u][id];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(flag[u]) <span class="keyword">return</span> <span class="literal">true</span>; <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å®ç°äºŒï¼šæ•°ç»„å®ç°çš„æŒ‰è¾¹æŸ¥æ‰¾ï¼ˆå·¦å„¿å­å³å…„å¼Ÿä¼˜åŒ–ï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxsize = <span class="number">26</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxnode = maxn * maxsize;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">TRIE</span>&#123;</span></span><br><span class="line"><span class="comment">//    vector&lt;int&gt; head, next;</span></span><br><span class="line"><span class="comment">//    vector&lt;char&gt; ch;</span></span><br><span class="line">    <span class="keyword">int</span> head[maxnode], next[maxnode];</span><br><span class="line">    <span class="keyword">char</span> ch[maxnode];</span><br><span class="line">    <span class="keyword">bool</span> flag[maxnode];</span><br><span class="line">    <span class="keyword">int</span> top = <span class="number">1</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">char</span> s[maxn], <span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> u = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> find = <span class="number">0</span>, v;</span><br><span class="line">            <span class="keyword">for</span>(v = head[u]; v; v = next[v]) <span class="keyword">if</span>(ch[v] == s[i])&#123;</span><br><span class="line">                find = <span class="number">1</span>; <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(!find)&#123;</span><br><span class="line">                v = top++;</span><br><span class="line">                ch[v] = s[i];</span><br><span class="line">                next[v] = head[u];</span><br><span class="line">                head[u] = v;</span><br><span class="line">            &#125;</span><br><span class="line">            u = v;</span><br><span class="line">        &#125;</span><br><span class="line">        flag[u] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">query</span><span class="params">(<span class="keyword">char</span> s[maxn], <span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> u = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> find = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> v = head[u]; v; v = next[v]) <span class="keyword">if</span>(ch[v] == s[i])&#123;</span><br><span class="line">                find = <span class="number">1</span>; u = v; <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(!find) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(flag[u]) <span class="keyword">return</span> <span class="literal">true</span>; <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å®ç°äºŒå€’æ˜¯ç¬¬ä¸€æ¬¡è§ï¼Œä¸å®ç°ä¸€çš„åŒºåˆ«å¤§æ¦‚å°±æ˜¯é‚»æ¥è¡¨ä¸é‚»æ¥çŸ©é˜µçš„åŒºåˆ«ã€‚</p><p>åœ¨å¯¹äºç©ºé—´è¦æ±‚æ›´åŠ ç‰¹æ®Šçš„ç¯å¢ƒä¸­å¯ä»¥ç”¨<code>å®ç°äºŒ</code>ä¼˜åŒ–ç©ºé—´<del>ç„¶è€Œæ€»æ„Ÿè§‰ä¸ç”¨vectorçš„è¯ç©ºé—´æ¶ˆè€—æ¯”å®ç°ä¸€æ›´å¤§ï¼Ÿ</del>ï¼Œå…·ä½“çš„æƒ…å†µç­‰ä»¥åé‡åˆ°äº†å†ä¿®æ”¹æ¿å­ã€‚</p><h3 id="Manacher"><a href="#Manacher" class="headerlink" title="Manacher"></a>Manacher</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> Manacherç®—æ³•</span></span><br><span class="line"><span class="comment"> è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²tempåŠå…¶é•¿åº¦n;</span></span><br><span class="line"><span class="comment"> è¯¥ç®—æ³•æ„é€ å‡ºså¹¶èµ‹äºˆæˆªæ–­æ ‡å¿—, è‡ªåŠ¨åˆå§‹åŒ–ã€è·å¾—æ•°ç»„p[i];</span></span><br><span class="line"><span class="comment"> å¯¹äºæŸä¸ªä½ç½®iâˆˆ[0, 2 * n], ä»¥iä¸ºä¸­å¿ƒçš„å›æ–‡ä¸²çš„å‚æ•°å¦‚ä¸‹:</span></span><br><span class="line"><span class="comment">    int start = (i / 2) - (p[i] / 2) + (i &amp; 1), d = p[i] - 1;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">char</span> temp[maxn], s[maxn &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> p[maxn &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">manacher</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//scanf(&quot;%s&quot;, temp);</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">        s[i &lt;&lt; <span class="number">1</span>] = <span class="string">&#x27;#&#x27;</span>; s[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = temp[i];</span><br><span class="line">    &#125;</span><br><span class="line">    s[n &lt;&lt; <span class="number">1</span>] = <span class="string">&#x27;#&#x27;</span>; s[n &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> id = <span class="number">0</span>, right = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n &lt;&lt; <span class="number">1</span>; i++) p[i] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n &lt;&lt; <span class="number">1</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(i &lt;= right) p[i] = <span class="built_in">min</span>(right - i + <span class="number">1</span>, p[<span class="number">2</span> * id - i]);</span><br><span class="line">        <span class="keyword">while</span>(i + p[i] &lt;= <span class="number">2</span> * n &amp;&amp; i - p[i] &gt;= <span class="number">0</span> &amp;&amp; s[i + p[i]] == s[i - p[i]])</span><br><span class="line">            p[i]++;</span><br><span class="line">        <span class="keyword">if</span>(right &lt; i + p[i] - <span class="number">1</span>)&#123;</span><br><span class="line">            id = i; right = i + p[i] - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="KMP"><a href="#KMP" class="headerlink" title="KMP"></a>KMP</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ³¨æ„ï¼Œä»1å¼€å§‹ç¼–å·ï¼</span></span><br><span class="line"><span class="keyword">int</span> nxt[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">kmp</span><span class="params">(<span class="keyword">char</span> s[maxn], <span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(nxt, <span class="number">0</span>, <span class="keyword">sizeof</span> nxt); </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> p = nxt[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">while</span>(p &gt; <span class="number">0</span> &amp;&amp; s[p + <span class="number">1</span>] != s[i]) p = nxt[p];</span><br><span class="line">        <span class="keyword">if</span>(s[p + <span class="number">1</span>] == s[i]) p++;</span><br><span class="line">        nxt[i] = p;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ACè‡ªåŠ¨æœº"><a href="#ACè‡ªåŠ¨æœº" class="headerlink" title="ACè‡ªåŠ¨æœº"></a>ACè‡ªåŠ¨æœº</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">30</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> s[maxn * <span class="number">10</span>];</span><br><span class="line"><span class="keyword">int</span> ch[maxn][N], top = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> fail[maxn];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> pos[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">char</span> *s, <span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> p = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; s[i]; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!ch[p][s[i] - <span class="string">&#x27;a&#x27;</span>]) ch[p][s[i] - <span class="string">&#x27;a&#x27;</span>] = top++;</span><br><span class="line">        p = ch[p][s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    pos[id] = p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">queue&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getfail</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) <span class="keyword">if</span>(ch[<span class="number">0</span>][i])&#123;</span><br><span class="line">        fail[ch[<span class="number">0</span>][i]] = <span class="number">0</span>;</span><br><span class="line">        q.<span class="built_in">push</span>(ch[<span class="number">0</span>][i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())&#123;</span><br><span class="line">        <span class="keyword">int</span> now = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(ch[now][i])&#123;</span><br><span class="line">                fail[ch[now][i]] = ch[fail[now]][i];</span><br><span class="line">                q.<span class="built_in">push</span>(ch[now][i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> ch[now][i] = ch[fail[now]][i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">star</span>&#123;</span><span class="keyword">int</span> to, next;&#125;edge[maxn];</span><br><span class="line"><span class="keyword">int</span> head[maxn], _top = <span class="number">0</span>, sze[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    edge[_top].to = v;</span><br><span class="line">    edge[_top].next = head[u];</span><br><span class="line">    head[u] = _top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> now)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[now]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="built_in">dfs</span>(to);</span><br><span class="line">        sze[now] += sze[to];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="built_in">clr</span>(head, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">int</span> n; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s); <span class="built_in">insert</span>(s, i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">getfail</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>, p = <span class="number">0</span>; s[i]; i++)&#123;</span><br><span class="line">        p = ch[p][s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        sze[p]++;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; top; i++) <span class="built_in">add</span>(fail[i], i); <span class="built_in">dfs</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, sze[pos[i]]);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢åœ¨ä¸»ä¸²ä¸­æ‰€æœ‰æ¨¡å¼ä¸²å‡ºç°çš„æ¬¡æ•°ã€‚</p><p>ä¸èƒ½æš´åŠ›è·³failè¿›è¡ŒåŒ¹é…ï¼Œå¯¹äºä¸»ä¸²çš„æ¯ä¸€ä¸ªä½ç½®æœ‰å¯èƒ½failéå†æ‰€æœ‰æ·±åº¦ï¼ˆå¦‚aaaaaaa)ï¼Œå› è€Œå»ºfailæ ‘è®°å½•å¹¶æ¯ä¸€ä¸ªèŠ‚ç‚¹è¢«ç›´æ¥è®¿é—®çš„æ¬¡æ•°ï¼Œæœ€ådfsæ±‚å¾—èŠ‚ç‚¹æ‰€åœ¨çš„å­æ ‘æ€»å…±çš„è®¿é—®æ¬¡æ•°å³å¯ã€‚</p><h3 id="å›æ–‡æ ‘"><a href="#å›æ–‡æ ‘" class="headerlink" title="å›æ–‡æ ‘"></a>å›æ–‡æ ‘</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">3e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">26</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">char</span> s[maxn];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> len[maxn], fail[maxn];</span><br><span class="line"><span class="keyword">int</span> ch[maxn][N], top;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ini</span><span class="params">()</span></span>&#123;fail[<span class="number">1</span>] = fail[<span class="number">0</span>] = <span class="number">1</span>; len[<span class="number">1</span>] = <span class="number">-1</span>; top = <span class="number">2</span>;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ’å…¥å­—ç¬¦s[n]</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getfail</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(s[n - <span class="number">1</span> - len[x]] != s[n]) x = fail[x];</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸‹æ ‡ä»1å¼€å§‹</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">char</span> s[maxn])</span></span>&#123;</span><br><span class="line">    <span class="built_in">ini</span>();</span><br><span class="line">    <span class="comment">//é€‰å–ä¸€ä¸ªä¿è¯ä¸ä¼šå‡ºç°çš„å­—ç¬¦ã€‚</span></span><br><span class="line">    s[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">    <span class="comment">//lastç»´æŠ¤äº†ä»¥s[n - 1]ç»“å°¾çš„æœ€é•¿å›æ–‡å­ä¸²çš„èŠ‚ç‚¹æ ‡å·ã€‚</span></span><br><span class="line">    <span class="keyword">int</span> last = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; s[i]; i++)&#123;</span><br><span class="line">        s[i] -= <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        <span class="keyword">int</span> p = <span class="built_in">getfail</span>(last, i);</span><br><span class="line">        <span class="keyword">if</span>(!ch[p][s[i]])&#123;</span><br><span class="line">            len[top] = len[p] + <span class="number">2</span>;</span><br><span class="line">            fail[top] = ch[<span class="built_in">getfail</span>(fail[p], i)][s[i]];</span><br><span class="line">            ch[p][s[i]] = top;</span><br><span class="line">            top++;</span><br><span class="line">        &#125;</span><br><span class="line">        last = ch[p][s[i]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-è®¡ç®—å‡ ä½•"><a href="#2-è®¡ç®—å‡ ä½•" class="headerlink" title="2 è®¡ç®—å‡ ä½•"></a>2 è®¡ç®—å‡ ä½•</h2><h3 id="å·²çŸ¥å¹³é¢åœ†ä¸Šä¸‰ç‚¹æ±‚åœ†å¿ƒåŠå…¶åŠå¾„"><a href="#å·²çŸ¥å¹³é¢åœ†ä¸Šä¸‰ç‚¹æ±‚åœ†å¿ƒåŠå…¶åŠå¾„" class="headerlink" title="å·²çŸ¥å¹³é¢åœ†ä¸Šä¸‰ç‚¹æ±‚åœ†å¿ƒåŠå…¶åŠå¾„"></a>å·²çŸ¥å¹³é¢åœ†ä¸Šä¸‰ç‚¹æ±‚åœ†å¿ƒåŠå…¶åŠå¾„</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cal</span><span class="params">(<span class="keyword">double</span> x1, <span class="keyword">double</span> y1, <span class="keyword">double</span> x2, <span class="keyword">double</span> y2, <span class="keyword">double</span> x3, <span class="keyword">double</span> y3)</span></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> a, b, c, d, e, f;</span><br><span class="line">    a = <span class="number">2</span> * (x2 - x1);</span><br><span class="line">    b = <span class="number">2</span> * (y2 - y1);</span><br><span class="line">    c = x2 * x2 + y2 * y2 - x1 * x1 - y1 * y1;</span><br><span class="line">    d = <span class="number">2</span> * (x3 - x2);</span><br><span class="line">    e = <span class="number">2</span> * (y3 - y2);</span><br><span class="line">    f = x3 * x3 + y3 * y3 - x2 * x2 - y2 * y2;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">double</span> x, y, r;</span><br><span class="line">    x = (b * f - e * c)/(b * d - e * a);</span><br><span class="line">    y = (d * c - a * f)/(b * d - e * a);</span><br><span class="line">    r = <span class="built_in">sqrt</span>((x - x1) * (x - x1) + (y - y1) * (y - y1));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯æ˜æ–¹æ³•æ˜¯åšå·®è§£äºŒå…ƒä¸€æ¬¡æ–¹ç¨‹çš„è¡Œåˆ—å¼è¡¨è¾¾ã€‚</p><p>æ ¹æ®å®é™…éœ€è¦å°†å‡½æ•°ä¸­çš„<code>x, y, r</code>çš„å€¼è¿›è¡Œè½¬ç§»(<del>è¦æ˜¯å†åŠ å…¥3ä¸ªæ›¿èº«å˜é‡å°±å¥½é•¿çš„åˆ—è¡¨</del>)ã€‚</p><h3 id="å¹³é¢ä¸Šåœ†çš„kæ¬¡äº¤"><a href="#å¹³é¢ä¸Šåœ†çš„kæ¬¡äº¤" class="headerlink" title="å¹³é¢ä¸Šåœ†çš„kæ¬¡äº¤"></a>å¹³é¢ä¸Šåœ†çš„kæ¬¡äº¤</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> manx = <span class="number">1e2</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-8</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> pi = <span class="built_in">acos</span>(<span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">sgn</span><span class="params">(<span class="keyword">double</span> x)</span></span>&#123;<span class="keyword">return</span> x &lt; -eps? <span class="number">-1</span>: x &gt; eps? <span class="number">1</span>: <span class="number">0</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">sqr</span><span class="params">(<span class="keyword">double</span> x)</span></span>&#123;<span class="keyword">return</span> x * x;&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">CIRCLE</span>&#123;</span></span><br><span class="line">    <span class="keyword">double</span> x, y, r, angle;</span><br><span class="line">    <span class="keyword">int</span> d;</span><br><span class="line">    <span class="built_in">CIRCLE</span>()&#123;d = <span class="number">1</span>; angle = <span class="number">0</span>;&#125;</span><br><span class="line">    <span class="built_in">CIRCLE</span>(<span class="keyword">double</span> _x, <span class="keyword">double</span> _y, <span class="keyword">double</span> _angle = <span class="number">0</span>, <span class="keyword">int</span> _d = <span class="number">0</span>)&#123;</span><br><span class="line">        x = _x; y = _y; angle = _angle; d = _d; r = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> CIRCLE &amp;b)<span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">sgn</span>(r - b.r) == <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">dis</span><span class="params">(CIRCLE a, CIRCLE b)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">sqrt</span>(<span class="built_in">sqr</span>(a.x - b.x) + <span class="built_in">sqr</span>(a.y - b.y));&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">cross</span><span class="params">(CIRCLE a, CIRCLE b, CIRCLE c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (b.x - a.x) * (c.y - a.y) - (b.y - a.y) * (c.x - a.x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æœ‰ä¸¤ä¸ªäº¤ç‚¹è¿”å›trueï¼Œä»¥åŠä¸¤ä¸ªäº¤ç‚¹çš„åæ ‡å’Œæ–¹ä½è§’ï¼Œp1æŒ‰ç…§é¡ºæ—¶é’ˆï¼Œp2æŒ‰ç…§é€†æ—¶é’ˆ</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cir_inter_cir</span><span class="params">(CIRCLE a, CIRCLE b, CIRCLE &amp;p1, CIRCLE &amp;p2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> d = <span class="built_in">dis</span>(a, b);</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">sgn</span>(d - a.r - b.r) &gt;= <span class="number">0</span> || <span class="built_in">sgn</span>(<span class="built_in">abs</span>(b.r - a.r) - d) &gt;= <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">double</span> cosa = (<span class="built_in">sqr</span>(a.r) + <span class="built_in">sqr</span>(d) - <span class="built_in">sqr</span>(b.r)) / (<span class="number">2</span> * a.r * d);</span><br><span class="line">    <span class="keyword">double</span> sina = <span class="built_in">sqrt</span>(<span class="built_in">max</span>(<span class="number">0.</span>, <span class="number">1.</span> - <span class="built_in">sqr</span>(cosa)));</span><br><span class="line">    <span class="comment">//æ—‹è½¬çŸ©é˜µ [cosa, -sina; sina, cosa]</span></span><br><span class="line">    p1 = p2 = a;</span><br><span class="line">    p1.x += a.r / d * ((b.x - a.x) * cosa + (b.y - a.y) * -sina);</span><br><span class="line">    p1.y += a.r / d * ((b.x - a.x) * sina + (b.y - a.y) * cosa);</span><br><span class="line">    p2.x += a.r / d * ((b.x - a.x) * cosa + (b.y - a.y) * sina);</span><br><span class="line">    p2.y += a.r / d * ((b.x - a.x) * -sina + (b.y - a.y) * cosa);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">const</span> CIRCLE &amp;a, <span class="keyword">const</span> CIRCLE &amp;b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">sgn</span>(a.angle - b.angle)) <span class="keyword">return</span> <span class="built_in">sgn</span>(a.angle - b.angle) == <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> a.d &gt; b.d;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">cal</span><span class="params">(CIRCLE a, CIRCLE p1, CIRCLE p2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> ans = <span class="built_in">sqr</span>(a.r) * (p2.angle - p1.angle) - <span class="built_in">cross</span>(a, p1, p2) + <span class="built_in">cross</span>(<span class="built_in">CIRCLE</span>(<span class="number">0</span>, <span class="number">0</span>), p1, p2);</span><br><span class="line">    <span class="keyword">return</span> ans / <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">CIRCLE dot[maxn &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">double</span> area[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cirunion</span><span class="params">(CIRCLE cir[], <span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="built_in">sort</span>(cir, cir + n);</span><br><span class="line">    <span class="comment">//è®°å½•æ¯ä¸ªåœ†è¢«å®Œå…¨è¦†ç›–çš„æ¬¡æ•°ï¼Œåˆå§‹å€¼æ˜¾ç„¶ä¸º1</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="keyword">for</span>(<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; n; j++)</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">sgn</span>(<span class="built_in">dis</span>(cir[i], cir[j]) + cir[i].r - cir[j].r) &lt;= <span class="number">0</span>) cir[i].d++;</span><br><span class="line">    CIRCLE p1, p2;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">        <span class="comment">//é’ˆå¯¹æ¯ä¸€ä¸ªåœ†è€ƒè™‘å®ƒä¸æ‰€æœ‰å…¶ä»–åœ†çš„äº¤</span></span><br><span class="line">        <span class="keyword">int</span> cnt = <span class="number">0</span>, top = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(i == j) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span>(!<span class="built_in">cir_inter_cir</span>(cir[i], cir[j], p1, p2)) <span class="keyword">continue</span>;</span><br><span class="line">            p1.angle = <span class="built_in">atan2</span>(p1.y - cir[i].y, p1.x - cir[i].x);</span><br><span class="line">            p2.angle = <span class="built_in">atan2</span>(p2.y - cir[i].y, p2.x - cir[i].x);</span><br><span class="line">            p1.d = <span class="number">-1</span>; p2.d = <span class="number">1</span>;</span><br><span class="line">            dot[top++] = p1; dot[top++] = p2;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">sgn</span>(p2.angle - p1.angle) == <span class="number">1</span>) cnt++;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//åŠ å…¥èµ·ç‚¹ç»ˆç‚¹ä½ç½®</span></span><br><span class="line">        dot[top++] = <span class="built_in">CIRCLE</span>(cir[i].x - cir[i].r, cir[i].y, -pi, <span class="number">-2</span>);</span><br><span class="line">        dot[top++] = <span class="built_in">CIRCLE</span>(cir[i].x - cir[i].r, cir[i].y, pi, <span class="number">2</span>);</span><br><span class="line">        <span class="built_in">sort</span>(dot, dot + top, cmp);</span><br><span class="line">        <span class="keyword">int</span> now = cir[i].d + cnt;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; top; j++)&#123;</span><br><span class="line">            area[now] += <span class="built_in">cal</span>(cir[i], dot[j - <span class="number">1</span>], dot[j]);</span><br><span class="line">            now += dot[j].d;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">CIRCLE cir[maxn];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="keyword">int</span> t; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;t); <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        <span class="built_in">clr</span>(area, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">int</span> n; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%lf %lf %lf&quot;</span>, &amp;cir[i].x, &amp;cir[i].y, &amp;cir[i].r);</span><br><span class="line">        <span class="built_in">cirunion</span>(cir, n);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">printf</span>(<span class="string">&quot;%.5f\n&quot;</span>, area[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="å‡¸åŒ…å‘¨é•¿"><a href="#å‡¸åŒ…å‘¨é•¿" class="headerlink" title="å‡¸åŒ…å‘¨é•¿"></a>å‡¸åŒ…å‘¨é•¿</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e2</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-9</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">POINT</span>&#123;</span></span><br><span class="line">    <span class="keyword">double</span> x, y;</span><br><span class="line">    POINT <span class="keyword">operator</span> - (<span class="keyword">const</span> POINT &amp;b)&#123;</span><br><span class="line">        POINT temp;</span><br><span class="line">        temp.x = x - b.x;</span><br><span class="line">        temp.y = y - b.y;</span><br><span class="line">        <span class="keyword">return</span> tmep;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;p[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">cross</span><span class="params">(POINT a, POINT b)</span></span>&#123; <span class="keyword">return</span> a.x * b.y - a.y * b.x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">dis</span><span class="params">(POINT a)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">sqrt</span>(a.x * a.x + a.y * a.y);&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sgn</span><span class="params">(<span class="keyword">double</span> x)</span></span>&#123;<span class="keyword">return</span> x &lt; -eps? <span class="number">-1</span>: x &gt; eps? <span class="number">1</span>: <span class="number">0</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(POINT a, POINT b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> flag = <span class="built_in">sgn</span>(<span class="built_in">cross</span>(a, b));</span><br><span class="line">    <span class="keyword">if</span>(flag == <span class="number">0</span>) <span class="keyword">return</span> <span class="built_in">dis</span>(a) &lt; <span class="built_in">dis</span>(b);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> flag == <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> sta[maxn], top = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;sta[top++] = x;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// Fastin;</span></span><br><span class="line">    <span class="keyword">int</span> n; <span class="keyword">while</span>(~<span class="built_in">scnaf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n) &amp;&amp; n)&#123;</span><br><span class="line">        top = <span class="number">0</span>; <span class="keyword">int</span> id = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n ; i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> x, y; <span class="built_in">scnaf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;x, &amp;y);</span><br><span class="line">            p[i].x = x; p[i].y = y;</span><br><span class="line">            <span class="keyword">if</span>(id == <span class="number">-1</span> || (p[id].x &gt; p[i].x) || (p[id].x == p[i].x &amp;&amp; p[id].y &gt; p[i].y)) id = i;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ä¸ç‰¹åˆ¤è®¡ç®—å‡ ä½•çš„éƒ½æ˜¯xx!</span></span><br><span class="line">        <span class="keyword">if</span>(n == <span class="number">1</span>)&#123;<span class="built_in">puts</span>(<span class="string">&quot;0.00&quot;</span>); <span class="keyword">continue</span>;&#125;</span><br><span class="line">        <span class="keyword">if</span>(n == <span class="number">2</span>)&#123;<span class="built_in">printf</span>(<span class="string">&quot;%.2f\n&quot;</span>, <span class="built_in">dis</span>(p[<span class="number">1</span>] - p[<span class="number">2</span>])); <span class="keyword">continue</span>;&#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="keyword">if</span>(i != id) p[i] = p[i] - p[id];</span><br><span class="line">        p[id].x = p[id].y = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">sort</span>(p + <span class="number">1</span>, p + <span class="number">1</span> + n, cmp);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">push</span>(<span class="number">1</span>); <span class="built_in">push</span>(<span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">3</span>; i &lt;= n; i++)&#123;</span><br><span class="line">            <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">sgn</span>(<span class="built_in">cross</span>(p[i] - p[sta[top - <span class="number">2</span>]], p[i] - p[sta[top - <span class="number">1</span>]])) &gt;= <span class="number">0</span>)&#123;</span><br><span class="line">                    <span class="built_in">push</span>(i); <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> top--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">double</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; top; i++) ans += <span class="built_in">dis</span>(p[sta[i]] - p[sta[i - <span class="number">1</span>]]);</span><br><span class="line">        ans += <span class="built_in">dis</span>(p[sta[<span class="number">0</span>]] - p[sta[top - <span class="number">1</span>]]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%.2f\n&quot;</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¤æ‚åº¦$O(nlogn)$</p><p>æ±‚å‘¨é•¿éœ€è¦å¾ªç¯åœ°æ±‚ä¸€éæ ˆä¸­ç›¸é‚»ä¸¤ä¸ªå…ƒç´ çš„è·ç¦»ï¼ä¸è¦æ¼æ±‚sta[0]ä¸sta[top - 1]ï¼</p><h2 id="3-å›¾è®º"><a href="#3-å›¾è®º" class="headerlink" title="3 å›¾è®º"></a>3 å›¾è®º</h2><h3 id="æœ€çŸ­è·¯"><a href="#æœ€çŸ­è·¯" class="headerlink" title="æœ€çŸ­è·¯"></a>æœ€çŸ­è·¯</h3><h4 id="01bfs"><a href="#01bfs" class="headerlink" title="01bfs"></a>01bfs</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(åŒç«¯é˜Ÿåˆ—éç©º)&#123;</span><br><span class="line">  å–å‡ºé˜Ÿé¦–å…ƒç´ <span class="function">now</span></span><br><span class="line"><span class="function">  <span class="title">for</span><span class="params">(nowçš„ç›¸é‚»èŠ‚ç‚¹)</span></span>&#123;</span><br><span class="line">    æ›´æ–°è·ç¦»</span><br><span class="line">    <span class="keyword">if</span>(è¾¹æƒä¸º<span class="number">0</span>) æ·»åŠ åˆ°é˜Ÿé¦–</span><br><span class="line">    <span class="keyword">else</span> æ·»åŠ åˆ°é˜Ÿå°¾</span><br><span class="line">  &#125;</span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure><p>å½“å›¾ä¸­è¾¹æƒä»…ä¸º0æˆ–1æ—¶ï¼Œå¯ä»¥ä½¿ç”¨01bfsè§£å†³å•æºæœ€çŸ­è·¯é—®é¢˜ã€‚</p><p>æ—¶é—´å¤æ‚åº¦$O(V+E)$</p><h3 id="tarjan"><a href="#tarjan" class="headerlink" title="tarjan"></a>tarjan</h3><h4 id="scc"><a href="#scc" class="headerlink" title="scc"></a>scc</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">star edge[maxn &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> head[manx], top = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">stack&lt;<span class="keyword">int</span>&gt; sta;</span><br><span class="line"><span class="keyword">int</span> dfn[maxn], low[maxn], cnt = <span class="number">1</span>, in[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tarjan</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    dfn[u] = low[u] = cnt++;</span><br><span class="line">    sta.<span class="built_in">push</span>(u); in[u] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[u]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to;</span><br><span class="line">        <span class="keyword">if</span>(!dfn[to])&#123;</span><br><span class="line">            <span class="built_in">tarjan</span>(to);</span><br><span class="line">            low[u] = <span class="built_in">min</span>(low[to], low[u]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(in[to])&#123;</span><br><span class="line">            low[u] = <span class="built_in">min</span>(low[u], dfn[to]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è¾“å‡ºä»¥uèŠ‚ç‚¹ä¸ºæ ¹çš„scc</span></span><br><span class="line">    <span class="keyword">if</span>(dfn[u] == low[u])&#123;</span><br><span class="line">        <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="built_in">assert</span>(!sta.<span class="built_in">empty</span>());</span><br><span class="line"></span><br><span class="line">            <span class="keyword">int</span> v = sta.<span class="built_in">top</span>(); sta.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, v); in[v] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(v == u)&#123;<span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>); <span class="keyword">break</span>;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// Fastin;</span></span><br><span class="line">    <span class="built_in">clr</span>(head, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">int</span> n, m; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i&lt; m; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> u, v; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">        <span class="built_in">add</span>(u, v);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">tarjan</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¼‚æˆ–MST-ï¼ˆBoruvkaç®—æ³•ï¼‰"><a href="#å¼‚æˆ–MST-ï¼ˆBoruvkaç®—æ³•ï¼‰" class="headerlink" title="å¼‚æˆ–MST ï¼ˆBoruvkaç®—æ³•ï¼‰"></a>å¼‚æˆ–MST ï¼ˆBoruvkaç®—æ³•ï¼‰</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">30</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf = ~<span class="number">0u</span> &gt;&gt; <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, w[maxn], c[maxn];;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ch[maxn * N][<span class="number">2</span>], sze = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> p = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">        <span class="keyword">int</span> id = (x &gt;&gt; i) &amp; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(ch[p][id] == <span class="number">0</span>) ch[p][id] = sze++;</span><br><span class="line">        p = ch[p][id];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> p = <span class="number">0</span>, ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">        <span class="keyword">int</span> id = (x &gt;&gt; i) &amp; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(ch[p][id] &gt; <span class="number">0</span>) p = ch[p][id];</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            ans |= <span class="number">1</span> &lt;&lt; i;</span><br><span class="line">            p = ch[p][id ^ <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ll ans = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sove</span><span class="params">(<span class="keyword">int</span> d, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l &lt; <span class="number">1</span> || r &gt; n || l &gt; r || d &lt; <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> L = l - <span class="number">1</span>, R = r + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = l; i &lt;= r; i++)</span><br><span class="line">        <span class="keyword">if</span>(w[i] &amp; <span class="number">1</span> &lt;&lt; d) c[--R] = w[i];</span><br><span class="line">        <span class="keyword">else</span> c[++L] = w[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = l; i &lt;= r; i++) w[i] = c[i];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">sove</span>(d - <span class="number">1</span>, l, L);</span><br><span class="line">    <span class="built_in">sove</span>(d - <span class="number">1</span>, R, r);</span><br><span class="line">    <span class="keyword">if</span>(L &lt; l || R &gt; r) <span class="keyword">return</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = l; i &lt;= L; i++) <span class="built_in">insert</span>(w[i]);</span><br><span class="line">    <span class="keyword">int</span> m = inf;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = R; i &lt;= r; i++) m = <span class="built_in">min</span>(m, <span class="built_in">query</span>(w[i]));</span><br><span class="line">    ans += m;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; sze; i++) ch[i][<span class="number">0</span>] = ch[i][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    sze = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n); <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, w + i);</span><br><span class="line">    <span class="built_in">sove</span>(N - <span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ¨¡æ¿è§„å®šèŠ‚ç‚¹ä»1å¼€å§‹æ ‡å·ï¼Œç‚¹æƒ$w_i&lt;2^{30}$ï¼Œå…·ä½“é¢˜ç›®åº”è¯¥ç»“åˆèŒƒå›´è¿›è¡Œå…·ä½“åˆ†æã€‚</p><h3 id="å›¾çš„åŒ¹é…"><a href="#å›¾çš„åŒ¹é…" class="headerlink" title="å›¾çš„åŒ¹é…"></a>å›¾çš„åŒ¹é…</h3><h4 id="äºŒåˆ†å›¾æœ€å¤§åŒ¹é…"><a href="#äºŒåˆ†å›¾æœ€å¤§åŒ¹é…" class="headerlink" title="äºŒåˆ†å›¾æœ€å¤§åŒ¹é…"></a>äºŒåˆ†å›¾æœ€å¤§åŒ¹é…</h4><h5 id="åŒˆç‰™åˆ©ç®—æ³•"><a href="#åŒˆç‰™åˆ©ç®—æ³•" class="headerlink" title="åŒˆç‰™åˆ©ç®—æ³•"></a>åŒˆç‰™åˆ©ç®—æ³•</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> manx = <span class="number">510</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, n1, n2, m;</span><br><span class="line"><span class="keyword">int</span> head[maxn &lt;&lt; <span class="number">1</span>], top = <span class="number">0</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">star</span>&#123;</span><span class="keyword">int</span> to, next;&#125;;</span><br><span class="line">star edge[maxn * maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> vis[maxn &lt;&lt; <span class="number">1</span>], match[maxn &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[u]; ~i; i = edge[i].next) <span class="keyword">if</span>(!vis[edge[i].to])&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; vis[to] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(!match[to] || <span class="built_in">find</span>(match[to]))&#123;</span><br><span class="line">            match[to] = u;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">hungary</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="built_in">clr</span>(vis, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">find</span>(i)) ans++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ans[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="built_in">clr</span>(head, <span class="number">-1</span>);</span><br><span class="line"> <span class="comment">//è¯»å…¥n1, n2, m, è¡¨ç¤ºä¸¤è¾¹ç‚¹é›†çš„æ•°é‡å’Œè¾¹æ•°ï¼Œå–n = max(n1, n2)ä½œä¸ºåºå·çš„åç§»é‡ã€‚</span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;n1, &amp;n2, &amp;m); n = <span class="built_in">max</span>(n1, n2);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> u, v; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">        <span class="built_in">add</span>(u, v + n);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">hungary</span>());</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n2; i++) ans[match[i + n]] = i;</span><br><span class="line">    <span class="built_in">prt</span>(ans + <span class="number">1</span>, n1);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åŒˆç‰™åˆ©ç®—æ³•ï¼Œä¸¤è¾¹ç‚¹é›†å¤§å°å‡ä¸ºmaxnï¼Œå› è€Œæœ‰å…³æ•°ç»„éœ€è¦å¼€è‡³2å€ç”šè‡³æ›´å¤šã€‚</p><p>å¤æ‚åº¦$O(nm)$</p><p><strong>æ¯æ¬¡ä¸ºaiåˆ†é…è·¯å¾„çš„æ—¶å€™éƒ½è¦å¯¹visæ•°ç»„åˆå§‹åŒ–ï¼Œå¤šç»„æ•°æ®çš„æ—¶å€™å¤æ‚åº¦ä¼šå˜æˆO(Tmaxn), è®°å¾—æ”¹æ‰memsetï¼</strong></p><h5 id="æœ€å¤§æµ-Dinicå®ç°"><a href="#æœ€å¤§æµ-Dinicå®ç°" class="headerlink" title="æœ€å¤§æµ(Dinicå®ç°)"></a>æœ€å¤§æµ(Dinicå®ç°)</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> itn maxn = <span class="number">1200</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxe = <span class="number">120000</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> ll inf = <span class="number">1ll</span> &lt;&lt; <span class="number">60</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">star</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> to, next, w;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">int</span> head[maxn], top = <span class="number">0</span>;</span><br><span class="line">star edge[maxe &lt;&lt; <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span> </span>&#123;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    edge[top].w = w;</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> d[maxn], cur[maxn];</span><br><span class="line"><span class="function">ll <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t, ll flow)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (flow == <span class="number">0</span> || s == t)</span><br><span class="line">        <span class="keyword">return</span> flow;</span><br><span class="line"></span><br><span class="line">    ll res = <span class="number">0</span>, f;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = cur[s]; ~i; i = edge[i].next) &#123;</span><br><span class="line">        cur[s] = i;</span><br><span class="line">        <span class="keyword">if</span> (d[edge[i].to] == d[s] + <span class="number">1</span>) &#123;</span><br><span class="line">            f = <span class="built_in">dfs</span>(edge[i].to, t, <span class="built_in">min</span>(flow, (ll)edge[i].w));</span><br><span class="line">            edge[i].w -= f;</span><br><span class="line">            edge[i ^ <span class="number">1</span>].w += f;</span><br><span class="line">            res += f;</span><br><span class="line">            flow -= f;</span><br><span class="line">            <span class="keyword">if</span> (flow == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">queue&lt;<span class="keyword">int</span>&gt; q, q0;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">bfs</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">clr</span>(d, <span class="number">0</span>);</span><br><span class="line">    q = q0;</span><br><span class="line">    q.<span class="built_in">push</span>(s);</span><br><span class="line">    cur[s] = head[s];</span><br><span class="line">    d[s] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (!q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="keyword">int</span> now = q.<span class="built_in">front</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = head[now]; ~i; i = edge[i].next)</span><br><span class="line">            <span class="keyword">if</span> (!d[edge[i].to] &amp;&amp; edge[i].w &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                cur[edge[i].to] = head[edge[i].to];</span><br><span class="line">                d[edge[i].to] = d[now] + <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span> (edge[i].to == t)</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                q.<span class="built_in">push</span>(edge[i].to);</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">dinic</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t)</span> </span>&#123;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">bfs</span>(s, t)) ans += <span class="built_in">dfs</span>(s, t, inf);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="built_in">clr</span>(head, <span class="number">-1</span>);</span><br><span class="line">     <span class="comment">//è¯»å…¥n1, n2, m, è¡¨ç¤ºä¸¤è¾¹ç‚¹é›†çš„æ•°é‡å’Œè¾¹æ•°ï¼Œå–n = max(n1, n2)ä½œä¸ºåºå·çš„åç§»é‡ã€‚</span></span><br><span class="line">    <span class="keyword">int</span> n1, n2, m, n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;n1, &amp;n2, &amp;m); n = <span class="built_in">max</span>(n1, n2);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> u, v; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">        <span class="built_in">add</span>(u, v + n, <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">add</span>(v + n, u, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n1; i++)&#123;<span class="built_in">add</span>(<span class="number">0</span>, i, <span class="number">1</span>); <span class="built_in">add</span>(i, <span class="number">0</span>, <span class="number">0</span>);&#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n2; i++)&#123;<span class="built_in">add</span>(i + n, <span class="number">2</span> * n + <span class="number">1</span>, <span class="number">1</span>); <span class="built_in">add</span>(<span class="number">2</span> * n + <span class="number">1</span>, i + n, <span class="number">0</span>);&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">dinic</span>(<span class="number">0</span>, <span class="number">2</span> * n + <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥è¯æ˜ï¼ŒDinicå®ç°äºŒåˆ†å›¾çš„æœ€å¤§æµå¤æ‚åº¦$O(\sqrt n m)$ï¼Œæ¯”æœ´ç´ çš„åŒˆç‰™åˆ©ç®—æ³•è¦å¿«ä¸Šä¸€äº›ã€‚</p><p>ä¸è¿‡å¦‚æœä½¿ç”¨äº†ç½‘ç»œæµç®—æ³•å¯èƒ½å°±ä¸èƒ½æ‰¾å‡ºåŒ¹é…æ–¹æ¡ˆäº†ã€‚</p><h4 id="äºŒåˆ†å›¾æœ€å¤§æƒåŒ¹é…"><a href="#äºŒåˆ†å›¾æœ€å¤§æƒåŒ¹é…" class="headerlink" title="äºŒåˆ†å›¾æœ€å¤§æƒåŒ¹é…"></a>äºŒåˆ†å›¾æœ€å¤§æƒåŒ¹é…</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">410</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> a[maxn][maxn];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">int</span> match[maxn];</span><br><span class="line"><span class="keyword">int</span> ex[<span class="number">2</span>][maxn], vis[<span class="number">2</span>][maxn];;</span><br><span class="line"><span class="keyword">int</span> slack[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> now)</span></span>&#123;</span><br><span class="line">    vis[<span class="number">0</span>][now] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="keyword">if</span>(!vis[<span class="number">1</span>][i])&#123;</span><br><span class="line">        <span class="keyword">int</span> gap = ex[<span class="number">0</span>][now] + ex[<span class="number">1</span>][i] - a[now][i];</span><br><span class="line">        <span class="keyword">if</span>(gap == <span class="number">0</span>)&#123;</span><br><span class="line">            vis[<span class="number">1</span>][i] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(match[i] == <span class="number">-1</span> || <span class="built_in">dfs</span>(match[i]))&#123; match[i] = now; <span class="keyword">return</span> <span class="number">1</span>; &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> slack[i] = <span class="built_in">min</span>(slack[i], gap);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">km</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;match[i] = <span class="number">-1</span>; ex[<span class="number">0</span>][i] = ex[<span class="number">1</span>][i] = <span class="number">0</span>;&#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++) ex[<span class="number">0</span>][i] = <span class="built_in">max</span>(ex[<span class="number">0</span>][i], a[i][j]);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) slack[i] = inf;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) vis[<span class="number">0</span>][i] = vis[<span class="number">1</span>][i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">dfs</span>(i)) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> d = inf; <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="keyword">if</span>(!vis[<span class="number">1</span>][i]) d = <span class="built_in">min</span>(d, slack[i]);</span><br><span class="line">            <span class="keyword">int</span> pos = <span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(vis[<span class="number">0</span>][i]) ex[<span class="number">0</span>][i] -= d;</span><br><span class="line">                <span class="keyword">if</span>(vis[<span class="number">1</span>][i]) ex[<span class="number">1</span>][i] += d;</span><br><span class="line">                <span class="keyword">else</span>&#123;</span><br><span class="line">                    slack[i] -= d;</span><br><span class="line">                    <span class="keyword">if</span>(slack[i] == <span class="number">0</span>) pos = i;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">assert</span>(pos != <span class="number">-1</span>);</span><br><span class="line">            <span class="keyword">if</span>(match[pos] == <span class="number">-1</span>) <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">int</span> u = match[pos];</span><br><span class="line">            vis[<span class="number">0</span>][u] = vis[<span class="number">1</span>][pos] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="keyword">if</span>(!vis[<span class="number">1</span>][i]) slack[i] = <span class="built_in">min</span>(slack[i], ex[<span class="number">0</span>][u] + ex[<span class="number">1</span>][i] - a[u][i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) vis[<span class="number">0</span>][i] = vis[<span class="number">1</span>][i] = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    ll res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) res += a[match[i]][i];</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ans[maxn];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="keyword">int</span> n1, n2, m; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;n1, &amp;n2, &amp;m);</span><br><span class="line">    n = <span class="built_in">max</span>(n1, n2);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> u, v, w; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;u, &amp;v, &amp;w);</span><br><span class="line">        u--; v--; a[u][v] = w;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">km</span>());</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n2; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(match[i] == <span class="number">-1</span>) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span>(a[match[i]][i] == <span class="number">0</span>) ans[match[i]] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span> ans[match[i]] = i + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n1; i++) <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, ans[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¯»å…¥å·¦å³ç‚¹æ•°å’Œè¾¹æ•°ï¼Œæ¥ä¸‹æ¥è·Ÿmè¡Œæœ‰å‘è¾¹åŠå…¶è¾¹æƒã€‚</p><p>ç‚¹æ•°èŒƒå›´400ï¼Œè¾¹æƒ1e9ã€‚</p><p><strong>æ‰¾å¢å¹¿è·¯å¾„çš„dfsä¸èƒ½æ”¾åœ¨whileå¾ªç¯ä¸­ï¼Œä¸ç„¶æˆä¸ºå‡ç®—æ³•$O(n^4)$ã€‚</strong></p><p>ä¸ºäº†ä¿®æ”¹æ ‡è®°ä½¿ä¸€æ¡å¯è¡Œå¢å¹¿è·¯å­˜åœ¨åªéœ€è¦ä¿®æ”¹slack tagå³å¯ï¼Œå› ä¸ºåªéœ€è¦åœ¨whileå¾ªç¯ä¸­æ›´æ–°slackå³å¯ã€‚</p><h3 id="æµç®—æ³•"><a href="#æµç®—æ³•" class="headerlink" title="æµç®—æ³•"></a>æµç®—æ³•</h3><h4 id="æœ€å¤§æµ"><a href="#æœ€å¤§æµ" class="headerlink" title="æœ€å¤§æµ"></a>æœ€å¤§æµ</h4><h5 id="dinic-å½“å‰å¼§ä¼˜åŒ–"><a href="#dinic-å½“å‰å¼§ä¼˜åŒ–" class="headerlink" title="dinic (å½“å‰å¼§ä¼˜åŒ–)"></a>dinic (å½“å‰å¼§ä¼˜åŒ–)</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> itn maxn = <span class="number">1200</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxe = <span class="number">120000</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> ll inf = <span class="number">1ll</span> &lt;&lt; <span class="number">60</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">star</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> to, next, w;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">int</span> head[maxn], top = <span class="number">0</span>;</span><br><span class="line">star edge[maxe &lt;&lt; <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span> </span>&#123;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    edge[top].w = w;</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> d[maxn], cur[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t, ll flow)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (flow == <span class="number">0</span> || s == t)</span><br><span class="line">        <span class="keyword">return</span> flow;</span><br><span class="line"></span><br><span class="line">    ll res = <span class="number">0</span>, f;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = cur[s]; ~i; i = edge[i].next) &#123;</span><br><span class="line">        cur[s] = i;</span><br><span class="line">        <span class="keyword">if</span> (d[edge[i].to] == d[s] + <span class="number">1</span>) &#123;</span><br><span class="line">            f = <span class="built_in">dfs</span>(edge[i].to, t, <span class="built_in">min</span>(flow, (ll)edge[i].w));</span><br><span class="line">            edge[i].w -= f;</span><br><span class="line">            edge[i ^ <span class="number">1</span>].w += f;</span><br><span class="line">            res += f;</span><br><span class="line">            flow -= f;</span><br><span class="line">            <span class="keyword">if</span> (flow == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">queue&lt;<span class="keyword">int</span>&gt; q, q0;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">bfs</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">clr</span>(d, <span class="number">0</span>);</span><br><span class="line">    q = q0;</span><br><span class="line">    q.<span class="built_in">push</span>(s);</span><br><span class="line">    cur[s] = head[s];</span><br><span class="line">    d[s] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (!q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="keyword">int</span> now = q.<span class="built_in">front</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = head[now]; ~i; i = edge[i].next)</span><br><span class="line">            <span class="keyword">if</span> (!d[edge[i].to] &amp;&amp; edge[i].w &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                cur[edge[i].to] = head[edge[i].to];</span><br><span class="line">                d[edge[i].to] = d[now] + <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span> (edge[i].to == t)</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                q.<span class="built_in">push</span>(edge[i].to);</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">dinic</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t)</span> </span>&#123;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">bfs</span>(s, t)) ans += <span class="built_in">dfs</span>(s, t, inf);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="built_in">clr</span>(head, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">int</span> n, m, s, t;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d %d&quot;</span>, &amp;n, &amp;m, &amp;s, &amp;t);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, u, v, w; i &lt; m; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;u, &amp;v, &amp;w);</span><br><span class="line">        <span class="built_in">add</span>(u, v, w);</span><br><span class="line">        <span class="built_in">add</span>(v, u, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">dinic</span>(s, t));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>$O(n^2  m)$</p><h5 id="isap-gapä¼˜åŒ–"><a href="#isap-gapä¼˜åŒ–" class="headerlink" title="isap (gapä¼˜åŒ–)"></a>isap (gapä¼˜åŒ–)</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> itn maxn = <span class="number">1200</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxe = <span class="number">120000</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> ll inf = <span class="number">1ll</span> &lt;&lt; <span class="number">60</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">star</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> to, next, w;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">int</span> n, m, s, t;</span><br><span class="line"><span class="keyword">int</span> head[maxn], top = <span class="number">0</span>;</span><br><span class="line">star edge[maxe &lt;&lt; <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span> </span>&#123;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    edge[top].w = w;</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> d[maxn], cur[maxn], gap[maxn];</span><br><span class="line"></span><br><span class="line">queue&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bfs</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t)</span> </span>&#123;</span><br><span class="line">    q.<span class="built_in">push</span>(t);</span><br><span class="line">    gap[d[t] = <span class="number">1</span>]++;</span><br><span class="line">    cur[t] = head[t];</span><br><span class="line">    <span class="keyword">while</span> (!q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="keyword">int</span> now = q.<span class="built_in">front</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = head[now]; ~i; i = edge[i].next)</span><br><span class="line">            <span class="keyword">if</span> (!d[edge[i].to]) &#123;</span><br><span class="line">                gap[d[edge[i].to] = d[now] + <span class="number">1</span>]++;</span><br><span class="line">                cur[edge[i].to] = head[edge[i].to];</span><br><span class="line">                q.<span class="built_in">push</span>(edge[i].to);</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> s, <span class="keyword">int</span> t, ll flow)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x == t)</span><br><span class="line">        <span class="keyword">return</span> flow;</span><br><span class="line"></span><br><span class="line">    ll res = <span class="number">0</span>, f;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = cur[x]; ~i; i = edge[i].next) &#123;</span><br><span class="line">        cur[x] = i;</span><br><span class="line">        <span class="keyword">if</span> (d[x] == d[edge[i].to] + <span class="number">1</span>) &#123;</span><br><span class="line">            f = <span class="built_in">dfs</span>(edge[i].to, s, t, <span class="built_in">min</span>(flow, (ll)edge[i].w));</span><br><span class="line">            edge[i].w -= f;</span><br><span class="line">            edge[i ^ <span class="number">1</span>].w += f;</span><br><span class="line">            flow -= f;</span><br><span class="line">            res += f;</span><br><span class="line">            <span class="keyword">if</span> (flow == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">return</span> res;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!(gap[d[x]]--))</span><br><span class="line">        d[s] = n + <span class="number">1</span>;</span><br><span class="line">    gap[++d[x]]++;</span><br><span class="line">    cur[x] = head[x];</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">isap</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">bfs</span>(s, t);</span><br><span class="line">    ll ans = <span class="built_in">dfs</span>(s, s, t, inf);</span><br><span class="line">    <span class="keyword">while</span> (d[s] &lt;= n) ans += <span class="built_in">dfs</span>(s, s, t, inf);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="built_in">clr</span>(head, <span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d %d&quot;</span>, &amp;n, &amp;m, &amp;s, &amp;t);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, u, v, w; i &lt; m; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;u, &amp;v, &amp;w);</span><br><span class="line">        <span class="built_in">add</span>(u, v, w);</span><br><span class="line">        <span class="built_in">add</span>(v, u, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">isap</span>(s, t));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>$O(n^2  m)$</p><h5 id="æœ€é«˜æ ‡å·é¢„æµæ¨è¿›HLPP"><a href="#æœ€é«˜æ ‡å·é¢„æµæ¨è¿›HLPP" class="headerlink" title="æœ€é«˜æ ‡å·é¢„æµæ¨è¿›HLPP"></a>æœ€é«˜æ ‡å·é¢„æµæ¨è¿›HLPP</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf = INT_MAX;</span><br><span class="line"><span class="keyword">const</span> ll INF = (<span class="number">0x3f3f3f3f3f3f3f3f</span>ll);</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1.2e3</span> + <span class="number">5</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">HLPP</span> &#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Edge</span> &#123;</span></span><br><span class="line">        <span class="keyword">int</span> v, rev;</span><br><span class="line">        ll cap;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">int</span> n, sp, tp, lim, ht, lcnt;</span><br><span class="line">    ll exf[maxn];</span><br><span class="line">    vector&lt;Edge&gt; G[maxn];</span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; hq[maxn], gap[maxn], h, sum;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> nn, <span class="keyword">int</span> s, <span class="keyword">int</span> t)</span> </span>&#123;</span><br><span class="line">        sp = s, tp = t, n = nn, lim = n + <span class="number">1</span>, ht = lcnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) G[i].<span class="built_in">clear</span>(), exf[i] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add_edge</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, ll cap)</span> </span>&#123;</span><br><span class="line">        G[u].<span class="built_in">push_back</span>(&#123; v, <span class="built_in"><span class="keyword">int</span></span>(G[v].<span class="built_in">size</span>()), cap &#125;);</span><br><span class="line">        G[v].<span class="built_in">push_back</span>(&#123; u, <span class="built_in"><span class="keyword">int</span></span>(G[u].<span class="built_in">size</span>()) - <span class="number">1</span>, <span class="number">0</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> nh)</span> </span>&#123;</span><br><span class="line">        ++lcnt;</span><br><span class="line">        <span class="keyword">if</span> (h[u] != lim)</span><br><span class="line">            --sum[h[u]];</span><br><span class="line">        h[u] = nh;</span><br><span class="line">        <span class="keyword">if</span> (nh == lim)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        ++sum[ht = nh];</span><br><span class="line">        gap[nh].<span class="built_in">push_back</span>(u);</span><br><span class="line">        <span class="keyword">if</span> (exf[u] &gt; <span class="number">0</span>)</span><br><span class="line">            hq[nh].<span class="built_in">push_back</span>(u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">relabel</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        queue&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= lim; ++i) hq[i].<span class="built_in">clear</span>(), gap[i].<span class="built_in">clear</span>();</span><br><span class="line">        h.<span class="built_in">assign</span>(lim, lim), sum.<span class="built_in">assign</span>(lim, <span class="number">0</span>), q.<span class="built_in">push</span>(tp);</span><br><span class="line">        lcnt = ht = h[tp] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (!q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="keyword">int</span> u = q.<span class="built_in">front</span>();</span><br><span class="line">            q.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">for</span> (Edge &amp;e : G[u])</span><br><span class="line">                <span class="keyword">if</span> (h[e.v] == lim &amp;&amp; G[e.v][e.rev].cap)</span><br><span class="line">                    <span class="built_in">update</span>(e.v, h[u] + <span class="number">1</span>), q.<span class="built_in">push</span>(e.v);</span><br><span class="line">            ht = h[u];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">push</span><span class="params">(<span class="keyword">int</span> u, Edge &amp;e)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!exf[e.v])</span><br><span class="line">            hq[h[e.v]].<span class="built_in">push_back</span>(e.v);</span><br><span class="line">        ll df = <span class="built_in">min</span>(exf[u], e.cap);</span><br><span class="line">        e.cap -= df, G[e.v][e.rev].cap += df;</span><br><span class="line">        exf[u] -= df, exf[e.v] += df;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">discharge</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> nh = lim;</span><br><span class="line">        <span class="keyword">if</span> (h[u] == lim)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">for</span> (Edge &amp;e : G[u]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!e.cap)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span> (h[u] == h[e.v] + <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="built_in">push</span>(u, e);</span><br><span class="line">                <span class="keyword">if</span> (exf[u] &lt;= <span class="number">0</span>)</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (nh &gt; h[e.v] + <span class="number">1</span>)</span><br><span class="line">                nh = h[e.v] + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (sum[h[u]] &gt; <span class="number">1</span>)</span><br><span class="line">            <span class="built_in">update</span>(u, nh);</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (; ht &gt;= h[u]; gap[ht--].<span class="built_in">clear</span>())</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> &amp;i : gap[ht]) <span class="built_in">update</span>(i, lim);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ll <span class="title">hlpp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        exf[sp] = INF, exf[tp] = -INF, <span class="built_in">relabel</span>();</span><br><span class="line">        <span class="keyword">for</span> (Edge &amp;e : G[sp]) <span class="built_in">push</span>(sp, e);</span><br><span class="line">        <span class="keyword">for</span> (; ~ht; --ht) &#123;</span><br><span class="line">            <span class="keyword">while</span> (!hq[ht].<span class="built_in">empty</span>()) &#123;</span><br><span class="line">                <span class="keyword">int</span> u = hq[ht].<span class="built_in">back</span>();</span><br><span class="line">                hq[ht].<span class="built_in">pop_back</span>();</span><br><span class="line">                <span class="built_in">discharge</span>(u);</span><br><span class="line">                <span class="keyword">if</span> (lcnt &gt; (n &lt;&lt; <span class="number">2</span>))</span><br><span class="line">                    <span class="built_in">relabel</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> exf[tp] + INF;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; hp;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>), cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">int</span> n, m, s, t, u, v, w;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; s &gt;&gt; t;</span><br><span class="line">    hp.<span class="built_in">init</span>(n, s, t);</span><br><span class="line">    <span class="keyword">while</span> (m--) &#123;</span><br><span class="line">        cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class="line">        hp.<span class="built_in">add_edge</span>(u, v, w);</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; hp.<span class="built_in">hlpp</span>() &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>loj127 </p><p>å·å…¶æ¿ï¼Œä¸çŸ¥å…¶æ‰€ä»¥ç„¶ã€‚</p><p><del>ç”šè‡³ä¸çŸ¥å…¶ç„¶qaq</del></p><p>$O(n^2 \sqrt m)$</p><h4 id="è´¹ç”¨æµ-dijstra"><a href="#è´¹ç”¨æµ-dijstra" class="headerlink" title="è´¹ç”¨æµ (dijstra)"></a>è´¹ç”¨æµ (dijstra)</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> ll inf = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">410</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxe = <span class="number">2e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">star</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> from, to, next; ll c, w;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">int</span> head[maxn], top = <span class="number">0</span>;</span><br><span class="line">star edge[maxe &lt;&lt; <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> c, <span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line">    edge[top].from = u;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].c = c;</span><br><span class="line">    edge[top].w = w;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ll dis[maxn], h[maxn];</span><br><span class="line"><span class="keyword">int</span> pre[maxn];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NODE</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> u; ll d;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> NODE &amp;b)<span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> d &gt; b.d;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">priority_queue&lt;NODE&gt; pq, pq0;</span><br><span class="line"><span class="function">ll <span class="title">mcmf</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t, ll f, ll &amp;flow)</span></span>&#123;</span><br><span class="line">    ll res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(f)&#123;</span><br><span class="line">        <span class="built_in">clr</span>(dis, <span class="number">0x3f</span>); dis[s] = <span class="number">0</span>;</span><br><span class="line">        pq = pq0; pq.<span class="built_in">push</span>(&#123;s, dis[s]&#125;);</span><br><span class="line">        <span class="keyword">while</span>(!pq.<span class="built_in">empty</span>())&#123;</span><br><span class="line">            NODE temp = pq.<span class="built_in">top</span>(); pq.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">int</span> u = temp.u; ll d = temp.d;</span><br><span class="line">            <span class="keyword">if</span>(dis[u] &lt; d) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = head[u]; ~i; i = edge[i].next)&#123;</span><br><span class="line">                <span class="keyword">int</span> to = edge[i].to;</span><br><span class="line">                <span class="keyword">if</span>(edge[i].c &gt; <span class="number">0</span> &amp;&amp; dis[to] &gt; dis[u] + edge[i].w + h[u] - h[to])&#123;</span><br><span class="line">                    dis[to] = dis[u] + edge[i].w + h[u] - h[to];</span><br><span class="line">                    pre[to] = i;</span><br><span class="line">                    pq.<span class="built_in">push</span>(&#123;to, dis[to]&#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(dis[t] == inf) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) h[i] += dis[i];</span><br><span class="line">        </span><br><span class="line">        ll d = f;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> now = t; now != s; now = edge[pre[now]].from) d = <span class="built_in">min</span>(d, edge[pre[now]].c);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> now = t; now != s; now = edge[pre[now]].from)&#123;</span><br><span class="line">            edge[pre[now]].c -= d;</span><br><span class="line">            edge[pre[now] ^ <span class="number">1</span>].c += d;</span><br><span class="line">        &#125;</span><br><span class="line">        f -= d; flow += d; res += d * h[t];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="built_in">clr</span>(head, <span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> u, v, c, w; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d %d&quot;</span>, &amp;u, &amp;v, &amp;c, &amp;w);</span><br><span class="line">        <span class="built_in">add</span>(u, v, c, w); <span class="built_in">add</span>(v, u, <span class="number">0</span>, -w);</span><br><span class="line">    &#125;</span><br><span class="line">    ll flow = <span class="number">0</span>;</span><br><span class="line">    ll res = <span class="built_in">mcmf</span>(<span class="number">1</span>, n, inf, flow);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld %lld\n&quot;</span>, flow, res);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>loj102 å•ç»„æ•°æ®æœ€æ…¢700mså·¦å³</p><p>$V&lt;=400, E&lt;=15000$</p><p>æ—¶é—´å¤æ‚åº¦$O(FElogV)$</p><h3 id="çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾"><a href="#çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾" class="headerlink" title="çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾"></a>çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mid ((l + r) &gt;&gt; 1)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">5e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxe = <span class="number">4e7</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> M;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m, p;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> &#123;</span><span class="keyword">int</span> to, next, w;&#125;edge[maxe];</span><br><span class="line"><span class="keyword">int</span> head[maxe], top = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].w = w;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">0</span>, pos[maxn], ls[maxn &lt;&lt; <span class="number">3</span>], rs[maxn &lt;&lt; <span class="number">3</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> now = cnt++;</span><br><span class="line">    <span class="keyword">if</span>(l == r)&#123;</span><br><span class="line">        <span class="built_in">add</span>(now, now + M, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> pos[l] = now;</span><br><span class="line">    &#125;</span><br><span class="line">    ls[now] = <span class="built_in">build</span>(l, mid);</span><br><span class="line">    <span class="built_in">add</span>(now, ls[now], <span class="number">0</span>); <span class="built_in">add</span>(ls[now] + M, now + M, <span class="number">0</span>);</span><br><span class="line">    rs[now] = <span class="built_in">build</span>(mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="built_in">add</span>(now, rs[now], <span class="number">0</span>); <span class="built_in">add</span>(rs[now] + M, now + M, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> now;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> u, <span class="keyword">int</span> type)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= l &amp;&amp; r &lt;= R)&#123;</span><br><span class="line">        <span class="keyword">if</span>(type) <span class="built_in">add</span>(p + M, u, <span class="number">1</span>); <span class="keyword">else</span> <span class="built_in">add</span>(u, p, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= mid) <span class="built_in">update</span>(ls[p], l, mid, L, R, u, type);</span><br><span class="line">    <span class="keyword">if</span>(R &gt; mid) <span class="built_in">update</span>(rs[p], mid + <span class="number">1</span>, r, L, R, u, type);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> dis[<span class="number">5000000</span>];</span><br><span class="line">deque&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bfs</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">clr</span>(dis, <span class="number">0x3f</span>);</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>()) q.<span class="built_in">pop_back</span>();</span><br><span class="line">    </span><br><span class="line">    dis[pos[p]] = <span class="number">0</span>; q.<span class="built_in">push_back</span>(pos[p]);</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())&#123;</span><br><span class="line">        <span class="keyword">int</span> now = q.<span class="built_in">front</span>(); q.<span class="built_in">pop_front</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = head[now]; ~i; i = edge[i].next)&#123;</span><br><span class="line">            <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(dis[to] != <span class="number">0x3f3f3f3f</span>) <span class="keyword">continue</span>;</span><br><span class="line">            dis[to] = dis[now] + edge[i].w;</span><br><span class="line">            <span class="keyword">if</span>(edge[i].w) q.<span class="built_in">push_back</span>(to);</span><br><span class="line">            <span class="keyword">else</span> q.<span class="built_in">push_front</span>(to);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="built_in">clr</span>(head, <span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;n, &amp;m, &amp;p);</span><br><span class="line">    M = n &lt;&lt; <span class="number">2</span>; <span class="built_in">build</span>(<span class="number">1</span>, n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> a, b, c, d; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d %d&quot;</span>, &amp;a, &amp;b, &amp;c, &amp;d);</span><br><span class="line">        <span class="comment">//åŠ å…¥è™šç‚¹i + 2Mä¸i + 1 + 2M;</span></span><br><span class="line">        <span class="built_in">update</span>(<span class="number">0</span>, <span class="number">1</span>, n, a, b, <span class="number">2</span> * i + <span class="number">2</span> * M, <span class="number">1</span>); <span class="built_in">update</span>(<span class="number">0</span>, <span class="number">1</span>, n, c, d, <span class="number">2</span> * i + <span class="number">2</span> * M, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">update</span>(<span class="number">0</span>, <span class="number">1</span>, n, c, d, <span class="number">2</span> * i + <span class="number">2</span> * M + <span class="number">1</span>, <span class="number">1</span>); <span class="built_in">update</span>(<span class="number">0</span>, <span class="number">1</span>, n, a, b, <span class="number">2</span> * i + <span class="number">2</span> * M + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">bfs</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, dis[pos[i]]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç»™å‡ºnä¸ªèŠ‚ç‚¹ã€mç§è¾¹ã€‚</p><p>å¯¹äºæŸä¸€ç§è¾¹è€Œè¨€ï¼Œæœ‰4ä¸ªå‚æ•°ï¼ša, b, c, dï¼Œè¡¨ç¤ºå¯¹äºæ‰€æœ‰çš„$a \leq x \leq b, c \leq y \leq d$éƒ½æœ‰ä¸€æ¡æ— å‘è¾¹$<x, y>$ç›¸è¿ã€‚</p><p>è¯¢é—®å¯¹äºæŸä¸ªæŒ‡å®šç‚¹pè€Œè¨€ï¼Œåˆ°å…¶ä»–æ‰€æœ‰ç‚¹çš„æœ€çŸ­è·ç¦»</p><p>æ•°æ®èŒƒå›´ $n \leq 5e5, m \leq 1e5$</p><h2 id="4-å¯æŒä¹…åŒ–"><a href="#4-å¯æŒä¹…åŒ–" class="headerlink" title="4 å¯æŒä¹…åŒ–"></a>4 å¯æŒä¹…åŒ–</h2><h3 id="å¯æŒä¹…åŒ–01-Trie"><a href="#å¯æŒä¹…åŒ–01-Trie" class="headerlink" title="å¯æŒä¹…åŒ–01-Trie"></a>å¯æŒä¹…åŒ–01-Trie</h3><p>æœ€åŸºæœ¬çš„ç‰ˆæœ¬å¦‚ä¸‹ï¼Œæ ¹æ®ä¸åŒçš„é¢˜ç›®å¯ä»¥æ·»åŠ ä¸åŒçš„è¾…åŠ©æ•°ç»„ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">30</span>;</span><br><span class="line"><span class="keyword">const</span> itn maxn = <span class="number">1e5</span> * N  +<span class="number">10</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">TRIE</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> version = <span class="number">0</span>, top = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> ch[maxn][<span class="number">2</span>], root[maxn];;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> rot = root[version];</span><br><span class="line">        root[++version] = ++top;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">            <span class="keyword">int</span> id = (x &gt;&gt; i) &amp; <span class="number">1</span>;</span><br><span class="line">            ch[top][id] = top + <span class="number">1</span>; <span class="comment">//æ–°å»º</span></span><br><span class="line">            ch[top][!id] = ch[rot][!id]; <span class="comment">//ç»§æ‰¿</span></span><br><span class="line">            top++; rot = ch[rot][id];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å¤šç»´æŠ¤ä¸€ä¸ªsizeæ•°ç»„è®°å½•å½“å‰èŠ‚ç‚¹ä¸‹æœ‰å¤šå°‘ä¸ªä¸²ï¼Œå¯ç”¨äºåœ¨ä»»æ„åŒºé—´ä¸­æŸ¥æ‰¾åŒºé—´ä¸­æŸä¸ªæ•°å¼‚æˆ–ä¸ŠæŸä¸ªç»™å®šxçš„æœ€å¤§å€¼ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">24</span>;</span><br><span class="line"><span class="keyword">const</span> itn maxn = <span class="number">1e5</span>  +<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">TRIE</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> version = <span class="number">0</span>, top = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> ch[maxn][<span class="number">2</span>], root[maxn];;</span><br><span class="line">    <span class="keyword">int</span> size[maxn];</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> rot = root[version];</span><br><span class="line">        root[++version] = ++top;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">            <span class="keyword">int</span> id = (x &gt;&gt; i) &amp; <span class="number">1</span>;</span><br><span class="line">            ch[top][id] = top + <span class="number">1</span>;</span><br><span class="line">            ch[top][!id] = ch[rot][!id];</span><br><span class="line">            size[top] = size[rot] + <span class="number">1</span>;</span><br><span class="line">            top++; rot = ch[rot][id];</span><br><span class="line">        &#125;</span><br><span class="line">        size[top] = size[rot] + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">  <span class="comment">//æŸ¥æ‰¾[L + 1, R]çš„ç»“æœ</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> L, <span class="keyword">int</span> R, itn x)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> l = root[L], r = root[R];</span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">            <span class="keyword">int</span> id = (x &gt;&gt; i) &amp; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(size[ch[r][!id]] - size[ch[l][!id]] &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                ans |= <span class="number">1</span> &lt;&lt; i;</span><br><span class="line">                r = ch[r][!id]; l = ch[l][!id];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                r = ch[r][id];</span><br><span class="line">                l = ch[l][id];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="å¯æŒä¹…åŒ–æƒå€¼çº¿æ®µæ ‘-é™æ€åŒºé—´ç¬¬kå¤§æŸ¥è¯¢"><a href="#å¯æŒä¹…åŒ–æƒå€¼çº¿æ®µæ ‘-é™æ€åŒºé—´ç¬¬kå¤§æŸ¥è¯¢" class="headerlink" title="å¯æŒä¹…åŒ–æƒå€¼çº¿æ®µæ ‘ é™æ€åŒºé—´ç¬¬kå¤§æŸ¥è¯¢"></a>å¯æŒä¹…åŒ–æƒå€¼çº¿æ®µæ ‘ é™æ€åŒºé—´ç¬¬kå¤§æŸ¥è¯¢</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mid ((l + r) &gt;&gt; 1)</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> a[maxn], c[maxn];</span><br><span class="line">unordered_map&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; mp;</span><br><span class="line"><span class="keyword">int</span> ls[maxn &lt;&lt; N], rs[maxn &lt;&lt; N], root[maxn], num[maxn &lt;&lt; N], top = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> p = top++;</span><br><span class="line">    <span class="keyword">if</span>(l == r) <span class="keyword">return</span> p;</span><br><span class="line">    ls[p] = <span class="built_in">build</span>(l, mid);</span><br><span class="line">    rs[p] = <span class="built_in">build</span>(mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> now = top++;</span><br><span class="line">    ls[now] = ls[p]; rs[now] = rs[p]; num[now] = num[p] + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l == r) <span class="keyword">return</span> now;</span><br><span class="line">    <span class="keyword">if</span>(k &lt;= mid) ls[now] = <span class="built_in">update</span>(ls[p], l, mid, k);</span><br><span class="line">    <span class="keyword">else</span> rs[now] = <span class="built_in">update</span>(rs[p], mid + <span class="number">1</span>, r, k);</span><br><span class="line">    <span class="keyword">return</span> now;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> r1, <span class="keyword">int</span> r2, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="comment">//[L + 1, R]</span></span><br><span class="line">    <span class="keyword">if</span>(l == r) <span class="keyword">return</span> l;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> x = num[ls[r2]] - num[ls[r1]];</span><br><span class="line">    <span class="keyword">if</span>(k &lt;= x) <span class="keyword">return</span> <span class="built_in">query</span>(ls[r1], ls[r2], l, mid, k);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">query</span>(rs[r1], rs[r2], mid + <span class="number">1</span>, r, k - x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="keyword">int</span> n, m; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a + i);</span><br><span class="line">        c[i] = a[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(c + <span class="number">1</span>, c + <span class="number">1</span> + n);</span><br><span class="line">    <span class="keyword">int</span> N = (<span class="keyword">int</span>)(<span class="built_in">unique</span>(c + <span class="number">1</span>, c + <span class="number">1</span> + n) - (c + <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++) mp[c[i]] = i;</span><br><span class="line">    </span><br><span class="line">    root[<span class="number">0</span>] = <span class="built_in">build</span>(<span class="number">1</span>, N);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        root[i] = <span class="built_in">update</span>(root[i - <span class="number">1</span>], <span class="number">1</span>, N, mp[a[i]]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> l, r, k; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;l, &amp;r, &amp;k);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, c[<span class="built_in">query</span>(root[l - <span class="number">1</span>], root[r], <span class="number">1</span>, N, k)]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="BITå¥—æƒå€¼çº¿æ®µæ ‘-å¸¦å•ç‚¹ä¿®æ”¹çš„åŒºé—´ç¬¬kå¤§æŸ¥è¯¢"><a href="#BITå¥—æƒå€¼çº¿æ®µæ ‘-å¸¦å•ç‚¹ä¿®æ”¹çš„åŒºé—´ç¬¬kå¤§æŸ¥è¯¢" class="headerlink" title="BITå¥—æƒå€¼çº¿æ®µæ ‘ å¸¦å•ç‚¹ä¿®æ”¹çš„åŒºé—´ç¬¬kå¤§æŸ¥è¯¢"></a>BITå¥—æƒå€¼çº¿æ®µæ ‘ å¸¦å•ç‚¹ä¿®æ”¹çš„åŒºé—´ç¬¬kå¤§æŸ¥è¯¢</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">6e4</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m, N;</span><br><span class="line"><span class="keyword">int</span> a[maxn], b[maxn];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NODE</span>&#123;</span><span class="keyword">int</span> type, x, y, z;&#125;;</span><br><span class="line">NODE node[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">hsh</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;<span class="keyword">return</span> (<span class="keyword">int</span>)(<span class="built_in">lower_bound</span>(b + <span class="number">1</span>, b + N, x) - b);&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> s[maxn], rt[maxn], ls[maxn &lt;&lt; <span class="number">5</span>], rs[maxn &lt;&lt; <span class="number">5</span>], st[maxn &lt;&lt; <span class="number">5</span>], top = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> now = top++, mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l == r) <span class="keyword">return</span> now;</span><br><span class="line">    ls[now] = <span class="built_in">build</span>(l, mid);</span><br><span class="line">    rs[now] = <span class="built_in">build</span>(mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="keyword">return</span> now;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ—§ç‰ˆæœ¬çš„èŠ‚ç‚¹æ ‡å·ä¸ºpï¼Œæ‹¥æœ‰åŒºé—´[l, r]ï¼›ç°è¦åœ¨kä½ç½®åŠ å…¥xï¼Œè¿”å›æ–°èŠ‚ç‚¹çš„æ ‡å·</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> now = top++;</span><br><span class="line">    ls[now] = ls[p]; rs[now] = rs[p]; st[now] = st[p] + x;</span><br><span class="line">    <span class="keyword">if</span>(l == r) <span class="keyword">return</span> now;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(k &lt;= mid) ls[now] = <span class="built_in">update</span>(ls[p], l, mid, k, x);</span><br><span class="line">    <span class="keyword">else</span> rs[now] = <span class="built_in">update</span>(rs[p], mid + <span class="number">1</span>, r, k, x);</span><br><span class="line">    <span class="keyword">return</span> now;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> use[maxn];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(x)&#123;</span><br><span class="line">        res += st[ls[use[x]]];</span><br><span class="line">        x -= <span class="built_in">lowbit</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å½“å‰åœ¨çº¿æ®µæ ‘çš„[l, r]ä½ç½®ä¸Šï¼Œå·¦ã€å³æ ¹èŠ‚ç‚¹åˆ†åˆ«ä¸ºr1ã€r2ï¼ŒæŸ¥è¯¢ä¸‹æ ‡åœ¨(L, R]ç¬¬kå°çš„æ•°å­—</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> r1, <span class="keyword">int</span> r2, <span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l == r) <span class="keyword">return</span> l;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="built_in">sum</span>(R) - <span class="built_in">sum</span>(L) + st[ls[r2]] - st[ls[r1]];</span><br><span class="line">    <span class="keyword">if</span>(k &lt;= res)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = L; i; i -= <span class="built_in">lowbit</span>(i)) use[i] = ls[use[i]];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = R; i; i -= <span class="built_in">lowbit</span>(i)) use[i] = ls[use[i]];</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">query</span>(l, mid, ls[r1], ls[r2], L, R, k);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = L; i; i -= <span class="built_in">lowbit</span>(i)) use[i] = rs[use[i]];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = R; i; i -= <span class="built_in">lowbit</span>(i)) use[i] = rs[use[i]];</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">query</span>(mid + <span class="number">1</span>, r, rs[r1], rs[r2], L, R, k - res);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> k, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(i &lt;= N)&#123;</span><br><span class="line">        s[i] = <span class="built_in">update</span>(s[i], <span class="number">1</span>, N, k, x);</span><br><span class="line">        i += <span class="built_in">lowbit</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    TTT&#123;</span><br><span class="line">        top = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a + i);</span><br><span class="line">            b[i] = a[i];</span><br><span class="line">        &#125;</span><br><span class="line">        N = n + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123;</span><br><span class="line">            <span class="keyword">char</span> op[<span class="number">2</span>]; <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, op);</span><br><span class="line">            <span class="keyword">int</span> x, y, z;</span><br><span class="line">            <span class="keyword">if</span>(op[<span class="number">0</span>] == <span class="string">&#x27;Q&#x27;</span>)&#123;</span><br><span class="line">                <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;x, &amp;y, &amp;z);</span><br><span class="line">                node[i] = &#123;<span class="number">0</span>, x, y, z&#125;;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;x, &amp;y);</span><br><span class="line">                node[i] = &#123;<span class="number">1</span>, x, y&#125;;</span><br><span class="line">                b[N++] = y;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">sort</span>(b + <span class="number">1</span>, b + N);</span><br><span class="line">        N = (<span class="keyword">int</span>)(<span class="built_in">unique</span>(b + <span class="number">1</span>, b + N) - (b + <span class="number">1</span>));</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        rt[<span class="number">0</span>] = <span class="built_in">build</span>(<span class="number">1</span>, N);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">            rt[i] = <span class="built_in">update</span>(rt[i - <span class="number">1</span>], <span class="number">1</span>, N, <span class="built_in">hsh</span>(a[i]), <span class="number">1</span>);</span><br><span class="line">            s[i] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123;</span><br><span class="line">            <span class="comment">//ä¿®æ”¹node[i].xä½ç½®çš„å€¼ä¸ºnode[i].y;</span></span><br><span class="line">            <span class="keyword">if</span>(node[i].type)&#123;</span><br><span class="line">                <span class="built_in">update</span>(node[i].x, <span class="built_in">hsh</span>(a[node[i].x]), <span class="number">-1</span>);</span><br><span class="line">                <span class="built_in">update</span>(node[i].x, <span class="built_in">hsh</span>(node[i].y), <span class="number">1</span>);</span><br><span class="line">                a[node[i].x] = node[i].y;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//æŸ¥è¯¢[node[i].x, node[i].y]ä¸­ç¬¬kå°çš„å€¼</span></span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">int</span> l = node[i].x - <span class="number">1</span>, r = node[i].y;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> i = l; i; i -= <span class="built_in">lowbit</span>(i)) use[i] = s[i];</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> i = r; i; i -= <span class="built_in">lowbit</span>(i)) use[i] = s[i];</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, b[<span class="built_in">query</span>(<span class="number">1</span>, N, rt[l], rt[r], l, r, node[i].z)]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><a href="https://zoj.pintia.cn/problem-sets/91827364500/problems/91827365611">ZOJ 2112</a></p><p>åœ¨rt[0]æ„å»ºä¸€ä¸ªç©ºçº¿æ®µæ ‘ï¼Œæ„å»ºä¸¤ä¸²æƒå€¼çº¿æ®µæ ‘ï¼ŒL96-99æ„å»ºåŸå§‹ç‰ˆæœ¬çš„é™æ€çš„ã€å‰ç¼€çš„æƒå€¼çº¿æ®µæ ‘ï¼›å¦ä¸€ä¸²æ„å»º$Î”$çº¿æ®µæ ‘ï¼Œåˆ©ç”¨bitè¿›è¡Œç»´æŠ¤è¿™ä¸€ä¸²çº¿æ®µæ ‘ã€‚æ›´æ–°æ—¶å¯¹logä¸ªçº¿æ®µæ ‘è¿›è¡Œå•ç‚¹æ›´æ–°ï¼Œæ€»èŠ±è´¹$O(log^2n)$ï¼›æŸ¥è¯¢æ—¶ä¸€å±‚ä¸€å±‚è¿›è¡ŒæŸ¥è¯¢ï¼šæŸ¥è¯¢bitä¸Šlogä¸ªçº¿æ®µæ ‘èŠ‚ç‚¹æ‰€æœ‰çš„å·¦å„¿å­ï¼Œå¦‚æœè¿™ä¸€å±‚å·®å€¼çš„å’Œä¸é™æ€å€¼ä¹‹å’Œå°äºç­‰äºkï¼Œå°±å°†bitä¸Šlogä¸ªå­æ ‘çš„èŠ‚ç‚¹æ ‡å·å‘å·¦å„¿å­ç§»åŠ¨ï¼Œé€’å½’åœ°ç±»ä¼¼äºæ™®é€šç¬¬kå¤§æŸ¥è¯¢è¿›è¡Œå¤„ç†å³å¯ã€‚</p><p><strong>å®é™…ä½¿ç”¨æ—¶æ³¨æ„ä»”ç»†ç ”ç©¶ä¸€ä¸‹æ•°æ®èŒƒå›´ï¼</strong></p><h2 id="5-æ ‘"><a href="#5-æ ‘" class="headerlink" title="5 æ ‘"></a>5 æ ‘</h2><h3 id="æ ‘é“¾å‰–åˆ†"><a href="#æ ‘é“¾å‰–åˆ†" class="headerlink" title="æ ‘é“¾å‰–åˆ†"></a>æ ‘é“¾å‰–åˆ†</h3><h4 id="æ±‚lca"><a href="#æ±‚lca" class="headerlink" title="æ±‚lca"></a>æ±‚lca</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">5e5</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, q, rot;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">star</span>&#123;</span><span class="keyword">int</span> from, to, next;&#125;;</span><br><span class="line"><span class="keyword">int</span> head[manx];</span><br><span class="line">star edge[maxn &lt;&lt; <span class="number">1</span>]; <span class="keyword">int</span> top = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(itn u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    edge[top].from = u;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//é»˜è®¤æ ‡å·ä»1å¼€å§‹ï¼Œç»™é‡å„¿å­æ‰“ä¸Šæ ‡è®°ã€‚</span></span><br><span class="line"><span class="keyword">int</span> son[maxn], par[maxn], sze[maxn], dep[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tag</span><span class="params">(<span class="keyword">int</span> now)</span></span>&#123;</span><br><span class="line">    sze[now] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[now]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(to == par[now]) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        par[to] = now; dep[to] = dep[now] + <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">tag</span>(to); </span><br><span class="line">        sze[now] += sze[to];</span><br><span class="line">        <span class="keyword">if</span>(sze[to] &gt; sze[son[now]]) son[now] = to;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å°†è¯¥é‡é“¾çš„èµ·ç‚¹ä½œä¸ºdsuä¸­ä¸€ä¸ªè”é€šå—çš„æ ¹èŠ‚ç‚¹</span></span><br><span class="line"><span class="keyword">int</span> tp[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> t)</span></span>&#123;</span><br><span class="line">    <span class="comment">//å­˜åœ¨å„¿å­ï¼Œå³éå¶å­</span></span><br><span class="line">    tp[now] = t;</span><br><span class="line">    <span class="keyword">if</span>(son[now]) <span class="built_in">build</span>(son[now], t);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[now]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(to == par[now] || to == son[now]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">build</span>(to, to);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(tp[u] != tp[v])&#123;</span><br><span class="line">        <span class="keyword">if</span>(dep[tp[u]] &gt; dep[tp[v]]) u = par[tp[u]];</span><br><span class="line">        <span class="keyword">else</span> v = par[tp[v]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dep[u] &lt; dep[v]? u: v;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// Fastin;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">clr</span>(head, <span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;n, &amp;q, &amp;rot);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> u, v; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">        <span class="built_in">add</span>(u, v); <span class="built_in">add</span>(v, u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">tag</span>(rot); <span class="built_in">build</span>(rot, rot);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; q; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> u, v; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">lca</span>(u, v));</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>é€Ÿåº¦å¾ˆå¿«ï¼Œåº”è¯¥æ˜¯åŠæ‰“stå’Œå€å¢ã€‚</p><h4 id="æ”¯æŒè·¯å¾„ä¿®æ”¹-æŸ¥è¯¢ã€å­æ ‘ä¿®æ”¹æŸ¥è¯¢"><a href="#æ”¯æŒè·¯å¾„ä¿®æ”¹-æŸ¥è¯¢ã€å­æ ‘ä¿®æ”¹æŸ¥è¯¢" class="headerlink" title="æ”¯æŒè·¯å¾„ä¿®æ”¹/æŸ¥è¯¢ã€å­æ ‘ä¿®æ”¹æŸ¥è¯¢"></a>æ”¯æŒè·¯å¾„ä¿®æ”¹/æŸ¥è¯¢ã€å­æ ‘ä¿®æ”¹æŸ¥è¯¢</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, q, rot, M;</span><br><span class="line"><span class="keyword">int</span> w[maxn];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">star</span>&#123;</span><span class="keyword">int</span> from, to, next;&#125;;</span><br><span class="line"><span class="keyword">int</span> head[maxn];</span><br><span class="line">star edge[maxn &lt;&lt; <span class="number">1</span>]; <span class="keyword">int</span> top = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(itn u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    edge[top].from = u;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> son[maxn], par[maxn], sze[maxn], dep[maxn];</span><br><span class="line"><span class="comment">//é»˜è®¤æ ‡å·ä»1å¼€å§‹ï¼Œç»™é‡å„¿å­æ‰“ä¸Šæ ‡è®°ã€‚</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getson</span><span class="params">(<span class="keyword">int</span> now)</span></span>&#123;</span><br><span class="line">    sze[now] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[now]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(to == par[now]) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        par[to] = now; dep[to] = dep[now] + <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">getson</span>(to); </span><br><span class="line">        sze[now] += sze[to];</span><br><span class="line">        <span class="keyword">if</span>(sze[to] &gt; sze[son[now]]) son[now] = to;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> tp[maxn];</span><br><span class="line"><span class="comment">//å°†è¯¥é‡é“¾çš„èµ·ç‚¹ä½œä¸ºdsuä¸­ä¸€ä¸ªè”é€šå—çš„æ ¹èŠ‚ç‚¹</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getlink</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> t)</span></span>&#123;</span><br><span class="line">    <span class="comment">//å­˜åœ¨å„¿å­ï¼Œå³éå¶å­</span></span><br><span class="line">    tp[now] = t;</span><br><span class="line">    <span class="keyword">if</span>(son[now]) <span class="built_in">getlink</span>(son[now], t);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[now]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(to == par[now] || to == son[now]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">getlink</span>(to, to);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//dfnä¸ºdfnåºï¼Œposä¸ºæŸä¸ªèŠ‚ç‚¹åœ¨dfnä¸­çš„ä½ç½®;</span></span><br><span class="line"><span class="keyword">int</span> r[maxn], pos[maxn], cnt = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> now)</span></span>&#123;</span><br><span class="line">    pos[now] = cnt; cnt++;</span><br><span class="line">    <span class="keyword">if</span>(son[now]) <span class="built_in">dfs</span>(son[now]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[now]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(to == par[now] || to == son[now]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(to);</span><br><span class="line">    &#125;</span><br><span class="line">    r[now] = cnt - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ls (p &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rs ((p &lt;&lt; 1) | 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mid ((l + r) &gt;&gt; 1)</span></span><br><span class="line"><span class="comment">//åœ¨dfnä¸Šçš„ä¿®æ”¹&amp;æŸ¥è¯¢,åˆ©ç”¨posæ˜ å°„</span></span><br><span class="line">ll st[maxn &lt;&lt; <span class="number">2</span>], tag[maxn &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">up</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;st[p] = st[ls] + st[rs]; st[p] %= M;&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">down</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(tag[p])&#123;</span><br><span class="line">        tag[p] %= M;</span><br><span class="line">        tag[ls] += tag[p]; tag[rs] += tag[p];</span><br><span class="line">        tag[ls] %= M; tag[rs] %= M;</span><br><span class="line">        st[ls] += (mid - l + <span class="number">1</span>) * tag[p] % M; st[ls] %= M;</span><br><span class="line">        st[rs] += (r - mid) * tag[p]; st[rs] %= M;</span><br><span class="line">        tag[p] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="built_in">assert</span>(L &lt;= R);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(L &lt;= l &amp;&amp; r &lt;= R)&#123;</span><br><span class="line">        st[p] += (r - l + <span class="number">1</span>) * x; st[p] %= M;</span><br><span class="line">        tag[p] += x; tag[p] %= M;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">down</span>(p, l, r);</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= mid) <span class="built_in">update</span>(ls, l, mid, L, R, x);</span><br><span class="line">    <span class="keyword">if</span>(R &gt; mid) <span class="built_in">update</span>(rs, mid + <span class="number">1</span>, r, L, R, x);</span><br><span class="line">    <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">query</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= l &amp;&amp; r &lt;= R) <span class="keyword">return</span> st[p];</span><br><span class="line">    <span class="built_in">down</span>(p, l, r);</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= mid) ans += <span class="built_in">query</span>(ls, l, mid, L, R); ans %= M;</span><br><span class="line">    <span class="keyword">if</span>(R &gt; mid) ans += <span class="built_in">query</span>(rs, mid + <span class="number">1</span>, r, L, R);</span><br><span class="line">    <span class="keyword">return</span> ans % M;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">updatepath</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(tp[u] != tp[v])&#123;</span><br><span class="line">        <span class="keyword">if</span>(dep[tp[u]] &gt; dep[tp[v]])&#123;</span><br><span class="line">            <span class="comment">//uæ‰€åœ¨çš„é‡é“¾æ›´æ·±</span></span><br><span class="line">            <span class="built_in">update</span>(<span class="number">1</span>, <span class="number">0</span>, cnt - <span class="number">1</span>, pos[tp[u]], pos[u], x);</span><br><span class="line">            u = par[tp[u]];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">update</span>(<span class="number">1</span>, <span class="number">0</span>, cnt - <span class="number">1</span>, pos[tp[v]], pos[v], x);</span><br><span class="line">            v = par[tp[v]];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(dep[u] &gt; dep[v]) <span class="built_in">swap</span>(u, v);</span><br><span class="line">    <span class="built_in">udpate</span>(<span class="number">1</span>, <span class="number">0</span>, cnt - <span class="number">1</span>, pos[u], pos[v], x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">pathquery</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(tp[u] != tp[v])&#123;</span><br><span class="line">        <span class="keyword">if</span>(dep[tp[u]] &gt; dep[tp[v]])&#123;</span><br><span class="line">            ans += <span class="built_in">query</span>(<span class="number">1</span>, <span class="number">0</span>, cnt - <span class="number">1</span>, pos[tp[u]], pos[u]);</span><br><span class="line">            ans %= M;</span><br><span class="line">            u = par[tp[u]];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            ans += <span class="built_in">query</span>(<span class="number">1</span>, <span class="number">0</span>, cnt - <span class="number">1</span>, pos[tp[v]], pos[v]);</span><br><span class="line">            ans %= M;</span><br><span class="line">            v = par[tp[v]];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(dep[u] &gt; dep[v]) <span class="built_in">swap</span>(u, v);</span><br><span class="line">    ans += <span class="built_in">query</span>(<span class="number">1</span>, <span class="number">0</span>, cnt - <span class="number">1</span>, pos[u], pos[v]);</span><br><span class="line">    ans %= M;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// Fastin;</span></span><br><span class="line">    <span class="built_in">clr</span>(head, <span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d %d&quot;</span>, &amp;n, &amp;q, &amp;rot, &amp;M);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, w + i);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> u, v; <span class="built_in">scnaf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">        <span class="built_in">add</span>(u, v); <span class="built_in">add</span>(v, u);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">getson</span>(rot); <span class="built_in">getlink</span>(rot, rot); <span class="built_in">dfs</span>(rot); </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">update</span>(<span class="number">1</span>, <span class="number">0</span>, cnt - <span class="number">1</span>, pos[i], pos[i], w[i]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; q; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> op; <span class="built_in">scnaf</span>(<span class="string">&quot;%d&quot;</span>, &amp;op);</span><br><span class="line">        <span class="keyword">int</span> x, y, z; </span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;x, &amp;y, &amp;z);</span><br><span class="line">            <span class="built_in">updatepath</span>(x, y, z);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">2</span>)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;x, &amp;y); <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">pathquery</span>(x, y) % M);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">3</span>)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;x, &amp;y); <span class="built_in">udpate</span>(<span class="number">1</span>, <span class="number">0</span>, cnt - <span class="number">1</span>, pos[x], r[x], y);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x); <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">query</span>(<span class="number">1</span>, <span class="number">0</span>, cnt - <span class="number">1</span>, pos[x], r[x]));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>ä¸ºäº†å……åˆ†åˆ©ç”¨é‡é“¾å’Œdfnåºï¼Œåœ¨dfsæ—¶ä¼˜å…ˆéå†é‡é“¾ï¼Œè¿™æ ·å³å¯ä¿è¯é‡é“¾ä¸Šçš„èŠ‚ç‚¹åœ¨dfnåºåˆ—ä¸Šè¿ç»­ã€‚</p><p>ä¿®æ”¹è·¯å¾„æ—¶åªéœ€è¦å‚è€ƒå‰è¿°æ±‚lcaçš„è·³ç‚¹è§„åˆ™ï¼Œä¸€æ®µæ®µåœ°åœ¨çº¿æ®µæ ‘ä¸Šè¿›è¡ŒåŒºé—´ä¿®æ”¹å¯ã€‚</p><p>è€Œä¿®æ”¹è·¯å¾„æ›´ä¸ºç®€å•ï¼Œåªéœ€è¦è®°å½•ä¸€ä¸‹å­æ ‘åœ¨dfnåºåˆ—ä¸Šçš„è¾–åŸŸå³å¯ã€‚</p><h3 id="ç‚¹åˆ†æ²»"><a href="#ç‚¹åˆ†æ²»" class="headerlink" title="ç‚¹åˆ†æ²»"></a>ç‚¹åˆ†æ²»</h3><h4 id="è®¡æ•°æ ‘ä¸Šä¸¤ç‚¹ä¹‹é—´è·¯å¾„é•¿åº¦ä¸ºkçš„å¯¹æ•°ï¼ˆå¼€æ¡¶åŠ é€Ÿ-å¤šç»„æŸ¥è¯¢ï¼‰"><a href="#è®¡æ•°æ ‘ä¸Šä¸¤ç‚¹ä¹‹é—´è·¯å¾„é•¿åº¦ä¸ºkçš„å¯¹æ•°ï¼ˆå¼€æ¡¶åŠ é€Ÿ-å¤šç»„æŸ¥è¯¢ï¼‰" class="headerlink" title="è®¡æ•°æ ‘ä¸Šä¸¤ç‚¹ä¹‹é—´è·¯å¾„é•¿åº¦ä¸ºkçš„å¯¹æ•°ï¼ˆå¼€æ¡¶åŠ é€Ÿ å¤šç»„æŸ¥è¯¢ï¼‰"></a>è®¡æ•°æ ‘ä¸Šä¸¤ç‚¹ä¹‹é—´è·¯å¾„é•¿åº¦ä¸ºkçš„å¯¹æ•°ï¼ˆå¼€æ¡¶åŠ é€Ÿ å¤šç»„æŸ¥è¯¢ï¼‰</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">star</span>&#123;</span><span class="keyword">int</span> to, next, w;&#125;;</span><br><span class="line"><span class="keyword">int</span> head[maxn], top = <span class="number">0</span>;</span><br><span class="line">star edge[maxn &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    edge[top].w = w;</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è°ƒç”¨getrootå‰åº”è¯¥åˆå§‹åŒ–Sï¼ï¼ï¼</span></span><br><span class="line"><span class="keyword">int</span> root = <span class="number">0</span>, S;</span><br><span class="line"><span class="keyword">int</span> vis[maxn], sze[maxn], mx[maxn];;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getroot</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> par)</span></span>&#123;</span><br><span class="line">    sze[u] = <span class="number">1</span>; mx[u] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = haed[u]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(vis[to] || to == par) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">getroot</span>(to, u);</span><br><span class="line">        sze[u] += sze[to];</span><br><span class="line">        mx[u] = <span class="built_in">max</span>(mx[u], sze[to]);</span><br><span class="line">    &#125;</span><br><span class="line">    mx[u] = <span class="built_in">max</span>(mx[u], S - sze[u]);</span><br><span class="line">    <span class="keyword">if</span>(mx[u] &lt; mx[root]) root = u;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; dis;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> par, <span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(d &gt; <span class="number">10000000</span>) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[u]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(vis[to] || to == par) <span class="keyword">continue</span>;</span><br><span class="line">        dis.<span class="built_in">push_back</span>(d + edge[i].w);</span><br><span class="line">        <span class="built_in">dfs</span>(to, u, d + edge[i].w);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> tong[<span class="number">10000010</span>];</span><br><span class="line"><span class="keyword">int</span> k[maxn], ans[maxn];</span><br><span class="line"><span class="comment">//è·å–ç»è¿‡uçš„ç­”æ¡ˆï¼Œè·¯å¾„é•¿åº¦æœ‰åŸºç¡€åç§»å€¼d</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fun</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> d, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    dis.<span class="built_in">clear</span>(); dis.<span class="built_in">push_back</span>(d); <span class="built_in">dfs</span>(u, <span class="number">0</span>, d);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>)dis.<span class="built_in">size</span>(); i++) <span class="keyword">if</span>(dis[i] &lt;= <span class="number">10000000</span>) tong[dis[i]]++;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>)dis.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; m; j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(dis[i] + dis[i] &lt; k[j]) ans[j] += (tong[k[j] - dis[i]]) * x;</span><br><span class="line">            <span class="keyword">if</span>(dis[i] + dis[i] == k[j]) ans[j] += (tong[dis[i]] - <span class="number">1</span>) * x;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>)dis.<span class="built_in">size</span>(); i++) <span class="keyword">if</span>(dis[i] &lt;= <span class="number">10000000</span>) tong[dis[i]]--;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//uæ˜¯é‡å¿ƒï¼Œè€ƒå¯Ÿä»¥ç»è¿‡uçš„è·¯å¾„é•¿åº¦</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sove</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">    <span class="comment">//å°é”uèŠ‚ç‚¹ï¼Œåˆ†æ²»åœ°å¯»æ‰¾å­æ ‘.</span></span><br><span class="line">    vis[u] = <span class="number">1</span>; <span class="built_in">fun</span>(u, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[u]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(vis[to]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="comment">//åˆ å»é‚£äº›æ ¹æœ¬ä¸ç»è¿‡uçš„ç‚¹å¯¹</span></span><br><span class="line">        <span class="built_in">fun</span>(to, edge[i].w, <span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">        S = sze[to]; root = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">getroot</span>(to, u);</span><br><span class="line">        <span class="built_in">sove</span>(root);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="built_in">clr</span>(head, <span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> u, v, w; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;u, &amp;v, &amp;w);</span><br><span class="line">        <span class="built_in">add</span>(u, v, w); <span class="built_in">add</span>(v, u, w);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, k + i);</span><br><span class="line"></span><br><span class="line">    mx[<span class="number">0</span>] = n; root = <span class="number">0</span>;</span><br><span class="line">    S = n; <span class="built_in">clr</span>(vis, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">getroot</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">sove</span>(root);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) <span class="built_in">puts</span>(ans[i]? <span class="string">&quot;AYE&quot;</span>: <span class="string">&quot;NAY&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ—¶é—´å¤æ‚åº¦$O(nlogn)$</p><ul><li>å®é™…ä½¿ç”¨æ¡¶åŠ é€Ÿæ—¶éœ€è¦æ ¹æ®é¢˜æ„ä¿®æ”¹æ¡¶çš„å¤§å°ã€‚</li><li>mainå‡½æ•°ä¸­å¯¹äºmx[0]çš„åˆå§‹åŒ–å¿…ä¸å¯å°‘</li><li>æ¯æ¬¡è°ƒç”¨getrootå‰éƒ½åº”å¯¹S(å½“å‰å­æ ‘æ€»å¤§å°)è¿›è¡Œåˆå§‹åŒ–ã€‚</li><li>å¦‚æœ<strong>æƒå€¼è¿‡å¤§ä¸èƒ½å¼€æ¡¶</strong>ï¼Œå¯ä»¥é€šè¿‡äºŒåˆ†æŸ¥æ‰¾ç­‰æ–¹å¼å¤šä¸€ä¸ª$log$åœ°è¿›è¡ŒæŸ¥è¯¢è®¡æ•°</li><li>æ‰¾é‡å¿ƒæ—¶Sçš„æ›´æ–°åº”è¯¥å¦‚ä¸‹æ‰å¯¹ï¼Ÿï¼ˆä¸æ‡‚.gif</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(sze[to] &lt; sze[u]) S = sze[to];</span><br><span class="line"><span class="keyword">else</span> S = sze[to] - sze[u];</span><br></pre></td></tr></table></figure><h3 id="ç‚¹åˆ†æ ‘"><a href="#ç‚¹åˆ†æ ‘" class="headerlink" title="ç‚¹åˆ†æ ‘"></a>ç‚¹åˆ†æ ‘</h3><h4 id="å¤šç»„æŸ¥è¯¢ä¸æŸç‚¹è·ç¦»å°äºç­‰äºkçš„æ‰€æœ‰ç‚¹æƒå’Œ-å¹¶æ”¯æŒå•ç‚¹ä¿®æ”¹"><a href="#å¤šç»„æŸ¥è¯¢ä¸æŸç‚¹è·ç¦»å°äºç­‰äºkçš„æ‰€æœ‰ç‚¹æƒå’Œ-å¹¶æ”¯æŒå•ç‚¹ä¿®æ”¹" class="headerlink" title="å¤šç»„æŸ¥è¯¢ä¸æŸç‚¹è·ç¦»å°äºç­‰äºkçš„æ‰€æœ‰ç‚¹æƒå’Œ å¹¶æ”¯æŒå•ç‚¹ä¿®æ”¹"></a>å¤šç»„æŸ¥è¯¢ä¸æŸç‚¹è·ç¦»å°äºç­‰äºkçš„æ‰€æœ‰ç‚¹æƒå’Œ å¹¶æ”¯æŒå•ç‚¹ä¿®æ”¹</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mid ((l + r) &gt;&gt; 1)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> manx = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="comment">//æ ¹æ®dfnæ•°ç»„çš„é•¿åº¦å†³å®šN(å³N = log2(cnt), cnt = maxn &lt;&lt; 1)</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">20</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, q;</span><br><span class="line"><span class="keyword">int</span> w[manx];</span><br><span class="line"><span class="comment">//åŠ¨æ€å¼€ç‚¹çš„å•ç‚¹ä¿®æ”¹ã€åŒºé—´æ±‚å’Œçº¿æ®µæ ‘</span></span><br><span class="line"><span class="comment">//ç»´æŠ¤ä¸¤ä¸ªstï¼Œä¸€ä¸ªæ˜¯uå­æ ‘å¯¹uçš„è´¡çŒ®ï¼Œå¦ä¸€ä¸ªæ˜¯uå­æ ‘å¯¹par[u]çš„è´¡çŒ®ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = maxn * N * <span class="number">4</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SEG</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> root[maxn];</span><br><span class="line">    <span class="keyword">int</span> st[M], ls[M], rs[M], top = <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> now = top++;</span><br><span class="line">        <span class="keyword">if</span>(l == r) <span class="keyword">return</span> now;</span><br><span class="line">        ls[now] = <span class="built_in">build</span>(l, mid);</span><br><span class="line">        rs[now] = <span class="built_in">build</span>(mid + <span class="number">1</span>, r);</span><br><span class="line">        <span class="keyword">return</span> now;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">up</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;st[p] = st[ls[p]] + st[rs[p]];&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">        <span class="built_in">assert</span>(k &gt;= l &amp;&amp; k &lt;= r);</span><br><span class="line">        <span class="keyword">if</span>(l == r &amp;&amp; l == k)&#123;</span><br><span class="line">            st[p] += x;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(k &lt;= mid) <span class="built_in">add</span>(ls[p], l, mid, k, x);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">add</span>(rs[p], mid + <span class="number">1</span>, r, k, x);</span><br><span class="line">        <span class="built_in">up</span>(p);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(R &lt; L) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(L &lt;= l &amp;&amp; r &lt;= R) <span class="keyword">return</span> st[p];</span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(L &lt;= mid) ans += <span class="built_in">query</span>(ls[p], l, mid, L, R);</span><br><span class="line">        <span class="keyword">if</span>(R &gt; mid) ans += <span class="built_in">query</span>(rs[p], mid + <span class="number">1</span>, r, L, R);</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;seg[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">vector&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt; E;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">TREE</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> head[maxn], par[manx], top = <span class="number">0</span>;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">star</span>&#123;</span><span class="keyword">int</span> to, next;&#125;;</span><br><span class="line">    star edge[maxn &lt;&lt; <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">TREE</span>()&#123;<span class="built_in">clr</span>(head, <span class="number">-1</span>); top = <span class="number">0</span>;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">        edge[top].to = v;</span><br><span class="line">        edge[top].next = head[u];</span><br><span class="line">        head[u] = top++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(vector&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt; &amp;E)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> e: E)&#123;</span><br><span class="line">            <span class="built_in">add</span>(e.first, e.second);</span><br><span class="line">            par[e.second] = e.first;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> mx[maxn], sze[maxn], vis[maxn], root = <span class="number">0</span>, S;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">getroot</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> par)</span></span>&#123;</span><br><span class="line">        sze[now] = <span class="number">1</span>; mx[now] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = head[now]; ~i; i = edge[i].next)&#123;</span><br><span class="line">            <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(to == par || vis[to]) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="built_in">getroot</span>(to, now);</span><br><span class="line">            sze[now] += sze[to];</span><br><span class="line">            mx[now] = <span class="built_in">max</span>(mx[now], sze[to]);</span><br><span class="line">        &#125;</span><br><span class="line">        mx[now] = <span class="built_in">max</span>(mx[now], S - sze[now]);</span><br><span class="line">        <span class="keyword">if</span>(mx[root] &gt; mx[now]) root = now;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å½“å‰åˆ†æ²»ä¸­å¿ƒä¸ºnowï¼Œå°é”ä½é€šå¾€parçš„è·¯å¾„ï¼Œå‡½æ•°è¿”å›é‡å¿ƒ</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">divide</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> par)</span></span>&#123;</span><br><span class="line">        root = <span class="number">0</span>; <span class="built_in">getroot</span>(now, par);</span><br><span class="line">        <span class="keyword">int</span> rt = root; vis[rt] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = head[rt]; ~i; i = edge[i].next)&#123;</span><br><span class="line">            <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(to == par || vis[to]) <span class="keyword">continue</span>;</span><br><span class="line">            S = sze[to];</span><br><span class="line">            E.<span class="built_in">push_back</span>(&#123;rt, <span class="built_in">divide</span>(to, rt)&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> rt;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å°†æ ‘é‡æ„ä¸ºç‚¹åˆ†æ ‘ï¼Œç‚¹åˆ†æ•°çš„è¾¹å­˜æ”¾åœ¨Eä¸­ï¼Œä¾›tree[1].addè°ƒç”¨ï¼›è¿”å›é‡æ„æ ‘çš„æ ¹</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">rebuild</span><span class="params">()</span></span>&#123;</span><br><span class="line">        S = mx[<span class="number">0</span>] = n;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">divide</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//åˆå§‹åŒ–dfnã€posæ•°ç»„ï¼Œå¾—åˆ°æ¯ä¸ªèŠ‚ç‚¹çš„æ·±åº¦dep</span></span><br><span class="line">    <span class="keyword">int</span> dfn[maxn &lt;&lt; <span class="number">1</span>], pos[manx], cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> dep[maxn];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> par)</span></span>&#123;</span><br><span class="line">        dfn[cnt] = now; pos[now] = cnt; cnt++;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = head[now]; ~i; i = edge[i].next)&#123;</span><br><span class="line">            <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(to == par) <span class="keyword">continue</span>;</span><br><span class="line">            dep[to] = dep[now] + <span class="number">1</span>;</span><br><span class="line">            <span class="built_in">dfs</span>(to, now);</span><br><span class="line">            dfn[cnt++] = now;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> st[maxn &lt;&lt; <span class="number">1</span>][N];</span><br><span class="line">    <span class="comment">//é€šè¿‡æ·±åº¦æ•°ç»„è·å–stè¡¨, stç»´æŠ¤åŒºé—´ä¸­æ·±åº¦æœ€å°çš„èŠ‚ç‚¹æ ‡å·</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">getst</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cnt; i++) st[i][<span class="number">0</span>] = dfn[i];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; N; j++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cnt; i++)&#123;</span><br><span class="line">                <span class="keyword">int</span> nxt = i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>));</span><br><span class="line">                <span class="keyword">if</span>(nxt &gt;= cnt) st[i][j] = st[i][j - <span class="number">1</span>];</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(dep[st[i][j - <span class="number">1</span>]] &lt; dep[st[nxt][j - <span class="number">1</span>]]) st[i][j] = st[i][j - <span class="number">1</span>];</span><br><span class="line">                <span class="keyword">else</span> st[i][j] = st[nxt][j - <span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//O1è·å–ä¸¤ç‚¹ä¹‹é—´çš„è·ç¦»</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getdis</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(x == y) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> l = <span class="built_in">min</span>(pos[x], pos[y]), r = <span class="built_in">max</span>(pos[x], pos[y]);</span><br><span class="line">        <span class="keyword">int</span> k = (<span class="keyword">int</span>)(<span class="built_in">log2</span>(r - l) + eps);</span><br><span class="line">        <span class="keyword">int</span> lca = st[l][k];</span><br><span class="line">        <span class="keyword">if</span>(dep[lca] &gt; dep[st[r - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k]]) lca = st[r - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k];</span><br><span class="line">        <span class="keyword">return</span> dep[x] + dep[y] - <span class="number">2</span> * dep[lca];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//è·å–å­æ ‘å¤§å°å¹¶åˆå§‹åŒ–çº¿æ®µæ ‘</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ini</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> par)</span></span>&#123;</span><br><span class="line">        sze[now] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = head[now]; ~i; i = edge[i].next)&#123;</span><br><span class="line">            <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(to == par) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="built_in">ini</span>(to, now);</span><br><span class="line">            sze[now] += sze[to];</span><br><span class="line">        &#125;</span><br><span class="line">        seg[<span class="number">0</span>].root[now] = seg[<span class="number">0</span>].<span class="built_in">build</span>(<span class="number">0</span>, sze[now]);</span><br><span class="line">        seg[<span class="number">1</span>].root[now] = seg[<span class="number">1</span>].<span class="built_in">build</span>(<span class="number">0</span>, sze[now] + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;tree[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¬¬kä¸ªåŸå¸‚ä¸Šå‘ç”Ÿxçš„å¢é‡ï¼Œå½“å‰å¤„ç†åˆ°nowèŠ‚ç‚¹ï¼Œä¿è¯nowèŠ‚ç‚¹ä¸€å®šæ˜¯kçš„ç¥–å…ˆ</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> k, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> dis = tree[<span class="number">0</span>].<span class="built_in">getdis</span>(now, k);</span><br><span class="line">    seg[<span class="number">0</span>].<span class="built_in">add</span>(seg[<span class="number">0</span>].root[now], <span class="number">0</span>, tree[<span class="number">1</span>].sze[now], dis, x);</span><br><span class="line">    <span class="keyword">if</span>(tree[<span class="number">1</span>].par[now])&#123;</span><br><span class="line">        dis = tree[<span class="number">0</span>].<span class="built_in">getdis</span>(tree[<span class="number">1</span>].par[now], k);</span><br><span class="line">        seg[<span class="number">1</span>].<span class="built_in">add</span>(seg[<span class="number">1</span>].root[now], <span class="number">0</span>, tree[<span class="number">1</span>].sze[now] + <span class="number">1</span>, dis, x);</span><br><span class="line">        <span class="built_in">add</span>(tree[<span class="number">1</span>].par[now], k, x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŸ¥è¯¢è·ç¦»kåŸå¸‚è·ç¦»å°äºç­‰äºxçš„ä»·å€¼å’Œï¼Œå½“å‰å¤„ç†åˆ°now</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> k, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> d = tree[<span class="number">0</span>].<span class="built_in">getdis</span>(now, k);</span><br><span class="line">    ans += seg[<span class="number">0</span>].<span class="built_in">query</span>(seg[<span class="number">0</span>].root[now], <span class="number">0</span>, tree[<span class="number">1</span>].sze[now], <span class="number">0</span>, x - d);</span><br><span class="line">    <span class="keyword">if</span>(tree[<span class="number">1</span>].par[now])&#123;</span><br><span class="line">        <span class="keyword">int</span> D = tree[<span class="number">0</span>].<span class="built_in">getdis</span>(tree[<span class="number">1</span>].par[now], k);</span><br><span class="line">        ans -= seg[<span class="number">1</span>].<span class="built_in">query</span>(seg[<span class="number">1</span>].root[now], <span class="number">0</span>, tree[<span class="number">1</span>].sze[now] + <span class="number">1</span>, <span class="number">0</span>, x - D);</span><br><span class="line">        ans += <span class="built_in">query</span>(tree[<span class="number">1</span>].par[now], k, x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//     Fastin;</span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;q);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, w + i);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> u, v; <span class="built_in">scnaf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">        tree[<span class="number">0</span>].<span class="built_in">add</span>(u, v); tree[<span class="number">0</span>].<span class="built_in">add</span>(v, u);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    tree[<span class="number">0</span>].<span class="built_in">getst</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> root = tree[<span class="number">0</span>].<span class="built_in">rebuild</span>();</span><br><span class="line">    tree[<span class="number">1</span>].<span class="built_in">add</span>(E);</span><br><span class="line"></span><br><span class="line">    tree[<span class="number">1</span>].<span class="built_in">ini</span>(root, <span class="number">0</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">add</span>(i, i, w[i]);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">whlie</span>(q--)&#123;</span><br><span class="line">        <span class="keyword">int</span> op, x, y; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;op, &amp;x, &amp;y);</span><br><span class="line">      <span class="comment">//å¼ºåˆ¶åœ¨çº¿</span></span><br><span class="line">        x ^= ans; y ^= ans;</span><br><span class="line">        <span class="keyword">if</span>(op)&#123;</span><br><span class="line">            <span class="built_in">add</span>(x, x, y - w[x]);</span><br><span class="line">            w[x] = y;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans = <span class="built_in">query</span>(x, x, y));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>ä¸»è¦æ•°æ®ç»“æ„<ul><li>tree[0]: åŸæ ‘<ul><li>åˆ©ç”¨mx[maxn]ã€sze[maxn]ã€vis[maxn]ã€rootã€Så¯¹æ ‘è¿›è¡Œé‡æ„ï¼Œå°†é‡æ„ç»“æœçš„è¾¹æš‚æ—¶ä¿å­˜åœ¨vector<pair<int, int>&gt; Eä¸­ï¼Œç­‰å¾…ä¹‹åå­˜æ”¾åˆ°tree[1]ä¸­</li><li>åˆ©ç”¨dfn[maxn &lt;&lt; 1]ã€pos[maxn]ã€cntã€dep[maxn]ã€st[maxn &lt;&lt; 1][N]å»ºç«‹stè¡¨ï¼Œæä¾›æ¥å£getdisè¿›è¡ŒO1æŸ¥è¯¢è·ç¦»ã€‚<strong>STè¡¨çš„å¤§å°åº”å½“ä¸dfnç›¸åŒï¼åŒæ—¶æ³¨æ„å»ºç«‹STè¡¨æ—¶è¾¹ç•Œè¶Šç•Œçš„é—®é¢˜ï¼</strong></li></ul></li><li>tree[1]: åŸæ ‘é‡æ„åå¾—åˆ°çš„ç‚¹åˆ†æ ‘<ul><li>åˆ©ç”¨ini()å‡½æ•°è·å–ç‚¹åˆ†æ ‘ä¸Šæ‰€æœ‰å­æ ‘çš„å¤§å°ï¼Œå°†è¯¥å¤§å°ä½œä¸ºçº¿æ®µæ ‘çš„è¾¹ç•Œï¼ŒåŒæ—¶å®ŒæˆåŠ¨æ€å¼€ç‚¹çš„çº¿æ®µæ ‘çš„åˆå§‹åŒ–ã€‚</li></ul></li><li>seg[0]: åŠ¨æ€å¼€ç‚¹çš„æƒå€¼çº¿æ®µæ ‘(å•ç‚¹ä¿®æ”¹ã€åŒºé—´æŸ¥è¯¢)<ul><li>é€šè¿‡seg[0].rootæ•°ç»„ä½œä¸ºtree[1]ä¸­æ¯ä¸ªèŠ‚ç‚¹çš„å…¥å£</li><li>å¯¹äºæŸä¸ªèŠ‚ç‚¹uè€Œè¨€ï¼Œæƒå€¼çº¿æ®µæ ‘çš„å€¼åŸŸåŒºé—´ä¸º[0, tree[1].sze[u]]ï¼Œå­˜å‚¨çš„å†…å®¹ä¸ºtree[1]ä¸­uèŠ‚ç‚¹æ‰€æœ‰å­©å­å¯¹uçš„è´¡çŒ®</li><li>éœ€è¦çš„ç©ºé—´ä¸ºn <em> logn </em> 4</li></ul></li><li>seg[1]: åŠ¨æ€å¼€ç‚¹çš„æƒå€¼çº¿æ®µæ ‘(å•ç‚¹ä¿®æ”¹ã€åŒºé—´æŸ¥è¯¢)<ul><li>é€šè¿‡seg[1].rootæ•°ç»„ä½œä¸ºtree[1]ä¸­æ¯ä¸ªèŠ‚ç‚¹çš„å…¥å£</li><li>å¯¹äºæŸä¸ªèŠ‚ç‚¹uè€Œè¨€ï¼Œæƒå€¼çº¿æ®µæ ‘çš„å€¼åŸŸåŒºé—´ä¸º[0, tree[1].sze[u] + 1] (<code>+1</code>æ˜¯å¿…è¦çš„)ï¼Œå­˜å‚¨çš„å†…å®¹ä¸ºtree[1]ä¸­uèŠ‚ç‚¹æ‰€æœ‰å­©å­å¯¹<strong>par[u]</strong>ï¼ˆå¦‚æœå­˜åœ¨çš„è¯ï¼‰çš„è´¡çŒ®</li><li>éœ€è¦çš„ç©ºé—´ä¸ºn <em> logn </em> 4</li></ul></li></ul></li><li>ä½¿ç”¨æŒ‡å—<ul><li>è¯»å…¥åŸæ ‘åˆ°tree[0]åï¼Œè°ƒç”¨tree[0].getst()åˆå§‹åŒ–stè¡¨</li><li>è°ƒç”¨tree[0].rebuild()é‡æ„åŸæ ‘ï¼Œæ–°æ ‘çš„è¾¹å­˜æ”¾åœ¨Eä¸­ï¼Œå†å¼€å˜é‡rootå­˜æ”¾å‡½æ•°çš„è¿”å›å€¼(å³æ–°æ ‘çš„æ ¹)</li><li>è°ƒç”¨tree[1].add(E)å°†Eä¸­çš„æœ‰å‘è¾¹åŠ å…¥åˆ°tree[1]ä¸­</li><li>è°ƒç”¨tree[1].ini(root)ä»æ–°æ ‘çš„æ ¹å¼€å§‹ï¼Œå®Œæˆæ–°æ ‘ä¸Šå¥—çº¿æ®µæ ‘çš„å»ºç«‹</li><li>è°ƒç”¨addå‡½æ•°å°†åŸæ ‘çš„æ‰€æœ‰ç‚¹æƒåŠ å…¥åˆ°çº¿æ®µæ ‘ä¸­ï¼Œå®Œæˆçº¿æ®µæ ‘çš„åˆå§‹åŒ–</li><li>è¯»å…¥qæ¬¡æŸ¥è¯¢ï¼Œæ ¹æ®æŸ¥è¯¢çš„ç±»å‹è°ƒç”¨add/queryè¿›è¡Œæ“ä½œå³å¯ã€‚</li></ul></li></ul><h3 id="prueferåºåˆ—"><a href="#prueferåºåˆ—" class="headerlink" title="prueferåºåˆ—"></a>prueferåºåˆ—</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">5e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">int</span> par[maxn], prufer[maxn], du[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">encode</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ptr = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="keyword">if</span>(ptr == <span class="number">-1</span> &amp;&amp; du[i] == <span class="number">1</span>) ptr = i;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> leaf = ptr;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">2</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> next = prufer[i] = par[leaf];</span><br><span class="line">        <span class="keyword">if</span>(--du[next] == <span class="number">1</span> &amp;&amp; next &lt; ptr) leaf = next;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            ptr++;</span><br><span class="line">            <span class="keyword">while</span>(du[ptr] != <span class="number">1</span>) ptr++;</span><br><span class="line">            leaf = ptr;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rebuild</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ptr = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(du[ptr] != <span class="number">1</span>) ptr++;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> leaf = ptr;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">2</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> next = par[leaf] = prufer[i];</span><br><span class="line">        <span class="keyword">if</span>(--du[next] == <span class="number">1</span> &amp;&amp; next &lt; ptr) leaf = next;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            ptr++;</span><br><span class="line">            <span class="keyword">while</span>(du[ptr] != <span class="number">1</span>) ptr++;</span><br><span class="line">            leaf = ptr;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    par[leaf] = n;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">hsh</span><span class="params">(<span class="keyword">int</span> a[maxn], <span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) ans ^= (i + <span class="number">1</span>) * <span class="number">1ll</span> * a[i];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> op;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;op);</span><br><span class="line">    <span class="keyword">if</span>(op == <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n - <span class="number">1</span>; i++)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, par + i);</span><br><span class="line">            du[par[i]]++; du[i]++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">encode</span>();</span><br><span class="line">        <span class="built_in">hsh</span>(prufer, n - <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) du[i] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">2</span>; i++)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, prufer + i);</span><br><span class="line">            du[prufer[i]]++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">rebuild</span>();</span><br><span class="line">        <span class="built_in">hsh</span>(par + <span class="number">1</span>, n - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æŒ‡å—</p><ul><li>è¯»å…¥ç‚¹æ•°nå’Œæ“ä½œæ•°op</li><li>op = 1 è¯»å…¥èŠ‚ç‚¹$[1, â€¦,n-1]$çš„çˆ¶äº²ï¼Œè°ƒç”¨encodeåå°†pruferåºåˆ—ä¿å­˜åœ¨$prufer[0, n - 2)$ä¸­</li><li>op = 2 è¯»å…¥é•¿ä¸ºn-2çš„pruferåºåˆ—ï¼Œè°ƒç”¨rebuildåå°†èŠ‚ç‚¹$[1, â€¦, n -1]$çš„çˆ¶äº²å­˜å‚¨åœ¨$par[1, .. n -1]$ä¸­</li></ul><p>TIPS</p><ul><li>å› ä¸ºpruferåºåˆ—æ„é€ çš„ç‰¹æ€§ï¼ŒèŠ‚ç‚¹nä¸€å®šæ˜¯ç•™åˆ°æœ€åçš„é‚£ä¸ªèŠ‚ç‚¹ï¼Œæ‰€ä»¥ç¨‹åºä¸­è¯»å…¥/è¾“å‡ºçš„paråºåˆ—å‡æ˜¯ä»¥nèŠ‚ç‚¹ä¸ºæ ¹æ—¶çš„çˆ¶å­å…³ç³»ã€‚</li></ul><h4 id="è®¡æ•°ç›¸å…³å®šç†"><a href="#è®¡æ•°ç›¸å…³å®šç†" class="headerlink" title="è®¡æ•°ç›¸å…³å®šç†"></a>è®¡æ•°ç›¸å…³å®šç†</h4><h5 id="å‡¯è±å…¬å¼"><a href="#å‡¯è±å…¬å¼" class="headerlink" title="å‡¯è±å…¬å¼"></a>å‡¯è±å…¬å¼</h5><p>å®Œå…¨å›¾$K_n$æœ‰$n^{n-2}$æ£µç”Ÿæˆæ ‘ã€‚</p><p>è¯æ˜æ˜¾ç„¶ã€‚</p><h5 id="å›¾è”é€šæ–¹æ¡ˆæ•°"><a href="#å›¾è”é€šæ–¹æ¡ˆæ•°" class="headerlink" title="å›¾è”é€šæ–¹æ¡ˆæ•°"></a>å›¾è”é€šæ–¹æ¡ˆæ•°</h5><p>ä¸€ä¸ªnèŠ‚ç‚¹çš„å¸¦æ ‡å·æ— å‘å›¾æœ‰kä¸ªè”é€šå—ã€‚æ·»åŠ k-1æ¡è¾¹ä½¿å¾—å›¾è”é€šçš„æ–¹æ¡ˆæ•°ä¸º$n^{k-2} * \prod s_i$.</p><p>è¯æ˜ï¼š</p><p>å°è¯•å¯¹kä¸ªè”é€šå—æ„é€ pruferåºåˆ—ã€‚</p><p>ç”±äºæ¯ä¸ªè”é€šå—çš„åº¦æœªçŸ¥ï¼Œå› è€Œè®¾$d_i$ä¸ºè”é€šå—içš„åº¦ã€‚$d_i$æ»¡è¶³$\sum d_i = 2(k-1)$</p><p>åˆ™å¯¹äºç»™å®šdåºåˆ—åæ„é€ pruferåºåˆ—çš„æ–¹æ¡ˆæ•°ä¸º$(^{\space \space \space \space \space \space \space \space k-2}_{(d_1-1)!â€¦(d_k-1)!})$</p><p>è€Œå¯¹äºæŸä¸ªè”é€šå—$s_i$è€Œè¨€ï¼Œå…¶è¿æ¥æ–¹å¼ä¸º$s_i^{d_i}$ç§ï¼Œå› è€Œå¯¹äºç»™å®šdåºåˆ—åå›¾è”é€šçš„æ–¹æ¡ˆæ•°æ˜¯$(^{\space \space \space \space \space \space \space \space k-2}_{(d_1-1)!â€¦(d_k-1)!})*s_i^{d_i}$</p><p>æ¥ä¸‹æ¥æšä¸¾dåºåˆ—ï¼Œå³$\sum_{d_iâ‰¥1,\sum d_i=2k-2}(^{\space \space \space \space \space \space \space \space k-2}_{(d_1-1)!â€¦(d_k-1)!})*\prod _{1 \leq i \leq k}s_i^{d_i}$</p><p>åˆ©ç”¨å¤šå…ƒäºŒé¡¹å¼å®šç†: $(x_1+â€¦+x_m)^p=\sum_{c_iâ‰¥0, \sum c_i=p}(^{\space \space \space \space p}_{c_1, â€¦, c_m}) * \prod x_i^{c_i}$, å¹¶æ¢å…ƒ$e_i=d_i-1$ã€‚$\sum e_i=k-2$</p><p>åˆ™åŸå¼æˆä¸º$\sum _{e_iâ‰¥0, \sum e_i = k-2} (^{\space \space k-2}_{e_1, â€¦, e_k})*\prod s_i^{e_i+1}$</p><p>åŒ–ç®€å¾—$(s_1+â€¦+s_k)^{k-2} * \prod s_i$</p><p>å³$n^{k-2} * \prod s_i$</p><h2 id="6-æ•°å­¦"><a href="#6-æ•°å­¦" class="headerlink" title="6 æ•°å­¦"></a>6 æ•°å­¦</h2><h3 id="å¼‚æˆ–çº¿æ€§åŸº"><a href="#å¼‚æˆ–çº¿æ€§åŸº" class="headerlink" title="å¼‚æˆ–çº¿æ€§åŸº"></a>å¼‚æˆ–çº¿æ€§åŸº</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">200</span> + <span class="number">10</span>;</span><br><span class="line">ll a[maxn];</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> L = <span class="number">63</span>;</span><br><span class="line">ll d[L];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">add</span><span class="params">(ll x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = L - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) <span class="keyword">if</span>(x &amp; <span class="number">1ll</span> &lt;&lt; i)&#123;</span><br><span class="line">        <span class="keyword">if</span>(d[i] == <span class="number">-1</span>)&#123;d[i] = x; <span class="keyword">return</span> <span class="literal">true</span>;&#125;</span><br><span class="line">        x ^= d[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fast;</span></span><br><span class="line">    <span class="keyword">int</span> t; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;t); <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        <span class="built_in">memset</span>(d, <span class="number">-1</span>, <span class="keyword">sizeof</span> d);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">int</span> n; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, a + i);</span><br><span class="line">        <span class="keyword">char</span> s[maxn]; <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s);</span><br><span class="line">        <span class="keyword">int</span> flag = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">add</span>(a[i]) &amp;&amp; s[i] == <span class="string">&#x27;1&#x27;</span>)&#123;</span><br><span class="line">                flag = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, flag);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="å¤šé¡¹å¼"><a href="#å¤šé¡¹å¼" class="headerlink" title="å¤šé¡¹å¼"></a>å¤šé¡¹å¼</h3><h4 id="FTT"><a href="#FTT" class="headerlink" title="FTT"></a>FTT</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">COM</span>&#123;</span></span><br><span class="line">    <span class="keyword">double</span> x, y;</span><br><span class="line">    COM <span class="keyword">operator</span> *(<span class="keyword">const</span> COM &amp;b)&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x * b.x - y * b.y, x * b.y + y * b.x&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    COM <span class="keyword">operator</span> -(<span class="keyword">const</span> COM &amp;b)&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x - b.x, y - b.y&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    COM <span class="keyword">operator</span> +(<span class="keyword">const</span> COM &amp;b)&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x + b.x, y + b.y&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m, sum, N, wei;</span><br><span class="line">COM a[maxn &lt;&lt; <span class="number">2</span>], b[maxn &lt;&lt; <span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> inv[maxn &lt;&lt; <span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//å°†0åˆ°N-1çš„å¤šé¡¹å¼è¡¨ç¤ºè½¬åŒ–ä¸ºç‚¹å€¼è¡¨ç¤º</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fft</span><span class="params">(COM *a, <span class="keyword">int</span> op)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) <span class="keyword">if</span>(i &lt; inv[i]) <span class="built_in">swap</span>(a[inv[i]], a[i]);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//é€†fftå°†èŒƒå¾·è’™å¾·è¡Œåˆ—å¼çš„æ¯ä¸€é¡¹å–å…±è½­å†é™¤ä»¥n</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = wei - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">        <span class="keyword">int</span> d = <span class="number">1</span> &lt;&lt; (wei - i);</span><br><span class="line">        COM wn = &#123;<span class="built_in">cos</span>(<span class="number">2</span> * pi / d), op * <span class="built_in">sin</span>(<span class="number">2</span> * pi / d)&#125;;</span><br><span class="line">        <span class="comment">//jéå†ç¬¬iå±‚çš„å¼€å¤´</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; N; j += d)&#123;</span><br><span class="line">            <span class="comment">//å¯¹jå¼€å¤´çš„ä¸€å°æ®µè¿›è¡Œæ›´æ–°</span></span><br><span class="line">            COM w = &#123;<span class="number">1</span>, <span class="number">0</span>&#125;;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; d / <span class="number">2</span>; k++)&#123;</span><br><span class="line">                COM x, y;</span><br><span class="line">                x = a[j + k]; y = a[j + k + d / <span class="number">2</span>] * w;</span><br><span class="line">                a[j + k] = x + y; a[j + k + d / <span class="number">2</span>] = x - y;</span><br><span class="line">                w = w * wn;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//#define LOCAL</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;in.txt&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%lf&quot;</span>, &amp;a[i].x);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%lf&quot;</span>, &amp;b[i].x);</span><br><span class="line">    </span><br><span class="line">    sum = n + m + <span class="number">1</span>; N = <span class="number">1</span>; wei = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(N &lt; sum)&#123;N *= <span class="number">2</span>; wei++;&#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">1</span> &lt;&lt; wei; j++)</span><br><span class="line">        inv[j] = inv[j &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span> | (j &amp; <span class="number">1</span>) &lt;&lt; (wei - <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">fft</span>(a, <span class="number">1</span>); <span class="built_in">fft</span>(b, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) a[i] = a[i] * b[i];</span><br><span class="line">    <span class="built_in">fft</span>(a, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n + m + <span class="number">1</span>; i++) <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, (<span class="keyword">int</span>)(a[i].x / N + <span class="number">0.5</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å…¥nã€mï¼Œæ¥n+1å’Œm+1ä¸ªæ•´æ•°ï¼Œåˆ†åˆ«è¡¨ç¤ºnæ¬¡å¤šé¡¹å¼å’Œmæ¬¡å¤šé¡¹å¼ä»ä½åˆ°é«˜çš„ç³»æ•°ã€‚</p><p>è¾“å‡ºn+m+1ä¸ªç³»æ•°ã€‚</p><h4 id="NTT"><a href="#NTT" class="headerlink" title="NTT"></a>NTT</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> p = <span class="number">3</span>, invp = <span class="number">332748118</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m, sum, N, wei;</span><br><span class="line">ll a[maxn &lt;&lt; <span class="number">2</span>], b[maxn &lt;&lt; <span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> inv[maxn &lt;&lt; <span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">quick_pow</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">    ll ans = <span class="number">1</span>, res = a;</span><br><span class="line">    <span class="keyword">while</span>(p)&#123;</span><br><span class="line">        <span class="keyword">if</span>(p &amp; <span class="number">1</span>) ans *= res; ans %= M;</span><br><span class="line">        res *= res; res %= M;</span><br><span class="line">        p &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans % M;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//é€†fftå°†èŒƒå¾·è’™å¾·è¡Œåˆ—å¼çš„æ¯ä¸€é¡¹å–å…±è½­å†é™¤ä»¥n</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fft</span><span class="params">(ll *a, <span class="keyword">int</span> op)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) <span class="keyword">if</span>(i &lt; inv[i]) <span class="built_in">swap</span>(a[inv[i]], a[i]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = wei - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">        <span class="keyword">int</span> d = <span class="number">1</span> &lt;&lt; (wei - i);</span><br><span class="line">        ll gn = <span class="built_in">quick_pow</span>(op == <span class="number">1</span>? p: invp, (M - <span class="number">1</span>) / d);</span><br><span class="line">        <span class="comment">//jéå†ç¬¬iå±‚çš„å¼€å¤´</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; N; j += d)&#123;</span><br><span class="line">            <span class="comment">//å¯¹jå¼€å¤´çš„å°æ®µè¿›è¡Œæ›´æ–°</span></span><br><span class="line">            ll g = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; d / <span class="number">2</span>; k++)&#123;</span><br><span class="line">                ll x, y;</span><br><span class="line">                x = a[j + k] % M;</span><br><span class="line">                y = a[j + k + d / <span class="number">2</span>] * g; y %= M;</span><br><span class="line">                a[j + k] = (x + y) % M; a[j + k + d / <span class="number">2</span>] = (x - y + M) % M;</span><br><span class="line">                g = g * gn; g %= M;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//#define LOCAL</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;in.txt&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n,  &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, a + i);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, b + i);</span><br><span class="line"></span><br><span class="line">    sum = n + m + <span class="number">1</span>; N = <span class="number">1</span>; wei = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(N &lt; sum)&#123;N *= <span class="number">2</span>; wei++;&#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">1</span> &lt;&lt; wei; j++)</span><br><span class="line">        inv[j] = inv[j &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span> | (j &amp; <span class="number">1</span>) &lt;&lt; (wei - <span class="number">1</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">fft</span>(a, <span class="number">1</span>); <span class="built_in">fft</span>(b, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) a[i] = (a[i] * b[i]) % M;</span><br><span class="line">    <span class="built_in">fft</span>(a, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">int</span> invn = <span class="built_in">quick_pow</span>(N, M - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n + m + <span class="number">1</span>; i++) <span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>, (a[i] * invn + M) % M);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¾“å…¥nã€mï¼Œæ¥n+1å’Œm+1ä¸ªæ•´æ•°ï¼Œåˆ†åˆ«è¡¨ç¤ºnæ¬¡å¤šé¡¹å¼å’Œmæ¬¡å¤šé¡¹å¼ä»ä½åˆ°é«˜çš„ç³»æ•°ã€‚</p><p>è¾“å‡ºn+m+1ä¸ªç³»æ•°ã€‚</p><h3 id="é«˜æ–¯æ•´æ•°"><a href="#é«˜æ–¯æ•´æ•°" class="headerlink" title="é«˜æ–¯æ•´æ•°"></a>é«˜æ–¯æ•´æ•°</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">GaussianInteger</span>&#123;</span></span><br><span class="line">    ll x, y;</span><br><span class="line">    <span class="function">ll <span class="title">norm</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> x * x + y * y;&#125;</span><br><span class="line">    GaussianInteger <span class="keyword">operator</span> + (<span class="keyword">const</span> GaussianInteger &amp;b)&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x + b.x, y + b.y&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    GaussianInteger <span class="keyword">operator</span> - (<span class="keyword">const</span> GaussianInteger &amp;b)&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x - b.x, y - b.y&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    GaussianInteger <span class="keyword">operator</span> * (<span class="keyword">const</span> GaussianInteger &amp;b)&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x * b.x - y * b.y, x * b.y + y * b.x&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//(ä¸“ç”¨! å› ä¸ºæ­¤å¤„bä¿è¯å¤§äº0)å››èˆäº”å…¥é™¤æ³•</span></span><br><span class="line">    <span class="comment">//é«˜æ–¯æ•´æ•°å•†çš„å®éƒ¨è™šéƒ¨åœ¨æŸä¸ªæ•´æ•°çš„**(-1/2, 1/2]**åŒºé—´ä¸­ã€‚</span></span><br><span class="line">    <span class="function">ll <span class="title">D</span><span class="params">(ll a, ll b)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(a &gt;= <span class="number">0</span>) <span class="keyword">return</span> (a % b) * <span class="number">2</span> &lt; b? a / b: a / b + <span class="number">1</span>;</span><br><span class="line">        a = -a; <span class="keyword">return</span> -((a % b) * <span class="number">2</span> &lt;= b? a / b: a / b + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    GaussianInteger <span class="keyword">operator</span> / (<span class="keyword">const</span> GaussianInteger &amp;b)&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="built_in">D</span>(x * b.x + y * b.y, x * b.x + y * b.y), <span class="built_in">D</span>(y * b.x - x * b.y, x * b.x + y * b.y)&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    GaussianInteger <span class="keyword">operator</span> % (<span class="keyword">const</span> GaussianInteger &amp;b)&#123;</span><br><span class="line">        GaussianInteger a = &#123;x, y&#125;;</span><br><span class="line">        <span class="keyword">return</span> a - a / b * b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">typedef</span> GaussianInteger NODE;</span><br><span class="line"><span class="function">NODE <span class="title">gcd</span><span class="params">(NODE a, NODE b)</span></span>&#123;<span class="keyword">return</span> !b.<span class="built_in">norm</span>()? a: <span class="built_in">gcd</span>(b, a % b);&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="çº¿æ€§ä»£æ•°"><a href="#çº¿æ€§ä»£æ•°" class="headerlink" title="çº¿æ€§ä»£æ•°"></a>çº¿æ€§ä»£æ•°</h3><h4 id="Gauss-Jordanæ¶ˆå…ƒæ³•"><a href="#Gauss-Jordanæ¶ˆå…ƒæ³•" class="headerlink" title="Gauss-Jordanæ¶ˆå…ƒæ³•"></a>Gauss-Jordanæ¶ˆå…ƒæ³•</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">ä½¿ç”¨æŒ‡å—ï¼š</span></span><br><span class="line"><span class="comment">    è¯»å…¥&quot;æ•´å½¢&quot;å¢å¹¿çŸ©é˜µaï¼Œä¿®æ”¹è¡Œåˆ—ä¿¡æ¯equã€varã€‚</span></span><br><span class="line"><span class="comment">    ä»é›¶å¼€å§‹ç¼–å·ï¼Œåˆ™è¡Œä¸º[0, equ - 1], åˆ—ä¸º[0, var];</span></span><br><span class="line"><span class="comment">    è¿”å›å€¼ï¼š</span></span><br><span class="line"><span class="comment">        è¿”å›0è¯´æ˜æœ‰æ•´æ•°è§£ï¼Œç»“æœå­˜æ”¾åœ¨xæ•°ç»„ä¸­</span></span><br><span class="line"><span class="comment">        è¿”å›-2è¯´æ˜æœ‰æµ®ç‚¹è§£ï¼Œéœ€è¦ä¿®æ”¹æ•°æ®ç±»å‹å†è¿ç®—</span></span><br><span class="line"><span class="comment">        è¿”å›-1æ—¶æ— è§£</span></span><br><span class="line"><span class="comment">        è¿”å›æ­£æ•°kæ—¶è¯´æ˜æœ‰kä¸ªè‡ªç”±å˜å…ƒï¼Œè‡ªç”±å˜å…ƒå­˜æ”¾åœ¨flagä¸­ï¼›</span></span><br><span class="line"><span class="comment">Tips:</span></span><br><span class="line"><span class="comment">    å¤„ç†è¿‡ç¨‹å¯èƒ½çˆ†int</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e2</span>;</span><br><span class="line"><span class="comment">//æœ‰equä¸ªç­‰å¼ï¼Œvarä¸ªå˜é‡ï¼Œé‚£ä¹ˆå¢å¹¿çŸ©é˜µæœ‰equè¡Œï¼Œvar + 1åˆ—ï¼›æ¨¡ç‰ˆä¸­ä»0å¼€å§‹æ ‡å·ã€‚</span></span><br><span class="line"><span class="keyword">int</span> equ, var;</span><br><span class="line"><span class="keyword">int</span> a[maxn][maxn];</span><br><span class="line"><span class="comment">//xæ˜¯è§£é›†ï¼Œflagæ ‡è®°æ˜¯å¦è‡ªç”±</span></span><br><span class="line"><span class="keyword">int</span> x[maxn], flag[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gauss</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, j;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>, j = <span class="number">0</span>; i &lt; equ &amp;&amp; j &lt; var; i++, j++)&#123;</span><br><span class="line">        <span class="keyword">int</span> l = i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k = i + <span class="number">1</span>; k &lt; equ; k++) <span class="keyword">if</span>(<span class="built_in">abs</span>(a[k][j] &gt; a[l][j])) l = k;</span><br><span class="line">        <span class="keyword">if</span>(l != i) <span class="built_in">swap</span>(a[l], a[i]);</span><br><span class="line">        <span class="comment">//iè¡ŒåŠä»¥ä¸‹çš„è¯¥åˆ—å…¨ä¸º0ï¼Œè½¬è€Œå¤„ç†ä¸‹ä¸€åˆ—ã€‚</span></span><br><span class="line">        <span class="keyword">if</span>(a[i][j] == <span class="number">0</span>)&#123;</span><br><span class="line">            i--; <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k = i + <span class="number">1</span>; k &lt; equ; k++) <span class="keyword">if</span>(a[k][j])&#123;</span><br><span class="line">            <span class="keyword">int</span> lcm = <span class="built_in">abs</span>(a[k][j] * a[i][j]) / <span class="built_in">gcd</span>(<span class="built_in">abs</span>(a[k][j]), <span class="built_in">abs</span>(a[i][j]));</span><br><span class="line">            <span class="keyword">int</span> pa = lcm / a[k][j], pb = lcm / a[i][j];</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> col = j; col &lt;= var; col++) a[k][col] = a[k][col] * pa - a[i][col] * pb;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¾ªç¯å®Œæˆåï¼Œiæ˜¯æœ‰æ•ˆè¡Œæ•°ï¼Œä¹Ÿå°±æ˜¯ç§©ï¼ˆï¼Ÿï¼‰ï¼›</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//(I)å­˜åœ¨(0, 0, ... ,0, k!=0)çš„ç»“æ„å­˜åœ¨ï¼Œå³æ— è§£,è¿”å›-1</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> k = i; k &lt; equ; k++) <span class="keyword">if</span>(a[k][var] != <span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//(II)å­˜åœ¨è‡ªç”±å˜å…ƒï¼Œè¿”å›å˜å…ƒæ•°é‡ï¼Œå¹¶ä¸”åœ¨flagæ•°ç»„ä¸­æ ‡è®°å‡ºæ‰€æœ‰çš„è‡ªç”±å˜å…ƒã€‚</span></span><br><span class="line">    <span class="keyword">if</span>(j &lt; var)&#123;</span><br><span class="line">        <span class="comment">//iæ˜¯ç§©ï¼Œ[0, i - 1]å‡ä¸ºéå…¨é›¶çš„è¡Œ</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k = i - <span class="number">1</span>; k &gt;= <span class="number">0</span>; k--)&#123;</span><br><span class="line">            <span class="keyword">int</span> cnt = <span class="number">0</span>, free_id = <span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> col = <span class="number">0</span>; col &lt; var; col++) <span class="keyword">if</span>(a[k][col] &amp;&amp; flag[col])&#123;</span><br><span class="line">                cnt++;</span><br><span class="line">                free_id = col;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//ä¸€å®šå­˜åœ¨è‡³å°‘ä¸€ä¸ªè‡ªç”±å˜å…ƒï¼Œä¸ç„¶ä¸€å®šä¼šè¢«å‘ä¸‹è¿‡ç¨‹æ¶ˆå»ã€‚</span></span><br><span class="line">            <span class="built_in">assert</span>(free_id != <span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//æœ‰ä¸¤ä¸ªåŠä»¥ä¸Šå˜å…ƒï¼Œé‚£ä¹ˆæ— æ³•ç¡®å®šè¿™äº›å˜å…ƒ</span></span><br><span class="line">            <span class="keyword">if</span>(cnt &gt;= <span class="number">2</span>) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æ³¨é‡ŠåŸå› :æ±‚è§£å˜å…ƒä¼šæ¶‰åŠåˆ°å°æ•°ï¼Ÿæ•…æ³¨é‡Šæ‰ï¼Œå®é™…æ“ä½œæ—¶æ ¹æ®å…·ä½“æƒ…å†µå¤„ç†</span></span><br><span class="line">            <span class="comment">// //åªå‰©ä¸€ä¸ªå˜å…ƒfree_idï¼Œå¯ä»¥æ±‚è§£å‡ºæ¥ã€‚</span></span><br><span class="line">            <span class="comment">// int temp = a[k][var];</span></span><br><span class="line">            <span class="comment">// for(int col = 0; col &lt; var; col++) if(a[k][col] &amp;&amp; col != free_id) temp -= a[k][col] * x[col];</span></span><br><span class="line">            <span class="comment">// x[free_id] = tmep / a[k][free_id];</span></span><br><span class="line"></span><br><span class="line">            flag[free_id] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> var - i;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//(III)æ±‚è§£æ–¹ç¨‹ï¼Œæ­¤æ—¶ä¿è¯æœ‰å”¯ä¸€è§£:å¦‚æœå…¨éƒ¨ä¸ºæ­£æ•´æ•°è§£ï¼Œè¿”å›0ï¼Œå¦‚æœå‡ºç°æµ®ç‚¹æ•°è§£ï¼Œè¿”å›-2ï¼›</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = var - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">        <span class="keyword">int</span> tmep = a[i][var];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; var; j++) <span class="keyword">if</span>(a[i][j]) tmep -= a[i][j] * x[j];</span><br><span class="line">        <span class="keyword">if</span>(temp % a[i][i]) <span class="keyword">return</span> <span class="number">-2</span>;</span><br><span class="line">        x[i] = temp / a[i][i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ç®—æ³•ä¸­çš„+-ä¸ºå¼‚æˆ–å°±å¯ä»¥å˜æˆå¼‚æˆ–åŠ çš„é«˜æ–¯æ¶ˆå…ƒæ³•ã€‚</p><h4 id="é€†çŸ©é˜µé«˜æ–¯æ¶ˆå…ƒ"><a href="#é€†çŸ©é˜µé«˜æ–¯æ¶ˆå…ƒ" class="headerlink" title="é€†çŸ©é˜µé«˜æ–¯æ¶ˆå…ƒ"></a>é€†çŸ©é˜µé«˜æ–¯æ¶ˆå…ƒ</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">ä½¿ç”¨æŒ‡å—ï¼š</span></span><br><span class="line"><span class="comment">    è¯»å…¥çŸ©é˜µå¤§å°nå’Œåˆå§‹çŸ©é˜µåœ¨a[i][j]ä¸­, i ,j âˆˆ[0, ... ,n - 1ã€‘</span></span><br><span class="line"><span class="comment">    è¿”å›åœ¨æ¨¡Mæ„ä¹‰ä¸‹çš„æ•´æ•°çŸ©é˜µåœ¨a[i][j + n]ä¸­, i ,j âˆˆ[0, ... ,n - 1ã€‘</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e2</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n; ll a[maxn][maxn &lt;&lt; <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">prt</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span> ;j &lt; <span class="number">2</span> * n; j++) <span class="built_in">printf</span>(<span class="string">&quot;%-10lld &quot;</span>,a[i][j]);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">inverse</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++) a[i][j + n] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) a[i][i + n] = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">prt</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> l = i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k = i + <span class="number">1</span>; k &lt; n; k++) <span class="keyword">if</span>(<span class="built_in">abs</span>(a[k][i] &gt; a[l][i])) l = k;</span><br><span class="line">        <span class="keyword">if</span>(l != i) <span class="built_in">swap</span>(a[l], a[i]);</span><br><span class="line">        <span class="built_in">prt</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!a[i][i]) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        ll inv = <span class="built_in">qp</span>(a[i][i], M - <span class="number">2</span>, M);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">2</span> * n; k++) a[i][k] = a[i][k] * inv % M;</span><br><span class="line">        <span class="built_in">prt</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++) <span class="keyword">if</span>(j != i)&#123;</span><br><span class="line">            ll t = a[j][i];</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">2</span> * n; k++) a[j][k] = ((a[j][k] - t * a[i][k]) % M + M) % M;</span><br><span class="line">            <span class="built_in">prt</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ²¡æœ‰ç»å†è¿‡è¾ƒå¼ºæ•°æ®çš„æµ‹è¯•ï¼Œä½¿ç”¨æ—¶éœ€è°¨æ…ï¼âš ï¸ï¼ï¼ï¼</p><p>æ±‚é€†å…ƒä½¿ç”¨çš„æ˜¯quick_powï¼Œå½“æ¨¡æ•°Mä¸æ˜¯ç´ æ•°æ—¶åº”è¯¥ä½¿ç”¨exgcdæ±‚ç´ æ•°ã€‚</p><h4 id="è¡Œåˆ—å¼"><a href="#è¡Œåˆ—å¼" class="headerlink" title="è¡Œåˆ—å¼"></a>è¡Œåˆ—å¼</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> n; ll a[maxn][maxn];</span><br><span class="line"><span class="function">ll <span class="title">det</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ll ans = <span class="number">1</span>, temp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> l = i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; n; j++) <span class="keyword">if</span>(<span class="built_in">abs</span>(a[j][i]) &gt; <span class="built_in">abs</span>(a[l][i])) l = j;</span><br><span class="line">        <span class="keyword">if</span>(l != i)&#123;</span><br><span class="line">            <span class="built_in">swap</span>(a[i], a[l]);</span><br><span class="line">            ans = -ans;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(!a[i][i]) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++) <span class="keyword">if</span>(j != i &amp;&amp; a[j][i])&#123;</span><br><span class="line">            ll lcm = a[i][i] * a[j][i] / <span class="built_in">gcd</span>(<span class="built_in">abs</span>(a[i][i]), <span class="built_in">abs</span>(a[j][i]));</span><br><span class="line">            ll ta = lcm / a[j][i], tb = lcm / a[i][i];</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; n; k++) a[j][k] = ta * a[j][k] - tb * a[i][k];</span><br><span class="line">            temp *= ta;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) ans *= a[i][i];</span><br><span class="line">    <span class="keyword">return</span> ans / temp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ²¡æœ‰ç»å†è¿‡è¾ƒå¼ºæ•°æ®çš„æµ‹è¯•ï¼Œä½¿ç”¨æ—¶éœ€è°¨æ…ï¼âš ï¸ï¼ï¼ï¼</p><h3 id="è‡ªé€‚åº”è¾›æ™®æ£®æ±‚å®šç§¯åˆ†"><a href="#è‡ªé€‚åº”è¾›æ™®æ£®æ±‚å®šç§¯åˆ†" class="headerlink" title="è‡ªé€‚åº”è¾›æ™®æ£®æ±‚å®šç§¯åˆ†"></a>è‡ªé€‚åº”è¾›æ™®æ£®æ±‚å®šç§¯åˆ†</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">f</span><span class="params">(<span class="keyword">double</span> x)</span></span>&#123;</span><br><span class="line">    <span class="comment">//å¡«å…¥ç§¯åˆ†å‡½æ•°</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">simpson</span><span class="params">(<span class="keyword">double</span> l, <span class="keyword">double</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (r - l) * (<span class="built_in">f</span>(l) + <span class="built_in">f</span>(r) + <span class="number">4</span> * <span class="built_in">f</span>((l + r) / <span class="number">2</span>)) / <span class="number">6</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">solve</span><span class="params">(<span class="keyword">double</span> L, <span class="keyword">double</span> R, <span class="keyword">double</span> ans)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> mid = (L + R) / <span class="number">2</span>, l = <span class="built_in">simpson</span>(L, mid), r = <span class="built_in">simpson</span>(mid, R);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">fabs</span>(l + r - ans) &lt;= eps) <span class="keyword">return</span> ans; </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">solve</span>(L, mid, l) + <span class="built_in">solve</span>(mid, R, r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="gcd-amp-exgcd-æ‹“å±•æ¬§å‡ é‡Œå¾·"><a href="#gcd-amp-exgcd-æ‹“å±•æ¬§å‡ é‡Œå¾·" class="headerlink" title="gcd &amp; exgcd(æ‹“å±•æ¬§å‡ é‡Œå¾·)"></a>gcd &amp; exgcd(æ‹“å±•æ¬§å‡ é‡Œå¾·)</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function">T <span class="title">gcd</span><span class="params">(T x, T y)</span></span>&#123;<span class="keyword">return</span> !x? y: <span class="built_in">gcd</span>(y % x, x);&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exgcd</span><span class="params">(T a, T b, T &amp;x, T &amp;y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!b)&#123;x = <span class="number">1</span>; y = <span class="number">0</span>;<span class="keyword">return</span>;&#125;</span><br><span class="line">    <span class="built_in">exgcd</span>(b, a % b, y, x); y -= a / b * x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="çº¿æ€§ç­›"><a href="#çº¿æ€§ç­›" class="headerlink" title="çº¿æ€§ç­›"></a>çº¿æ€§ç­›</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">euler</span><span class="params">(<span class="keyword">int</span> *prime, <span class="keyword">int</span> *vis, <span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> top = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++) vis[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!vis[i]) prime[top++] = i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; top &amp;&amp; i * prime[j] &lt;= n; j++)&#123;</span><br><span class="line">            vis[i * prime[j]] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i % prime[j] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> top;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="7-æ•°æ®ç»“æ„"><a href="#7-æ•°æ®ç»“æ„" class="headerlink" title="7 æ•°æ®ç»“æ„"></a>7 æ•°æ®ç»“æ„</h2><h3 id="åŒºé—´åˆå¹¶çº¿æ®µæ ‘"><a href="#åŒºé—´åˆå¹¶çº¿æ®µæ ‘" class="headerlink" title="åŒºé—´åˆå¹¶çº¿æ®µæ ‘"></a>åŒºé—´åˆå¹¶çº¿æ®µæ ‘</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Tree</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> l, r, ll, rr, all;</span><br><span class="line">&#125;tree[maxn &lt;&lt; <span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆå§‹åŒ–åŒºé—´çº¿æ®µæ ‘</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    tree[p].l = l; tree[p].r = r;</span><br><span class="line">    tree[p].ll = tree[p].rr = tree[p].all = r - l + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(r == l) <span class="keyword">return</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">build</span>(ls, l, mid);</span><br><span class="line">    <span class="built_in">build</span>(rs, mid + <span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">up</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line"><span class="comment">//æ›´æ–°è¿ç»­å·¦åŒºé—´</span></span><br><span class="line">    <span class="keyword">if</span>(tree[ls].ll == tree[ls].r - tree[ls].l + <span class="number">1</span>) tree[p].ll = tree[ls].ll + tree[rs].ll;</span><br><span class="line">    <span class="keyword">else</span> tree[p].ll = tree[ls].ll;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//æ›´æ–°è¿ç»­å³åŒºé—´</span></span><br><span class="line">    <span class="keyword">if</span>(tree[rs].rr == tree[rs].r - tree[rs].l + <span class="number">1</span>) tree[p].rr = tree[ls].rr + tree[rs].rr;</span><br><span class="line">    <span class="keyword">else</span> tree[p].rr = tree[rs].rr;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//æ›´æ–°å…¨åŒºé—´</span></span><br><span class="line">    tree[p].all = <span class="built_in">max</span>(tree[ls].all, <span class="built_in">max</span>(tree[rs].all, tree[ls].rr + tree[rs].ll));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//å°†xæ‰€åœ¨çš„å…ƒç´ ç½®ä¸ºk(k = 0/1)ï¼›å½“å‰èŠ‚ç‚¹ä¸ºp</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> x, <span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(tree[p].l == tree[p].r &amp;&amp; tree[p].l == x)&#123;</span><br><span class="line">        tree[p].all = tree[p].ll = tree[p].rr = k;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(x &lt;= (tree[p].l + tree[p].r) &gt;&gt; <span class="number">1</span>) <span class="built_in">update</span>(ls, x, k);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">update</span>(rs, x, k);</span><br><span class="line">    <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">que</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(tree[p].l == tree[p].r) <span class="keyword">return</span> tree[p].all;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//xå¤„äºä¸­å¿ƒä½ç½®çš„åŒºé—´åˆ™æ›´æ–°ä¹‹</span></span><br><span class="line">    <span class="keyword">if</span>(x &gt;= tree[ls].r - tree[ls].rr + <span class="number">1</span> &amp;&amp; x &lt;= tree[rs].l + tree[rs].ll - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> tree[ls].rr + tree[rs].ll;</span><br><span class="line">    <span class="comment">//xå¤„äºå·¦è¾¹å…¶ä»–æŸä¸ªä½ç½®</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(x &lt; tree[ls].r - tree[ls].rr + <span class="number">1</span>) <span class="keyword">return</span> <span class="built_in">que</span>(ls, x);</span><br><span class="line">    <span class="comment">//xå¤„äºå³è¾¹å…¶ä»–æŸä¸ªä½ç½®</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">que</span>(rs, x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="çº¿æ®µæ ‘å“ˆå¸Œ"><a href="#çº¿æ®µæ ‘å“ˆå¸Œ" class="headerlink" title="çº¿æ®µæ ‘å“ˆå¸Œ"></a>çº¿æ®µæ ‘å“ˆå¸Œ</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ls (p &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rs ((p &lt;&lt; 1) | 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mid ((l + r) &gt;&gt; 1)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">5e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="comment">//æ•°å€¼å¯¹modå–æ¨¡</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">65536</span>;</span><br><span class="line"><span class="comment">//å“ˆå¸Œçš„åŸºåº•å’Œæ¨¡æ•°</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> pp = <span class="number">999983</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1000237529</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ³¨æ„modå’ŒMï¼å®é™…è¿ç”¨æ—¶ä¸è¦å†™é”™äº†ï¼</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//stä¸ºå“ˆå¸Œå’Œçº¿æ®µæ ‘; st1ä¸ºæå€¼çº¿æ®µæ ‘ï¼Œç”¨äºç»´æŠ¤å¯¹modå–æ¨¡çš„ç›¸å…³ä¿¡æ¯ã€‚</span></span><br><span class="line"><span class="keyword">int</span> a[maxn];</span><br><span class="line">ll tag[maxn &lt;&lt; <span class="number">2</span>], st1[maxn &lt;&lt; <span class="number">2</span>], st[maxn &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="comment">//po[i] = pp ^ i; pre[i] = po[0] + po[1] + ... + po[i]ï¼Œç”¨äºå¯¹åŒºé—´å¿«é€Ÿæ›´æ–°å“ˆå¸Œå’Œ</span></span><br><span class="line">ll po[maxn], pre[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">up</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    st[p] = st[ls] + st[rs] * po[mid - l + <span class="number">1</span>] % M; st[p] %= M;</span><br><span class="line">    st1[p] = <span class="built_in">max</span>(st1[ls], st1[rs]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l == r &amp;&amp; l == k)&#123;</span><br><span class="line">        st[p] = st1[p] = x;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(k &lt;= mid) <span class="built_in">build</span>(ls, l, mid, k, x);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">build</span>(rs, mid + <span class="number">1</span>, r, k, x);</span><br><span class="line">    <span class="built_in">up</span>(p, l, r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">down</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(tag[p])&#123;</span><br><span class="line">        tag[ls] += tag[p];</span><br><span class="line">        tag[rs] += tag[p];</span><br><span class="line">        </span><br><span class="line">        st[ls] += pre[mid - l] * tag[p] % M; st[ls] %= M;</span><br><span class="line">        st[rs] += pre[r - mid - <span class="number">1</span>] * tag[p] % M; st[rs] %= M;</span><br><span class="line">        </span><br><span class="line">        st1[ls] += tag[p];</span><br><span class="line">        st1[rs] += tag[p];</span><br><span class="line">        </span><br><span class="line">        tag[p] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= l &amp;&amp; r &lt;= R)&#123;</span><br><span class="line">        st[p] += pre[r - l] * x % M; st[p] %= M;</span><br><span class="line">        st1[p] += x; tag[p] += x;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">down</span>(p, l, r);</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= mid) <span class="built_in">udpate</span>(ls, l, mid, L, R, x);</span><br><span class="line">    <span class="keyword">if</span>(R &gt; mid) <span class="built_in">update</span>(rs, mid + <span class="number">1</span>, r, L , R, x);</span><br><span class="line">    <span class="built_in">up</span>(p, l, r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">purify</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(st1[p] &lt; mod) <span class="keyword">return</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(l == r)&#123;</span><br><span class="line">        st[p] %= mod; st1[p] %= mod;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">down</span>(p, l, r);</span><br><span class="line">    <span class="keyword">if</span>(st1[ls] &gt;= mod) <span class="built_in">purify</span>(ls, l, mid);</span><br><span class="line">    <span class="keyword">if</span>(st1[rs] &gt;= mod) <span class="built_in">purify</span>(rs, mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="built_in">up</span>(p, l, r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">hsh</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= l &amp;&amp; r &lt;= R) <span class="keyword">return</span> st[p];</span><br><span class="line">    <span class="built_in">down</span>(p, l, r);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(R &lt;= mid) <span class="keyword">return</span> <span class="built_in">hsh</span>(ls, l, mid, L, R);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(L &gt; mid) <span class="keyword">return</span> <span class="built_in">hsh</span>(rs, mid + <span class="number">1</span>, r, L, R);</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="comment">/*</span></span><br><span class="line"><span class="comment">      éœ€è¦æ³¨æ„ï¼</span></span><br><span class="line"><span class="comment">      å¾€å­æ ‘é€’å½’æ—¶[L, R]è¦å˜åŒ–æˆ[L, mid](ä¸é‡è¦)å’Œ[mid + 1, R](é‡è¦)ï¼</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">        ll ans = <span class="built_in">hsh</span>(ls, l, mid, L, mid);</span><br><span class="line">        ans += <span class="built_in">hsh</span>(rs, mid + <span class="number">1</span>, r, mid + <span class="number">1</span>, R) * po[mid - L + <span class="number">1</span>] % M;</span><br><span class="line">        ans %= M;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//Fastin;</span></span><br><span class="line">    po[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; maxn; i++) po[i] = po[i - <span class="number">1</span>] * <span class="number">1ll</span> * pp % M;</span><br><span class="line">    pre[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; maxn; i++) pre[i] = pre[i - <span class="number">1</span>] + po[i], pre[i] %= M;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> n, m; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a + i);</span><br><span class="line">        <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n, i, a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span>(m--)&#123;</span><br><span class="line">        <span class="keyword">int</span> op; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;op);</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> l, r, x; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;l, &amp;r, &amp;x);</span><br><span class="line">            <span class="built_in">update</span>(<span class="number">1</span>, <span class="number">1</span>, n, l, r, x);</span><br><span class="line">          <span class="comment">//æ¯æ¬¡æ›´æ–°å®Œåéƒ½ä¼šå°†è¶…å‡ºèŒƒå›´çš„å¶å­ç»“ç‚¹è¿›è¡Œæ›´æ–°ï¼Œå®é™…åº”ç”¨æ—¶éœ€è¦è€ƒè™‘å¤æ‚åº¦æ˜¯å¦æ”¯æŒï¼</span></span><br><span class="line">            <span class="built_in">purify</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">int</span> l, r, k; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;l, &amp;r, &amp;k);</span><br><span class="line">            </span><br><span class="line">            ll res1 = <span class="built_in">hsh</span>(<span class="number">1</span>, <span class="number">1</span>, n, l, l + k - <span class="number">1</span>);</span><br><span class="line">            ll res2 = <span class="built_in">hsh</span>(<span class="number">1</span>, <span class="number">1</span>, n, r, r + k - <span class="number">1</span>);</span><br><span class="line">            <span class="built_in">puts</span>(res1 == res2? <span class="string">&quot;yes&quot;</span>: <span class="string">&quot;no&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>INPUT</code></p><p>æ•°æ®é•¿åº¦n æ“ä½œæ¬¡æ•°m</p><p>$a_1, a_2,â€¦,a_n$</p><p>$op_1, l_1, r_1, x_1$</p><p>$op_2, l_2, r_2, x_2$</p><p>â€¦</p><p>$op_m, l_m, r_m, x_m$</p><p><code>åŠŸèƒ½</code></p><ul><li>opä¸º1ï¼Œå¯¹åŒºé—´[li, ri] += xi, å¹¶å¯¹æŒ‡å®šæ¨¡æ•°<code>mod</code>å–æ¨¡</li><li>opä¸º2ï¼ŒæŸ¥è¯¢ä»¥liå’Œriä¸ºèµ·ç‚¹çš„ä¸¤ç«¯é•¿åº¦å‡ä¸ºxçš„åŒºé—´çš„å“ˆå¸Œå’Œï¼Œä»¥æ­¤æ¥åˆ¤æ–­åºåˆ—æ˜¯å¦ç›¸åŒã€‚</li></ul><h3 id="çº¿æ®µæ ‘åˆå¹¶"><a href="#çº¿æ®µæ ‘åˆå¹¶" class="headerlink" title="çº¿æ®µæ ‘åˆå¹¶"></a>çº¿æ®µæ ‘åˆå¹¶</h3><h4 id="å­æ ‘æœ€å¤šå‡ºç°æ¬¡æ•°é¢œè‰²å’Œçš„æŸ¥è¯¢"><a href="#å­æ ‘æœ€å¤šå‡ºç°æ¬¡æ•°é¢œè‰²å’Œçš„æŸ¥è¯¢" class="headerlink" title="å­æ ‘æœ€å¤šå‡ºç°æ¬¡æ•°é¢œè‰²å’Œçš„æŸ¥è¯¢"></a>å­æ ‘æœ€å¤šå‡ºç°æ¬¡æ•°é¢œè‰²å’Œçš„æŸ¥è¯¢</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘ï¼š</span></span><br><span class="line"><span class="comment">    - æ’å…¥ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">    - åˆå¹¶ä¸¤æ£µæ ‘</span></span><br><span class="line"><span class="comment"> ç»´æŠ¤å‡ºç°æœ€å¤šçš„æ¬¡æ•°çš„é¢œè‰²çš„å’Œï¼Œè®°å½•ä¸¤ä¸ªå€¼(å‡ºç°æ¬¡æ•°ï¼Œé¢œè‰²å’Œ)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mid ((l + r) &gt;&gt; 1)</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1e5</span> * <span class="number">20</span> * <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">int</span> haed[maxn], top = <span class="number">0</span>, root[maxn];</span><br><span class="line">star edge[maxn &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NODE</span>&#123;</span><span class="keyword">int</span> mx; ll sum;&#125;;</span><br><span class="line">NODE st[M];</span><br><span class="line"><span class="keyword">int</span> ls[M], rs[M], cnt = <span class="number">1</span>;</span><br><span class="line"><span class="comment">//cntå¿…é¡»ä»1å¼€å§‹ï¼è¿™æ˜¯ç”±mergeçš„å®ç°æ‰€å†³å®šçš„ï¼</span></span><br><span class="line"><span class="comment">//åŠ å…¥ä¸€ä¸ªå•ç‚¹ä½œä¸ºåˆå§‹åŒ–</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> &amp;p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!p) p = cnt++;</span><br><span class="line">    <span class="keyword">if</span>(l == r &amp;&amp; l == k)&#123;</span><br><span class="line">        st[p].mx = <span class="number">1</span>; st[p].sum = k;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(k &lt;= mid)&#123;</span><br><span class="line">        <span class="built_in">update</span>(ls[p], l, mid, k);</span><br><span class="line">        st[p] = st[ls[p]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">update</span>(rs[p], mid + <span class="number">1</span>, r, k);</span><br><span class="line">        st[p] = st[rs[p]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">up</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(st[ls[p]].mx &gt; st[rs[p]].mx) st[p] = st[ls[p]];</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(st[ls[p]].mx &lt; st[rs[p]].mx) st[p] = st[rs[p]];</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        st[p].mx = st[ls[p]].mx;</span><br><span class="line">        st[p].sum = st[ls[p]].sum + st[rs[p]].sum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å°†r1ä¸r2å¯¹åº”çš„ä¸¤æ£µç»“æ„ç›¸åŒçš„çº¿æ®µæ ‘è¿›è¡Œåˆå¹¶ï¼Œè¿”å›å€¼ä¸ºåˆå¹¶åçš„æ ‘çš„æ ‡å·</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> r1, <span class="keyword">int</span> r2, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!r1) <span class="keyword">return</span> r2;</span><br><span class="line">    <span class="keyword">if</span>(!r2) <span class="keyword">return</span> r1;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(l == r)&#123;</span><br><span class="line">        st[r1].mx += st[r2].mx;</span><br><span class="line">        <span class="keyword">return</span> r1;</span><br><span class="line">    &#125;</span><br><span class="line">    ls[r1] = <span class="built_in">merge</span>(ls[r1], ls[r2], l, mid);</span><br><span class="line">    rs[r1] = <span class="built_in">merge</span>(rs[r1], rs[r2], mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="built_in">up</span>(r1);</span><br><span class="line">    <span class="keyword">return</span> r1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ll ans[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> par)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[now]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(to == par) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(to, now);</span><br><span class="line">        root[now] = <span class="built_in">merge</span>(root[now], root[to], <span class="number">1</span>, n);</span><br><span class="line">    &#125;</span><br><span class="line">    ans[now] = st[root[now]].sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="built_in">clr</span>(head, <span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> c; <span class="built_in">scnaf</span>(<span class="string">&quot;%d&quot;</span>, &amp;c);</span><br><span class="line">        <span class="built_in">udpate</span>(root[i], <span class="number">1</span>, n, c);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> u, v; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">        <span class="built_in">add</span>(u, v); <span class="built_in">add</span>(v, u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">prt</span>(ans + <span class="number">1</span>, n);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç»™å‡ºä¸€æ£µnèŠ‚ç‚¹çš„æ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹å…·æœ‰ä¸€ä¸ªé¢œè‰²ã€‚</p><p>è¾“å‡ºåœ¨ä»¥1ä¸ºæ ¹æ—¶ï¼Œæ¯ä¸ªèŠ‚ç‚¹åŠå…¶å­æ ‘ä¸Šæ‰€æœ‰èŠ‚ç‚¹ä¸­æœ€å¤šæ•°é‡çš„é¢œè‰²çš„å’Œã€‚</p><p>$n \leq 1e5, c_i \leq n$</p><p>æ¯æ’å…¥ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¼šäº§ç”Ÿlognä¸ªæ–°èŠ‚ç‚¹ï¼Œå› è€Œæ€»å…±è‡³å¤šäº§ç”Ÿnlognä¸ªæ–°èŠ‚ç‚¹ã€‚</p><p>è€Œåœ¨æ¯ä¸€æ¬¡mergeæ—¶ï¼Œä¼šåˆå¹¶æ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œåˆå¹¶çš„å¤æ‚åº¦æ˜¯$O(1)$ï¼Œæ‰€ä»¥è‡³å¤šè¿›è¡Œnlognæ¬¡åˆå¹¶ã€‚</p><p>å› è€Œçº¿æ®µæ ‘åˆå¹¶çš„æ€»ä½“å¤æ‚åº¦æ˜¯$O(nlogn)$</p><h3 id="segment-tree-beats"><a href="#segment-tree-beats" class="headerlink" title="segment tree beats"></a>segment tree beats</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ls (p &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rs ((p &lt;&lt; 1) | 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mid ((l + r) &gt;&gt; 1)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> a[manx];</span><br><span class="line"><span class="comment">//stä¸­è®°å½•åŒºé—´å’Œï¼Œmxè®°å½•æœ€å€¼ï¼Œcntè®°å½•æœ€å€¼çš„æ•°é‡ï¼Œsmxè®°å½•ç¬¬äºŒæå€¼çš„å¤§å°ã€‚</span></span><br><span class="line">ll st[maxn &lt;&lt; <span class="number">2</span>]; <span class="keyword">int</span> mx[maxn &lt;&lt; <span class="number">2</span>], cnt[maxn &lt;&lt; <span class="number">2</span>], smx[maxn &lt;&lt; <span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">up</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">    st[p] = st[ls] + st[rs];</span><br><span class="line">    <span class="keyword">if</span>(mx[ls] &gt; mx[rs])&#123;</span><br><span class="line">        mx[p] = mx[ls];</span><br><span class="line">        cnt[p] = cnt[ls];</span><br><span class="line">        smx[p] = <span class="built_in">max</span>(mx[rs], smx[ls]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(mx[ls] &lt; mx[rs])&#123;</span><br><span class="line">        mx[p] = mx[rs];</span><br><span class="line">        cnt[p] = cnt[rs];</span><br><span class="line">        smx[p] = <span class="built_in">max</span>(mx[ls], smx[rs]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        mx[p] = mx[ls];</span><br><span class="line">        cnt[p] = cnt[ls] + cnt[rs];</span><br><span class="line">        smx[p] = <span class="built_in">max</span>(smx[ls], smx[rs]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fun</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    st[p] -= <span class="number">1ll</span> * cnt[p] * (mx[p] - x);</span><br><span class="line">    mx[p] = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">down</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(mx[ls] &gt; mx[p] &amp;&amp; mx[p] &gt; smx[ls]) <span class="built_in">fun</span>(ls, mx[p]);</span><br><span class="line">    <span class="keyword">if</span>(mx[rs] &gt; mx[p] &amp;&amp; mx[p] &gt; smx[rs]) <span class="built_in">fun</span>(rs, mx[p]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l == r)&#123;</span><br><span class="line">        st[p] = mx[p] = a[l];</span><br><span class="line">        cnt[p] = <span class="number">1</span>;</span><br><span class="line">        smx[p] = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">build</span>(ls, l, mid);</span><br><span class="line">    <span class="built_in">build</span>(rs, mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(mx[p] &lt;= x) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= l &amp;&amp; r &lt;= R)&#123;</span><br><span class="line">        <span class="keyword">if</span>(smx[p] &lt; x)&#123;</span><br><span class="line">            <span class="built_in">fun</span>(p, x); <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">down</span>(p);</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= mid) <span class="built_in">update</span>(ls, l, mid, L, R, x);</span><br><span class="line">    <span class="keyword">if</span>(R &gt; mid) <span class="built_in">update</span>(rs, mid + <span class="number">1</span>, r, L, R, x);</span><br><span class="line">    <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getmx</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= l &amp;&amp; r &lt;= R) <span class="keyword">return</span> mx[p];</span><br><span class="line">    <span class="built_in">down</span>(p);</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= mid) ans = <span class="built_in">max</span>(ans, <span class="built_in">getmx</span>(ls, l, mid, L, R));</span><br><span class="line">    <span class="keyword">if</span>(R &gt; mid) ans = <span class="built_in">max</span>(ans, <span class="built_in">getmx</span>(rs, mid + <span class="number">1</span>, r, L, R));</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">getsum</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= l &amp;&amp; r &lt;= R) <span class="keyword">return</span> st[p];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">down</span>(p);</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= mid) ans += <span class="built_in">getsum</span>(ls, l, mid, L, R);</span><br><span class="line">    <span class="keyword">if</span>(R &gt; mid) ans += <span class="built_in">getsum</span>(rs, mid + <span class="number">1</span>, r, L, R);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// Fastin;</span></span><br><span class="line">    TTT&#123;</span><br><span class="line">        <span class="keyword">int</span> n, m; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scnaf</span>(<span class="string">&quot;%d&quot;</span>, a + i);</span><br><span class="line">        <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>(m--)&#123;</span><br><span class="line">            <span class="keyword">int</span> op; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;op);</span><br><span class="line">            <span class="keyword">int</span> x, y, z;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;x, &amp;y);</span><br><span class="line">            <span class="keyword">if</span>(op == <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="built_in">scnaf</span>(<span class="string">&quot;%d&quot;</span>, &amp;z);</span><br><span class="line">                <span class="built_in">update</span>(<span class="number">1</span>, <span class="number">1</span>, n, x, y, z);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">1</span>)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">getmx</span>(<span class="number">1</span>, <span class="number">1</span>, n, x, y));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">getsum</span>(<span class="number">1</span>, <span class="number">1</span>, n, x, y));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=5306">hdu 5306æ¨¡æ¿</a></p><p>ç»™å‡ºé•¿åº¦ä¸º$n$çš„åºåˆ—ï¼Œè¦æ±‚æ”¯æŒå¦‚ä¸‹æ“ä½œ:</p><ul><li>ç»™å‡º$l ,r, x$ï¼Œä»¤$a_i = min(a_i, x), i = l, â€¦, r$</li><li>ç»™å‡º$l, r$ï¼ŒæŸ¥è¯¢åŒºé—´ä¸­çš„æœ€å¤§å€¼/åŒºé—´å’Œ</li></ul><p>å¬è¯´ä¸è¿›è¡ŒåŒºé—´åŠ å‡çš„è¯å¤æ‚åº¦å‡æ‘Š$O(nlogn)$</p><h2 id="8-DP"><a href="#8-DP" class="headerlink" title="8 DP"></a>8 DP</h2><h3 id="ä¾èµ–èƒŒåŒ…ï¼ˆæ ‘ä¸ŠèƒŒåŒ…ï¼‰"><a href="#ä¾èµ–èƒŒåŒ…ï¼ˆæ ‘ä¸ŠèƒŒåŒ…ï¼‰" class="headerlink" title="ä¾èµ–èƒŒåŒ…ï¼ˆæ ‘ä¸ŠèƒŒåŒ…ï¼‰"></a>ä¾èµ–èƒŒåŒ…ï¼ˆæ ‘ä¸ŠèƒŒåŒ…ï¼‰</h3><h4 id="å‘ä¸Šè½¬ç§»"><a href="#å‘ä¸Šè½¬ç§»" class="headerlink" title="å‘ä¸Šè½¬ç§»"></a>å‘ä¸Šè½¬ç§»</h4><p>çŠ¶æ€è½¬ç§»æ—¶æš´åŠ›æšä¸¾å„¿å­çš„æ‰€æœ‰çŠ¶å†µï¼Œå°†å…¶æ›´æ–°åˆ°çˆ¶äº²ä¸­ã€‚</p><p>æ—¶é—´å¤æ‚åº¦$O(N*M^2)$</p><h4 id="å‘ä¸‹ä¼ é€’"><a href="#å‘ä¸‹ä¼ é€’" class="headerlink" title="å‘ä¸‹ä¼ é€’"></a>å‘ä¸‹ä¼ é€’</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> manx = <span class="number">1e2</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, W, v[maxn], w[maxn];</span><br><span class="line"><span class="keyword">int</span> dp[maxn][maxn];</span><br><span class="line">star edge[maxn &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> head[maxn], top = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//dp[i][j]è¡¨ç¤ºiå­æ ‘ä¸­é‡é‡ä¸ºjä¸‹çš„æœ€å¤§ä»·å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> par)</span></span>&#123;</span><br><span class="line">    dp[u][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[u]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(to == par) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= W; i++) dp[to][i] = dp[u][i];</span><br><span class="line">        <span class="built_in">dfs</span>(to, u);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = W; i &gt;= w[to]; i--) <span class="keyword">if</span>(dp[to][i - w[to]] != <span class="number">-1</span>)</span><br><span class="line">            dp[u][i] = <span class="built_in">max</span>(dp[u][i], dp[to][i - w[to]] + v[to]);</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span>&#123;</span><br><span class="line">    <span class="comment">// Fastin; </span></span><br><span class="line">    <span class="built_in">clr</span>(head, <span class="number">-1</span>); <span class="built_in">clr</span>(dp, <span class="number">-1</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;W);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> x, y, z; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;x, &amp;y, &amp;z); <span class="keyword">if</span>(z == <span class="number">-1</span>) z = <span class="number">0</span>;</span><br><span class="line">        w[i] = x; v[i] = y;</span><br><span class="line">        <span class="built_in">add</span>(z, i);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">0</span>, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>; <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= W; i++) ans = <span class="built_in">max</span>(ans, dp[<span class="number">0</span>][i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çŠ¶æ€æ•°ç»„$dp[i][j]$è¡¨ç¤º<strong>ä¸å…è®¸é€‰å–iæœ¬èº«</strong>çš„æœ€å¤§ä»·å€¼ï¼Œæ‰€ä»¥åœ¨å¯¹içš„å„¿å­éå†æ—¶ï¼Œå…¶å®æ˜¯å°†æ‰€æœ‰å„¿å­çš„æƒ…å†µæ›´æ–°åˆ°dp[i]ä¸­ã€‚æ¯æ¬¡å°†dp[i]çš„çŠ¶æ€ä¼ é€’ç»™å„¿å­ï¼Œå„¿å­é€’å½’çš„æ›´æ–°å®Œåå†æ›´æ–°å›dp[i]</p><p>å¦‚æœé‡‡å–è¿™æ ·çš„æ–¹æ³•ï¼Œ<strong>å¿…é¡»ä½¿ç”¨è¶…çº§æºç‚¹</strong>ï¼</p><p>æ—¶é—´å¤æ‚åº¦$O(N*M)$</p><h4 id="dfnåºä¸Šæ›´æ–°èƒŒåŒ…"><a href="#dfnåºä¸Šæ›´æ–°èƒŒåŒ…" class="headerlink" title="dfnåºä¸Šæ›´æ–°èƒŒåŒ…"></a>dfnåºä¸Šæ›´æ–°èƒŒåŒ…</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line">       </span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unordered_set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;random&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;chrono&gt;</span></span></span><br><span class="line">      </span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cassert&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> manx maxn</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> whlie while</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> itn int</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fro for</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> asn ans</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> scnaf scanf</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sacnf scanf</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pritnf printf</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> haed head</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> tmep temp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> udpate update</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> cosnt const</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Fastin freopen(<span class="meta-string">&quot;/home/rqdmap/Desktop/codes/in&quot;</span>, <span class="meta-string">&quot;r&quot;</span>, stdin)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Fastout freopen(<span class="meta-string">&quot;/home/rqdmap/Desktop/codes/main.out&quot;</span>, <span class="meta-string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lowbit(x) ((x) &amp; (-x))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> clr(a, x) memset((a), x, sizeof (a))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TTT int __; scanf(<span class="meta-string">&quot;%d&quot;</span>, &amp;__); for(int _ = 1; _ &lt;= __; _++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DEBUG printf(<span class="meta-string">&quot;DEBUG LINE: %d\n&quot;</span>, __LINE__)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NL puts(<span class="meta-string">&quot;&quot;</span>)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/*------------------------------------------------------------------------------------*/</span></span><br><span class="line"><span class="keyword">clock_t</span> startTime;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">getCurrentTime</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> (<span class="keyword">double</span>)(<span class="built_in">clock</span>() - startTime) / CLOCKS_PER_SEC;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">prt</span><span class="params">(T *a, <span class="keyword">int</span> n, <span class="keyword">bool</span> withid = <span class="number">0</span>)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!withid) <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) cout &lt;&lt; a[i] &lt;&lt; ((i == n - <span class="number">1</span>)? <span class="string">&#x27;\n&#x27;</span>:<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) cout &lt;&lt; i &lt;&lt; <span class="string">&quot;: &quot;</span> &lt;&lt; a[i] &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function">T <span class="title">ceil</span><span class="params">(T a, T b)</span></span>&#123;<span class="keyword">return</span> (a + b - <span class="number">1</span>) / b;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function">T <span class="title">gcd</span><span class="params">(T x, T y)</span></span>&#123;<span class="keyword">return</span> !x? y: <span class="built_in">gcd</span>(y % x, x);&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exgcd</span><span class="params">(T a, T b, T &amp;x, T &amp;y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!b)&#123;x = <span class="number">1</span>; y = <span class="number">0</span>;<span class="keyword">return</span>;&#125;</span><br><span class="line">    <span class="built_in">exgcd</span>(b, a % b, y, x); y -= a / b * x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">qp</span><span class="params">(ll a, ll p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(p &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    ll ans = <span class="number">1</span>; <span class="keyword">while</span>(p)&#123;<span class="keyword">if</span>(p &amp; <span class="number">1</span>) ans = ans * a ; a = a * a; p &gt;&gt;= <span class="number">1</span>;&#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">qp</span><span class="params">(ll a, ll p, ll M)</span></span>&#123;</span><br><span class="line">    ll ans = <span class="number">1</span>; <span class="keyword">while</span>(p)&#123; <span class="keyword">if</span>(p &amp; <span class="number">1</span>) ans = ans * a % M; a = a * a % M; p &gt;&gt;= <span class="number">1</span>;&#125;</span><br><span class="line">    <span class="keyword">return</span> (ans % M + M) % M;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">euler</span><span class="params">(<span class="keyword">int</span> *prime, <span class="keyword">int</span> *vis, <span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> top = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++) vis[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!vis[i]) prime[top++] = i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; top &amp;&amp; i * prime[j] &lt;= n; j++)&#123;</span><br><span class="line">            vis[i * prime[j]] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i % prime[j] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> top;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">star</span>&#123;</span><span class="keyword">int</span> to, next, w;&#125;; </span><br><span class="line"><span class="comment">/*------------------------------------------------------------------------------------*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">2e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxe = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> K =  <span class="number">2e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, W;</span><br><span class="line"><span class="keyword">int</span> head[maxn], top = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> w[maxn];</span><br><span class="line">star edge[maxe &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    edge[top].to = v;</span><br><span class="line">    edge[top].next = head[u];</span><br><span class="line">    head[u] = top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> mx[maxn], root, vis[maxn], S, sze[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getroot</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> par)</span></span>&#123;</span><br><span class="line">    sze[now] = <span class="number">1</span>; mx[now] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[now]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(vis[to] || to == par) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">getroot</span>(to, now);</span><br><span class="line">        sze[now] += sze[to];</span><br><span class="line">        mx[now] = <span class="built_in">max</span>(mx[now], sze[to]);</span><br><span class="line">    &#125;</span><br><span class="line">    mx[now] = <span class="built_in">max</span>(mx[now], S - mx[now]);</span><br><span class="line">    <span class="keyword">if</span>(mx[now] &lt; mx[root]) root = now;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> dfn[maxn], cnt = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> par)</span></span>&#123;</span><br><span class="line">    dfn[cnt++] = now; sze[now] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = haed[now]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(vis[to] || par == to) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(to, now);</span><br><span class="line">        sze[now] += sze[to];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">ll ans = <span class="number">0</span>;</span><br><span class="line">ll dp[maxn][K];</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; vec;</span><br><span class="line"><span class="keyword">int</span> mp[K * K];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fun</span><span class="params">(<span class="keyword">int</span> now)</span></span>&#123;</span><br><span class="line">    cnt = <span class="number">0</span>; <span class="built_in">dfs</span>(now, <span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= cnt; i++) <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; vec.<span class="built_in">size</span>(); j++) dp[i][j] = <span class="number">0</span>;</span><br><span class="line">    dp[cnt][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = cnt - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">        <span class="keyword">int</span> u = dfn[i];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; vec.<span class="built_in">size</span>(); j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(vec[j] / w[u])&#123;</span><br><span class="line">                <span class="keyword">int</span> pos = mp[vec[j] / w[u]];</span><br><span class="line">                <span class="comment">//ä»å½“å‰å­æ ‘ä¸­æ›´æ–°èƒŒåŒ…çš„è®¡æ•°</span></span><br><span class="line">                dp[i][pos] += dp[i + <span class="number">1</span>][j];</span><br><span class="line">                dp[i][pos] %= M;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//ç»§æ‰¿å³å…„å¼Ÿçš„è®¡æ•°æ–¹æ¡ˆï¼Œä¸ºéšåä¼ é€’ç»™çˆ¶äº²ä¸æ–­ç§¯ç´¯</span></span><br><span class="line">            dp[i][j] += dp[i + sze[u]][j];</span><br><span class="line">            dp[i][j] %= M;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (itn)vec.<span class="built_in">size</span>(); i++) ans = (ans + dp[<span class="number">0</span>][i]) % M;</span><br><span class="line">    ans = (ans + M - <span class="number">1</span>) % M;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sove</span><span class="params">(<span class="keyword">int</span> now)</span></span>&#123;</span><br><span class="line">    vis[now] = <span class="number">1</span>; </span><br><span class="line">    <span class="built_in">fun</span>(now);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[now]; ~i; i = edge[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> to = edge[i].to; <span class="keyword">if</span>(vis[to]) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        S = sze[to]; root = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">getroot</span>(to, now);</span><br><span class="line">        <span class="built_in">sove</span>(root);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// Fastin; </span></span><br><span class="line">    TTT&#123;</span><br><span class="line">        ans = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">clr</span>(head, <span class="number">-1</span>); top = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;W);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scnaf</span>(<span class="string">&quot;%d&quot;</span>, w + i);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> u, v; scanfclrv, u);</span><br><span class="line">        &#125;</span><br><span class="line">        vec.<span class="built_in">clear</span>(); <span class="built_in">clr</span>(mp, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= W; i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> res = W / i; </span><br><span class="line">            <span class="keyword">if</span>(vec.<span class="built_in">empty</span>() || *vec.<span class="built_in">rbegin</span>() != res) vec.<span class="built_in">push_back</span>(res);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; vec.<span class="built_in">size</span>(); i++) mp[vec[i]] = i;</span><br><span class="line"></span><br><span class="line">        root = <span class="number">0</span>;</span><br><span class="line">        S = mx[<span class="number">0</span>] = n;</span><br><span class="line">        <span class="built_in">clr</span>(vis, <span class="number">0</span>); <span class="built_in">clr</span>(dp, <span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">getroot</span>(<span class="number">1</span>, <span class="number">0</span>); <span class="built_in">sove</span>(root);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç»™å‡ºä¸€é¢—ä¾èµ–æ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½è¡¨ç¤ºä¸€ä¸ªæœ‰è‹¥å¹²é‡é‡çš„ç‰©å“ã€‚</p><p>ä¸€ä¸ªè¿é€šå—çš„æ€»é‡é‡å®šä¹‰ä¸ºè¿é€šå—å†…æ‰€æœ‰èŠ‚ç‚¹çš„é‡é‡ç§¯ã€‚</p><p>é—®æ€»é‡é‡ä¸è¶…è¿‡$W$çš„è¿é€šå—ä¸ªæ•°ã€‚</p><p>è¿™æ˜¯ä¸€é“ç»¼åˆçš„ä¾‹é¢˜ï¼š<strong>ç‚¹åˆ†æ²»</strong>ååœ¨æ¯ä¸ªè¿é€šå—ä¸­çš„<strong>dfnåºåˆ—</strong>ä¸Šè¿›è¡Œ<strong>èƒŒåŒ…æ›´æ–°</strong>ï¼Œæ›´æ–°æ—¶ä¸éå†æ‰€æœ‰å¯èƒ½çš„é‡é‡ï¼Œè€Œæ˜¯éå†<strong>ä¹˜ç§¯å‹ç¼©</strong>åçš„çŠ¶æ€ã€‚</p><p>ä¸ºäº†å­¦ä¹ dfnåºæ›´æ–°èƒŒåŒ…çš„çŸ¥è¯†ï¼Œç€é‡ç ”ç©¶<code>fun</code>æ•°ç»„å³å¯ã€‚</p><p>$dp[i][j]$ç”±<strong>ä¸¤éƒ¨åˆ†</strong>æ„æˆï¼Œä¸€éƒ¨åˆ†æ˜¯dfn[i]èŠ‚ç‚¹æœ¬èº«å­æ ‘æ„æˆçš„æ€»é‡é‡wæ»¡è¶³$\frac W w=j$çš„è®¡æ•°æ–¹æ¡ˆï¼Œå¦ä¸€éƒ¨åˆ†é€’å½’åœ°ç»§æ‰¿dfsæ ‘ä¸Šiçš„<strong>å³å…„å¼Ÿ</strong>çš„è‹¥å¹²ä¿¡æ¯ã€‚</p><p>å› è€Œé™¤äº†æ ¹èŠ‚ç‚¹çš„dpæ•°ç»„ä¸ºå…¶çœŸå®æƒ…å†µä»¥å¤–ï¼Œå…¶ä½™èŠ‚ç‚¹çš„dpæ•°ç»„å‡æœ‰ä¸€äº›ç»§æ‰¿å³å…„å¼Ÿè€Œæ¥çš„è®¡æ•°æ–¹æ¡ˆï¼Œè¿™äº›æ–¹æ¡ˆåœ¨æœ€ç»ˆè¿™ä¸€ä¸²å…„å¼Ÿä»¬å›å½’åˆ°çˆ¶äº²åç»Ÿä¸€è¿›è¡Œè´¡çŒ®ã€‚</p><h2 id="10-æŠ€æœ¯"><a href="#10-æŠ€æœ¯" class="headerlink" title="10 æŠ€æœ¯"></a>10 æŠ€æœ¯</h2><h3 id="1-å¿«è¯»"><a href="#1-å¿«è¯»" class="headerlink" title="1 å¿«è¯»"></a>1 å¿«è¯»</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> <span class="keyword">_t</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(<span class="keyword">_t</span> &amp;x)</span></span>&#123;</span><br><span class="line">    x = <span class="number">0</span>; <span class="keyword">_t</span> fu = <span class="number">1</span>; <span class="keyword">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span>(ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>)&#123;<span class="keyword">if</span>(ch == <span class="string">&#x27;-&#x27;</span>) fu = - <span class="number">1</span>; ch = <span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">while</span>(ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>)&#123;</span><br><span class="line">        x = (x &lt;&lt; <span class="number">3</span>) + (x &lt;&lt; <span class="number">1</span>) + (ch &amp; <span class="number">15</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    x *= fu ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-å¯¹æ‹-linux"><a href="#2-å¯¹æ‹-linux" class="headerlink" title="2 å¯¹æ‹(linux)"></a>2 å¯¹æ‹(linux)</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e3</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">string s;</span><br><span class="line"><span class="keyword">char</span> str[][<span class="number">100</span>] = &#123;<span class="string">&quot;&quot;</span>, <span class="string">&quot;main.cpp&quot;</span>, <span class="string">&quot;std.cpp&quot;</span>, <span class="string">&quot;data.cpp&quot;</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> * argv[])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(argc != <span class="number">4</span> &amp;&amp; argc != <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Input $main $std $data!\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(argc == <span class="number">4</span>)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">3</span>; i++) <span class="built_in">strcpy</span>(str[i], argv[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    s = (string)&#123;<span class="string">&quot;g++ &quot;</span>&#125; + str[<span class="number">1</span>] + <span class="string">&quot; -o main&quot;</span>;</span><br><span class="line">    <span class="built_in">system</span>(s.<span class="built_in">c_str</span>());</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;åŸå§‹ç¨‹åºç¼–è¯‘å®Œæˆ.&quot;</span>);</span><br><span class="line"></span><br><span class="line">    s = (string)&#123;<span class="string">&quot;g++ &quot;</span>&#125; + str[<span class="number">2</span>] + <span class="string">&quot; -o std&quot;</span>;</span><br><span class="line">    <span class="built_in">system</span>(s.<span class="built_in">c_str</span>());</span><br><span class="line"></span><br><span class="line">    s = (string)&#123;<span class="string">&quot;g++ &quot;</span>&#125; + str[<span class="number">3</span>] + <span class="string">&quot; -o data&quot;</span>;</span><br><span class="line">    <span class="built_in">system</span>(s.<span class="built_in">c_str</span>());</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;æ•°æ®ç”Ÿæˆå™¨ç¼–è¯‘å®Œæˆ&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="built_in">system</span>(<span class="string">&quot;./data &gt; in&quot;</span>);</span><br><span class="line">        <span class="built_in">system</span>(<span class="string">&quot;./main &lt; in &gt; main.out&quot;</span>);</span><br><span class="line">        <span class="built_in">system</span>(<span class="string">&quot;./std &lt; in &gt; std.out&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">system</span>(<span class="string">&quot;diff main.out std.out&quot;</span>))&#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;Differences occur!&quot;</span>);</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;--------------Input data:--------------&quot;</span>);</span><br><span class="line">            <span class="built_in">system</span>(<span class="string">&quot;cat in&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;No.%d&#x27;s OK.\n&quot;</span>, cnt++);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Template </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ©ç”¨å¯æŒä¹…åŒ–01Trieè§£å†³åŒºé—´å¼‚æˆ–ä¸€ç±»é—®é¢˜</title>
      <link href="/2020/06/16/%E5%88%A9%E7%94%A8%E5%8F%AF%E6%8C%81%E4%B9%85%E5%8C%9601Trie%E8%A7%A3%E5%86%B3%E5%8C%BA%E9%97%B4%E5%BC%82%E6%88%96%E4%B8%80%E7%B1%BB%E9%97%AE%E9%A2%98/"/>
      <url>/2020/06/16/%E5%88%A9%E7%94%A8%E5%8F%AF%E6%8C%81%E4%B9%85%E5%8C%9601Trie%E8%A7%A3%E5%86%B3%E5%8C%BA%E9%97%B4%E5%BC%82%E6%88%96%E4%B8%80%E7%B1%BB%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<p>ä¸ºäº†è¡¥æ ¡èµ›ç½‘ç»œçš„Ié¢˜ï¼Œå°±å»çœ‹äº†å¼‚æˆ–ç²½å­ï¼Œç„¶åå°±çœ‹åˆ°äº†Trieä»¥åŠå¯æŒä¹…åŒ–01Trieï¼Œè¿›è€Œå°±æœ‰äº†è¿™ç¯‡åšå®¢qaq</p><p>å€ŸåŠ©è¿™å‡ é“é¢˜å­¦ä¹ ä¸€ç•ªå¯æŒä¹…åŒ–01Trieçš„æœ‰å…³çŸ¥è¯†</p><p>[toc]</p><span id="more"></span><p>å‚è€ƒåšå®¢ï¼š<strong><a href="https://blog.csdn.net/qq_42447015/article/details/97812659">å¯æŒä¹…åŒ–01Trie + å¼‚æˆ–ç²½å­ ï¼ˆç²¾å¿ƒ)</a></strong></p><hr><h3 id="P4735-æœ€å¤§å¼‚æˆ–å’Œ"><a href="#P4735-æœ€å¤§å¼‚æˆ–å’Œ" class="headerlink" title="P4735 æœ€å¤§å¼‚æˆ–å’Œ"></a><strong><a href="https://www.luogu.com.cn/problem/P4735">P4735 æœ€å¤§å¼‚æˆ–å’Œ</a></strong></h3><p>é¢˜ç›®è¦æ±‚åŒºé—´ä¸­æŸä¸ªä½ç½®<code>pâˆˆ[L, R]</code>ä½¿å¾—<code>a[p] ^ a[p + 1]^ ... ^ a[n] ^ x</code>æœ€å¤§ï¼Œå…¶ä¸­<code>p, L, R</code>ç»™å®šï¼Œå…è®¸åœ¨è¯¥åºåˆ—æœ«å°¾åŠ¨æ€æ·»åŠ æ•°å­—ã€‚é¦–å…ˆæ ¹æ®å¼‚æˆ–çš„æ€§è´¨ç­‰ä»·è½¬åŒ–è¦æ±‚çš„è¡¨è¾¾å¼ï¼š<code>`a[p] ^ a[p + 1]^ ... ^ a[n] ^ x = x ^ sum ^ a[1] ^ a[2] ^ ... ^ a[p - 1]</code>ï¼Œå…¶ä¸­sumæ˜¯æ•´ä¸ªåºåˆ—çš„å¼‚æˆ–å€¼ï¼›å› è€Œåœ¨æŸä¸ªç»™å®šçš„çŠ¶æ€ä¸‹ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰¾ä½ç½®p-1ä½¿å¾—å…¶å‰ç¼€å¼‚æˆ–å€¼å’Œx^sumå¼‚æˆ–å€¼æœ€å¤§å³å¯ã€‚ä¸ºäº†å®ŒæˆåŠ¨æ€ä¿®æ”¹ã€æŸ¥è¯¢çš„å·¥ä½œï¼Œæˆ‘ä»¬ä½¿ç”¨å¯æŒä¹…åŒ–01Trieï¼Œå…¶æ€æƒ³ä¸ä¸»å¸­æ ‘ç±»ä¼¼ï¼ˆ<del>å°½ç®¡æˆ‘è¿˜æ²¡å­¦ä½†æ˜¯ä¸å¦¨ç¢æˆ‘å­¦ä¼š01Trie</del>)ã€‚</p><p>å¯æŒä¹…åŒ–01Trieçš„æ ¸å¿ƒæ€æƒ³åœ¨äºï¼šåœ¨æ’å…¥ä¸€ä¸ªæ–°æ•°çš„æ—¶å€™ç”¨è¯¥æ•°æœ¬èº«æ‹¥æœ‰çš„å€¼æ–°å»ºèŠ‚ç‚¹ï¼Œå¯¹äºæœ¬èº«ä¸æ‹¥æœ‰çš„å€¼åˆ™ç»§æ‰¿ä¸Šä¸€é¢—æ ‘çš„æƒ…å†µï¼Œå³L11ã€L12æ‰€ç¤ºã€‚</p><p>è€Œåœ¨æœ¬é¢˜ä¸­å› ä¸ºè¦æŸ¥æ‰¾ä¸€æ®µåŒºé—´æœ€ä¼˜çš„ä¸€ä¸ªå¼‚æˆ–å€¼ï¼Œæ‰€ä»¥ä¸ºäº†æ–¹ä¾¿æŸ¥æ‰¾é¢å¤–è®¾ç½®sizeæ•°ç»„è®°å½•å½“å‰èŠ‚ç‚¹æ‹¥æœ‰å­—ç¬¦ä¸²çš„ä¸ªæ•°ã€‚å¦‚æœåŒä¸€ä¸ªèŠ‚ç‚¹åœ¨ä¸¤ä¸ªä¸åŒç‰ˆæœ¬ä¹‹é—´çš„sizeå€¼ä¸åŒï¼Œé‚£ä¹ˆè¯´æ˜è¿™æ®µç‰ˆæœ¬ä¹‹é—´ä¸€å®šæ‹¥æœ‰ä¸€ä¸ªå«æœ‰è¿™ä¸ªå€¼çš„ä¸²ï¼Œæ‰€ä»¥åº”è¯¥å°†æŒ‡é’ˆæ²¿ç€è¿™ä¸ªæ–¹å‘å‰è¿›ã€‚å› ä¸ºæœ¬é¢˜è¦æ±‚å¼‚æˆ–å€¼æœ€å¤§ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰¾æ–¹å‘è¾¹æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨çš„è¯æ¯«æ— ç–‘é—®åº”è¯¥ä»åå‘è¾¹å¾€åæŸ¥æ‰¾ï¼Œè¿™ä¹Ÿå°±æ˜¯queryå‡½æ•°æ‰€å®Œæˆçš„å·¥ä½œã€‚</p><p>æ­¤å¤–ï¼Œå› ä¸ºæˆ‘ä»¬åˆ†æå‡ºæ¥å¦‚æœç»™å®šåŒºé—´<code>[L, R]</code>ï¼Œé‚£ä¹ˆæœ€ç»ˆæˆ‘ä»¬è¦æ‰¾çš„å‰ç¼€å’Œåº”è¯¥åœ¨<code>[L - 1, R - 1]</code>ä¹‹ä¸­ï¼Œç”¨Trieçš„ç‰ˆæœ¬å·è¡¨ç¤ºå°±æ„å‘³æ‰¾<code>R-1</code>å’Œ<code>L - 2</code>çš„å·®å€¼ã€‚ä¸ºäº†é˜²æ­¢æº¢å‡ºç­‰éº»çƒ¦çš„é—®é¢˜ï¼Œæˆ‘ä»¬æ·»åŠ å†—ä½™é¡¹<code>0</code>ï¼Œè¿™æ ·åŸåºåˆ—æ•´ä½“ä¸‹æ ‡åç§»1ä½ï¼Œæ‰€ä»¥å°±å˜æˆäº†æŸ¥æ‰¾<code>R</code>ä¸<code>L - 1</code>çš„å·®å€¼ã€‚</p><p>æœ€åï¼Œå› ä¸ºåˆå§‹ç»™å®š3e5çš„åŸå§‹åºåˆ—å’Œ<strong>æ“ä½œ</strong>ï¼Œæ‰€ä»¥æœ€ç»ˆä¸²çš„é•¿åº¦æœ‰å¯èƒ½æˆä¸º<strong>6e5</strong>ï¼åˆå› ä¸ºå¯æŒä¹…åŒ–Trieå­˜äº†æ¯ä¸ªç‰ˆæœ¬çš„ä¿¡æ¯ï¼Œæ‰€ä»¥æ¯å¤šä¸€ä¸ªç‰ˆæœ¬ï¼Œå°±ä¼šå†èŠ±è´¹Nä¸ªèŠ‚ç‚¹ï¼ŒNæ˜¯è¡¨è¾¾ä¸€ä¸ªæ•°æœ€å¤šéœ€è¦çš„ä½æ•°ï¼Œæ•…æ€»å¤æ‚åº¦åº”è¯¥è®¾ç½®ä¸º<strong>6e5 * N</strong>ã€‚<del>ä¸ç„¶RE</del></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">24</span>;</span><br><span class="line"><span class="keyword">const</span> itn maxn = <span class="number">6e5</span> * N + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">TRIE</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> version = <span class="number">0</span>, top = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> ch[maxn][<span class="number">2</span>], root[maxn];;</span><br><span class="line">    <span class="keyword">int</span> size[maxn];</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> rot = root[version];</span><br><span class="line">        root[++version] = ++top;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">            <span class="keyword">int</span> id = (x &gt;&gt; i) &amp; <span class="number">1</span>;</span><br><span class="line">            ch[top][id] = top + <span class="number">1</span>;<span class="comment">//æ–°å»º</span></span><br><span class="line">            ch[top][!id] = ch[rot][!id];<span class="comment">//ç»§æ‰¿</span></span><br><span class="line">            size[top] = size[rot] + <span class="number">1</span>;</span><br><span class="line">            top++; rot = ch[rot][id];</span><br><span class="line">        &#125;</span><br><span class="line">        size[top] = size[rot] + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> L, <span class="keyword">int</span> R, itn x)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> l = root[L], r = root[R];</span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">            <span class="keyword">int</span> id = (x &gt;&gt; i) &amp; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(size[ch[r][!id]] - size[ch[l][!id]] &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                ans |= <span class="number">1</span> &lt;&lt; i;</span><br><span class="line">                r = ch[r][!id]; l = ch[l][!id];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                r = ch[r][id];</span><br><span class="line">                l = ch[l][id];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">TRIE tree;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="keyword">int</span> n, m; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    tree.<span class="built_in">insert</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> x; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x); sum ^= x;</span><br><span class="line">        tree.<span class="built_in">insert</span>(sum);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> l, r, x;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123;</span><br><span class="line">        <span class="keyword">char</span> op[<span class="number">2</span>];</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, op);</span><br><span class="line">        <span class="keyword">if</span>(op[<span class="number">0</span>] == <span class="string">&#x27;A&#x27;</span>)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x); sum ^= x;</span><br><span class="line">            tree.<span class="built_in">insert</span>(sum);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;l, &amp;r, &amp;x);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, tree.<span class="built_in">query</span>(l - <span class="number">1</span>, r, x ^ sum));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="P5283-åäºŒçœè”è€ƒ2019-å¼‚æˆ–ç²½å­"><a href="#P5283-åäºŒçœè”è€ƒ2019-å¼‚æˆ–ç²½å­" class="headerlink" title="P5283 [åäºŒçœè”è€ƒ2019]å¼‚æˆ–ç²½å­"></a><strong>P5283 [åäºŒçœè”è€ƒ2019]å¼‚æˆ–ç²½å­</strong></h3><h4 id="å‰ç½®çŸ¥è¯†ç‚¹ï¼šP1631-åºåˆ—åˆå¹¶"><a href="#å‰ç½®çŸ¥è¯†ç‚¹ï¼šP1631-åºåˆ—åˆå¹¶" class="headerlink" title="å‰ç½®çŸ¥è¯†ç‚¹ï¼šP1631 åºåˆ—åˆå¹¶"></a>å‰ç½®çŸ¥è¯†ç‚¹ï¼šP1631 åºåˆ—åˆå¹¶</h4><p>ç®€è€Œè¨€ä¹‹ï¼Œç”¨å †$O(logn)$ç»´æŠ¤nä¸ªæœ‰åºé˜Ÿåˆ—å„è‡ªçš„æœ€å¤§å€¼ï¼Œå°†$n ^2$çš„æ¯”è¾ƒå˜æˆäº†$n$çš„æ¯”è¾ƒï¼Œå€¼å¾—å­¦ä¹ çš„æ‰‹æ³•ï¼</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> a[maxn], b[maxn];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NODE</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> i, j, sum;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> NODE &amp;b)<span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sum &gt; b.sum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">priority_queue&lt;NODE&gt; pq;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="keyword">int</span> n; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a + i);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, b + i);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) pq.<span class="built_in">push</span>(&#123;i, <span class="number">0</span>, a[i] + b[<span class="number">0</span>]&#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> times = n;</span><br><span class="line">    <span class="keyword">while</span>(times--)&#123;</span><br><span class="line">        NODE temp = pq.<span class="built_in">top</span>(); pq.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, temp.sum); <span class="keyword">if</span>(times) <span class="built_in">printf</span>(<span class="string">&quot; &quot;</span>); <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">int</span> i = temp.i, j = temp.j + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(j &gt;= n) <span class="keyword">continue</span>;</span><br><span class="line">        pq.<span class="built_in">push</span>(&#123;i, j, a[i] + b[j]&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="å¼‚æˆ–ç²½å­"><a href="#å¼‚æˆ–ç²½å­" class="headerlink" title="å¼‚æˆ–ç²½å­"></a>å¼‚æˆ–ç²½å­</h4><p>ç»™å‡º$n &lt;= 5e5$çš„åºåˆ—ï¼Œé—®æ‰€æœ‰åŒºé—´å¼‚æˆ–å€¼ä¸­å‰$k &lt;= 2e5$å¤§ä¹‹å’Œã€‚</p><p>é¦–å…ˆåšå¼‚æˆ–å‰ç¼€ï¼Œè¿™æ ·å°±å¯ä»¥ç”¨ä¸¤ç‚¹è¡¨ç¤ºä¸€æ®µåŒºé—´ï¼Œæ¥ä¸‹é‡Œå°†è¿™äº›å‰ç¼€æ’å…¥åˆ°å¯æŒä¹…åŒ–01Trieä¸­ã€‚ä¸‹é¢è€ƒè™‘å¦‚ä½•æŸ¥æ‰¾å‰kå¤§çš„æ¯ä¸€ä¸ªæ•°ï¼Œä¸»è¦æ€æƒ³ä¸P1631åºåˆ—åˆå¹¶ç±»ä¼¼ï¼šæˆ‘ä»¬æšä¸¾å³ç«¯ç‚¹<code>j</code>ï¼Œå¯¹æ¯ä¸€ä¸ªå³ç«¯ç‚¹æ‰€æ‹¥æœ‰çš„ä¸€ä¸²æœ‰åºåºåˆ—ä»å¤§åˆ°å°ä¸€ä¸ªä¸ªæ’å…¥åˆ°å †ä¸­ã€‚é‚£ä¹ˆå¦‚ä½•ç»´æŠ¤è¿™ä¸ªæœ‰åºé˜Ÿåˆ—å‘¢ï¼Ÿæˆ‘ä»¬è®¾ç½®ç»“æ„<code>[i, j, l, r, sum]</code>è¡¨ç¤ºå³ç«¯ç‚¹åœ¨<code>j</code>ï¼Œåœ¨åŒºé—´<code>[l, r]</code>ä¸­æ‰¾åˆ°çš„æœ€ä¼˜å·¦ç«¯ç‚¹æ˜¯<code>i</code>ï¼Œå…¶å¼‚æˆ–å€¼æ˜¯<code>sum</code>ã€‚é‚£ä¹ˆå½“æˆ‘ä»¬ä»å †ä¸­æ‹¿å‡ºä¸€ä¸ªèŠ‚ç‚¹åï¼Œä¸‹ä¸€ä¸ªå°±åº”è¯¥ä»å³ç«¯ç‚¹åœ¨<code>j</code>ï¼Œå·¦ç«¯ç‚¹å¤„äºåŒºé—´<code>[l, i - 1]</code>å’ŒåŒºé—´<code>[i + 1, r]</code>ä¸­æ‰¾æ›´å¤§çš„ç»“æœå¹¶æ”¾å…¥å †ä¸­ã€‚<del>æˆ‘è‡ªå·±å†™çš„æ—¶å€™æ²¡æœ‰åˆ¤æ–­å“ªä¸€è¾¹æ›´å¤§è€Œæ˜¯ä¸¤è¾¹éƒ½æ”¾è¿›å»äº† å› ä¸ºä¸æƒ³åˆ¤æ–­å·¦æé™å³æé™çš„æƒ…å†µ ä»…ä»…å¤šä¸€ä¸ªlog2çš„å¤æ‚åº¦é—®é¢˜ä¸å¤§</del></p><p>ä¸è¿‡è¿™é‡Œé¢æœ‰ä¸€äº›åœ°æ–¹å¾ˆç»•â€¦æˆ‘æƒ³äº†å¾ˆä¹…æ‰åŸºæœ¬ç†æ¸…æ¥šã€‚<del>qaq</del></p><p>å¦‚æœåˆå§‹åºåˆ—ä»1å¼€å§‹ç¼–å·ï¼Œé‚£ä¹ˆå¦‚æœå½“å‰å³ç«¯ç‚¹ç¡®å®šä¸º<code>i</code>ï¼Œå·¦ç«¯ç‚¹å¯é€‰åŒºé—´å°±åœ¨<code>[1, i]</code>ï¼Œåœ¨å‰ç¼€çš„è¡¨è¾¾ä¸­å°±æ˜¯å¼‚æˆ–ä¸Š<code>[0, i - 1]</code>ï¼Œæ‰€ä»¥åœ¨Trieä¸­çš„æŸ¥æ‰¾å°±æ˜¯ç‰ˆæœ¬<code>i - 1</code>å‡å»ç‰ˆæœ¬<code>0 - 1</code>ä¹‹é—´çš„æƒ…å†µã€‚è¿™æ ·ä¼šå‡ºç°-1è¿™ç§ä¸å¤ªå¦™çš„ä¸œè¥¿ï¼Œæ‰€ä»¥æˆ‘ä»¬æ·»åŠ å†—ä½™é¡¹0ï¼Œé‚£ä¹ˆå°±åªéœ€è¦åœ¨ç‰ˆæœ¬<code>i</code>å’Œç‰ˆæœ¬<code>0</code>ä¹‹é—´æ±‚å·®å€¼ã€‚</p><p>æœ€åæœ‰ä¸€ä¸ªå…³äºå¯æŒä¹…åŒ–Trieç›¸å…³çš„æ•°æ®èŒƒå›´çš„é—®é¢˜ã€‚ã€‚å‘</p><p><strong>å› ä¸ºè¦å­˜ç‰ˆæœ¬ï¼Œæ‰€ä»¥ä¼šå¤šå¼€maxnä¸ªèŠ‚ç‚¹ï¼</strong></p><p>ç„¶è€Œè¿™ä¸æ„å‘³ç€è¦æŠŠNå¼€å¤§ï¼Œå› ä¸ºNå¼€å¤§æ’å…¥çš„æ¯ä¸€ä¸ªæ•°å ç”¨çš„èŠ‚ç‚¹ä¹Ÿä¼šå¯¹åº”å˜å¤§ï¼</p><p>æ‰€ä»¥åº”è¯¥åœ¨maxnä¸­æ·»åŠ ä¸€äº›å†—ä½™çš„ä½ç½®ï¼Œä¸ä¿®æ”¹Nçš„æœ€å¤§å€¼ï¼</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">33</span>;</span><br><span class="line"><span class="keyword">const</span> itn maxn = <span class="number">5e5</span> * (N + <span class="number">5</span>) + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">TRIE</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> version = <span class="number">0</span>, top = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> ch[maxn][<span class="number">2</span>], root[maxn];;</span><br><span class="line">    <span class="keyword">int</span> size[maxn], id[maxn];</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(ll x, <span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> rot = root[version];</span><br><span class="line">        root[++version] = ++top;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">            <span class="keyword">int</span> id = (x &gt;&gt; i) &amp; <span class="number">1</span>;</span><br><span class="line">            ch[top][id] = top + <span class="number">1</span>;</span><br><span class="line">            ch[top][!id] = ch[rot][!id];</span><br><span class="line">            size[top] = size[rot] + <span class="number">1</span>;</span><br><span class="line">            top++; rot = ch[rot][id];</span><br><span class="line">        &#125;</span><br><span class="line">        size[top] = size[rot] + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">this</span>-&gt;id[top] = id;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> L, <span class="keyword">int</span> R, ll x, <span class="keyword">int</span> &amp;k, ll &amp;sum)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> l = root[L], r = root[R];</span><br><span class="line">        sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">            <span class="keyword">int</span> id = (x &gt;&gt; i) &amp; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(size[ch[r][!id]] - size[ch[l][!id]] &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                sum |= <span class="number">1ll</span> &lt;&lt; i;</span><br><span class="line">                r = ch[r][!id]; l = ch[l][!id];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                l = ch[l][id];</span><br><span class="line">                r = ch[r][id];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        k = <span class="keyword">this</span>-&gt;id[r];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">TRIE tree;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å³ç«¯ç‚¹jç»™å®šï¼Œæ¯æ¬¡æ‰¾iï¼›å½“å‰åŒºé—´ä¸º[l, r]</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NODE</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> i, j, l, r;</span><br><span class="line">    ll sum;</span><br><span class="line">    <span class="built_in">NODE</span>(<span class="keyword">int</span> _i, <span class="keyword">int</span>  _j, <span class="keyword">int</span> _l ,itn _r, ll _sum)&#123;</span><br><span class="line">        i = _i; j = _j; l = _l; r = _r; sum = _sum;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> NODE &amp;b)<span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sum &lt; b.sum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">ll a[<span class="number">500010</span>];</span><br><span class="line">priority_queue&lt;NODE&gt; pq;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    tree.<span class="built_in">insert</span>(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> n, m; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, a + i);</span><br><span class="line">        a[i] ^= a[i - <span class="number">1</span>];</span><br><span class="line">        tree.<span class="built_in">insert</span>(a[i], i);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> k; ll sum;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="comment">//æŸ¥è¯¢[1, i]</span></span><br><span class="line">        tree.<span class="built_in">query</span>(<span class="number">0</span>, i, a[i], k, sum);</span><br><span class="line">        <span class="comment">//[k + 1, i]</span></span><br><span class="line">        pq.<span class="built_in">push</span>(<span class="built_in">NODE</span>(k + <span class="number">1</span>, i, <span class="number">1</span>, i, sum));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(m--)&#123;</span><br><span class="line">        NODE temp = pq.<span class="built_in">top</span>(); pq.<span class="built_in">pop</span>();</span><br><span class="line">        ans += temp.sum;</span><br><span class="line">        <span class="keyword">int</span> i = temp.i, j = temp.j, l = temp.l, r = temp.r;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(i - <span class="number">1</span> &gt;= l)&#123;</span><br><span class="line">            <span class="comment">//åˆ’åˆ†å·¦ç«¯ç‚¹ï¼ŒæŸ¥è¯¢[l, i - 1]ä¸­æœ€åˆé€‚çš„ç«¯ç‚¹ã€‚</span></span><br><span class="line">            tree.<span class="built_in">query</span>(l - <span class="number">1</span>, i - <span class="number">1</span>, a[j], k, sum);</span><br><span class="line">            pq.<span class="built_in">push</span>(<span class="built_in">NODE</span>(k + <span class="number">1</span>, j, l, i - <span class="number">1</span>, sum));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(i + <span class="number">1</span> &lt;= r)&#123;</span><br><span class="line">            tree.<span class="built_in">query</span>(i, r, a[j], k, sum);</span><br><span class="line">            pq.<span class="built_in">push</span>(<span class="built_in">NODE</span>(k + <span class="number">1</span>, j, i + <span class="number">1</span>, r, sum));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="2020æ ¡èµ›ç½‘ç»œèµ›I-ç¬¬kå¤§åŒºé—´"><a href="#2020æ ¡èµ›ç½‘ç»œèµ›I-ç¬¬kå¤§åŒºé—´" class="headerlink" title="2020æ ¡èµ›ç½‘ç»œèµ›I ç¬¬kå¤§åŒºé—´"></a><strong>2020æ ¡èµ›ç½‘ç»œèµ›I ç¬¬kå¤§åŒºé—´</strong></h3><p>xdojå¥½åƒæœ€è¿‘å‡çº§å‡çˆ†äº†äº¤ä¸äº†é¢˜</p><p>ä¸çŸ¥é“è‡ªå·±æ­£ç¡®ä¸å¦å°±åˆé¡ºæ‰‹ç”¨å†™äº†ä¸ªå¯¹æ‹ç¨‹åºã€‚ã€‚åŸæ¥MacOSä¹Ÿæ”¯æŒsystemå‡½æ•°é‚£å°±å¥½å†™äº†ï¼</p><p>ä¹‹å‰å°è¯•è¿‡ç”¨ç®¡é“å®ç°è¿›ç¨‹é€šä¿¡â€¦.ç„¶è€Œå¤±è´¥äº†â€¦.qaq</p><p>åœ¨1000çš„èŒƒå›´å†…å¯¹æ‹ä¸‹æ¥æ²¡æœ‰ä¸ä¸€æ ·çš„ç»“æœï¼Œé‚£ä¹ˆå§‘ä¸”è®¤ä¸ºæ˜¯ACäº†ï¼Œç­‰ä¹‹åOJä¿®å¥½äº†å†åº·åº·ã€‚</p><p>è¿™é“é¢˜ä¸å¼‚æˆ–ç²½å­ä¸åŒçš„åœ°æ–¹åœ¨äºä¸éœ€è¦æŸ¥è¯¢å‰kçš„æ¯ä¸€é¡¹ï¼Œè€Œåªéœ€è¦çŸ¥é“ç¬¬kå¤§ç¡®åˆ‡æ˜¯å¤šå°‘ï¼Œä»è€Œkçš„èŒƒå›´ä¹Ÿå˜å¤§åˆ°äº†$n^2$çš„æ•°é‡çº§ã€‚é‚£ä¹ˆå°±å›åˆ°äº†æ¢¦æœ€å¼€å§‹çš„åœ°æ–¹ï¼ŒäºŒåˆ†ç­”æ¡ˆï¼Œé€šè¿‡æŒä¹…01Trieæ£€æŸ¥æ˜¯å¦æœ‰è¶³å¤Ÿå¤šçš„å¤§äºç­‰äºè¯¥å€¼çš„åŒºé—´ã€‚</p><p>åŒæ ·æ˜¯åŒºé—´æŸ¥è¯¢ï¼Œæ‰€ä»¥å…ˆåšå‰ç¼€å¼‚æˆ–å’Œï¼Œå°†åŒºé—´æŸ¥è¯¢è½¬æ¢ä¸ºç‚¹å¯¹æŸ¥è¯¢ã€‚ç„¶åæšä¸¾å³ç«¯ç‚¹$j$ï¼Œçœ‹å…¶å¯¹åº”çš„å·¦ç«¯ç‚¹æœ‰å“ªäº›æ»¡è¶³å¼‚æˆ–ä¸Š$a[j]$åæ¯”äºŒåˆ†çš„ç­”æ¡ˆæ›´å¤§ã€‚å› è€Œæˆ‘ä»¬åœ¨Trieä¸­ç»´æŠ¤sizeè¡¨ç¤ºèŠ‚ç‚¹æ‹¥æœ‰çš„å­ä¸²ä¸ªæ•°ï¼ŒæŸ¥è¯¢æ—¶æŒ‰ç…§å¦‚ä¸‹æ³•åˆ™ï¼š</p><ul><li>å¦‚æœäºŒåˆ†ç­”æ¡ˆåœ¨è¯¥ä½ä¸º0ï¼Œé‚£ä¹ˆ$a[j]$åœ¨è¯¥ä½çš„å€¼ä¸å…¶åå‘è¾¹æ‰€æ‹¥æœ‰çš„æ‰€æœ‰ä¸²å¼‚æˆ–å…¨éƒ¨éƒ½å¯ä»¥å–ï¼ŒåŒå‘è¾¹åˆ™éœ€è¦è¿›ä¸€æ­¥dfsçœ‹æ›´ä½ä½çš„æƒ…å†µã€‚</li><li>å¦‚æœäºŒåˆ†ç­”æ¡ˆåœ¨è¯¥ä½ä¸º0ï¼Œé‚£ä¹ˆå¿…é¡»èµ°åå‘è¾¹æ‰èƒ½æ»¡è¶³è¿™ä¸€ä½ä¸æ¯”1å°ï¼Œç´ ä»¥ä»åå‘è¾¹å¼€å§‹è¿›ä¸€æ­¥dfsï¼›è¿™é‡Œè¦åˆ¤æ–­ä¸€ä¸‹æ˜¯å¦å­˜åœ¨è‡³å°‘ä¸€ä¸ªåå‘è¾¹ï¼Œå¦‚æœæ²¡æœ‰ç›´æ¥è¿”å›0å³å¯ã€‚ï¼ˆå› ä¸ºç»ˆç‚¹æ ¹æ®weiæ˜¯å¦å°äº0åˆ¤æ–­ï¼Œå°äº0è¿”å›1ï¼Œå…¶å‰ææ˜¯å‰é¢çš„æ¯ä¸€ä½éƒ½ç›¸ç­‰ï¼Œæ‰€ä»¥ä¸å…è®¸ä¹‹å‰æœ‰ä¸å­˜åœ¨çš„æƒ…å†µï¼‰</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">32</span>;</span><br><span class="line"><span class="keyword">const</span> itn maxn = <span class="number">1e5</span> * (N + <span class="number">5</span>) + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">TRIE</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> version = <span class="number">0</span>, top = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> ch[maxn][<span class="number">2</span>], root[maxn];;</span><br><span class="line">    <span class="keyword">int</span> size[maxn];</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(ll x)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> rot = root[version];</span><br><span class="line">        root[++version] = ++top;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">            <span class="keyword">int</span> id = (x &gt;&gt; i) &amp; <span class="number">1</span>;</span><br><span class="line">            ch[top][id] = top + <span class="number">1</span>;</span><br><span class="line">            ch[top][!id] = ch[rot][!id];</span><br><span class="line">            size[top] = size[rot] + <span class="number">1</span>;</span><br><span class="line">            top++; rot = ch[rot][id];</span><br><span class="line">        &#125;</span><br><span class="line">        size[top] = size[rot] + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//æŸ¥è¯¢[L + 1, R]åŒºé—´ä¸­å¼‚æˆ–ä¸Šxåå¤§äºç­‰äºkeyçš„æ•°é‡</span></span><br><span class="line">    <span class="function">ll <span class="title">query</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, ll x, ll key, <span class="keyword">int</span> wei)</span></span>&#123;</span><br><span class="line">        <span class="comment">//ä»€ä¹ˆæ—¶å€™ä¼šè¿›è¡Œé€’å½’ï¼Ÿå‰é¢çš„æ‰€æœ‰ä½éƒ½ç›¸ç­‰çš„æƒ…å†µï¼</span></span><br><span class="line">        <span class="keyword">if</span>(wei &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        ll res = <span class="number">0</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">int</span> op = (key &gt;&gt; wei) &amp; <span class="number">1</span>, id = (x &gt;&gt; wei) &amp; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="comment">//keyçš„è¿™ä¸€ä½æ˜¯0ï¼Œç»“æœå¯ä»¥æ˜¯0/1</span></span><br><span class="line">            res += size[ch[r][!id]] - size[ch[l][!id]];</span><br><span class="line">            <span class="keyword">if</span>(size[ch[r][id]] - size[ch[l][id]] &gt; <span class="number">0</span>)</span><br><span class="line">                res += <span class="built_in">query</span>(ch[l][id], ch[r][id], x, key, wei - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(size[ch[r][!id]] - size[ch[l][!id]] &gt; <span class="number">0</span>)</span><br><span class="line">            res += <span class="built_in">query</span>(ch[l][!id], ch[r][!id], x, key, wei - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">TRIE tree;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line">ll a[<span class="number">100010</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(ll x)</span></span>&#123;</span><br><span class="line">    <span class="comment">/*å¯¹äºæ¯ä¸ªå³ç«¯ç‚¹jï¼ŒæŸ¥è¯¢å·¦ç«¯ç‚¹[1, j]çœ‹å¤šå°‘ä¸ªåŒºé—´çš„å€¼å¤§äºç­‰äºx</span></span><br><span class="line"><span class="comment">     å‰ç¼€å·¦ç«¯ç‚¹åŒºé—´[0, j - 1] æŸ¥è¯¢[-1, j - 1] æ·»åŠ å†—ä½™é¡¹0 æ•…æŸ¥è¯¢[0, j]</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> l = tree.root[<span class="number">0</span>], r = tree.root[i];</span><br><span class="line">        ans += tree.<span class="built_in">query</span>(l, r, a[i], x, N - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> ans &gt;= m;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    tree.<span class="built_in">insert</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, a + i);</span><br><span class="line">        a[i] ^= a[i - <span class="number">1</span>];</span><br><span class="line">        tree.<span class="built_in">insert</span>(a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    ll left = <span class="number">0</span>, right = (<span class="number">1ll</span> &lt;&lt; <span class="number">32</span>) - <span class="number">1</span>, middle;</span><br><span class="line">    <span class="keyword">while</span>(left &lt; right)&#123;</span><br><span class="line">        middle = (left + right + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">check</span>(middle)) left = middle;</span><br><span class="line">        <span class="keyword">else</span> right = middle - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, left);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Trie </tag>
            
            <tag> å¯æŒä¹…åŒ– </tag>
            
            <tag> å¯æŒä¹…åŒ–01Trie </tag>
            
            <tag> å­—ç¬¦ä¸² </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2017_CCPC_HARBIN</title>
      <link href="/2020/06/16/2017-CCPC-HARBIN/"/>
      <url>/2020/06/16/2017-CCPC-HARBIN/</url>
      
        <content type="html"><![CDATA[<p>æ–°åšå®¢çš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œæ‰“ç®—å¸å–ä¸€ä¸‹ä¹‹å‰CSDNå†™å®Œåšå®¢æ‰¾ä¸åˆ°é¢˜çš„æ•™è®­ï¼šå¯¹äºå¥—é¢˜çš„è¡¥é¢˜åº”è¯¥è®¾ç½®ä¸€äº›æ¯”è¾ƒæ˜æ˜¾çš„ç›®å½•ä»¥å¾…ä»ŠåæŸ¥é˜…ï¼Œæ¯ä¸ªé¢˜ç›®çš„é¢˜ç›®ä»¥åŠçŸ¥è¯†ç‚¹éƒ½äºˆä»¥ç®€å•çš„æè¿°ã€‚</p><p>[toc]</p><span id="more"></span><p><strong><a href="https://vjudge.net/contest/378359">2017ä¸­å›½å¤§å­¦ç”Ÿç¨‹åºè®¾è®¡ç«èµ›-å“ˆå°”æ»¨ç«™</a></strong> </p><p>è¿™å¥½åƒæ˜¯ä¸€åœºæ¯”è¾ƒéš¾(<del>ä½†æ˜¯é˜Ÿå‹å¾ˆé¡¶</del>)çš„è®­ç»ƒèµ›ï¼Œç„¶è€Œæˆ‘åˆä¸€æ¬¡æ­»åœ¨äº†è®¡ç®—å‡ ä½•ä¸Šï¼Œå¹¶ä¸”æˆä¸ºçˆ†äº¤ç‹‚é­”â€¦qaq</p><p>ä¸è¿‡æ€»è€Œè¨€ä¹‹æ‰“å¥—é¢˜è¿˜æ˜¯æ„Ÿè§‰ä¸ä»…å¯¹äºç®—æ³•åŠ›è¿˜æ˜¯å¯¹äºç åŠ›éƒ½æœ‰å¾ˆå¤§çš„æå‡ï¼Œè‡ªæ­¤æˆ‘æ‰¾åˆ°äº†çœŸæ­£çš„å¿«ä¹ /xyx</p><!-- more --><p><img src="2017-CCPC-HARBIN/1.png" alt="1" style="zoom:50%;" /></p><hr><h3 id="A-å›æ–‡ä¸²-amp-çº¿æ®µæ ‘"><a href="#A-å›æ–‡ä¸²-amp-çº¿æ®µæ ‘" class="headerlink" title="A  å›æ–‡ä¸² &amp; çº¿æ®µæ ‘"></a><strong>A</strong>  å›æ–‡ä¸² &amp; çº¿æ®µæ ‘</h3><p>åœºä¸Šé˜Ÿå‹è¿‡äº†è¿™é“é¢˜(<del>orz</del>)ï¼Œèµ›åè‡ªå·±è¡¥ä¸€ä¸‹</p><p>ç ”è¯»é¢˜ç›®è§„å®šçš„å›æ–‡ä¸²çš„å…·ä½“å½¢å¼ï¼Œå‘ç°è¿™æ˜¯ä¸¤ä¸ªå›æ–‡ä¸²çš„åµŒå¥—ï¼Œå› è€Œé¢˜ç›®ä¾¿è½¬åŒ–ä¸ºäº†æ‰¾æœ‰åºå¯¹<code>(i, j)</code>æ»¡è¶³</p><ul><li><p>$i &lt;j$</p></li><li><p>$i + r[i] &gt;= j$</p></li><li><p>$j - r[j] &lt;= i$</p></li></ul><p>å…¶ä¸­$r[i]$æ˜¯ä»¥iä¸ºä¸­å¿ƒçš„å›æ–‡ä¸²çš„åŠå¾„ï¼›$r$æ•°ç»„å¯ä»¥ç”¨Manacherç®—æ³•$O(n)$çš„å¤„ç†å‡ºæ¥ï¼Œæ¥ä¸‹æ¥å°±æ˜¯ç»Ÿè®¡äº’ç›¸è¦†ç›–çš„ç‚¹å¯¹ã€‚</p><p>æƒ³äº†å¾ˆä¹…å¹¶æ²¡æœ‰æƒ³åˆ°å¥½åŠæ³•â€¦å­¦ä¹ äº†ä¸€ç•ªçº¿æ®µæ ‘çš„è§£æ³•..</p><p>æˆ‘ä»¬å…ˆé¢„å¤„ç†å‡ºæ•°ç»„<code>vec[i]</code>è¡¨ç¤ºä»¥<code>i</code>ä¸ºèµ·ç‚¹çš„å›æ–‡ä¸²çš„ä¸­å¿ƒä½ç½®ï¼Œç„¶åé¡ºåºéå†å­—ç¬¦ä¸²ï¼Œæ¯æ¬¡å°†æ•°ç»„<code>vec[i]</code>çš„ä¸­å¿ƒä½ç½®åŠ å…¥çº¿æ®µæ ‘ï¼Œæ¥ç€æŸ¥è¯¢<code>[i + 1, i + r[i]</code>ç‚¹çš„ä¸ªæ•°ã€‚å› ä¸ºæŸ¥è¯¢çš„æ˜¯<code>[i + 1, i + r[i]]</code>ï¼Œæ‰€ä»¥å¯ä»¥ä¿è¯ä¸Šè¿°ä¸‰ä¸ªæ¡ä»¶ä¸­çš„12æ¡ä»¶ï¼›å¦ä¸€æ–¹é¢ï¼Œå› ä¸ºè¯¥ä¸­å¿ƒç‚¹å·²ç»å‡ºç°åœ¨çº¿æ®µæ ‘ä¸­äº†ï¼Œæ‰€ä»¥å…¶èµ·ç‚¹çš„ä½ç½®ä¸€å®šå°äºç­‰äºå½“å‰ä½ç½®<code>i</code>ï¼Œè¿™ä¹Ÿå°±ä¿è¯æ¡ä»¶3çš„æˆç«‹ã€‚ç»¼ä¸Šæ‰€è¿°å°±å¯ä»¥$O(nlogn)$æ‰«ä¸€éå¾—åˆ°æ‰€æœ‰çš„ç»“æœã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">5e5</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> Manacherç®—æ³•</span></span><br><span class="line"><span class="comment"> è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²tempåŠå…¶é•¿åº¦n;</span></span><br><span class="line"><span class="comment"> è¯¥ç®—æ³•æ„é€ å‡ºså¹¶èµ‹äºˆæˆªæ–­æ ‡å¿—, è‡ªåŠ¨åˆå§‹åŒ–ã€è·å¾—æ•°ç»„p[i];</span></span><br><span class="line"><span class="comment"> å¯¹äºæŸä¸ªä½ç½®iâˆˆ[0, 2 * n], ä»¥iä¸ºä¸­å¿ƒçš„å›æ–‡ä¸²çš„å‚æ•°å¦‚ä¸‹:</span></span><br><span class="line"><span class="comment">    int start = (i / 2) - (p[i] / 2) + (i &amp; 1);    //å›æ–‡ä¸²åœ¨åŸä¸²ä¸­çš„èµ·ç‚¹</span></span><br><span class="line"><span class="comment">    int d = p[i] - 1;   //å›æ–‡ä¸²åœ¨åŸä¸²ä¸­çš„æ€»é•¿åº¦</span></span><br><span class="line"><span class="comment">    int middle = (i - 1) / 2;   //å›æ–‡ä¸²åœ¨åŸä¸²çš„ä¸­ç‚¹</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">char</span> temp[maxn], s[maxn &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> p[maxn &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">manacher</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">        s[i &lt;&lt; <span class="number">1</span>] = <span class="string">&#x27;#&#x27;</span>; s[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = temp[i];</span><br><span class="line">    &#125;</span><br><span class="line">    s[n &lt;&lt; <span class="number">1</span>] = <span class="string">&#x27;#&#x27;</span>; s[n &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> id = <span class="number">0</span>, right = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n &lt;&lt; <span class="number">1</span>; i++) p[i] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n &lt;&lt; <span class="number">1</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(i &lt;= right) p[i] = <span class="built_in">min</span>(right - i + <span class="number">1</span>, p[<span class="number">2</span> * id - i]);</span><br><span class="line">        <span class="keyword">while</span>(i + p[i] &lt;= <span class="number">2</span> * n &amp;&amp; i - p[i] &gt;= <span class="number">0</span> &amp;&amp; s[i + p[i]] == s[i - p[i]])</span><br><span class="line">            p[i]++;</span><br><span class="line">        <span class="keyword">if</span>(right &lt; i + p[i] - <span class="number">1</span>)&#123;</span><br><span class="line">            id = i; right = i + p[i] - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ls (p &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rs ((p &lt;&lt; 1) | 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mid ((l + r) &gt;&gt; 1)</span></span><br><span class="line"></span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; vec[maxn];</span><br><span class="line"></span><br><span class="line">ll st[maxn &lt;&lt; <span class="number">2</span>], tag[maxn &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="comment">//åŒºé—´æŸ¥è¯¢ï¼Œå•ç‚¹ç½®å€¼ã€‚</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">up</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;st[p] = st[ls] + st[rs];&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l == r &amp;&amp; l == k)&#123;</span><br><span class="line">        st[p] += <span class="number">1</span>;</span><br><span class="line">        tag[p] += <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(k &lt;= mid) <span class="built_in">update</span>(ls, l, mid, k);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">update</span>(rs, mid + <span class="number">1</span>, r, k);</span><br><span class="line">    <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">query</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L &gt; R) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= l &amp;&amp; r &lt;= R) <span class="keyword">return</span> st[p];</span><br><span class="line">    ll ans =<span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= mid) ans += <span class="built_in">query</span>(ls, l, mid, L, R);</span><br><span class="line">    <span class="keyword">if</span>(R &gt; mid) ans += <span class="built_in">query</span>(rs, mid + <span class="number">1</span>, r, L, R);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="keyword">int</span> t; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;t); <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        <span class="built_in">clr</span>(st, <span class="number">0</span>); <span class="built_in">clr</span>(tag, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, temp); n = (<span class="keyword">int</span>)<span class="built_in">strlen</span>(temp);</span><br><span class="line">        <span class="built_in">manacher</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) vec[i].<span class="built_in">clear</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">2</span> * n; i += <span class="number">2</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> start = (i / <span class="number">2</span>) - (p[i] / <span class="number">2</span>) + (i &amp; <span class="number">1</span>), middle = (i - <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">            vec[start].<span class="built_in">push_back</span>(middle);</span><br><span class="line">        &#125;</span><br><span class="line">        ll ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">            <span class="comment">//2 * i + 1 æ˜¯åœ¨sä¸²ä¸­çš„ä¸‹æ ‡ã€‚</span></span><br><span class="line">            <span class="keyword">int</span> r = (p[<span class="number">2</span> * i + <span class="number">1</span>] - <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> x: vec[i]) <span class="built_in">update</span>(<span class="number">1</span>, <span class="number">0</span>, n - <span class="number">1</span>, x);</span><br><span class="line">            ans += <span class="built_in">query</span>(<span class="number">1</span>, <span class="number">0</span>, n - <span class="number">1</span>, i + <span class="number">1</span>, i + r);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="B-åŒºé—´ç¬¬kå¤§-gt-äºŒåˆ†"><a href="#B-åŒºé—´ç¬¬kå¤§-gt-äºŒåˆ†" class="headerlink" title="B  åŒºé—´ç¬¬kå¤§ -&gt; äºŒåˆ†"></a><strong>B</strong>  åŒºé—´ç¬¬kå¤§ -&gt; äºŒåˆ†</h3><p>ä¸Šä¸€æ¬¡è§åˆ°åŒºé—´ç¬¬kå¤§ç›¸å…³é—®é¢˜æ—¶æ˜¯åœ¨2018CCPCç½‘ç»œèµ›ï¼Œå½“æ—¶å¥½åƒæ˜¯ä¸ªçœŸå®çš„åœ¨çº¿æŸ¥è¯¢ä¸ä¿®æ”¹çš„ä¸»å¸­æ ‘ï¼Œè€Œè¿™ä¸€æ¬¡æ˜¯ä¸€ä¸ªæŠ«ç€ç¬¬kå¤§å¤–è¡£çš„äºŒåˆ†ç®—æ³•ã€‚</p><p>å¯¹äºæŸä¸ªå¾…æ£€éªŒçš„å€¼xï¼Œæˆ‘ä»¬ç»Ÿè®¡è¯¥åºåˆ—ä¸­æ‰€æœ‰<strong>æ»¡è¶³å…¶ç¬¬kå¤§çš„æ•°å¤§äºç­‰äºxçš„åŒºé—´</strong>çš„ä¸ªæ•°ã€‚å¦‚æœæœ‰ä¸ªæ•°$cnt&gt;=m$ï¼Œé‚£ä¹ˆè¿™ä¸ªå€¼$x$å°±æœ‰å¯èƒ½æˆä¸ºæœ€ç»ˆçš„ç¬¬må¤§æ•°ï¼Œæ›´æ–°äºŒåˆ†ä¸‹ç•Œï¼›ä¸ç„¶ï¼Œè¿™ä¸ªæ•°è‚¯å®šä¸ä¼šæˆä¸ºç¬¬må¤§æ•°ï¼Œæ›´æ–°äºŒåˆ†ä¸Šç•Œã€‚</p><p>æœ‰çš„ç­”æ¡ˆç”¨äº†ç¦»æ•£åŒ–&amp;äºŒåˆ†ç­”æ¡ˆï¼Œæˆ‘å­¦ä¹ äº†è¿™ç§æ€æƒ³åè§‰å¾—æ²¡æœ‰å¿…è¦è¿›è¡Œç¦»æ•£åŒ–çš„äºŒåˆ†ç­”æ¡ˆï¼Œå¯ä»¥ç›´æ¥å¯¹æ’è¿‡åºã€å»è¿‡é‡çš„åºåˆ—çš„ä¸‹æ ‡è¿›è¡ŒäºŒåˆ†ï¼Œæ£€æŸ¥å½“å‰ä¸‹æ ‡æ‰€å¯¹åº”çš„å€¼ä»¥åŠåºåˆ—ä¸­å…¶ä»–å€¼çš„å¤§å°å…³ç³»å³å¯ã€‚</p><p><del>å› ä¸ºå­¦ä¹ çš„ç®—æ³•ä¸­ä»1å¼€å§‹ç¼–å·ï¼Œæ‰€ä»¥æˆ‘åœ¨L13è®¡ç®—çš„æ—¶å€™ä¹Ÿç”¨äº†(n - vec[i] + 1)è®¡ç®—â€¦.å› è€ŒDEBUGäº†åŠå¤©æ‰è¿‡â€¦.</del></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, l;</span><br><span class="line">ll m;</span><br><span class="line"><span class="keyword">int</span> a[maxn], b[maxn];</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; vec;</span><br><span class="line"><span class="comment">//æ£€æŸ¥å¤šå°‘ä¸ªåŒºé—´çš„ç¬¬kå¤§æ•° &gt;= x</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    vec.<span class="built_in">clear</span>(); vec.<span class="built_in">push_back</span>(<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="keyword">if</span>(a[i] &gt;= x) vec.<span class="built_in">push_back</span>(i);</span><br><span class="line">    ll res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, top = (<span class="keyword">int</span>)vec.<span class="built_in">size</span>(); i &lt; top; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(i &gt;= l) res += (vec[i - l + <span class="number">1</span>] - vec[i - l]) * <span class="number">1ll</span> * (n - vec[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res &gt;= m;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    Fastin;</span></span><br><span class="line">    <span class="keyword">int</span> t; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;t); <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %lld&quot;</span>, &amp;n, &amp;l, &amp;m); <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a + i);</span><br><span class="line">            b[i] = a[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">sort</span>(b, b + n);</span><br><span class="line">        <span class="keyword">int</span> top = (<span class="keyword">int</span>)(<span class="built_in">unique</span>(b, b + n) - b);</span><br><span class="line">        <span class="keyword">int</span> left = <span class="number">0</span>, right = top - <span class="number">1</span>, middle;</span><br><span class="line">        <span class="keyword">while</span>(left &lt; right)&#123;</span><br><span class="line">            middle = (left + right + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">check</span>(b[middle])) left = middle;</span><br><span class="line">            <span class="keyword">else</span> right = middle - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, b[left]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><del>å› ä¸ºä¸2020æ ¡èµ›ç½‘ç»œèµ›Ié¢˜ç±»ä¼¼ï¼Œè€Œå½“æ—¶é‚£é“é¢˜çœ‹é¢˜è§£å¥½åƒå¥½éš¾çš„æ ·å­å°±æ²¡æœ‰è¡¥ï¼Œæ‰€ä»¥å€Ÿæ­¤æœºä¼šä¹Ÿè¡¥å®Œäº†Ié¢˜å­¦ä¹ äº†ç¬¬ä¸€ä¸ªå¯æŒä¹…åŒ–ç»“æ„</del></p><h3 id="J-ç»„åˆæ•°å­¦-amp-æ•°å­¦æœŸæœ›"><a href="#J-ç»„åˆæ•°å­¦-amp-æ•°å­¦æœŸæœ›" class="headerlink" title="J   ç»„åˆæ•°å­¦ &amp; æ•°å­¦æœŸæœ›"></a>J   ç»„åˆæ•°å­¦ &amp; æ•°å­¦æœŸæœ›</h3><p>å­¦ä¹ äºåšå®¢ : <a href="https://blog.csdn.net/axuhongbo/article/details/78684561">hdu6239 Interview æœŸæœ›+æ‹‰æ ¼æœ—æ—¥æ’å€¼æ³•|ç”Ÿæˆå‡½æ•° æ¨å…¬å¼</a></p><p>ç®—æ˜¯ä¸€ä¸ªæ¯”è¾ƒçº¯ç²¹çš„æ•°å­¦é¢˜ï¼Œä½†æ˜¯å‘ç°è¿™é“é¢˜ç›®çš„æ—¶å€™å·²ç»æœ‰ç‚¹æ™šï¼Œæ²¡æœ‰æ¥å¾—åŠæ¨å®Œæ‰€æœ‰ç»“æœã€‚</p><p>æœ€åˆæˆ‘è‡ªå·±æƒ³çš„æ—¶å€™æ²¡æœ‰è€ƒè™‘æ¸…æ¥šï¼Œè®¤ä¸ºå½“å‰è§‚æµ‹åˆ°çš„äº‹å®æ‰€å¸¦æ¥ä¸€äº›çº¦æŸæ¡ä»¶å‡ºç°çš„å‡ ç‡éƒ½æ˜¯ç­‰å¯èƒ½çš„ï¼Œä½†æ˜¯è¿™ä¸ç¬¦åˆé¢˜ç›®çš„è¦æ±‚ï¼›é¢˜ç›®åªä¿è¯äº†åœ¨æœ€å¼€å§‹ç»ç†é€‰æ‹©Kå€¼æ—¶æ¯ä¸ªä½ç½®å‡ ç‡ç›¸ç­‰ï¼Œæ‰€ä»¥å½“è§‚æµ‹å‘ç”Ÿåï¼Œå°½ç®¡Kå¯èƒ½å‡ºç°çš„èŒƒå›´ç¡®å®šï¼Œä½†æ˜¯ä»–ä»¬çš„å‡ ç‡ä¸æ˜¯ç­‰å¯èƒ½çš„ï¼Œä¸èƒ½ç®€å•çš„è¿›è¡Œç­‰æ¦‚ç‡è®¡ç®—ã€‚</p><p>ä¸€ç§å¯è¡Œçš„åŠæ³•æ˜¯è½¬åŒ–ä¸ºå¤å…¸æ¦‚å‹ï¼Œé€šè¿‡æƒ…å†µçš„æ€»æ•°ã€æ¯ä¸€ç§æƒ…å†µä¸‹çš„è§‚æµ‹å€¼è¿›è¡Œè®¡ç®—éšæœºå˜é‡çš„æ•°å­¦æœŸæœ›ã€‚</p><p>å½“<strong>å·²çŸ¥Bobåœ¨ç¬¬ä¸€å¤©é¢è¯•</strong>æ—¶ï¼Œåº”è¯¥æœ‰ä¸ç­‰å¼$1 &lt;= b &lt;= k &lt; a &lt;= n$ï¼Œæ€»æ•°å°±æ˜¯è¿™ä¸ªä¸ç­‰å¼æ‰€æœ‰å¯èƒ½çš„ä¸‰å…ƒç»„$(b, k, a)$çš„ä¸ªæ•°ã€‚æˆ‘ä»¬å¯ä»¥å°†ä¸ç­‰å¼è½¬åŒ–ä¸ºå¦ä¸€ç§å½¢å¼:</p><p>ä»¤: <script type="math/tex">x= b- 1, y = k - b, z = a - k - 1, w = n - a</script></p><p>åˆ™æœ‰: <script type="math/tex">x + y + z + w = n - 2, x, y, z, w>=0</script></p><p>æ±‚ä¸å®šæ–¹ç¨‹çš„æ•´æ•°è§£ä¸ªæ•°ã€‚</p><p>é‚£ä¹ˆç»“æœæ˜¾ç„¶ï¼Œæ€»æ•°æœ‰$(^{n+1}_{\space\space3})$</p><p>æ¥ä¸‹æ¥è€ƒè™‘ç¬¬äºŒå¤©é¢è¯•æ¬¡åºçš„å€¼ã€‚è€ƒè™‘è¿™æ ·çš„æšä¸¾æ–¹æ³•ï¼šæšä¸¾Bobå’ŒAliceçš„é—´è·$d$ï¼Œä¸¤äººä¸€å…±æœ‰$n-d$ç§å¯èƒ½çš„å¸ƒç½®ä½ç½®ï¼Œè€Œå¯¹äºæ¯ä¸€ç§ä½ç½®ï¼ŒKå¯ä»¥å–çš„èŒƒå›´ä¸º<code>[Bob, Alice)</code>ï¼ŒAliceç¬¬äºŒå¤©çš„é¢è¯•æ¬¡åºå¯¹åº”åˆ†åˆ«ä¸º<code>1,2,...,d</code>ã€‚å› è€Œå¯¹äºæ¯ä¸€ä¸ª$d$ï¼Œéƒ½ä¼šæœ‰è´¡çŒ®$\frac{d *(d + 1)}{2}$ã€‚æ•…åœ¨æ‰€æœ‰æƒ…å†µä¸­ï¼ŒAliceçš„ä½ç½®å¯ä»¥ç”¨ä»¥ä¸‹å’Œå¼è¡¨è¾¾ï¼š</p><p>$\sum_{d = 1}^{n-1}$ $(n-d)<em>$ $ \frac {d </em>(d + 1)}{2}$       $(*)$</p><p>åŒ–ç®€ä¸€ç•ªå¾—åˆ°$(^{n+2}_{\space\space4})$</p><p>ç”±äºè¿™ä¸ªå’Œå¼å¯ä»¥å¾ˆå®¹æ˜“åœ°æ„é€ é˜¶æ¢¯é¡¹åšå·®æ¶ˆå»ä¸­é—´é‡ï¼Œæ‰€ä»¥æ²¡æœ‰èŠ±åŠŸå¤«å†å»å­¦ä¹ <del>æ‹‰æ ¼æœ—æ—¥æ’å€¼ ç”Ÿæˆå‡½æ•°</del>ç­‰ç®—æ³•ã€‚ä¸è¿‡æœ€ä¸»è¦çš„åŸå› è¿˜æ˜¯è¦å­¦çš„ä¸œè¥¿å¤ªå¤šäº†â€¦è€Œç»„åˆæ•°å­¦å’Œå…·ä½“æ•°å­¦å·²ç»æ— æ•°æ¬¡è¢«æèµ·æ—¥ç¨‹å¹¶è¢«æ‹–å»¶è‡³ä»Šäº†ã€‚</p><p>ä¸‹é¢<strong>è€ƒè™‘Bobåœ¨ç¬¬äºŒå¤©é¢è¯•</strong>æ—¶ã€‚</p><p>æ€»æ•°å¯ä»¥ç±»ä¼¼åœ°è€ƒè™‘ä¸¤ä¸ªä¸ç­‰å¼çš„å€¼:</p><p>$0 &lt;= k &lt;a &lt;b &lt;= n$</p><p>$0&lt;=k&lt;b&lt;a&lt;=n$</p><p>è¿™ä¸¤ä¸ªä¸ç­‰å¼å½¢å¼å¯¹ç§°ï¼Œç»“åˆBobç¬¬ä¸€å¤©çš„è®¨è®ºæ–¹æ³•æ˜“çŸ¥ç»“æœä¸º$2*(^{n+1}_{\space\space3})$.</p><p>è€Œé¢è¯•çš„æ¬¡åºåˆ†ä¸ºä¸¤ç±»æƒ…å†µè®¨è®º:</p><ul><li>$0 &lt;= k &lt; a &lt; b &lt;= n$. åœ¨è¿™ç§æƒ…å†µä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç±»ä¼¼åœ°æšä¸¾è·ç¦»$d = b - k$ï¼Œå¯¹äºæ¯ä¸€ä¸ªè·ç¦»Aliceçš„æ¬¡åºä¼šå–åˆ°<code>[1,..,d-1]</code>ï¼Œ$d$ä»2å–åˆ°nï¼Œå°†$(*)$å¼ç¨ä½œå˜æ¢å°±ä¸è¿™ç§æƒ…å†µç›¸åŒã€‚</li><li>$0 &lt;= k &lt; b &lt; a &lt;= n$. æ­¤æ—¶ï¼Œæˆ‘ä»¬æšä¸¾Aliceåœ¨ç¬¬äºŒå¤©çš„æ¬¡åºï¼Œå³$d = a - k$ã€‚å¯¹äºæ¯ä¸€ä¸ªæ¬¡åºï¼ŒBobå¯ä»¥å–çš„èŒƒå›´åœ¨<code>[k + 1, a- 1]</code>ï¼Œå³æœ‰$d-1$ç§å¯è¡Œä½ç½®ï¼Œé‚£ä¹ˆç»“æœå°±æ˜¯$\sum_{d=2}^{n}$ $d(d-1)$ï¼Œè¿™æ°æ˜¯ä¸Šä¸€ç§æƒ…å†µã€ä¹Ÿå°±æ˜¯$(*)$å¼çš„ä¸¤å€ã€‚</li></ul><p>å› è€Œç»¼ä¸Šæ‰€ç¤ºï¼ŒBobåœ¨ç¬¬äºŒå¤©æ—¶ä½æ¬¡çš„æ€»å’Œæ˜¯$(<em>)$ å¼çš„ä¸‰å€ï¼Œå³$3</em>(^{n+2}_{\space\space4})$.</p><p>è‡³æ­¤ï¼Œæˆ‘ä»¬æœ‰äº†æ€»æ•°å’Œæ¯ç§æƒ…å†µä¸‹çš„æ¬¡åºä¹‹å’Œï¼Œåšé™¤æ³•å°±å¯ä»¥å¾—åˆ°æœŸæœ›ã€‚ç»“æœåˆ†åˆ«ä¸º$\frac{n+2}{4}$ä¸$\frac{3n+6}{8}$ã€‚</p><h3 id="M-è®¡ç®—å‡ ä½•"><a href="#M-è®¡ç®—å‡ ä½•" class="headerlink" title="M è®¡ç®—å‡ ä½•"></a>M è®¡ç®—å‡ ä½•</h3><p><del>è®ºå¦‚ä½•çˆ†äº¤40å‘</del></p><p>ç»™å‡ºnä¸ªç‚¹ï¼Œè¯•æ‰¾å‡ºä¸€ä¸ªåœ†è¿‡$ceil\frac n2$ä¸ªç‚¹ï¼Œä¿è¯è¿™æ ·çš„åœ†ä¸€å®šå­˜åœ¨ã€‚</p><p>å¾ˆæ˜æ˜¾çš„ä¸€ä¸ªéšæœºåŒ–ï¼Œå®¹æ˜“æ¨å‡ºä»»æ„æ‰¾ä¸‰ä¸ªç‚¹ä¸åœ¨è¯¥åœ†ä¸Šçš„æ¦‚ç‡æ¥è¿‘$\frac78$ï¼Œå› è€Œæˆ‘ä»¬åªéœ€è¦éšæœº100æ¬¡å°±å¯ä»¥å‡ ä¹ç¡®å®šä¸‹æ¥è¿™ä¸ªåœ†ã€‚é‚£ä¸ºä»€ä¹ˆWAäº†40å‘å‘¢..ä»¥ä¸ºæ˜¯ç²¾åº¦ï¼Œç»“æœæ˜¯æƒ…å†µå°‘è€ƒè™‘äº†ã€‚qaqåœ¨æˆ‘çš„ç®—æ³•ä¸­ï¼Œå¦‚æœéšæœºå¾—åˆ°çš„3ä¸ªç‚¹å…±çº¿ï¼Œå°±continueè¿›è¡Œä¸‹ä¸€æ¬¡ã€‚ç„¶è€Œæˆ‘æ²¡æœ‰ç‰¹åˆ¤4ç‚¹å…±çº¿çš„æƒ…å†µï¼Œå¯¼è‡´äº†è¿™ç§æƒ…å†µä¸‹æ‰¾ä¸åˆ°ä¸€ä¸ªåˆé€‚çš„åœ†ã€‚</p><p>è´´ä¸€ä¸ªå·²çŸ¥å¹³é¢ä¸‰ç‚¹æ±‚åœ†å¿ƒåŠå…¶åŠå¾„çš„æ¿å­ã€‚</p><p>è¯æ˜æ–¹æ³•ä¸ºåšå·®è§£äºŒå…ƒä¸€æ¬¡æ–¹ç¨‹çš„è¡Œåˆ—å¼ç»“æœã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cal</span><span class="params">(<span class="keyword">double</span> x1, <span class="keyword">double</span> y1, <span class="keyword">double</span> x2, <span class="keyword">double</span> y2, <span class="keyword">double</span> x3, <span class="keyword">double</span> y3)</span></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> a, b, c, d, e, f;</span><br><span class="line">    a = <span class="number">2</span> * (x2 - x1);</span><br><span class="line">    b = <span class="number">2</span> * (y2 - y1);</span><br><span class="line">    c = x2 * x2 + y2 * y2 - x1 * x1 - y1 * y1;</span><br><span class="line">    d = <span class="number">2</span> * (x3 - x2);</span><br><span class="line">    e = <span class="number">2</span> * (y3 - y2);</span><br><span class="line">    f = x3 * x3 + y3 * y3 - x2 * x2 - y2 * y2;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">double</span> x, y, r;</span><br><span class="line">    x = (b * f - e * c)/(b * d - e * a);</span><br><span class="line">    y = (d * c - a * f)/(b * d - e * a);</span><br><span class="line">    r = <span class="built_in">sqrt</span>((x - x1) * (x - x1) + (y - y1) * (y - y1));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ACM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¡ç®—å‡ ä½• </tag>
            
            <tag> å›æ–‡æ ‘ </tag>
            
            <tag> çº¿æ®µæ ‘ </tag>
            
            <tag> äºŒåˆ† </tag>
            
            <tag> åŒºé—´ç¬¬kå¤§ </tag>
            
            <tag> ç»„åˆæ•°å­¦ </tag>
            
            <tag> æ•°å­¦æœŸæœ› </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
